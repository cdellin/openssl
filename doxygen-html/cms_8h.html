<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/cms/cms.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_7882632c4dffce91474d1f2c5c940725.html">cms</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">cms.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;openssl/x509.h&gt;</code><br/>
</div>
<p><a href="cms_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa90a5540395664981482a8f6aa9e5e33"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aa90a5540395664981482a8f6aa9e5e33">CMS_SIGNERINFO_ISSUER_SERIAL</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:ad42a4799f8919e59919223af98623ca0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ad42a4799f8919e59919223af98623ca0">CMS_SIGNERINFO_KEYIDENTIFIER</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:a772ce5ff5d0aea0e9003b401fe418fb0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a772ce5ff5d0aea0e9003b401fe418fb0">CMS_RECIPINFO_NONE</a>&#160;&#160;&#160;-1</td></tr>
<tr class="memitem:a16bd2b791fd7cc36a235fe459226ebfa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:acef9d700f8704eef4c8cef466d2ccce2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:a2e860541fc9b71e68774a92635e7c03a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>&#160;&#160;&#160;2</td></tr>
<tr class="memitem:ab206c8d6ec7c2bc1c4798b3775759db5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ab206c8d6ec7c2bc1c4798b3775759db5">CMS_RECIPINFO_PASS</a>&#160;&#160;&#160;3</td></tr>
<tr class="memitem:ad984582c1d86072a850b447553ab9506"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ad984582c1d86072a850b447553ab9506">CMS_RECIPINFO_OTHER</a>&#160;&#160;&#160;4</td></tr>
<tr class="memitem:a6386aad1cceb6f5561003c28bbf2dcb3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a6386aad1cceb6f5561003c28bbf2dcb3">CMS_TEXT</a>&#160;&#160;&#160;0x1</td></tr>
<tr class="memitem:aebd9b8ff6570442e29aa864e3b91d645"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aebd9b8ff6570442e29aa864e3b91d645">CMS_NOCERTS</a>&#160;&#160;&#160;0x2</td></tr>
<tr class="memitem:adda58aee98a505082601471e313a61f4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#adda58aee98a505082601471e313a61f4">CMS_NO_CONTENT_VERIFY</a>&#160;&#160;&#160;0x4</td></tr>
<tr class="memitem:acb04c24ec58a4dec438798d4801d0315"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#acb04c24ec58a4dec438798d4801d0315">CMS_NO_ATTR_VERIFY</a>&#160;&#160;&#160;0x8</td></tr>
<tr class="memitem:a140e381c7de31bd3381593ea4cd46b73"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a140e381c7de31bd3381593ea4cd46b73">CMS_NOSIGS</a>&#160;&#160;&#160;(<a class="el" href="cms_8h.html#adda58aee98a505082601471e313a61f4">CMS_NO_CONTENT_VERIFY</a>|<a class="el" href="cms_8h.html#acb04c24ec58a4dec438798d4801d0315">CMS_NO_ATTR_VERIFY</a>)</td></tr>
<tr class="memitem:a7e17b533e127751bf3bea0370437c365"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7e17b533e127751bf3bea0370437c365">CMS_NOINTERN</a>&#160;&#160;&#160;0x10</td></tr>
<tr class="memitem:ac1582d4bdb24ac326ebfb0168df964c8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ac1582d4bdb24ac326ebfb0168df964c8">CMS_NO_SIGNER_CERT_VERIFY</a>&#160;&#160;&#160;0x20</td></tr>
<tr class="memitem:ae74af7175ab866497b77b6caddbc0875"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae74af7175ab866497b77b6caddbc0875">CMS_NOVERIFY</a>&#160;&#160;&#160;0x20</td></tr>
<tr class="memitem:a9aca14ae67c24cf5b7d0c66368fab072"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a9aca14ae67c24cf5b7d0c66368fab072">CMS_DETACHED</a>&#160;&#160;&#160;0x40</td></tr>
<tr class="memitem:a26044c9210eb8c5e3308d023ae4d5245"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a26044c9210eb8c5e3308d023ae4d5245">CMS_BINARY</a>&#160;&#160;&#160;0x80</td></tr>
<tr class="memitem:a55173b8e2b621059aec758e57360c043"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a55173b8e2b621059aec758e57360c043">CMS_NOATTR</a>&#160;&#160;&#160;0x100</td></tr>
<tr class="memitem:ac1f8028ac155516a5750f6c35a294f24"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ac1f8028ac155516a5750f6c35a294f24">CMS_NOSMIMECAP</a>&#160;&#160;&#160;0x200</td></tr>
<tr class="memitem:a2b89f1f31e961cfb9b4b886aec1253ac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2b89f1f31e961cfb9b4b886aec1253ac">CMS_NOOLDMIMETYPE</a>&#160;&#160;&#160;0x400</td></tr>
<tr class="memitem:ae5058fb6c9fe884c071d3f474bd082ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae5058fb6c9fe884c071d3f474bd082ff">CMS_CRLFEOL</a>&#160;&#160;&#160;0x800</td></tr>
<tr class="memitem:af7c70d85fa217f66b9f10bc37281c723"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af7c70d85fa217f66b9f10bc37281c723">CMS_STREAM</a>&#160;&#160;&#160;0x1000</td></tr>
<tr class="memitem:a98467ee02388202556ca48bb523b8509"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a98467ee02388202556ca48bb523b8509">CMS_NOCRL</a>&#160;&#160;&#160;0x2000</td></tr>
<tr class="memitem:a20b64bc8c182f7ac666da5bcb0190c07"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a20b64bc8c182f7ac666da5bcb0190c07">CMS_PARTIAL</a>&#160;&#160;&#160;0x4000</td></tr>
<tr class="memitem:a925a18a0aeb4d0f8cdec3b24ffa9774b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a925a18a0aeb4d0f8cdec3b24ffa9774b">CMS_REUSE_DIGEST</a>&#160;&#160;&#160;0x8000</td></tr>
<tr class="memitem:ae4670dfe3e27c5494ea55bc9f7a70296"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae4670dfe3e27c5494ea55bc9f7a70296">CMS_USE_KEYID</a>&#160;&#160;&#160;0x10000</td></tr>
<tr class="memitem:a3e910f5d1c60a64bd5c43ef26ccd43ce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a3e910f5d1c60a64bd5c43ef26ccd43ce">CMS_DEBUG_DECRYPT</a>&#160;&#160;&#160;0x20000</td></tr>
<tr class="memitem:afcd7a48a3b9f4a217ad110d7b4adc5ba"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#afcd7a48a3b9f4a217ad110d7b4adc5ba">CMS_KEY_PARAM</a>&#160;&#160;&#160;0x40000</td></tr>
<tr class="memitem:a2dff043317948b4c2c08a305cf10b478"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2dff043317948b4c2c08a305cf10b478">CMS_ASCIICRLF</a>&#160;&#160;&#160;0x80000</td></tr>
<tr class="memitem:a561078e96618f1985e95d5a7cb8b63e6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a561078e96618f1985e95d5a7cb8b63e6">CMS_F_CHECK_CONTENT</a>&#160;&#160;&#160;99</td></tr>
<tr class="memitem:a4da4a99381f52334723946f198d87728"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a4da4a99381f52334723946f198d87728">CMS_F_CMS_ADD0_CERT</a>&#160;&#160;&#160;164</td></tr>
<tr class="memitem:a8d53d170864f78c0dc99b2fbaa0957e7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a8d53d170864f78c0dc99b2fbaa0957e7">CMS_F_CMS_ADD0_RECIPIENT_KEY</a>&#160;&#160;&#160;100</td></tr>
<tr class="memitem:abaa885cb63f5a560cd4068967d98b83a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#abaa885cb63f5a560cd4068967d98b83a">CMS_F_CMS_ADD0_RECIPIENT_PASSWORD</a>&#160;&#160;&#160;165</td></tr>
<tr class="memitem:a3793a15ee7d2330dd0bdac1f3c68820d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a3793a15ee7d2330dd0bdac1f3c68820d">CMS_F_CMS_ADD1_RECEIPTREQUEST</a>&#160;&#160;&#160;158</td></tr>
<tr class="memitem:a466fc9af20c872ac00dbf5e414c769d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a466fc9af20c872ac00dbf5e414c769d6">CMS_F_CMS_ADD1_RECIPIENT_CERT</a>&#160;&#160;&#160;101</td></tr>
<tr class="memitem:a33310fdd60839acfda68c53c7cf41209"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a33310fdd60839acfda68c53c7cf41209">CMS_F_CMS_ADD1_SIGNER</a>&#160;&#160;&#160;102</td></tr>
<tr class="memitem:a544c5f98db03880a3e686c494ffae5cc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a544c5f98db03880a3e686c494ffae5cc">CMS_F_CMS_ADD1_SIGNINGTIME</a>&#160;&#160;&#160;103</td></tr>
<tr class="memitem:a7c2ae2d56e874d77e44af42ef89eb680"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7c2ae2d56e874d77e44af42ef89eb680">CMS_F_CMS_COMPRESS</a>&#160;&#160;&#160;104</td></tr>
<tr class="memitem:a9250d8b36dc726d49394eb9b42418201"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a9250d8b36dc726d49394eb9b42418201">CMS_F_CMS_COMPRESSEDDATA_CREATE</a>&#160;&#160;&#160;105</td></tr>
<tr class="memitem:a2c52b7702cde42f20db70cbafdea16ed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2c52b7702cde42f20db70cbafdea16ed">CMS_F_CMS_COMPRESSEDDATA_INIT_BIO</a>&#160;&#160;&#160;106</td></tr>
<tr class="memitem:a24c10549d81c3d2123a62d72a35def71"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a24c10549d81c3d2123a62d72a35def71">CMS_F_CMS_COPY_CONTENT</a>&#160;&#160;&#160;107</td></tr>
<tr class="memitem:a02254ecb659ccbe4894135c4ee36e277"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a02254ecb659ccbe4894135c4ee36e277">CMS_F_CMS_COPY_MESSAGEDIGEST</a>&#160;&#160;&#160;108</td></tr>
<tr class="memitem:a47c7367f7f973cd508117a9fe8e7e6e8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a47c7367f7f973cd508117a9fe8e7e6e8">CMS_F_CMS_DATA</a>&#160;&#160;&#160;109</td></tr>
<tr class="memitem:a8e68562b976a1e675ef7a52b6b1601fd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a8e68562b976a1e675ef7a52b6b1601fd">CMS_F_CMS_DATAFINAL</a>&#160;&#160;&#160;110</td></tr>
<tr class="memitem:a2430638220587768d0447fc25fdd8efc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2430638220587768d0447fc25fdd8efc">CMS_F_CMS_DATAINIT</a>&#160;&#160;&#160;111</td></tr>
<tr class="memitem:ab9907d42c5fd1d4c8a8f3859f07f74d8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ab9907d42c5fd1d4c8a8f3859f07f74d8">CMS_F_CMS_DECRYPT</a>&#160;&#160;&#160;112</td></tr>
<tr class="memitem:a78082a731cf00f28c93aa366674cd426"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a78082a731cf00f28c93aa366674cd426">CMS_F_CMS_DECRYPT_SET1_KEY</a>&#160;&#160;&#160;113</td></tr>
<tr class="memitem:af41beccbed88ab6ec20442aed11a193f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af41beccbed88ab6ec20442aed11a193f">CMS_F_CMS_DECRYPT_SET1_PASSWORD</a>&#160;&#160;&#160;166</td></tr>
<tr class="memitem:ab2dcd528d2ac49bb38432d451217bd24"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ab2dcd528d2ac49bb38432d451217bd24">CMS_F_CMS_DECRYPT_SET1_PKEY</a>&#160;&#160;&#160;114</td></tr>
<tr class="memitem:a9ba97bf7f311bcc5ac1b5020e22cf63c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a9ba97bf7f311bcc5ac1b5020e22cf63c">CMS_F_CMS_DIGESTALGORITHM_FIND_CTX</a>&#160;&#160;&#160;115</td></tr>
<tr class="memitem:a5e4f1b8a34184e085d9623ba93382843"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a5e4f1b8a34184e085d9623ba93382843">CMS_F_CMS_DIGESTALGORITHM_INIT_BIO</a>&#160;&#160;&#160;116</td></tr>
<tr class="memitem:aa71e5f8afca2b67f50d075a33457d88f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aa71e5f8afca2b67f50d075a33457d88f">CMS_F_CMS_DIGESTEDDATA_DO_FINAL</a>&#160;&#160;&#160;117</td></tr>
<tr class="memitem:a05c0850f3d882fe12e80d8f01a5f3e10"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a05c0850f3d882fe12e80d8f01a5f3e10">CMS_F_CMS_DIGEST_VERIFY</a>&#160;&#160;&#160;118</td></tr>
<tr class="memitem:ad76a23b904c12491ccbf836d87ecb583"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ad76a23b904c12491ccbf836d87ecb583">CMS_F_CMS_ENCODE_RECEIPT</a>&#160;&#160;&#160;161</td></tr>
<tr class="memitem:a2711aa4754788e9c93186bbd082449bd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2711aa4754788e9c93186bbd082449bd">CMS_F_CMS_ENCRYPT</a>&#160;&#160;&#160;119</td></tr>
<tr class="memitem:a0212693acbc22d892fea7d594532dc5d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a0212693acbc22d892fea7d594532dc5d">CMS_F_CMS_ENCRYPTEDCONTENT_INIT_BIO</a>&#160;&#160;&#160;120</td></tr>
<tr class="memitem:a780c677d07227dec584a1606e13fca34"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a780c677d07227dec584a1606e13fca34">CMS_F_CMS_ENCRYPTEDDATA_DECRYPT</a>&#160;&#160;&#160;121</td></tr>
<tr class="memitem:af7ee42e04206b7dd3e2ae2547c07b596"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af7ee42e04206b7dd3e2ae2547c07b596">CMS_F_CMS_ENCRYPTEDDATA_ENCRYPT</a>&#160;&#160;&#160;122</td></tr>
<tr class="memitem:a6ba74b36decb7067945d6bc7b97a3ffa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a6ba74b36decb7067945d6bc7b97a3ffa">CMS_F_CMS_ENCRYPTEDDATA_SET1_KEY</a>&#160;&#160;&#160;123</td></tr>
<tr class="memitem:a2c6e13925680edf4647b340f6d2a53e7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2c6e13925680edf4647b340f6d2a53e7">CMS_F_CMS_ENVELOPEDDATA_CREATE</a>&#160;&#160;&#160;124</td></tr>
<tr class="memitem:ae35927bfd818290e5affff1a96ef33c6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae35927bfd818290e5affff1a96ef33c6">CMS_F_CMS_ENVELOPEDDATA_INIT_BIO</a>&#160;&#160;&#160;125</td></tr>
<tr class="memitem:ae3856b2ddbf1d25c08d5e6ebe9b5e8fd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae3856b2ddbf1d25c08d5e6ebe9b5e8fd">CMS_F_CMS_ENVELOPED_DATA_INIT</a>&#160;&#160;&#160;126</td></tr>
<tr class="memitem:af36b801b1dec357f689eff8c68fb16b4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af36b801b1dec357f689eff8c68fb16b4">CMS_F_CMS_ENV_ASN1_CTRL</a>&#160;&#160;&#160;171</td></tr>
<tr class="memitem:a8c7c5d5ca9eb1a7d0a6a957d5be72b08"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a8c7c5d5ca9eb1a7d0a6a957d5be72b08">CMS_F_CMS_FINAL</a>&#160;&#160;&#160;127</td></tr>
<tr class="memitem:aba70478a85afce278cce834619542bfa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aba70478a85afce278cce834619542bfa">CMS_F_CMS_GET0_CERTIFICATE_CHOICES</a>&#160;&#160;&#160;128</td></tr>
<tr class="memitem:ad1af319335c3d48e2cfacbef29f81101"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ad1af319335c3d48e2cfacbef29f81101">CMS_F_CMS_GET0_CONTENT</a>&#160;&#160;&#160;129</td></tr>
<tr class="memitem:a277697668b2b8d68c08929a7d9a30813"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a277697668b2b8d68c08929a7d9a30813">CMS_F_CMS_GET0_ECONTENT_TYPE</a>&#160;&#160;&#160;130</td></tr>
<tr class="memitem:a024f46d6ce854beb8be94aa80426e2cd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a024f46d6ce854beb8be94aa80426e2cd">CMS_F_CMS_GET0_ENVELOPED</a>&#160;&#160;&#160;131</td></tr>
<tr class="memitem:ad7ec80ae25d68851ee71802f00e63be3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ad7ec80ae25d68851ee71802f00e63be3">CMS_F_CMS_GET0_REVOCATION_CHOICES</a>&#160;&#160;&#160;132</td></tr>
<tr class="memitem:a5595c71064de9251e0a270e74769d5db"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a5595c71064de9251e0a270e74769d5db">CMS_F_CMS_GET0_SIGNED</a>&#160;&#160;&#160;133</td></tr>
<tr class="memitem:a0b9af42b4cb5106ebc14b28ff58d93c5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a0b9af42b4cb5106ebc14b28ff58d93c5">CMS_F_CMS_MSGSIGDIGEST_ADD1</a>&#160;&#160;&#160;162</td></tr>
<tr class="memitem:ad91284ad7bcf284f28c947eb15b78c9b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ad91284ad7bcf284f28c947eb15b78c9b">CMS_F_CMS_RECEIPTREQUEST_CREATE0</a>&#160;&#160;&#160;159</td></tr>
<tr class="memitem:a07a945524b609f3976c0fe852ad7558a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>&#160;&#160;&#160;160</td></tr>
<tr class="memitem:a7b61f312558cf5f0b0b6a488cad635a1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7b61f312558cf5f0b0b6a488cad635a1">CMS_F_CMS_RECIPIENTINFO_DECRYPT</a>&#160;&#160;&#160;134</td></tr>
<tr class="memitem:a0327f69f5888456157c4c359ac37fb7b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a0327f69f5888456157c4c359ac37fb7b">CMS_F_CMS_RECIPIENTINFO_ENCRYPT</a>&#160;&#160;&#160;169</td></tr>
<tr class="memitem:a58ff144816f61684193afd1144a81ba7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a58ff144816f61684193afd1144a81ba7">CMS_F_CMS_RECIPIENTINFO_KARI_ENCRYPT</a>&#160;&#160;&#160;178</td></tr>
<tr class="memitem:a013600bf0dcafcd84a215679ac3da0bc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a013600bf0dcafcd84a215679ac3da0bc">CMS_F_CMS_RECIPIENTINFO_KARI_GET0_ALG</a>&#160;&#160;&#160;175</td></tr>
<tr class="memitem:acd27a4f555ea6daf92dd1f33c3d68ce2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#acd27a4f555ea6daf92dd1f33c3d68ce2">CMS_F_CMS_RECIPIENTINFO_KARI_GET0_ORIG_ID</a>&#160;&#160;&#160;173</td></tr>
<tr class="memitem:a649b88a59acb6c0ada5c46c8e02e3d1b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a649b88a59acb6c0ada5c46c8e02e3d1b">CMS_F_CMS_RECIPIENTINFO_KARI_GET0_REKS</a>&#160;&#160;&#160;172</td></tr>
<tr class="memitem:a4c54f31257bf8a91ed5a502ab1a111de"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a4c54f31257bf8a91ed5a502ab1a111de">CMS_F_CMS_RECIPIENTINFO_KARI_ORIG_ID_CMP</a>&#160;&#160;&#160;174</td></tr>
<tr class="memitem:aa7a36dff4e89116aac8b38d29e472aab"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aa7a36dff4e89116aac8b38d29e472aab">CMS_F_CMS_RECIPIENTINFO_KEKRI_DECRYPT</a>&#160;&#160;&#160;135</td></tr>
<tr class="memitem:ae8eb3fb54c6c9a236ea9ea5463a8b985"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae8eb3fb54c6c9a236ea9ea5463a8b985">CMS_F_CMS_RECIPIENTINFO_KEKRI_ENCRYPT</a>&#160;&#160;&#160;136</td></tr>
<tr class="memitem:ad4b5d7960f63c3a1c4665c55436f69c0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ad4b5d7960f63c3a1c4665c55436f69c0">CMS_F_CMS_RECIPIENTINFO_KEKRI_GET0_ID</a>&#160;&#160;&#160;137</td></tr>
<tr class="memitem:a4823452068827ce9dff504d3dbd729d1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a4823452068827ce9dff504d3dbd729d1">CMS_F_CMS_RECIPIENTINFO_KEKRI_ID_CMP</a>&#160;&#160;&#160;138</td></tr>
<tr class="memitem:ac01c397092c078cb18f70f732d9c7349"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ac01c397092c078cb18f70f732d9c7349">CMS_F_CMS_RECIPIENTINFO_KTRI_CERT_CMP</a>&#160;&#160;&#160;139</td></tr>
<tr class="memitem:a655e5d8e32cdc48bb9f0b6bea13fba1a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a655e5d8e32cdc48bb9f0b6bea13fba1a">CMS_F_CMS_RECIPIENTINFO_KTRI_DECRYPT</a>&#160;&#160;&#160;140</td></tr>
<tr class="memitem:a40708bc6d3015cb8a6210124c0844e16"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a40708bc6d3015cb8a6210124c0844e16">CMS_F_CMS_RECIPIENTINFO_KTRI_ENCRYPT</a>&#160;&#160;&#160;141</td></tr>
<tr class="memitem:aaad41bb8ee537e69bf8a2f56f59337e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aaad41bb8ee537e69bf8a2f56f59337e5">CMS_F_CMS_RECIPIENTINFO_KTRI_GET0_ALGS</a>&#160;&#160;&#160;142</td></tr>
<tr class="memitem:a59b981b457a264b21809375134e4256d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a59b981b457a264b21809375134e4256d">CMS_F_CMS_RECIPIENTINFO_KTRI_GET0_SIGNER_ID</a>&#160;&#160;&#160;143</td></tr>
<tr class="memitem:a4c23192ef7c2b91b8760a454380d2de7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a4c23192ef7c2b91b8760a454380d2de7">CMS_F_CMS_RECIPIENTINFO_PWRI_CRYPT</a>&#160;&#160;&#160;167</td></tr>
<tr class="memitem:ade9eabf14d47c561634a7a5e28cfb3a9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ade9eabf14d47c561634a7a5e28cfb3a9">CMS_F_CMS_RECIPIENTINFO_SET0_KEY</a>&#160;&#160;&#160;144</td></tr>
<tr class="memitem:a860876d446accfddfa742b1f05347174"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a860876d446accfddfa742b1f05347174">CMS_F_CMS_RECIPIENTINFO_SET0_PASSWORD</a>&#160;&#160;&#160;168</td></tr>
<tr class="memitem:a2a8cd121b59b934d82e0affaf42bbe29"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2a8cd121b59b934d82e0affaf42bbe29">CMS_F_CMS_RECIPIENTINFO_SET0_PKEY</a>&#160;&#160;&#160;145</td></tr>
<tr class="memitem:a41192bd0a7fd2e8c036db77aa5346ea5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a41192bd0a7fd2e8c036db77aa5346ea5">CMS_F_CMS_SD_ASN1_CTRL</a>&#160;&#160;&#160;170</td></tr>
<tr class="memitem:a56afcc0b4f6ae8e72f2f2d367747c3c0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a56afcc0b4f6ae8e72f2f2d367747c3c0">CMS_F_CMS_SET1_IAS</a>&#160;&#160;&#160;176</td></tr>
<tr class="memitem:a13e1d37542421bef355e03450ca36499"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a13e1d37542421bef355e03450ca36499">CMS_F_CMS_SET1_KEYID</a>&#160;&#160;&#160;177</td></tr>
<tr class="memitem:aca9ac7d7daad952eb717b68b6018c314"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aca9ac7d7daad952eb717b68b6018c314">CMS_F_CMS_SET1_SIGNERIDENTIFIER</a>&#160;&#160;&#160;146</td></tr>
<tr class="memitem:a78ff9c6d6fbf031ca2a347d710431e9c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a78ff9c6d6fbf031ca2a347d710431e9c">CMS_F_CMS_SET_DETACHED</a>&#160;&#160;&#160;147</td></tr>
<tr class="memitem:a5744bb322983fa8b30cc21a73f769d99"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a5744bb322983fa8b30cc21a73f769d99">CMS_F_CMS_SIGN</a>&#160;&#160;&#160;148</td></tr>
<tr class="memitem:a945c71d3c763737442483fefa490e6b2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a945c71d3c763737442483fefa490e6b2">CMS_F_CMS_SIGNED_DATA_INIT</a>&#160;&#160;&#160;149</td></tr>
<tr class="memitem:a649ebb89a9840ad126188456921e631d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a649ebb89a9840ad126188456921e631d">CMS_F_CMS_SIGNERINFO_CONTENT_SIGN</a>&#160;&#160;&#160;150</td></tr>
<tr class="memitem:accf2f06fdd0b93862ba1da22b2b7eaf2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#accf2f06fdd0b93862ba1da22b2b7eaf2">CMS_F_CMS_SIGNERINFO_SIGN</a>&#160;&#160;&#160;151</td></tr>
<tr class="memitem:ae5b35633f5666771cb9488c601b51ee7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae5b35633f5666771cb9488c601b51ee7">CMS_F_CMS_SIGNERINFO_VERIFY</a>&#160;&#160;&#160;152</td></tr>
<tr class="memitem:a124f58ecbfcdcf27becd6db35b23a875"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a124f58ecbfcdcf27becd6db35b23a875">CMS_F_CMS_SIGNERINFO_VERIFY_CERT</a>&#160;&#160;&#160;153</td></tr>
<tr class="memitem:a24e6725e6b743b3ac25a447c7385f1f8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a24e6725e6b743b3ac25a447c7385f1f8">CMS_F_CMS_SIGNERINFO_VERIFY_CONTENT</a>&#160;&#160;&#160;154</td></tr>
<tr class="memitem:a576d9f3b720f6ebbb7e8c6e5ebd0e339"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a576d9f3b720f6ebbb7e8c6e5ebd0e339">CMS_F_CMS_SIGN_RECEIPT</a>&#160;&#160;&#160;163</td></tr>
<tr class="memitem:aa04abb521f92d49dc2a4e01a8357e764"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aa04abb521f92d49dc2a4e01a8357e764">CMS_F_CMS_STREAM</a>&#160;&#160;&#160;155</td></tr>
<tr class="memitem:ad92dc2fe717459b8dbd407eb3af535c6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ad92dc2fe717459b8dbd407eb3af535c6">CMS_F_CMS_UNCOMPRESS</a>&#160;&#160;&#160;156</td></tr>
<tr class="memitem:a65dd513977bf4a58a9933e443a4f414f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a65dd513977bf4a58a9933e443a4f414f">CMS_F_CMS_VERIFY</a>&#160;&#160;&#160;157</td></tr>
<tr class="memitem:a362420679074443818711ec9aa3a14a6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a362420679074443818711ec9aa3a14a6">CMS_R_ADD_SIGNER_ERROR</a>&#160;&#160;&#160;99</td></tr>
<tr class="memitem:aca330411e7ba04276df4ea30b4a37a0a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aca330411e7ba04276df4ea30b4a37a0a">CMS_R_CERTIFICATE_ALREADY_PRESENT</a>&#160;&#160;&#160;175</td></tr>
<tr class="memitem:a05a57d82abc5030a5340dce444a84d98"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a05a57d82abc5030a5340dce444a84d98">CMS_R_CERTIFICATE_HAS_NO_KEYID</a>&#160;&#160;&#160;160</td></tr>
<tr class="memitem:a25666de73be1ea28e70629942b735de6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a25666de73be1ea28e70629942b735de6">CMS_R_CERTIFICATE_VERIFY_ERROR</a>&#160;&#160;&#160;100</td></tr>
<tr class="memitem:afa52b2bd2206156435b55e15bac11ee1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#afa52b2bd2206156435b55e15bac11ee1">CMS_R_CIPHER_INITIALISATION_ERROR</a>&#160;&#160;&#160;101</td></tr>
<tr class="memitem:a8f810f38c4d363007aaf06a17919f61f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a8f810f38c4d363007aaf06a17919f61f">CMS_R_CIPHER_PARAMETER_INITIALISATION_ERROR</a>&#160;&#160;&#160;102</td></tr>
<tr class="memitem:a022e051933d79d1d0c8d55d913465193"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a022e051933d79d1d0c8d55d913465193">CMS_R_CMS_DATAFINAL_ERROR</a>&#160;&#160;&#160;103</td></tr>
<tr class="memitem:a7d3f32a0dc5227fe770161cd570b8c7b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7d3f32a0dc5227fe770161cd570b8c7b">CMS_R_CMS_LIB</a>&#160;&#160;&#160;104</td></tr>
<tr class="memitem:a54d94a3135e8cac7ded5fa3e4aee6378"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a54d94a3135e8cac7ded5fa3e4aee6378">CMS_R_CONTENTIDENTIFIER_MISMATCH</a>&#160;&#160;&#160;170</td></tr>
<tr class="memitem:a97c0c7b0cb5dd5a7be7d6b8980f4ec18"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a97c0c7b0cb5dd5a7be7d6b8980f4ec18">CMS_R_CONTENT_NOT_FOUND</a>&#160;&#160;&#160;105</td></tr>
<tr class="memitem:a27141fe451491203f154002af88d6fce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a27141fe451491203f154002af88d6fce">CMS_R_CONTENT_TYPE_MISMATCH</a>&#160;&#160;&#160;171</td></tr>
<tr class="memitem:a2565bfd570bc0eabc4e3a74d1abc43e0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2565bfd570bc0eabc4e3a74d1abc43e0">CMS_R_CONTENT_TYPE_NOT_COMPRESSED_DATA</a>&#160;&#160;&#160;106</td></tr>
<tr class="memitem:a0407e04d7aee2109eaa028cc17096869"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a0407e04d7aee2109eaa028cc17096869">CMS_R_CONTENT_TYPE_NOT_ENVELOPED_DATA</a>&#160;&#160;&#160;107</td></tr>
<tr class="memitem:afb5e55a2e31f2eb686663c4bf69edf21"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#afb5e55a2e31f2eb686663c4bf69edf21">CMS_R_CONTENT_TYPE_NOT_SIGNED_DATA</a>&#160;&#160;&#160;108</td></tr>
<tr class="memitem:a6a655244aa4b45127f0c43388eb7d59a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a6a655244aa4b45127f0c43388eb7d59a">CMS_R_CONTENT_VERIFY_ERROR</a>&#160;&#160;&#160;109</td></tr>
<tr class="memitem:acaacc3148004af71679e726810e7d532"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#acaacc3148004af71679e726810e7d532">CMS_R_CTRL_ERROR</a>&#160;&#160;&#160;110</td></tr>
<tr class="memitem:a8d038f601b36de5ab9b0ee6829f41d2a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a8d038f601b36de5ab9b0ee6829f41d2a">CMS_R_CTRL_FAILURE</a>&#160;&#160;&#160;111</td></tr>
<tr class="memitem:ab4eef6d95bc8f30799f1fcf9d87b604b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ab4eef6d95bc8f30799f1fcf9d87b604b">CMS_R_DECRYPT_ERROR</a>&#160;&#160;&#160;112</td></tr>
<tr class="memitem:a88d47e6ff8e4cfe23620f452cb1fe46b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a88d47e6ff8e4cfe23620f452cb1fe46b">CMS_R_DIGEST_ERROR</a>&#160;&#160;&#160;161</td></tr>
<tr class="memitem:ae8e40f58dd5746e3df367d40bf5a11dd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae8e40f58dd5746e3df367d40bf5a11dd">CMS_R_ERROR_GETTING_PUBLIC_KEY</a>&#160;&#160;&#160;113</td></tr>
<tr class="memitem:ac98cad4079e4febb50fb1652d6268b7c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ac98cad4079e4febb50fb1652d6268b7c">CMS_R_ERROR_READING_MESSAGEDIGEST_ATTRIBUTE</a>&#160;&#160;&#160;114</td></tr>
<tr class="memitem:a5c0c79e8fc1ea7456fdff7715ca43f61"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a5c0c79e8fc1ea7456fdff7715ca43f61">CMS_R_ERROR_SETTING_KEY</a>&#160;&#160;&#160;115</td></tr>
<tr class="memitem:ab0d306b14288eeebeec749a1fddbbe82"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ab0d306b14288eeebeec749a1fddbbe82">CMS_R_ERROR_SETTING_RECIPIENTINFO</a>&#160;&#160;&#160;116</td></tr>
<tr class="memitem:a45eadb3b90cd04617a6f289af54db3c4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a45eadb3b90cd04617a6f289af54db3c4">CMS_R_INVALID_ENCRYPTED_KEY_LENGTH</a>&#160;&#160;&#160;117</td></tr>
<tr class="memitem:aeb8794764b9fdbd0a746c676be282791"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aeb8794764b9fdbd0a746c676be282791">CMS_R_INVALID_KEY_ENCRYPTION_PARAMETER</a>&#160;&#160;&#160;176</td></tr>
<tr class="memitem:ad72973d78eacc1a9b5794588665614d2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ad72973d78eacc1a9b5794588665614d2">CMS_R_INVALID_KEY_LENGTH</a>&#160;&#160;&#160;118</td></tr>
<tr class="memitem:a7c37779b4e7c568c841d84b1607687f3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7c37779b4e7c568c841d84b1607687f3">CMS_R_MD_BIO_INIT_ERROR</a>&#160;&#160;&#160;119</td></tr>
<tr class="memitem:a8769c8c179d967156e761dd9d4b89503"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a8769c8c179d967156e761dd9d4b89503">CMS_R_MESSAGEDIGEST_ATTRIBUTE_WRONG_LENGTH</a>&#160;&#160;&#160;120</td></tr>
<tr class="memitem:aac86e03aa9a17729244f690e449a3fd5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aac86e03aa9a17729244f690e449a3fd5">CMS_R_MESSAGEDIGEST_WRONG_LENGTH</a>&#160;&#160;&#160;121</td></tr>
<tr class="memitem:a9f5d6cdd1764fed539c9f80d1fb5089b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a9f5d6cdd1764fed539c9f80d1fb5089b">CMS_R_MSGSIGDIGEST_ERROR</a>&#160;&#160;&#160;172</td></tr>
<tr class="memitem:afb33e9388a7ad0416830cf0aa4f26cc9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#afb33e9388a7ad0416830cf0aa4f26cc9">CMS_R_MSGSIGDIGEST_VERIFICATION_FAILURE</a>&#160;&#160;&#160;162</td></tr>
<tr class="memitem:ae6aabfd4a80e3663df4f2dec244afec5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae6aabfd4a80e3663df4f2dec244afec5">CMS_R_MSGSIGDIGEST_WRONG_LENGTH</a>&#160;&#160;&#160;163</td></tr>
<tr class="memitem:abd680d0fa6e388cc7d6d78790c42d0ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#abd680d0fa6e388cc7d6d78790c42d0ea">CMS_R_NEED_ONE_SIGNER</a>&#160;&#160;&#160;164</td></tr>
<tr class="memitem:a8faeb882bae14e4e12b5144bb376dcc2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a8faeb882bae14e4e12b5144bb376dcc2">CMS_R_NOT_A_SIGNED_RECEIPT</a>&#160;&#160;&#160;165</td></tr>
<tr class="memitem:a868a4e6fc226d0fd080e80c78dc7ff68"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a868a4e6fc226d0fd080e80c78dc7ff68">CMS_R_NOT_ENCRYPTED_DATA</a>&#160;&#160;&#160;122</td></tr>
<tr class="memitem:ac555a8ace3e9e0226535c7221b63bf26"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ac555a8ace3e9e0226535c7221b63bf26">CMS_R_NOT_KEK</a>&#160;&#160;&#160;123</td></tr>
<tr class="memitem:a3dafd7ae00cc336b974db955156f890f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a3dafd7ae00cc336b974db955156f890f">CMS_R_NOT_KEY_AGREEMENT</a>&#160;&#160;&#160;181</td></tr>
<tr class="memitem:abb0895b04040c42d03a5ca1178f7a54e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#abb0895b04040c42d03a5ca1178f7a54e">CMS_R_NOT_KEY_TRANSPORT</a>&#160;&#160;&#160;124</td></tr>
<tr class="memitem:a2798816e9b3824ba2970145c31561d99"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2798816e9b3824ba2970145c31561d99">CMS_R_NOT_PWRI</a>&#160;&#160;&#160;177</td></tr>
<tr class="memitem:a5501f38a05380b4d48562e17db5d931b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a5501f38a05380b4d48562e17db5d931b">CMS_R_NOT_SUPPORTED_FOR_THIS_KEY_TYPE</a>&#160;&#160;&#160;125</td></tr>
<tr class="memitem:aaab26e85a9411a43fd5e021b0d6a3e80"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aaab26e85a9411a43fd5e021b0d6a3e80">CMS_R_NO_CIPHER</a>&#160;&#160;&#160;126</td></tr>
<tr class="memitem:a4cb3ddc7ed52aeb2019880b240d1a74f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a4cb3ddc7ed52aeb2019880b240d1a74f">CMS_R_NO_CONTENT</a>&#160;&#160;&#160;127</td></tr>
<tr class="memitem:a315dac2b2cfc6ee517e8dafa92b56a7f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a315dac2b2cfc6ee517e8dafa92b56a7f">CMS_R_NO_CONTENT_TYPE</a>&#160;&#160;&#160;173</td></tr>
<tr class="memitem:abaa0a56b68d2bed5aa3456bcf05b6b73"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#abaa0a56b68d2bed5aa3456bcf05b6b73">CMS_R_NO_DEFAULT_DIGEST</a>&#160;&#160;&#160;128</td></tr>
<tr class="memitem:a51319470b072ceafad8d6f8bbf32ff81"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a51319470b072ceafad8d6f8bbf32ff81">CMS_R_NO_DIGEST_SET</a>&#160;&#160;&#160;129</td></tr>
<tr class="memitem:a92176674c9b5c4b87465f93a79c7cec9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a92176674c9b5c4b87465f93a79c7cec9">CMS_R_NO_KEY</a>&#160;&#160;&#160;130</td></tr>
<tr class="memitem:a6de6edfaddc9f8be340cb2fba91a7bd8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a6de6edfaddc9f8be340cb2fba91a7bd8">CMS_R_NO_KEY_OR_CERT</a>&#160;&#160;&#160;174</td></tr>
<tr class="memitem:a625091664f384ceaab468eb6aa106c03"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a625091664f384ceaab468eb6aa106c03">CMS_R_NO_MATCHING_DIGEST</a>&#160;&#160;&#160;131</td></tr>
<tr class="memitem:a62cbdd81c91645c79c7353094409a385"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a62cbdd81c91645c79c7353094409a385">CMS_R_NO_MATCHING_RECIPIENT</a>&#160;&#160;&#160;132</td></tr>
<tr class="memitem:a6c6e7c179f9ba847a46ff8fd62040223"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a6c6e7c179f9ba847a46ff8fd62040223">CMS_R_NO_MATCHING_SIGNATURE</a>&#160;&#160;&#160;166</td></tr>
<tr class="memitem:af5be1545206725e8206e07d83572537d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af5be1545206725e8206e07d83572537d">CMS_R_NO_MSGSIGDIGEST</a>&#160;&#160;&#160;167</td></tr>
<tr class="memitem:a24ba42a81c73436b8da937f56185d745"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a24ba42a81c73436b8da937f56185d745">CMS_R_NO_PASSWORD</a>&#160;&#160;&#160;178</td></tr>
<tr class="memitem:a06ecbb8febe4d7968ab68dfb148e1721"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a06ecbb8febe4d7968ab68dfb148e1721">CMS_R_NO_PRIVATE_KEY</a>&#160;&#160;&#160;133</td></tr>
<tr class="memitem:af3a4a80c8965f53fded432c7cd39c1fb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af3a4a80c8965f53fded432c7cd39c1fb">CMS_R_NO_PUBLIC_KEY</a>&#160;&#160;&#160;134</td></tr>
<tr class="memitem:a77a255f4d9b2a55cdbc0c0bd77b3c4a2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a77a255f4d9b2a55cdbc0c0bd77b3c4a2">CMS_R_NO_RECEIPT_REQUEST</a>&#160;&#160;&#160;168</td></tr>
<tr class="memitem:a12d6fe11e8573f82a382fe65bd458462"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a12d6fe11e8573f82a382fe65bd458462">CMS_R_NO_SIGNERS</a>&#160;&#160;&#160;135</td></tr>
<tr class="memitem:a4f3e4ec51eccf1e1fa8c225f4165e35b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a4f3e4ec51eccf1e1fa8c225f4165e35b">CMS_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE</a>&#160;&#160;&#160;136</td></tr>
<tr class="memitem:a2876d00a7792f29c9ad4a75be68a8f69"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2876d00a7792f29c9ad4a75be68a8f69">CMS_R_RECEIPT_DECODE_ERROR</a>&#160;&#160;&#160;169</td></tr>
<tr class="memitem:a2e9f93fc79052e7a81a6dc17ca7b0f86"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2e9f93fc79052e7a81a6dc17ca7b0f86">CMS_R_RECIPIENT_ERROR</a>&#160;&#160;&#160;137</td></tr>
<tr class="memitem:a45a9953862e357e43ef69f4ea0d9e7b9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a45a9953862e357e43ef69f4ea0d9e7b9">CMS_R_SIGNER_CERTIFICATE_NOT_FOUND</a>&#160;&#160;&#160;138</td></tr>
<tr class="memitem:a6c5ccc581c18e0a3685d2e39dbab11de"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a6c5ccc581c18e0a3685d2e39dbab11de">CMS_R_SIGNFINAL_ERROR</a>&#160;&#160;&#160;139</td></tr>
<tr class="memitem:a3898cca630348d95716a7318fc35b321"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a3898cca630348d95716a7318fc35b321">CMS_R_SMIME_TEXT_ERROR</a>&#160;&#160;&#160;140</td></tr>
<tr class="memitem:a5e99415ca95f19756fa7d2d385d95732"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a5e99415ca95f19756fa7d2d385d95732">CMS_R_STORE_INIT_ERROR</a>&#160;&#160;&#160;141</td></tr>
<tr class="memitem:a06f5270859137fc67b170bf26c94ebab"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a06f5270859137fc67b170bf26c94ebab">CMS_R_TYPE_NOT_COMPRESSED_DATA</a>&#160;&#160;&#160;142</td></tr>
<tr class="memitem:aab570bcfac19f5dab4b12ae72aa9ded9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aab570bcfac19f5dab4b12ae72aa9ded9">CMS_R_TYPE_NOT_DATA</a>&#160;&#160;&#160;143</td></tr>
<tr class="memitem:a7df84d87200cc308bb9773abf3ce9146"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7df84d87200cc308bb9773abf3ce9146">CMS_R_TYPE_NOT_DIGESTED_DATA</a>&#160;&#160;&#160;144</td></tr>
<tr class="memitem:a42a3d531b1e383257e1882aa532eed15"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a42a3d531b1e383257e1882aa532eed15">CMS_R_TYPE_NOT_ENCRYPTED_DATA</a>&#160;&#160;&#160;145</td></tr>
<tr class="memitem:ab599c716523d66f9f0e8d128adecb8a7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ab599c716523d66f9f0e8d128adecb8a7">CMS_R_TYPE_NOT_ENVELOPED_DATA</a>&#160;&#160;&#160;146</td></tr>
<tr class="memitem:a60859dfda32464c93da459b430439950"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a60859dfda32464c93da459b430439950">CMS_R_UNABLE_TO_FINALIZE_CONTEXT</a>&#160;&#160;&#160;147</td></tr>
<tr class="memitem:a7ced89b08b244602676ca478190f6c91"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7ced89b08b244602676ca478190f6c91">CMS_R_UNKNOWN_CIPHER</a>&#160;&#160;&#160;148</td></tr>
<tr class="memitem:a1a4144c1803a65d36cc4f75a98704dd8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a1a4144c1803a65d36cc4f75a98704dd8">CMS_R_UNKNOWN_DIGEST_ALGORIHM</a>&#160;&#160;&#160;149</td></tr>
<tr class="memitem:ac9bcaaf30c0d054b260b256208cf0bbf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ac9bcaaf30c0d054b260b256208cf0bbf">CMS_R_UNKNOWN_ID</a>&#160;&#160;&#160;150</td></tr>
<tr class="memitem:a93634ca62d329411640a389df0392f5d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a93634ca62d329411640a389df0392f5d">CMS_R_UNSUPPORTED_COMPRESSION_ALGORITHM</a>&#160;&#160;&#160;151</td></tr>
<tr class="memitem:ac36b65bc5a5072964b6bb37d2a2641bb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ac36b65bc5a5072964b6bb37d2a2641bb">CMS_R_UNSUPPORTED_CONTENT_TYPE</a>&#160;&#160;&#160;152</td></tr>
<tr class="memitem:a17e31d84518bd96633f70c05d3586b60"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a17e31d84518bd96633f70c05d3586b60">CMS_R_UNSUPPORTED_KEK_ALGORITHM</a>&#160;&#160;&#160;153</td></tr>
<tr class="memitem:ae91540d4d6a51fc2ae4021a33d111f9d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae91540d4d6a51fc2ae4021a33d111f9d">CMS_R_UNSUPPORTED_KEY_ENCRYPTION_ALGORITHM</a>&#160;&#160;&#160;179</td></tr>
<tr class="memitem:a5dedd8ba3201a67c024aaeaa87c70c0d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a5dedd8ba3201a67c024aaeaa87c70c0d">CMS_R_UNSUPPORTED_RECIPIENT_TYPE</a>&#160;&#160;&#160;154</td></tr>
<tr class="memitem:ab906515535f6457ebafdab611944cf32"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ab906515535f6457ebafdab611944cf32">CMS_R_UNSUPPORTED_RECPIENTINFO_TYPE</a>&#160;&#160;&#160;155</td></tr>
<tr class="memitem:ae98d3859d6d3ba3210c26fd53970be2e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae98d3859d6d3ba3210c26fd53970be2e">CMS_R_UNSUPPORTED_TYPE</a>&#160;&#160;&#160;156</td></tr>
<tr class="memitem:af8f7020b19a22351f467ac893275e9f3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af8f7020b19a22351f467ac893275e9f3">CMS_R_UNWRAP_ERROR</a>&#160;&#160;&#160;157</td></tr>
<tr class="memitem:a6e89c9021038aa0f4961ef1d6f222b06"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a6e89c9021038aa0f4961ef1d6f222b06">CMS_R_UNWRAP_FAILURE</a>&#160;&#160;&#160;180</td></tr>
<tr class="memitem:aa49b30049d0eb233a76d8c3396f72d7a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aa49b30049d0eb233a76d8c3396f72d7a">CMS_R_VERIFICATION_FAILURE</a>&#160;&#160;&#160;158</td></tr>
<tr class="memitem:a7254f807afef588dd99991679c90c846"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7254f807afef588dd99991679c90c846">CMS_R_WRAP_ERROR</a>&#160;&#160;&#160;159</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a8f6e99fcf6597c9d6ef2959736e697b3"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structCMS__ContentInfo__st.html">CMS_ContentInfo_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a></td></tr>
<tr class="memitem:a3f38c8c8e63c9af0a13f373f9f9df2f5"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structCMS__SignerInfo__st.html">CMS_SignerInfo_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a></td></tr>
<tr class="memitem:a592df6454d7c9ec6545694bd85ac2769"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a592df6454d7c9ec6545694bd85ac2769">CMS_CertificateChoices</a></td></tr>
<tr class="memitem:a9eeccd496bd97cbb41a8a045cae0548e"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__RevocationInfoChoice__st.html">CMS_RevocationInfoChoice_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a9eeccd496bd97cbb41a8a045cae0548e">CMS_RevocationInfoChoice</a></td></tr>
<tr class="memitem:ac5c9066f9d23a39dc973dd8821304756"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a></td></tr>
<tr class="memitem:ad6b0df3c7c986cf29209828f9e31c523"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
CMS_ReceiptRequest_st&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ad6b0df3c7c986cf29209828f9e31c523">CMS_ReceiptRequest</a></td></tr>
<tr class="memitem:ac34335dae5c86dd281e21e075d417c58"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structCMS__Receipt__st.html">CMS_Receipt_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ac34335dae5c86dd281e21e075d417c58">CMS_Receipt</a></td></tr>
<tr class="memitem:aea929bebf778a99c3f2c6b5151850fc8"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__RecipientEncryptedKey__st.html">CMS_RecipientEncryptedKey_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aea929bebf778a99c3f2c6b5151850fc8">CMS_RecipientEncryptedKey</a></td></tr>
<tr class="memitem:af54d24ab3b9acdc97b67988d660ede75"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__OtherKeyAttribute__st.html">CMS_OtherKeyAttribute_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af54d24ab3b9acdc97b67988d660ede75">CMS_OtherKeyAttribute</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a416a06af57cce1e9339ff9d981160f13"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a416a06af57cce1e9339ff9d981160f13">CMS_get0_type</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:af321d3ecf3ee6e9d3dbdbc8a7b572917"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af321d3ecf3ee6e9d3dbdbc8a7b572917">CMS_dataInit</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *icont)</td></tr>
<tr class="memitem:a1c36b8225ea45f33d22fe44d16a3f98b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a1c36b8225ea45f33d22fe44d16a3f98b">CMS_dataFinal</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *bio)</td></tr>
<tr class="memitem:aed4845b6010a2e1988ca0234cbfa3b18"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aed4845b6010a2e1988ca0234cbfa3b18">CMS_get0_content</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a6f37782948eda96657c46a2a93ef11bf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a6f37782948eda96657c46a2a93ef11bf">CMS_is_detached</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a7e9044c6fa0899c711c09da4eed9d5c5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7e9044c6fa0899c711c09da4eed9d5c5">CMS_set_detached</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, int detached)</td></tr>
<tr class="memitem:a52b2995cc0a11ac3dda054475f2bdd3a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a52b2995cc0a11ac3dda054475f2bdd3a">CMS_stream</a> (unsigned char ***boundary, <a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a5abce8bd2d355f6ab7d91a05bbef2a59"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a5abce8bd2d355f6ab7d91a05bbef2a59">d2i_CMS_bio</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>, <a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> **cms)</td></tr>
<tr class="memitem:a0477bcc5b3df214f1797cd771f0b88c7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a0477bcc5b3df214f1797cd771f0b88c7">i2d_CMS_bio</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>, <a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a0b589be192d2c8d21d13dbf77543ea27"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a0b589be192d2c8d21d13dbf77543ea27">BIO_new_CMS</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, <a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:afb5d07b3feb027024e41d858b6f7da7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#afb5d07b3feb027024e41d858b6f7da7b">i2d_CMS_bio_stream</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, <a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a45e17ba0610b74bba77154a178bf8854"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a45e17ba0610b74bba77154a178bf8854">PEM_write_bio_CMS_stream</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, <a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a06a74deca8bbbe696408ef93393de087"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a06a74deca8bbbe696408ef93393de087">SMIME_read_CMS</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *bio, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> **bcont)</td></tr>
<tr class="memitem:ac187dbf572f1f1d79db727458d2c61d6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ac187dbf572f1f1d79db727458d2c61d6">SMIME_write_CMS</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *bio, <a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ec__curve_8c.html#af1780c54f65adaed36d43e53ad9afe51">data</a>, int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a52397f4b59560ac8a0ad14707dbd8335"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a52397f4b59560ac8a0ad14707dbd8335">CMS_final</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ec__curve_8c.html#af1780c54f65adaed36d43e53ad9afe51">data</a>, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *dcont, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a7d5544dd9b2126fb5b8885f8eb9dff41"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7d5544dd9b2126fb5b8885f8eb9dff41">CMS_sign</a> (<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *signcert, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *pkey, <a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*certs, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ec__curve_8c.html#af1780c54f65adaed36d43e53ad9afe51">data</a>, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a318fdac3de75759689ec06b66d4806ef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a318fdac3de75759689ec06b66d4806ef">CMS_sign_receipt</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *signcert, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *pkey, <a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*certs, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:af982b5d6dc72ed24c93441b27bc0a746"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af982b5d6dc72ed24c93441b27bc0a746">CMS_data</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:aae9d721032654d0e5f7d990fec8a2fdb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aae9d721032654d0e5f7d990fec8a2fdb">CMS_data_create</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a630cc14a0ff582151b217cccd86ef4b0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a630cc14a0ff582151b217cccd86ef4b0">CMS_digest_verify</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *dcont, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a4c1f7b713a342990f8a58b307deb9c1d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a4c1f7b713a342990f8a58b307deb9c1d">CMS_digest_create</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, const <a class="el" href="ossl__typ_8h.html#aac66cf010326fa9a927c2a34888f45d3">EVP_MD</a> *md, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a32bd1dc9455410dde8a5090985eadb98"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a32bd1dc9455410dde8a5090985eadb98">CMS_EncryptedData_decrypt</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, const unsigned char *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, size_t keylen, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *dcont, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a76a86ee3243cba3813f2d7f9845de97d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a76a86ee3243cba3813f2d7f9845de97d">CMS_EncryptedData_encrypt</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *cipher, const unsigned char *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, size_t keylen, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a8f848b65aa93ae7a86ff7613e0e10bed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a8f848b65aa93ae7a86ff7613e0e10bed">CMS_EncryptedData_set1_key</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *ciph, const unsigned char *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, size_t keylen)</td></tr>
<tr class="memitem:a6043f2a317d9144607c845f7b9c2599f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a6043f2a317d9144607c845f7b9c2599f">CMS_verify</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*certs, <a class="el" href="ossl__typ_8h.html#a3a2b800bae08729d11bc28f12b795597">X509_STORE</a> *store, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *dcont, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a7098a596f5bd761782d27ae6b3f5a8f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7098a596f5bd761782d27ae6b3f5a8f3">CMS_verify_receipt</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *rcms, <a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *ocms, <a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*certs, <a class="el" href="ossl__typ_8h.html#a3a2b800bae08729d11bc28f12b795597">X509_STORE</a> *store, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a86f8e8f6e4c410be96765c142445ff99"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a86f8e8f6e4c410be96765c142445ff99">STACK_OF</a> (<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*CMS_get0_signers(<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a48e204531be03c765b7e307bfca35a2e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a48e204531be03c765b7e307bfca35a2e">CMS_encrypt</a> (<a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*certs, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *cipher, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:aac00aef8326c57bb7533790e5e297aae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aac00aef8326c57bb7533790e5e297aae">CMS_decrypt</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *pkey, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *dcont, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a2964117c4d9a5d33602840a3cbe1a96a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2964117c4d9a5d33602840a3cbe1a96a">CMS_decrypt_set1_pkey</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *pk, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:a16000416939d14915dd607d0591bcfd5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a16000416939d14915dd607d0591bcfd5">CMS_decrypt_set1_key</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, unsigned char *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, size_t keylen, unsigned char *id, size_t idlen)</td></tr>
<tr class="memitem:a1fa57a0854635ddd67869672167a7e72"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a1fa57a0854635ddd67869672167a7e72">CMS_decrypt_set1_password</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, unsigned char *<a class="el" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>, ossl_ssize_t <a class="el" href="pkcs12_8h.html#a0f676fe0b7faf04d68165e7546ffd518">passlen</a>)</td></tr>
<tr class="memitem:af38c10f1531317974f19062a90fea4b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af38c10f1531317974f19062a90fea4b2">STACK_OF</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a>)*CMS_get0_RecipientInfos(<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a3ae6eeed24d48fa38986857810a09304"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a3ae6eeed24d48fa38986857810a09304">CMS_RecipientInfo_type</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri)</td></tr>
<tr class="memitem:af0289104150559a8e0ea51f8111aafd1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#aaadbb75633e4460a52864970a3b875de">EVP_PKEY_CTX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af0289104150559a8e0ea51f8111aafd1">CMS_RecipientInfo_get0_pkey_ctx</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri)</td></tr>
<tr class="memitem:a63d3912c2faa83a1c9330353c805ee19"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a63d3912c2faa83a1c9330353c805ee19">CMS_EnvelopedData_create</a> (const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *cipher)</td></tr>
<tr class="memitem:aa0f430b3dda40a05acc7cf29bd4b93d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aa0f430b3dda40a05acc7cf29bd4b93d8">CMS_add1_recipient_cert</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *recip, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a9677b76bdae4ef3dfb1da114a02b7093"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a9677b76bdae4ef3dfb1da114a02b7093">CMS_RecipientInfo_set0_pkey</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *pkey)</td></tr>
<tr class="memitem:ab7a3b21a9d98942c07103ea081bee640"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ab7a3b21a9d98942c07103ea081bee640">CMS_RecipientInfo_ktri_cert_cmp</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:a7a862d5cd26243bae2f833aed5a955c2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7a862d5cd26243bae2f833aed5a955c2">CMS_RecipientInfo_ktri_get0_algs</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> **pk, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> **recip, <a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **palg)</td></tr>
<tr class="memitem:a8f598cf775da0d77f02950fe395deac8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a8f598cf775da0d77f02950fe395deac8">CMS_RecipientInfo_ktri_get0_signer_id</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **keyid, <a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> **issuer, <a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **sno)</td></tr>
<tr class="memitem:abc79183fe66f31806a18c02cd3b0c118"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#abc79183fe66f31806a18c02cd3b0c118">CMS_add0_recipient_key</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, int <a class="el" href="x509_8h.html#a7235ef62e89328f5155846dc59c6fc37">nid</a>, unsigned char *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, size_t keylen, unsigned char *id, size_t idlen, <a class="el" href="ossl__typ_8h.html#abd19ea5b527807ce3a516e6a41440f84">ASN1_GENERALIZEDTIME</a> *date, <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *otherTypeId, <a class="el" href="asn1_8h.html#a7895e03d9fee2bc4963faf2a31a9439e">ASN1_TYPE</a> *otherType)</td></tr>
<tr class="memitem:a5605ce2e902d1a84e651ef14a569e92a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a5605ce2e902d1a84e651ef14a569e92a">CMS_RecipientInfo_kekri_get0_id</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **palg, <a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **pid, <a class="el" href="ossl__typ_8h.html#abd19ea5b527807ce3a516e6a41440f84">ASN1_GENERALIZEDTIME</a> **pdate, <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> **potherid, <a class="el" href="asn1_8h.html#a7895e03d9fee2bc4963faf2a31a9439e">ASN1_TYPE</a> **pothertype)</td></tr>
<tr class="memitem:abcbf7e892f737b18c52779d636143b14"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#abcbf7e892f737b18c52779d636143b14">CMS_RecipientInfo_set0_key</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, unsigned char *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, size_t keylen)</td></tr>
<tr class="memitem:a3abd22c1ff8260d4935a428898030f92"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a3abd22c1ff8260d4935a428898030f92">CMS_RecipientInfo_kekri_id_cmp</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, const unsigned char *id, size_t idlen)</td></tr>
<tr class="memitem:a748a276eb5936a0d5760a89119e83fe4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a748a276eb5936a0d5760a89119e83fe4">CMS_RecipientInfo_set0_password</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, unsigned char *<a class="el" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>, ossl_ssize_t <a class="el" href="pkcs12_8h.html#a0f676fe0b7faf04d68165e7546ffd518">passlen</a>)</td></tr>
<tr class="memitem:a11c9902c3ce2f434c7ef5ba01b1a81a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a11c9902c3ce2f434c7ef5ba01b1a81a5">CMS_add0_recipient_password</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, int iter, int wrap_nid, int pbe_nid, unsigned char *<a class="el" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>, ossl_ssize_t <a class="el" href="pkcs12_8h.html#a0f676fe0b7faf04d68165e7546ffd518">passlen</a>, const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *kekciph)</td></tr>
<tr class="memitem:a2db1d83492be468599b3be3452e98cc5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2db1d83492be468599b3be3452e98cc5">CMS_RecipientInfo_decrypt</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri)</td></tr>
<tr class="memitem:a44fec504f4ab356a6095f25527aabc46"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a44fec504f4ab356a6095f25527aabc46">CMS_RecipientInfo_encrypt</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri)</td></tr>
<tr class="memitem:a49597406d7d4b9fb0e1fea4e4893a1fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a49597406d7d4b9fb0e1fea4e4893a1fb">CMS_uncompress</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *dcont, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:aaeca81397f9282a2834272b3eabd35c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aaeca81397f9282a2834272b3eabd35c0">CMS_compress</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, int comp_nid, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a244b5fc1d06ba187897439827c5fec70"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a244b5fc1d06ba187897439827c5fec70">CMS_set1_eContentType</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, const <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *oid)</td></tr>
<tr class="memitem:ab0a011907cfe668a473f918ccbab301d"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ab0a011907cfe668a473f918ccbab301d">CMS_get0_eContentType</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:aef3d3cc691ea54473b0306c0f970746b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aef3d3cc691ea54473b0306c0f970746b">CMS_add0_CertificateChoices</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a54d38d62bfc50c2e8761130c36c5bad2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a54d38d62bfc50c2e8761130c36c5bad2">CMS_add0_cert</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:a9ba4ef68ee60c507f65b0a18e38de4fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a9ba4ef68ee60c507f65b0a18e38de4fe">CMS_add1_cert</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:a043f3d99d4d29d587a30cc34d1d684a8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a9eeccd496bd97cbb41a8a045cae0548e">CMS_RevocationInfoChoice</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a043f3d99d4d29d587a30cc34d1d684a8">CMS_add0_RevocationInfoChoice</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:ad9ab18e37d81a6dab74485818afce6d1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ad9ab18e37d81a6dab74485818afce6d1">CMS_add0_crl</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a> *crl)</td></tr>
<tr class="memitem:af2e14773b875a1a124c1fb01b28b1f16"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af2e14773b875a1a124c1fb01b28b1f16">CMS_add1_crl</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a> *crl)</td></tr>
<tr class="memitem:ae1c0071645cb5cdab38d7a940ec49b23"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae1c0071645cb5cdab38d7a940ec49b23">STACK_OF</a> (<a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a>)*CMS_get1_crls(<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a1644c2838a48d575d251f2b658ae4034"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a1644c2838a48d575d251f2b658ae4034">CMS_SignedData_init</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a2eb58dd50af8338432ec5b09c11becbc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a2eb58dd50af8338432ec5b09c11becbc">CMS_add1_signer</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *signer, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *pk, const <a class="el" href="ossl__typ_8h.html#aac66cf010326fa9a927c2a34888f45d3">EVP_MD</a> *md, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:af51972010dbe8b59ad7afdc9f0b8fb16"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#aaadbb75633e4460a52864970a3b875de">EVP_PKEY_CTX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af51972010dbe8b59ad7afdc9f0b8fb16">CMS_SignerInfo_get0_pkey_ctx</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si)</td></tr>
<tr class="memitem:acb3b0881dbad94057600a0f166d44b96"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a69cda4d21bd068f01c469222c1dd92fe">EVP_MD_CTX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#acb3b0881dbad94057600a0f166d44b96">CMS_SignerInfo_get0_md_ctx</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si)</td></tr>
<tr class="memitem:a886d105de38166c73da9baa1d01153ea"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a886d105de38166c73da9baa1d01153ea">STACK_OF</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a>)*CMS_get0_SignerInfos(<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a6c7423a2fbefe9e3519679784265c973"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a6c7423a2fbefe9e3519679784265c973">CMS_SignerInfo_set1_signer_cert</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *signer)</td></tr>
<tr class="memitem:af9530c8048cf7bece6d09717f7e4e737"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af9530c8048cf7bece6d09717f7e4e737">CMS_SignerInfo_get0_signer_id</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, <a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **keyid, <a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> **issuer, <a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **sno)</td></tr>
<tr class="memitem:a844f95e7b7bf9837c05c16989f0dd634"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a844f95e7b7bf9837c05c16989f0dd634">CMS_SignerInfo_cert_cmp</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:af91d09ff17c46f9f6e98828152c6e1f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af91d09ff17c46f9f6e98828152c6e1f7">CMS_set1_signers_certs</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*certs, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a41425496f0226eec3323fb81c66172f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a41425496f0226eec3323fb81c66172f5">CMS_SignerInfo_get0_algs</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> **pk, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> **signer, <a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **pdig, <a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **psig)</td></tr>
<tr class="memitem:a02ea025a7f70db116cdd2aefc4d3c355"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a02ea025a7f70db116cdd2aefc4d3c355">CMS_SignerInfo_get0_signature</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si)</td></tr>
<tr class="memitem:a426439b64ded9f572e4afd97bdfb4015"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a426439b64ded9f572e4afd97bdfb4015">CMS_SignerInfo_sign</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si)</td></tr>
<tr class="memitem:a37e31a3a3362596f3e950cefddb10678"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a37e31a3a3362596f3e950cefddb10678">CMS_SignerInfo_verify</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si)</td></tr>
<tr class="memitem:a3892cb7d22ea2d5bcb409c1404409857"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a3892cb7d22ea2d5bcb409c1404409857">CMS_SignerInfo_verify_content</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *chain)</td></tr>
<tr class="memitem:a90229c07fd143aba2279b472319f7bf8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a90229c07fd143aba2279b472319f7bf8">CMS_add_smimecap</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, <a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a>)*algs)</td></tr>
<tr class="memitem:a8dbdee035fa4fe59e9de524f28f941ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a8dbdee035fa4fe59e9de524f28f941ed">CMS_add_simple_smimecap</a> (<a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a>)**algs, int algnid, int keysize)</td></tr>
<tr class="memitem:aafde25928ef5918da9c63d3e74236a58"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aafde25928ef5918da9c63d3e74236a58">CMS_add_standard_smimecap</a> (<a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a>)**smcap)</td></tr>
<tr class="memitem:ad32fc38b6df05652fe4543b813366550"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ad32fc38b6df05652fe4543b813366550">CMS_signed_get_attr_count</a> (const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si)</td></tr>
<tr class="memitem:ab1a10728ac6fa2defa464eea43912184"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ab1a10728ac6fa2defa464eea43912184">CMS_signed_get_attr_by_NID</a> (const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, int <a class="el" href="x509_8h.html#a7235ef62e89328f5155846dc59c6fc37">nid</a>, int lastpos)</td></tr>
<tr class="memitem:aee280884edf261b5edd53bc4a662f86e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aee280884edf261b5edd53bc4a662f86e">CMS_signed_get_attr_by_OBJ</a> (const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *<a class="el" href="x509_8h.html#a8e76a846a02bda3e8e416145f67e90ae">obj</a>, int lastpos)</td></tr>
<tr class="memitem:a689dc22b400fa430b81d4bbee527291c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="x509_8h.html#aa4f1a62a9d2dd8cb6780fe2713737c0f">X509_ATTRIBUTE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a689dc22b400fa430b81d4bbee527291c">CMS_signed_get_attr</a> (const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, int <a class="el" href="x509_8h.html#aebdbf0bfc23402adcaa55cb1fb6f2dd7">loc</a>)</td></tr>
<tr class="memitem:a8d4b8c7d93b46ed722be5c6436941a82"><td class="memItemLeft" align="right" valign="top"><a class="el" href="x509_8h.html#aa4f1a62a9d2dd8cb6780fe2713737c0f">X509_ATTRIBUTE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a8d4b8c7d93b46ed722be5c6436941a82">CMS_signed_delete_attr</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, int <a class="el" href="x509_8h.html#aebdbf0bfc23402adcaa55cb1fb6f2dd7">loc</a>)</td></tr>
<tr class="memitem:a05741723badc0ac44ff55b797bda2143"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a05741723badc0ac44ff55b797bda2143">CMS_signed_add1_attr</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, <a class="el" href="x509_8h.html#aa4f1a62a9d2dd8cb6780fe2713737c0f">X509_ATTRIBUTE</a> *<a class="el" href="x509_8h.html#aff9037fcb7fcfead3168611f8008a2dc">attr</a>)</td></tr>
<tr class="memitem:af0cfd0420a7f32a63087f311ff6f59bf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af0cfd0420a7f32a63087f311ff6f59bf">CMS_signed_add1_attr_by_OBJ</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, const <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *<a class="el" href="x509_8h.html#a8e76a846a02bda3e8e416145f67e90ae">obj</a>, int <a class="el" href="x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>, const void *<a class="el" href="x509_8h.html#a3fb78b1e1dea1301c549fdcb5a6ddc11">bytes</a>, int <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:ac54e63b2827670c7b82c449f536ae59d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ac54e63b2827670c7b82c449f536ae59d">CMS_signed_add1_attr_by_NID</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, int <a class="el" href="x509_8h.html#a7235ef62e89328f5155846dc59c6fc37">nid</a>, int <a class="el" href="x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>, const void *<a class="el" href="x509_8h.html#a3fb78b1e1dea1301c549fdcb5a6ddc11">bytes</a>, int <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:ae302bd9f0942e92744a6af8c89b96f4b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae302bd9f0942e92744a6af8c89b96f4b">CMS_signed_add1_attr_by_txt</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, const char *<a class="el" href="x509_8h.html#a78f646207493cc73cd624c99da84424d">attrname</a>, int <a class="el" href="x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>, const void *<a class="el" href="x509_8h.html#a3fb78b1e1dea1301c549fdcb5a6ddc11">bytes</a>, int <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:af1803123210af8b7304b66eb4c704941"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#af1803123210af8b7304b66eb4c704941">CMS_signed_get0_data_by_OBJ</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *oid, int lastpos, int <a class="el" href="x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>)</td></tr>
<tr class="memitem:a5fd75c09a2b0ecdc976750a8c8f0160e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a5fd75c09a2b0ecdc976750a8c8f0160e">CMS_unsigned_get_attr_count</a> (const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si)</td></tr>
<tr class="memitem:a37d0e5e65912b3b7e40e6871f66c950a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a37d0e5e65912b3b7e40e6871f66c950a">CMS_unsigned_get_attr_by_NID</a> (const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, int <a class="el" href="x509_8h.html#a7235ef62e89328f5155846dc59c6fc37">nid</a>, int lastpos)</td></tr>
<tr class="memitem:a459983c73ba7344710043a453f870727"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a459983c73ba7344710043a453f870727">CMS_unsigned_get_attr_by_OBJ</a> (const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *<a class="el" href="x509_8h.html#a8e76a846a02bda3e8e416145f67e90ae">obj</a>, int lastpos)</td></tr>
<tr class="memitem:ae1d3af13add0207b601c81b5bf784bd7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="x509_8h.html#aa4f1a62a9d2dd8cb6780fe2713737c0f">X509_ATTRIBUTE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ae1d3af13add0207b601c81b5bf784bd7">CMS_unsigned_get_attr</a> (const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, int <a class="el" href="x509_8h.html#aebdbf0bfc23402adcaa55cb1fb6f2dd7">loc</a>)</td></tr>
<tr class="memitem:ac3646520e1d5ff39914e86446dbe16e1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="x509_8h.html#aa4f1a62a9d2dd8cb6780fe2713737c0f">X509_ATTRIBUTE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ac3646520e1d5ff39914e86446dbe16e1">CMS_unsigned_delete_attr</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, int <a class="el" href="x509_8h.html#aebdbf0bfc23402adcaa55cb1fb6f2dd7">loc</a>)</td></tr>
<tr class="memitem:a39cbda7e0124c4b183a13a3737d8eb5d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a39cbda7e0124c4b183a13a3737d8eb5d">CMS_unsigned_add1_attr</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, <a class="el" href="x509_8h.html#aa4f1a62a9d2dd8cb6780fe2713737c0f">X509_ATTRIBUTE</a> *<a class="el" href="x509_8h.html#aff9037fcb7fcfead3168611f8008a2dc">attr</a>)</td></tr>
<tr class="memitem:aa3454289f8f2fd2e3c08e36c78fc7622"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aa3454289f8f2fd2e3c08e36c78fc7622">CMS_unsigned_add1_attr_by_OBJ</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, const <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *<a class="el" href="x509_8h.html#a8e76a846a02bda3e8e416145f67e90ae">obj</a>, int <a class="el" href="x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>, const void *<a class="el" href="x509_8h.html#a3fb78b1e1dea1301c549fdcb5a6ddc11">bytes</a>, int <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:a6fdfc96a16752e94eac03599ecf073d3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a6fdfc96a16752e94eac03599ecf073d3">CMS_unsigned_add1_attr_by_NID</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, int <a class="el" href="x509_8h.html#a7235ef62e89328f5155846dc59c6fc37">nid</a>, int <a class="el" href="x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>, const void *<a class="el" href="x509_8h.html#a3fb78b1e1dea1301c549fdcb5a6ddc11">bytes</a>, int <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:a501c408a5e353af44ecfa15acec45673"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a501c408a5e353af44ecfa15acec45673">CMS_unsigned_add1_attr_by_txt</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, const char *<a class="el" href="x509_8h.html#a78f646207493cc73cd624c99da84424d">attrname</a>, int <a class="el" href="x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>, const void *<a class="el" href="x509_8h.html#a3fb78b1e1dea1301c549fdcb5a6ddc11">bytes</a>, int <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:ab8d3e30cbe48334e56607c510527093f"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#ab8d3e30cbe48334e56607c510527093f">CMS_unsigned_get0_data_by_OBJ</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si, <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *oid, int lastpos, int <a class="el" href="x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>)</td></tr>
<tr class="memitem:aef2777d4c051b819513ca63e18de9a79"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aef2777d4c051b819513ca63e18de9a79">CMS_RecipientInfo_kari_get0_alg</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **palg, <a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **pukm)</td></tr>
<tr class="memitem:a57282c85361b0236945d82ca60e4e22a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a57282c85361b0236945d82ca60e4e22a">STACK_OF</a> (<a class="el" href="cms_8h.html#aea929bebf778a99c3f2c6b5151850fc8">CMS_RecipientEncryptedKey</a>)*CMS_RecipientInfo_kari_get0_reks(<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri)</td></tr>
<tr class="memitem:a209691a56cb96974cf86e9cebb345f91"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a209691a56cb96974cf86e9cebb345f91">CMS_RecipientInfo_kari_get0_orig_id</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **pubalg, <a class="el" href="ossl__typ_8h.html#af837aaa00e151b1e8773aea5a8fe1cc4">ASN1_BIT_STRING</a> **pubkey, <a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **keyid, <a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> **issuer, <a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **sno)</td></tr>
<tr class="memitem:a4ca315f531e49cf12f7e108431318f3b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a4ca315f531e49cf12f7e108431318f3b">CMS_RecipientInfo_kari_orig_id_cmp</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:a7b749be942f8aeea3a3d515526090bc8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7b749be942f8aeea3a3d515526090bc8">CMS_RecipientEncryptedKey_get0_id</a> (<a class="el" href="cms_8h.html#aea929bebf778a99c3f2c6b5151850fc8">CMS_RecipientEncryptedKey</a> *rek, <a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **keyid, <a class="el" href="ossl__typ_8h.html#abd19ea5b527807ce3a516e6a41440f84">ASN1_GENERALIZEDTIME</a> **tm, <a class="el" href="cms_8h.html#af54d24ab3b9acdc97b67988d660ede75">CMS_OtherKeyAttribute</a> **other, <a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> **issuer, <a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **sno)</td></tr>
<tr class="memitem:a7b75fd402338e1489e4730faf461ca61"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a7b75fd402338e1489e4730faf461ca61">CMS_RecipientEncryptedKey_cert_cmp</a> (<a class="el" href="cms_8h.html#aea929bebf778a99c3f2c6b5151850fc8">CMS_RecipientEncryptedKey</a> *rek, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:a585f407ee2d6046d19e919ad35cfd1e1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a585f407ee2d6046d19e919ad35cfd1e1">CMS_RecipientInfo_kari_set0_pkey</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *pk)</td></tr>
<tr class="memitem:aa8de84f2733f37b3dcbda807c489186a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#aab2bd6a044e1d31ebc2fe82b3b0b3d9a">EVP_CIPHER_CTX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#aa8de84f2733f37b3dcbda807c489186a">CMS_RecipientInfo_kari_get0_ctx</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri)</td></tr>
<tr class="memitem:a08fc89556c5524e7b5083845a77d0c6b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a08fc89556c5524e7b5083845a77d0c6b">CMS_RecipientInfo_kari_decrypt</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="cms_8h.html#aea929bebf778a99c3f2c6b5151850fc8">CMS_RecipientEncryptedKey</a> *rek)</td></tr>
<tr class="memitem:a64ee2c9fa6bef977abba1d8728b3284e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a64ee2c9fa6bef977abba1d8728b3284e">CMS_SharedInfo_encode</a> (unsigned char **pder, <a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> *kekalg, <a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> *ukm, int keylen)</td></tr>
<tr class="memitem:a4f4348ca22044e1900f589356cd4655a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms_8h.html#a4f4348ca22044e1900f589356cd4655a">ERR_load_CMS_strings</a> (void)</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="a2dff043317948b4c2c08a305cf10b478"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_ASCIICRLF&#160;&#160;&#160;0x80000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00120">120</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a26044c9210eb8c5e3308d023ae4d5245"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_BINARY&#160;&#160;&#160;0x80</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00108">108</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae5058fb6c9fe884c071d3f474bd082ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_CRLFEOL&#160;&#160;&#160;0x800</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00112">112</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3e910f5d1c60a64bd5c43ef26ccd43ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_DEBUG_DECRYPT&#160;&#160;&#160;0x20000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00118">118</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9aca14ae67c24cf5b7d0c66368fab072"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_DETACHED&#160;&#160;&#160;0x40</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00107">107</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a561078e96618f1985e95d5a7cb8b63e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CHECK_CONTENT&#160;&#160;&#160;99</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00381">381</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4da4a99381f52334723946f198d87728"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ADD0_CERT&#160;&#160;&#160;164</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00382">382</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8d53d170864f78c0dc99b2fbaa0957e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ADD0_RECIPIENT_KEY&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00383">383</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="abaa885cb63f5a560cd4068967d98b83a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ADD0_RECIPIENT_PASSWORD&#160;&#160;&#160;165</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00384">384</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3793a15ee7d2330dd0bdac1f3c68820d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ADD1_RECEIPTREQUEST&#160;&#160;&#160;158</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00385">385</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a466fc9af20c872ac00dbf5e414c769d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ADD1_RECIPIENT_CERT&#160;&#160;&#160;101</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00386">386</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a33310fdd60839acfda68c53c7cf41209"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ADD1_SIGNER&#160;&#160;&#160;102</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00387">387</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a544c5f98db03880a3e686c494ffae5cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ADD1_SIGNINGTIME&#160;&#160;&#160;103</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00388">388</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7c2ae2d56e874d77e44af42ef89eb680"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_COMPRESS&#160;&#160;&#160;104</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00389">389</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9250d8b36dc726d49394eb9b42418201"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_COMPRESSEDDATA_CREATE&#160;&#160;&#160;105</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00390">390</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2c52b7702cde42f20db70cbafdea16ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_COMPRESSEDDATA_INIT_BIO&#160;&#160;&#160;106</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00391">391</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a24c10549d81c3d2123a62d72a35def71"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_COPY_CONTENT&#160;&#160;&#160;107</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00392">392</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a02254ecb659ccbe4894135c4ee36e277"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_COPY_MESSAGEDIGEST&#160;&#160;&#160;108</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00393">393</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a47c7367f7f973cd508117a9fe8e7e6e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_DATA&#160;&#160;&#160;109</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00394">394</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8e68562b976a1e675ef7a52b6b1601fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_DATAFINAL&#160;&#160;&#160;110</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00395">395</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2430638220587768d0447fc25fdd8efc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_DATAINIT&#160;&#160;&#160;111</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00396">396</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab9907d42c5fd1d4c8a8f3859f07f74d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_DECRYPT&#160;&#160;&#160;112</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00397">397</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a78082a731cf00f28c93aa366674cd426"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_DECRYPT_SET1_KEY&#160;&#160;&#160;113</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00398">398</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="af41beccbed88ab6ec20442aed11a193f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_DECRYPT_SET1_PASSWORD&#160;&#160;&#160;166</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00399">399</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab2dcd528d2ac49bb38432d451217bd24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_DECRYPT_SET1_PKEY&#160;&#160;&#160;114</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00400">400</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a05c0850f3d882fe12e80d8f01a5f3e10"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_DIGEST_VERIFY&#160;&#160;&#160;118</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00404">404</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9ba97bf7f311bcc5ac1b5020e22cf63c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_DIGESTALGORITHM_FIND_CTX&#160;&#160;&#160;115</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00401">401</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5e4f1b8a34184e085d9623ba93382843"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_DIGESTALGORITHM_INIT_BIO&#160;&#160;&#160;116</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00402">402</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa71e5f8afca2b67f50d075a33457d88f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_DIGESTEDDATA_DO_FINAL&#160;&#160;&#160;117</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00403">403</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad76a23b904c12491ccbf836d87ecb583"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ENCODE_RECEIPT&#160;&#160;&#160;161</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00405">405</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2711aa4754788e9c93186bbd082449bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ENCRYPT&#160;&#160;&#160;119</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00406">406</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0212693acbc22d892fea7d594532dc5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ENCRYPTEDCONTENT_INIT_BIO&#160;&#160;&#160;120</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00407">407</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a780c677d07227dec584a1606e13fca34"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ENCRYPTEDDATA_DECRYPT&#160;&#160;&#160;121</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00408">408</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="af7ee42e04206b7dd3e2ae2547c07b596"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ENCRYPTEDDATA_ENCRYPT&#160;&#160;&#160;122</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00409">409</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6ba74b36decb7067945d6bc7b97a3ffa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ENCRYPTEDDATA_SET1_KEY&#160;&#160;&#160;123</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00410">410</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="af36b801b1dec357f689eff8c68fb16b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ENV_ASN1_CTRL&#160;&#160;&#160;171</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00414">414</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae3856b2ddbf1d25c08d5e6ebe9b5e8fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ENVELOPED_DATA_INIT&#160;&#160;&#160;126</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00413">413</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2c6e13925680edf4647b340f6d2a53e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ENVELOPEDDATA_CREATE&#160;&#160;&#160;124</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00411">411</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae35927bfd818290e5affff1a96ef33c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_ENVELOPEDDATA_INIT_BIO&#160;&#160;&#160;125</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00412">412</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8c7c5d5ca9eb1a7d0a6a957d5be72b08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_FINAL&#160;&#160;&#160;127</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00415">415</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aba70478a85afce278cce834619542bfa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_GET0_CERTIFICATE_CHOICES&#160;&#160;&#160;128</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00416">416</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad1af319335c3d48e2cfacbef29f81101"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_GET0_CONTENT&#160;&#160;&#160;129</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00417">417</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a277697668b2b8d68c08929a7d9a30813"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_GET0_ECONTENT_TYPE&#160;&#160;&#160;130</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00418">418</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a024f46d6ce854beb8be94aa80426e2cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_GET0_ENVELOPED&#160;&#160;&#160;131</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00419">419</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad7ec80ae25d68851ee71802f00e63be3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_GET0_REVOCATION_CHOICES&#160;&#160;&#160;132</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00420">420</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5595c71064de9251e0a270e74769d5db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_GET0_SIGNED&#160;&#160;&#160;133</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00421">421</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0b9af42b4cb5106ebc14b28ff58d93c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_MSGSIGDIGEST_ADD1&#160;&#160;&#160;162</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00422">422</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a07a945524b609f3976c0fe852ad7558a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECEIPT_VERIFY&#160;&#160;&#160;160</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00424">424</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad91284ad7bcf284f28c947eb15b78c9b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECEIPTREQUEST_CREATE0&#160;&#160;&#160;159</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00423">423</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7b61f312558cf5f0b0b6a488cad635a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_DECRYPT&#160;&#160;&#160;134</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00425">425</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0327f69f5888456157c4c359ac37fb7b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_ENCRYPT&#160;&#160;&#160;169</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00426">426</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a58ff144816f61684193afd1144a81ba7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KARI_ENCRYPT&#160;&#160;&#160;178</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00427">427</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a013600bf0dcafcd84a215679ac3da0bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KARI_GET0_ALG&#160;&#160;&#160;175</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00428">428</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="acd27a4f555ea6daf92dd1f33c3d68ce2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KARI_GET0_ORIG_ID&#160;&#160;&#160;173</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00429">429</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a649b88a59acb6c0ada5c46c8e02e3d1b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KARI_GET0_REKS&#160;&#160;&#160;172</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00430">430</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4c54f31257bf8a91ed5a502ab1a111de"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KARI_ORIG_ID_CMP&#160;&#160;&#160;174</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00431">431</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa7a36dff4e89116aac8b38d29e472aab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KEKRI_DECRYPT&#160;&#160;&#160;135</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00432">432</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae8eb3fb54c6c9a236ea9ea5463a8b985"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KEKRI_ENCRYPT&#160;&#160;&#160;136</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00433">433</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad4b5d7960f63c3a1c4665c55436f69c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KEKRI_GET0_ID&#160;&#160;&#160;137</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00434">434</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4823452068827ce9dff504d3dbd729d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KEKRI_ID_CMP&#160;&#160;&#160;138</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00435">435</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac01c397092c078cb18f70f732d9c7349"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KTRI_CERT_CMP&#160;&#160;&#160;139</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00436">436</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a655e5d8e32cdc48bb9f0b6bea13fba1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KTRI_DECRYPT&#160;&#160;&#160;140</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00437">437</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a40708bc6d3015cb8a6210124c0844e16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KTRI_ENCRYPT&#160;&#160;&#160;141</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00438">438</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aaad41bb8ee537e69bf8a2f56f59337e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KTRI_GET0_ALGS&#160;&#160;&#160;142</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00439">439</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a59b981b457a264b21809375134e4256d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_KTRI_GET0_SIGNER_ID&#160;&#160;&#160;143</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00440">440</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4c23192ef7c2b91b8760a454380d2de7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_PWRI_CRYPT&#160;&#160;&#160;167</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00441">441</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ade9eabf14d47c561634a7a5e28cfb3a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_SET0_KEY&#160;&#160;&#160;144</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00442">442</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a860876d446accfddfa742b1f05347174"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_SET0_PASSWORD&#160;&#160;&#160;168</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00443">443</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2a8cd121b59b934d82e0affaf42bbe29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_RECIPIENTINFO_SET0_PKEY&#160;&#160;&#160;145</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00444">444</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a41192bd0a7fd2e8c036db77aa5346ea5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_SD_ASN1_CTRL&#160;&#160;&#160;170</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00445">445</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a56afcc0b4f6ae8e72f2f2d367747c3c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_SET1_IAS&#160;&#160;&#160;176</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00446">446</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a13e1d37542421bef355e03450ca36499"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_SET1_KEYID&#160;&#160;&#160;177</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00447">447</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aca9ac7d7daad952eb717b68b6018c314"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_SET1_SIGNERIDENTIFIER&#160;&#160;&#160;146</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00448">448</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a78ff9c6d6fbf031ca2a347d710431e9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_SET_DETACHED&#160;&#160;&#160;147</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00449">449</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5744bb322983fa8b30cc21a73f769d99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_SIGN&#160;&#160;&#160;148</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00450">450</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a576d9f3b720f6ebbb7e8c6e5ebd0e339"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_SIGN_RECEIPT&#160;&#160;&#160;163</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00457">457</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a945c71d3c763737442483fefa490e6b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_SIGNED_DATA_INIT&#160;&#160;&#160;149</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00451">451</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a649ebb89a9840ad126188456921e631d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_SIGNERINFO_CONTENT_SIGN&#160;&#160;&#160;150</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00452">452</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="accf2f06fdd0b93862ba1da22b2b7eaf2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_SIGNERINFO_SIGN&#160;&#160;&#160;151</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00453">453</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae5b35633f5666771cb9488c601b51ee7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_SIGNERINFO_VERIFY&#160;&#160;&#160;152</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00454">454</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a124f58ecbfcdcf27becd6db35b23a875"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_SIGNERINFO_VERIFY_CERT&#160;&#160;&#160;153</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00455">455</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a24e6725e6b743b3ac25a447c7385f1f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_SIGNERINFO_VERIFY_CONTENT&#160;&#160;&#160;154</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00456">456</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa04abb521f92d49dc2a4e01a8357e764"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_STREAM&#160;&#160;&#160;155</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00458">458</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad92dc2fe717459b8dbd407eb3af535c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_UNCOMPRESS&#160;&#160;&#160;156</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00459">459</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a65dd513977bf4a58a9933e443a4f414f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_F_CMS_VERIFY&#160;&#160;&#160;157</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00460">460</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="afcd7a48a3b9f4a217ad110d7b4adc5ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_KEY_PARAM&#160;&#160;&#160;0x40000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00119">119</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="acb04c24ec58a4dec438798d4801d0315"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_NO_ATTR_VERIFY&#160;&#160;&#160;0x8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00101">101</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="adda58aee98a505082601471e313a61f4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_NO_CONTENT_VERIFY&#160;&#160;&#160;0x4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00100">100</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac1582d4bdb24ac326ebfb0168df964c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_NO_SIGNER_CERT_VERIFY&#160;&#160;&#160;0x20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00105">105</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a55173b8e2b621059aec758e57360c043"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_NOATTR&#160;&#160;&#160;0x100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00109">109</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aebd9b8ff6570442e29aa864e3b91d645"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_NOCERTS&#160;&#160;&#160;0x2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00099">99</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a98467ee02388202556ca48bb523b8509"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_NOCRL&#160;&#160;&#160;0x2000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00114">114</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7e17b533e127751bf3bea0370437c365"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_NOINTERN&#160;&#160;&#160;0x10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00104">104</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2b89f1f31e961cfb9b4b886aec1253ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_NOOLDMIMETYPE&#160;&#160;&#160;0x400</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00111">111</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a140e381c7de31bd3381593ea4cd46b73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_NOSIGS&#160;&#160;&#160;(<a class="el" href="cms_8h.html#adda58aee98a505082601471e313a61f4">CMS_NO_CONTENT_VERIFY</a>|<a class="el" href="cms_8h.html#acb04c24ec58a4dec438798d4801d0315">CMS_NO_ATTR_VERIFY</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00102">102</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac1f8028ac155516a5750f6c35a294f24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_NOSMIMECAP&#160;&#160;&#160;0x200</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00110">110</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae74af7175ab866497b77b6caddbc0875"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_NOVERIFY&#160;&#160;&#160;0x20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00106">106</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a20b64bc8c182f7ac666da5bcb0190c07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_PARTIAL&#160;&#160;&#160;0x4000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00115">115</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a362420679074443818711ec9aa3a14a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_ADD_SIGNER_ERROR&#160;&#160;&#160;99</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00463">463</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aca330411e7ba04276df4ea30b4a37a0a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CERTIFICATE_ALREADY_PRESENT&#160;&#160;&#160;175</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00464">464</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a05a57d82abc5030a5340dce444a84d98"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CERTIFICATE_HAS_NO_KEYID&#160;&#160;&#160;160</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00465">465</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a25666de73be1ea28e70629942b735de6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CERTIFICATE_VERIFY_ERROR&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00466">466</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="afa52b2bd2206156435b55e15bac11ee1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CIPHER_INITIALISATION_ERROR&#160;&#160;&#160;101</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00467">467</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8f810f38c4d363007aaf06a17919f61f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CIPHER_PARAMETER_INITIALISATION_ERROR&#160;&#160;&#160;102</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00468">468</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a022e051933d79d1d0c8d55d913465193"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CMS_DATAFINAL_ERROR&#160;&#160;&#160;103</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00469">469</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7d3f32a0dc5227fe770161cd570b8c7b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CMS_LIB&#160;&#160;&#160;104</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00470">470</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a97c0c7b0cb5dd5a7be7d6b8980f4ec18"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CONTENT_NOT_FOUND&#160;&#160;&#160;105</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00472">472</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a27141fe451491203f154002af88d6fce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CONTENT_TYPE_MISMATCH&#160;&#160;&#160;171</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00473">473</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2565bfd570bc0eabc4e3a74d1abc43e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CONTENT_TYPE_NOT_COMPRESSED_DATA&#160;&#160;&#160;106</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00474">474</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0407e04d7aee2109eaa028cc17096869"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CONTENT_TYPE_NOT_ENVELOPED_DATA&#160;&#160;&#160;107</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00475">475</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="afb5e55a2e31f2eb686663c4bf69edf21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CONTENT_TYPE_NOT_SIGNED_DATA&#160;&#160;&#160;108</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00476">476</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6a655244aa4b45127f0c43388eb7d59a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CONTENT_VERIFY_ERROR&#160;&#160;&#160;109</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00477">477</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a54d94a3135e8cac7ded5fa3e4aee6378"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CONTENTIDENTIFIER_MISMATCH&#160;&#160;&#160;170</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00471">471</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="acaacc3148004af71679e726810e7d532"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CTRL_ERROR&#160;&#160;&#160;110</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00478">478</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8d038f601b36de5ab9b0ee6829f41d2a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_CTRL_FAILURE&#160;&#160;&#160;111</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00479">479</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab4eef6d95bc8f30799f1fcf9d87b604b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_DECRYPT_ERROR&#160;&#160;&#160;112</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00480">480</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a88d47e6ff8e4cfe23620f452cb1fe46b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_DIGEST_ERROR&#160;&#160;&#160;161</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00481">481</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae8e40f58dd5746e3df367d40bf5a11dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_ERROR_GETTING_PUBLIC_KEY&#160;&#160;&#160;113</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00482">482</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac98cad4079e4febb50fb1652d6268b7c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_ERROR_READING_MESSAGEDIGEST_ATTRIBUTE&#160;&#160;&#160;114</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00483">483</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5c0c79e8fc1ea7456fdff7715ca43f61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_ERROR_SETTING_KEY&#160;&#160;&#160;115</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00484">484</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab0d306b14288eeebeec749a1fddbbe82"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_ERROR_SETTING_RECIPIENTINFO&#160;&#160;&#160;116</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00485">485</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a45eadb3b90cd04617a6f289af54db3c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_INVALID_ENCRYPTED_KEY_LENGTH&#160;&#160;&#160;117</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00486">486</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aeb8794764b9fdbd0a746c676be282791"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_INVALID_KEY_ENCRYPTION_PARAMETER&#160;&#160;&#160;176</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00487">487</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad72973d78eacc1a9b5794588665614d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_INVALID_KEY_LENGTH&#160;&#160;&#160;118</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00488">488</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7c37779b4e7c568c841d84b1607687f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_MD_BIO_INIT_ERROR&#160;&#160;&#160;119</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00489">489</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8769c8c179d967156e761dd9d4b89503"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_MESSAGEDIGEST_ATTRIBUTE_WRONG_LENGTH&#160;&#160;&#160;120</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00490">490</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aac86e03aa9a17729244f690e449a3fd5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_MESSAGEDIGEST_WRONG_LENGTH&#160;&#160;&#160;121</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00491">491</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9f5d6cdd1764fed539c9f80d1fb5089b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_MSGSIGDIGEST_ERROR&#160;&#160;&#160;172</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00492">492</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="afb33e9388a7ad0416830cf0aa4f26cc9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_MSGSIGDIGEST_VERIFICATION_FAILURE&#160;&#160;&#160;162</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00493">493</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae6aabfd4a80e3663df4f2dec244afec5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_MSGSIGDIGEST_WRONG_LENGTH&#160;&#160;&#160;163</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00494">494</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="abd680d0fa6e388cc7d6d78790c42d0ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NEED_ONE_SIGNER&#160;&#160;&#160;164</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00495">495</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aaab26e85a9411a43fd5e021b0d6a3e80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_CIPHER&#160;&#160;&#160;126</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00503">503</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4cb3ddc7ed52aeb2019880b240d1a74f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_CONTENT&#160;&#160;&#160;127</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00504">504</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a315dac2b2cfc6ee517e8dafa92b56a7f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_CONTENT_TYPE&#160;&#160;&#160;173</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00505">505</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="abaa0a56b68d2bed5aa3456bcf05b6b73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_DEFAULT_DIGEST&#160;&#160;&#160;128</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00506">506</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a51319470b072ceafad8d6f8bbf32ff81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_DIGEST_SET&#160;&#160;&#160;129</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00507">507</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a92176674c9b5c4b87465f93a79c7cec9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_KEY&#160;&#160;&#160;130</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00508">508</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6de6edfaddc9f8be340cb2fba91a7bd8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_KEY_OR_CERT&#160;&#160;&#160;174</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00509">509</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a625091664f384ceaab468eb6aa106c03"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_MATCHING_DIGEST&#160;&#160;&#160;131</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00510">510</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a62cbdd81c91645c79c7353094409a385"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_MATCHING_RECIPIENT&#160;&#160;&#160;132</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00511">511</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6c6e7c179f9ba847a46ff8fd62040223"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_MATCHING_SIGNATURE&#160;&#160;&#160;166</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00512">512</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="af5be1545206725e8206e07d83572537d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_MSGSIGDIGEST&#160;&#160;&#160;167</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00513">513</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a24ba42a81c73436b8da937f56185d745"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_PASSWORD&#160;&#160;&#160;178</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00514">514</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a06ecbb8febe4d7968ab68dfb148e1721"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_PRIVATE_KEY&#160;&#160;&#160;133</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00515">515</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="af3a4a80c8965f53fded432c7cd39c1fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_PUBLIC_KEY&#160;&#160;&#160;134</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00516">516</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a77a255f4d9b2a55cdbc0c0bd77b3c4a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_RECEIPT_REQUEST&#160;&#160;&#160;168</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00517">517</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a12d6fe11e8573f82a382fe65bd458462"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NO_SIGNERS&#160;&#160;&#160;135</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00518">518</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8faeb882bae14e4e12b5144bb376dcc2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NOT_A_SIGNED_RECEIPT&#160;&#160;&#160;165</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00496">496</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a868a4e6fc226d0fd080e80c78dc7ff68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NOT_ENCRYPTED_DATA&#160;&#160;&#160;122</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00497">497</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac555a8ace3e9e0226535c7221b63bf26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NOT_KEK&#160;&#160;&#160;123</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00498">498</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3dafd7ae00cc336b974db955156f890f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NOT_KEY_AGREEMENT&#160;&#160;&#160;181</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00499">499</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="abb0895b04040c42d03a5ca1178f7a54e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NOT_KEY_TRANSPORT&#160;&#160;&#160;124</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00500">500</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2798816e9b3824ba2970145c31561d99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NOT_PWRI&#160;&#160;&#160;177</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00501">501</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5501f38a05380b4d48562e17db5d931b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_NOT_SUPPORTED_FOR_THIS_KEY_TYPE&#160;&#160;&#160;125</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00502">502</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4f3e4ec51eccf1e1fa8c225f4165e35b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE&#160;&#160;&#160;136</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00519">519</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2876d00a7792f29c9ad4a75be68a8f69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_RECEIPT_DECODE_ERROR&#160;&#160;&#160;169</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00520">520</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2e9f93fc79052e7a81a6dc17ca7b0f86"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_RECIPIENT_ERROR&#160;&#160;&#160;137</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00521">521</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a45a9953862e357e43ef69f4ea0d9e7b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_SIGNER_CERTIFICATE_NOT_FOUND&#160;&#160;&#160;138</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00522">522</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6c5ccc581c18e0a3685d2e39dbab11de"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_SIGNFINAL_ERROR&#160;&#160;&#160;139</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00523">523</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3898cca630348d95716a7318fc35b321"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_SMIME_TEXT_ERROR&#160;&#160;&#160;140</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00524">524</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5e99415ca95f19756fa7d2d385d95732"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_STORE_INIT_ERROR&#160;&#160;&#160;141</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00525">525</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a06f5270859137fc67b170bf26c94ebab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_TYPE_NOT_COMPRESSED_DATA&#160;&#160;&#160;142</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00526">526</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aab570bcfac19f5dab4b12ae72aa9ded9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_TYPE_NOT_DATA&#160;&#160;&#160;143</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00527">527</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7df84d87200cc308bb9773abf3ce9146"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_TYPE_NOT_DIGESTED_DATA&#160;&#160;&#160;144</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00528">528</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a42a3d531b1e383257e1882aa532eed15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_TYPE_NOT_ENCRYPTED_DATA&#160;&#160;&#160;145</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00529">529</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab599c716523d66f9f0e8d128adecb8a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_TYPE_NOT_ENVELOPED_DATA&#160;&#160;&#160;146</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00530">530</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a60859dfda32464c93da459b430439950"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_UNABLE_TO_FINALIZE_CONTEXT&#160;&#160;&#160;147</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00531">531</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7ced89b08b244602676ca478190f6c91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_UNKNOWN_CIPHER&#160;&#160;&#160;148</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00532">532</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1a4144c1803a65d36cc4f75a98704dd8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_UNKNOWN_DIGEST_ALGORIHM&#160;&#160;&#160;149</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00533">533</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac9bcaaf30c0d054b260b256208cf0bbf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_UNKNOWN_ID&#160;&#160;&#160;150</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00534">534</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a93634ca62d329411640a389df0392f5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_UNSUPPORTED_COMPRESSION_ALGORITHM&#160;&#160;&#160;151</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00535">535</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac36b65bc5a5072964b6bb37d2a2641bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_UNSUPPORTED_CONTENT_TYPE&#160;&#160;&#160;152</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00536">536</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a17e31d84518bd96633f70c05d3586b60"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_UNSUPPORTED_KEK_ALGORITHM&#160;&#160;&#160;153</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00537">537</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae91540d4d6a51fc2ae4021a33d111f9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_UNSUPPORTED_KEY_ENCRYPTION_ALGORITHM&#160;&#160;&#160;179</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00538">538</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5dedd8ba3201a67c024aaeaa87c70c0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_UNSUPPORTED_RECIPIENT_TYPE&#160;&#160;&#160;154</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00539">539</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab906515535f6457ebafdab611944cf32"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_UNSUPPORTED_RECPIENTINFO_TYPE&#160;&#160;&#160;155</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00540">540</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae98d3859d6d3ba3210c26fd53970be2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_UNSUPPORTED_TYPE&#160;&#160;&#160;156</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00541">541</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="af8f7020b19a22351f467ac893275e9f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_UNWRAP_ERROR&#160;&#160;&#160;157</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00542">542</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6e89c9021038aa0f4961ef1d6f222b06"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_UNWRAP_FAILURE&#160;&#160;&#160;180</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00543">543</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa49b30049d0eb233a76d8c3396f72d7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_VERIFICATION_FAILURE&#160;&#160;&#160;158</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00544">544</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7254f807afef588dd99991679c90c846"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_R_WRAP_ERROR&#160;&#160;&#160;159</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00545">545</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="acef9d700f8704eef4c8cef466d2ccce2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_RECIPINFO_AGREE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00091">91</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2e860541fc9b71e68774a92635e7c03a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_RECIPINFO_KEK&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00092">92</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a772ce5ff5d0aea0e9003b401fe418fb0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_RECIPINFO_NONE&#160;&#160;&#160;-1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00089">89</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad984582c1d86072a850b447553ab9506"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_RECIPINFO_OTHER&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00094">94</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab206c8d6ec7c2bc1c4798b3775759db5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_RECIPINFO_PASS&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00093">93</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a16bd2b791fd7cc36a235fe459226ebfa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_RECIPINFO_TRANS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00090">90</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a925a18a0aeb4d0f8cdec3b24ffa9774b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_REUSE_DIGEST&#160;&#160;&#160;0x8000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00116">116</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa90a5540395664981482a8f6aa9e5e33"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_SIGNERINFO_ISSUER_SERIAL&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00086">86</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad42a4799f8919e59919223af98623ca0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_SIGNERINFO_KEYIDENTIFIER&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00087">87</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="af7c70d85fa217f66b9f10bc37281c723"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_STREAM&#160;&#160;&#160;0x1000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00113">113</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6386aad1cceb6f5561003c28bbf2dcb3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_TEXT&#160;&#160;&#160;0x1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00098">98</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae4670dfe3e27c5494ea55bc9f7a70296"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_USE_KEYID&#160;&#160;&#160;0x10000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00117">117</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<h2>Typedef Documentation</h2>
<a class="anchor" id="a592df6454d7c9ec6545694bd85ac2769"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a> <a class="el" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00071">71</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8f6e99fcf6597c9d6ef2959736e697b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__ContentInfo__st.html">CMS_ContentInfo_st</a> <a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00069">69</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="af54d24ab3b9acdc97b67988d660ede75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__OtherKeyAttribute__st.html">CMS_OtherKeyAttribute_st</a> <a class="el" href="cms_8h.html#af54d24ab3b9acdc97b67988d660ede75">CMS_OtherKeyAttribute</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00077">77</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac34335dae5c86dd281e21e075d417c58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__Receipt__st.html">CMS_Receipt_st</a> <a class="el" href="cms_8h.html#ac34335dae5c86dd281e21e075d417c58">CMS_Receipt</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00075">75</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad6b0df3c7c986cf29209828f9e31c523"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct CMS_ReceiptRequest_st <a class="el" href="cms_8h.html#ad6b0df3c7c986cf29209828f9e31c523">CMS_ReceiptRequest</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00074">74</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="aea929bebf778a99c3f2c6b5151850fc8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__RecipientEncryptedKey__st.html">CMS_RecipientEncryptedKey_st</a> <a class="el" href="cms_8h.html#aea929bebf778a99c3f2c6b5151850fc8">CMS_RecipientEncryptedKey</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00076">76</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac5c9066f9d23a39dc973dd8821304756"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo_st</a> <a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00073">73</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9eeccd496bd97cbb41a8a045cae0548e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__RevocationInfoChoice__st.html">CMS_RevocationInfoChoice_st</a> <a class="el" href="cms_8h.html#a9eeccd496bd97cbb41a8a045cae0548e">CMS_RevocationInfoChoice</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00072">72</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3f38c8c8e63c9af0a13f373f9f9df2f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__SignerInfo__st.html">CMS_SignerInfo_st</a> <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms_8h_source.html#l00070">70</a> of file <a class="el" href="cms_8h_source.html">cms.h</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a0b589be192d2c8d21d13dbf77543ea27"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* BIO_new_CMS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a54d38d62bfc50c2e8761130c36c5bad2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_add0_cert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00445">445</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a> *cch;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a>) **pcerts;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        pcerts = cms_get0_certificate_choices(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!pcerts)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a809f17e57bc4cd94f16649dbd6301fc0">sk_CMS_CertificateChoices_num</a>(*pcerts); i++)</div>
<div class="line">                {</div>
<div class="line">                cch = <a class="code" href="safestack_8h.html#a2c8ace5f3a7bb9a157622cf42340c1fa">sk_CMS_CertificateChoices_value</a>(*pcerts, i);</div>
<div class="line">                <span class="keywordflow">if</span> (cch-&gt;<a class="code" href="structCMS__CertificateChoices.html#af446184e0fdd56690ad06c6c4a0dba5c">type</a> == <a class="code" href="cms__lcl_8h.html#ac13e38ed7a0fad673c41edf5812c387d">CMS_CERTCHOICE_CERT</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (!<a class="code" href="x509_8h.html#af7d8ab113a29212c9818af26c2573b42">X509_cmp</a>(cch-&gt;<a class="code" href="structCMS__CertificateChoices.html#a9d8fa9df292b45f229970f4a41273cff">d</a>.<a class="code" href="structCMS__CertificateChoices.html#a73bb916b33aef426bc1d27b8261feaeb">certificate</a>, cert))</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a4da4a99381f52334723946f198d87728">CMS_F_CMS_ADD0_CERT</a>, </div>
<div class="line">                                        <a class="code" href="cms_8h.html#aca330411e7ba04276df4ea30b4a37a0a">CMS_R_CERTIFICATE_ALREADY_PRESENT</a>);</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        cch = <a class="code" href="cms_8h.html#aef3d3cc691ea54473b0306c0f970746b">CMS_add0_CertificateChoices</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!cch)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        cch-&gt;<a class="code" href="structCMS__CertificateChoices.html#af446184e0fdd56690ad06c6c4a0dba5c">type</a> = <a class="code" href="cms__lcl_8h.html#ac13e38ed7a0fad673c41edf5812c387d">CMS_CERTCHOICE_CERT</a>;</div>
<div class="line">        cch-&gt;<a class="code" href="structCMS__CertificateChoices.html#a9d8fa9df292b45f229970f4a41273cff">d</a>.<a class="code" href="structCMS__CertificateChoices.html#a73bb916b33aef426bc1d27b8261feaeb">certificate</a> = cert;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aef3d3cc691ea54473b0306c0f970746b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a>* CMS_add0_CertificateChoices </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00423">423</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a>) **pcerts;</div>
<div class="line">        <a class="code" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a> *cch;</div>
<div class="line">        pcerts = cms_get0_certificate_choices(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!pcerts)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (!*pcerts)</div>
<div class="line">                *pcerts = <a class="code" href="safestack_8h.html#a0393e63979d23d722f8acde250b344ba">sk_CMS_CertificateChoices_new_null</a>();</div>
<div class="line">        <span class="keywordflow">if</span> (!*pcerts)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        cch = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!cch)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#a4fbd52f1b9b4c675644eb1cd41110790">sk_CMS_CertificateChoices_push</a>(*pcerts, cch))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="asn1_8h.html#a64344e58b69188c21fd5ec2abe3a4a38">M_ASN1_free_of</a>(cch, <a class="code" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> cch;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad9ab18e37d81a6dab74485818afce6d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_add0_crl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a> *&#160;</td>
          <td class="paramname"><em>crl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00524">524</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__RevocationInfoChoice__st.html">CMS_RevocationInfoChoice</a> *rch;</div>
<div class="line">        rch = <a class="code" href="cms_8h.html#a043f3d99d4d29d587a30cc34d1d684a8">CMS_add0_RevocationInfoChoice</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!rch)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        rch-&gt;<a class="code" href="structCMS__RevocationInfoChoice__st.html#a97c3144337544cb6c734b324939b74d7">type</a> = <a class="code" href="cms__lcl_8h.html#a56217290da46d71e42d5d9cba9fbcc70">CMS_REVCHOICE_CRL</a>;</div>
<div class="line">        rch-&gt;<a class="code" href="structCMS__RevocationInfoChoice__st.html#a7bc8b06bbdb92b5d7e7ebf21bf08e7de">d</a>.<a class="code" href="structCMS__RevocationInfoChoice__st.html#ad7af71309ed9d760419b9f4d722ead46">crl</a> = crl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abc79183fe66f31806a18c02cd3b0c118"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a>* CMS_add0_recipient_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>idlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#abd19ea5b527807ce3a516e6a41440f84">ASN1_GENERALIZEDTIME</a> *&#160;</td>
          <td class="paramname"><em>date</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *&#160;</td>
          <td class="paramname"><em>otherTypeId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="asn1_8h.html#a7895e03d9fee2bc4963faf2a31a9439e">ASN1_TYPE</a> *&#160;</td>
          <td class="paramname"><em>otherType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00564">564</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a> *ri = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structCMS__EnvelopedData__st.html">CMS_EnvelopedData</a> *env;</div>
<div class="line">        <a class="code" href="structCMS__KEKRecipientInfo__st.html">CMS_KEKRecipientInfo</a> *kekri;</div>
<div class="line">        env = <a class="code" href="cms__env_8c.html#a904bcd4685600e69c9cadfc48e4c3e7c">cms_get0_enveloped</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!env)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a> == <a class="code" href="obj__mac_8h.html#ad115d9b07ddf7f48ea5feb47299a8894">NID_undef</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">switch</span> (keylen)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">case</span> 16:</div>
<div class="line">                        <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a> = <a class="code" href="obj__mac_8h.html#a8cc0ccb8b81faeb60a81c0fbbbf52842">NID_id_aes128_wrap</a>;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">case</span>  24:</div>
<div class="line">                        <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a> = <a class="code" href="obj__mac_8h.html#a3bb82f36dff0dbecd25e14637f903741">NID_id_aes192_wrap</a>;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">case</span>  32:</div>
<div class="line">                        <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a> = <a class="code" href="obj__mac_8h.html#acb67f0c443c4a1ec2b2e501859397b84">NID_id_aes256_wrap</a>;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">default</span>:</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a8d53d170864f78c0dc99b2fbaa0957e7">CMS_F_CMS_ADD0_RECIPIENT_KEY</a>,</div>
<div class="line">                                                <a class="code" href="cms_8h.html#ad72973d78eacc1a9b5794588665614d2">CMS_R_INVALID_KEY_LENGTH</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line"></div>
<div class="line">                <span class="keywordtype">size_t</span> exp_keylen = aes_wrap_keylen(<a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (!exp_keylen)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a8d53d170864f78c0dc99b2fbaa0957e7">CMS_F_CMS_ADD0_RECIPIENT_KEY</a>,</div>
<div class="line">                                        <a class="code" href="cms_8h.html#a17e31d84518bd96633f70c05d3586b60">CMS_R_UNSUPPORTED_KEK_ALGORITHM</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (keylen != exp_keylen)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a8d53d170864f78c0dc99b2fbaa0957e7">CMS_F_CMS_ADD0_RECIPIENT_KEY</a>,</div>
<div class="line">                                        <a class="code" href="cms_8h.html#ad72973d78eacc1a9b5794588665614d2">CMS_R_INVALID_KEY_LENGTH</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initialize recipient info */</span></div>
<div class="line">        ri = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!ri)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line"></div>
<div class="line">        ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a> = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__KEKRecipientInfo__st.html">CMS_KEKRecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> = <a class="code" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>;</div>
<div class="line"></div>
<div class="line">        kekri = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (otherTypeId)</div>
<div class="line">                {</div>
<div class="line">                kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a> = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__OtherKeyAttribute__st.html">CMS_OtherKeyAttribute</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        <span class="keywordflow">goto</span> merr;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#abbb67eae173733f0fabb2d8c4f2c9f0a">sk_CMS_RecipientInfo_push</a>(env-&gt;recipientInfos, ri))</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* After this point no calls can fail */</span></div>
<div class="line"></div>
<div class="line">        kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a45bab15d4cf10c9f4cb739f3aacd606e">version</a> = 4;</div>
<div class="line"></div>
<div class="line">        kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#ac82292d2f82c4e2a01b18ce48cbced3d">key</a> = <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>;</div>
<div class="line">        kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#ad588a2c59910bbaa2e54e09d4de4144f">keylen</a> = keylen;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="asn1_8h.html#add085933f3a303f7c59acf0e9b072d63">ASN1_STRING_set0</a>(kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a62da3e7a25399bba4bb209bba467ad53">keyIdentifier</a>, <span class="keywordtype">id</span>, idlen);</div>
<div class="line"></div>
<div class="line">        kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#aa5dc596530ce6f9f57d2515085808aac">date</a> = date;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>)</div>
<div class="line">                {</div>
<div class="line">                kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>-&gt;<a class="code" href="structCMS__OtherKeyAttribute__st.html#ae77e87e21328fc0456d48c96a4d5b9ea">keyAttrId</a> = otherTypeId;</div>
<div class="line">                kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>-&gt;<a class="code" href="structCMS__OtherKeyAttribute__st.html#a09e2b7c3fa802c038198ba99dbc11406">keyAttr</a> = otherType;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="x509_8h.html#a5c289a6fbc3107fefb5dc6184b5b7cc4">X509_ALGOR_set0</a>(kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a5f51b5cad62639eafec3e3948e82784c">keyEncryptionAlgorithm</a>,</div>
<div class="line">                                <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>), <a class="code" href="asn1_8h.html#ae9ce601db9cb8ba6fa09b69d399d7475">V_ASN1_UNDEF</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> ri;</div>
<div class="line"></div>
<div class="line">        merr:</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a8d53d170864f78c0dc99b2fbaa0957e7">CMS_F_CMS_ADD0_RECIPIENT_KEY</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (ri)</div>
<div class="line">                <a class="code" href="asn1_8h.html#a64344e58b69188c21fd5ec2abe3a4a38">M_ASN1_free_of</a>(ri, <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a11c9902c3ce2f434c7ef5ba01b1a81a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a>* CMS_add0_recipient_password </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wrap_nid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pbe_nid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>pass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ossl_ssize_t&#160;</td>
          <td class="paramname"><em>passlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *&#160;</td>
          <td class="paramname"><em>kekciph</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__pwri_8c_source.html#l00083">83</a> of file <a class="el" href="cms__pwri_8c_source.html">cms_pwri.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a> *ri = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structCMS__EnvelopedData__st.html">CMS_EnvelopedData</a> *env;</div>
<div class="line">        <a class="code" href="structCMS__PasswordRecipientInfo__st.html">CMS_PasswordRecipientInfo</a> *pwri;</div>
<div class="line">        <a class="code" href="structevp__cipher__ctx__st.html">EVP_CIPHER_CTX</a> ctx;</div>
<div class="line">        <a class="code" href="structX509__algor__st.html">X509_ALGOR</a> *encalg = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> iv[<a class="code" href="evp_8h.html#a80893bc2dbae769441bf6a042cf4069e">EVP_MAX_IV_LENGTH</a>];</div>
<div class="line">        <span class="keywordtype">int</span> ivlen;</div>
<div class="line">        env = <a class="code" href="cms__env_8c.html#a904bcd4685600e69c9cadfc48e4c3e7c">cms_get0_enveloped</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!env)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (wrap_nid &lt;= 0)</div>
<div class="line">                wrap_nid = <a class="code" href="obj__mac_8h.html#a9c9b8533d6d319e89277ab17f83c2374">NID_id_alg_PWRI_KEK</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (pbe_nid &lt;= 0)</div>
<div class="line">                pbe_nid = <a class="code" href="obj__mac_8h.html#a443be8862c926a5572844cdda1eab447">NID_id_pbkdf2</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Get from enveloped data */</span></div>
<div class="line">        <span class="keywordflow">if</span> (kekciph == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                kekciph = env-&gt;<a class="code" href="structCMS__EnvelopedData__st.html#a61ff72488726aa8cf3191e2e1cacc97d">encryptedContentInfo</a>-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a42d15187520e31613b3d2c47c79fa8dd">cipher</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (kekciph == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#abaa885cb63f5a560cd4068967d98b83a">CMS_F_CMS_ADD0_RECIPIENT_PASSWORD</a>, <a class="code" href="cms_8h.html#aaab26e85a9411a43fd5e021b0d6a3e80">CMS_R_NO_CIPHER</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (wrap_nid != <a class="code" href="obj__mac_8h.html#a9c9b8533d6d319e89277ab17f83c2374">NID_id_alg_PWRI_KEK</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#abaa885cb63f5a560cd4068967d98b83a">CMS_F_CMS_ADD0_RECIPIENT_PASSWORD</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#ae91540d4d6a51fc2ae4021a33d111f9d">CMS_R_UNSUPPORTED_KEY_ENCRYPTION_ALGORITHM</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Setup algorithm identifier for cipher */</span></div>
<div class="line">        encalg = X509_ALGOR_new();</div>
<div class="line">        <a class="code" href="evp_8h.html#ad32900fec7d9cb579e5d0bad7a4e1daa">EVP_CIPHER_CTX_init</a>(&amp;ctx);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#aa1ef7bdeb2a1f92e5f40a3fe1d87da65">EVP_EncryptInit_ex</a>(&amp;ctx, kekciph, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#abaa885cb63f5a560cd4068967d98b83a">CMS_F_CMS_ADD0_RECIPIENT_PASSWORD</a>, <a class="code" href="err_8h.html#a8959418b04c171c02dbacbd298326e2f">ERR_R_EVP_LIB</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        ivlen = <a class="code" href="evp_8h.html#af3201d12bcf0e13a885ca4cf5ee379f3">EVP_CIPHER_CTX_iv_length</a>(&amp;ctx);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ivlen &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="rand_8h.html#a8a4e911a9be281eb797faa8590637ac3">RAND_pseudo_bytes</a>(iv, ivlen) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#aa1ef7bdeb2a1f92e5f40a3fe1d87da65">EVP_EncryptInit_ex</a>(&amp;ctx, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, iv) &lt;= 0)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#abaa885cb63f5a560cd4068967d98b83a">CMS_F_CMS_ADD0_RECIPIENT_PASSWORD</a>,</div>
<div class="line">                                                        <a class="code" href="err_8h.html#a8959418b04c171c02dbacbd298326e2f">ERR_R_EVP_LIB</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                encalg-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a> = ASN1_TYPE_new();</div>
<div class="line">                <span class="keywordflow">if</span> (!encalg-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#abaa885cb63f5a560cd4068967d98b83a">CMS_F_CMS_ADD0_RECIPIENT_PASSWORD</a>,</div>
<div class="line">                                                        <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#a3a3e94ce6ad87d960addd62106a6d71d">EVP_CIPHER_param_to_asn1</a>(&amp;ctx, encalg-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a>) &lt;= 0)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#abaa885cb63f5a560cd4068967d98b83a">CMS_F_CMS_ADD0_RECIPIENT_PASSWORD</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a8f810f38c4d363007aaf06a17919f61f">CMS_R_CIPHER_PARAMETER_INITIALISATION_ERROR</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        encalg-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a> = <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="evp_8h.html#ab96111f6a3cef845f0d94c40b2b236fd">EVP_CIPHER_CTX_type</a>(&amp;ctx));</div>
<div class="line"></div>
<div class="line">        <a class="code" href="evp_8h.html#a41a7598b73c126d9f881296cad6305b8">EVP_CIPHER_CTX_cleanup</a>(&amp;ctx);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initialize recipient info */</span></div>
<div class="line">        ri = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!ri)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line"></div>
<div class="line">        ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#af50e43fa59b8416cfc0a31cc74805aca">pwri</a> = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__PasswordRecipientInfo__st.html">CMS_PasswordRecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#af50e43fa59b8416cfc0a31cc74805aca">pwri</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> = <a class="code" href="cms_8h.html#ab206c8d6ec7c2bc1c4798b3775759db5">CMS_RECIPINFO_PASS</a>;</div>
<div class="line"></div>
<div class="line">        pwri = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#af50e43fa59b8416cfc0a31cc74805aca">pwri</a>;</div>
<div class="line">        <span class="comment">/* Since this is overwritten, free up empty structure already there */</span></div>
<div class="line">        X509_ALGOR_free(pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#abaa7dcab8ae9e0969cffc43f4ba4bd13">keyEncryptionAlgorithm</a>);</div>
<div class="line">        pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#abaa7dcab8ae9e0969cffc43f4ba4bd13">keyEncryptionAlgorithm</a> = X509_ALGOR_new();</div>
<div class="line">        <span class="keywordflow">if</span> (!pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#abaa7dcab8ae9e0969cffc43f4ba4bd13">keyEncryptionAlgorithm</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#abaa7dcab8ae9e0969cffc43f4ba4bd13">keyEncryptionAlgorithm</a>-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a> = <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(wrap_nid);</div>
<div class="line">        pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#abaa7dcab8ae9e0969cffc43f4ba4bd13">keyEncryptionAlgorithm</a>-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a> = ASN1_TYPE_new();</div>
<div class="line">        <span class="keywordflow">if</span> (!pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#abaa7dcab8ae9e0969cffc43f4ba4bd13">keyEncryptionAlgorithm</a>-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!<a class="code" href="asn1_8h.html#ae48707fb4d9967ddb90ce4458c3810ab">ASN1_item_pack</a>(encalg, <a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(<a class="code" href="structX509__algor__st.html">X509_ALGOR</a>),</div>
<div class="line">            &amp;pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#abaa7dcab8ae9e0969cffc43f4ba4bd13">keyEncryptionAlgorithm</a>-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a>-&gt;<a class="code" href="structasn1__type__st.html#ab37a86242c23b20bd17ee2adb4678e38">value</a>.<a class="code" href="structasn1__type__st.html#a3799edca9238b6a1cb9604ed8ffdfb54">sequence</a>))</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#abaa7dcab8ae9e0969cffc43f4ba4bd13">keyEncryptionAlgorithm</a>-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a>-&gt;<a class="code" href="structasn1__type__st.html#af1bd6ef16c406f3cd3fa67eb81693b54">type</a> = <a class="code" href="asn1_8h.html#ab76fef5a089d894b827029a84a6f4f7a">V_ASN1_SEQUENCE</a>;</div>
<div class="line"></div>
<div class="line">        X509_ALGOR_free(encalg);</div>
<div class="line">        encalg = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Setup PBE algorithm */</span></div>
<div class="line"></div>
<div class="line">        pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#ada13747d28a08335dbc4381df2c796ac">keyDerivationAlgorithm</a> = <a class="code" href="x509_8h.html#a4e86df0216eae5d5c1b4f82e1af60777">PKCS5_pbkdf2_set</a>(iter, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, 0, -1, -1);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#ada13747d28a08335dbc4381df2c796ac">keyDerivationAlgorithm</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="cms_8h.html#a748a276eb5936a0d5760a89119e83fe4">CMS_RecipientInfo_set0_password</a>(ri, <a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>, <a class="code" href="pkcs12_8h.html#a0f676fe0b7faf04d68165e7546ffd518">passlen</a>);</div>
<div class="line">        pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#a7c6fdd4533e56e677e31c39de56af772">version</a> = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#abbb67eae173733f0fabb2d8c4f2c9f0a">sk_CMS_RecipientInfo_push</a>(env-&gt;recipientInfos, ri))</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> ri;</div>
<div class="line"></div>
<div class="line">        merr:</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#abaa885cb63f5a560cd4068967d98b83a">CMS_F_CMS_ADD0_RECIPIENT_PASSWORD</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        err:</div>
<div class="line">        <a class="code" href="evp_8h.html#a41a7598b73c126d9f881296cad6305b8">EVP_CIPHER_CTX_cleanup</a>(&amp;ctx);</div>
<div class="line">        <span class="keywordflow">if</span> (ri)</div>
<div class="line">                <a class="code" href="asn1_8h.html#a64344e58b69188c21fd5ec2abe3a4a38">M_ASN1_free_of</a>(ri, <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (encalg)</div>
<div class="line">                X509_ALGOR_free(encalg);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a043f3d99d4d29d587a30cc34d1d684a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a9eeccd496bd97cbb41a8a045cae0548e">CMS_RevocationInfoChoice</a>* CMS_add0_RevocationInfoChoice </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00502">502</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__RevocationInfoChoice__st.html">CMS_RevocationInfoChoice</a>) **pcrls;</div>
<div class="line">        <a class="code" href="structCMS__RevocationInfoChoice__st.html">CMS_RevocationInfoChoice</a> *rch;</div>
<div class="line">        pcrls = cms_get0_revocation_choices(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!pcrls)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (!*pcrls)</div>
<div class="line">                *pcrls = <a class="code" href="safestack_8h.html#a446f05c5ca887ed66486c80b0a6f33ac">sk_CMS_RevocationInfoChoice_new_null</a>();</div>
<div class="line">        <span class="keywordflow">if</span> (!*pcrls)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        rch = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__RevocationInfoChoice__st.html">CMS_RevocationInfoChoice</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!rch)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#a0ded1e1b7ffaef579c3673bfe07a4797">sk_CMS_RevocationInfoChoice_push</a>(*pcrls, rch))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="asn1_8h.html#a64344e58b69188c21fd5ec2abe3a4a38">M_ASN1_free_of</a>(rch, <a class="code" href="structCMS__RevocationInfoChoice__st.html">CMS_RevocationInfoChoice</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> rch;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9ba4ef68ee60c507f65b0a18e38de4fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_add1_cert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00474">474</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> r;</div>
<div class="line">        r = <a class="code" href="cms_8h.html#a54d38d62bfc50c2e8761130c36c5bad2">CMS_add0_cert</a>(cms, cert);</div>
<div class="line">        <span class="keywordflow">if</span> (r &gt; 0)</div>
<div class="line">                <a class="code" href="crypto_8h.html#ab8556c4f12443f1876ce487dd0c8db27">CRYPTO_add</a>(&amp;cert-&gt;<a class="code" href="structx509__st.html#ab1114b325664bca1cdfd6854f247a4d5">references</a>, 1, <a class="code" href="crypto_8h.html#abcd6591ef6acea51bf9f6edb6bb05bca">CRYPTO_LOCK_X509</a>);</div>
<div class="line">        <span class="keywordflow">return</span> r;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af2e14773b875a1a124c1fb01b28b1f16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_add1_crl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a> *&#160;</td>
          <td class="paramname"><em>crl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00535">535</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> r;</div>
<div class="line">        r = <a class="code" href="cms_8h.html#ad9ab18e37d81a6dab74485818afce6d1">CMS_add0_crl</a>(cms, crl);</div>
<div class="line">        <span class="keywordflow">if</span> (r &gt; 0)</div>
<div class="line">                <a class="code" href="crypto_8h.html#ab8556c4f12443f1876ce487dd0c8db27">CRYPTO_add</a>(&amp;crl-&gt;<a class="code" href="structX509__crl__st.html#aa143dabd3c77e3ef347835fc2f92b5a8">references</a>, 1, <a class="code" href="crypto_8h.html#acc0c636f451144eadad19883527a0a1a">CRYPTO_LOCK_X509_CRL</a>);</div>
<div class="line">        <span class="keywordflow">return</span> r;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa0f430b3dda40a05acc7cf29bd4b93d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a>* CMS_add1_recipient_cert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>recip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00240">240</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a> *ri = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structCMS__EnvelopedData__st.html">CMS_EnvelopedData</a> *env;</div>
<div class="line">        <a class="code" href="structevp__pkey__st.html">EVP_PKEY</a> *pk = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        env = <a class="code" href="cms__env_8c.html#a904bcd4685600e69c9cadfc48e4c3e7c">cms_get0_enveloped</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!env)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initialize recipient info */</span></div>
<div class="line">        ri = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!ri)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line"></div>
<div class="line">        pk = <a class="code" href="x509_8h.html#a97c3703b14a1f4a987c5d31cdf6cb205">X509_get_pubkey</a>(recip);</div>
<div class="line">        <span class="keywordflow">if</span> (!pk)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a466fc9af20c872ac00dbf5e414c769d6">CMS_F_CMS_ADD1_RECIPIENT_CERT</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#ae8e40f58dd5746e3df367d40bf5a11dd">CMS_R_ERROR_GETTING_PUBLIC_KEY</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">switch</span> (<a class="code" href="cms__env_8c.html#a4175d1c76c8093fb8a0f61c77a62fd86">cms_pkey_get_ri_type</a>(pk))</div>
<div class="line">                {</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>:</div>
<div class="line">                <span class="keywordflow">if</span> (!cms_RecipientInfo_ktri_init(ri, recip, pk, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>:</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="cms__kari_8c.html#acf47dd02ab24b071a4539c0eae072a73">cms_RecipientInfo_kari_init</a>(ri, recip, pk, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a466fc9af20c872ac00dbf5e414c769d6">CMS_F_CMS_ADD1_RECIPIENT_CERT</a>,</div>
<div class="line">                                        <a class="code" href="cms_8h.html#a5501f38a05380b4d48562e17db5d931b">CMS_R_NOT_SUPPORTED_FOR_THIS_KEY_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#abbb67eae173733f0fabb2d8c4f2c9f0a">sk_CMS_RecipientInfo_push</a>(env-&gt;recipientInfos, ri))</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="evp_8h.html#a448d9f9209a54694aff045d403850db7">EVP_PKEY_free</a>(pk);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> ri;</div>
<div class="line"></div>
<div class="line">        merr:</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a466fc9af20c872ac00dbf5e414c769d6">CMS_F_CMS_ADD1_RECIPIENT_CERT</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (ri)</div>
<div class="line">                <a class="code" href="asn1_8h.html#a64344e58b69188c21fd5ec2abe3a4a38">M_ASN1_free_of</a>(ri, <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (pk)</div>
<div class="line">                <a class="code" href="evp_8h.html#a448d9f9209a54694aff045d403850db7">EVP_PKEY_free</a>(pk);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2eb58dd50af8338432ec5b09c11becbc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a>* CMS_add1_signer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>signer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#aac66cf010326fa9a927c2a34888f45d3">EVP_MD</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00287">287</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__SignedData__st.html">CMS_SignedData</a> *sd;</div>
<div class="line">        <a class="code" href="structCMS__SignerInfo__st.html">CMS_SignerInfo</a> *si = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structX509__algor__st.html">X509_ALGOR</a> *alg;</div>
<div class="line">        <span class="keywordtype">int</span> i, <a class="code" href="e__aes_8c.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>;</div>
<div class="line">        <span class="keywordflow">if</span>(!<a class="code" href="x509_8h.html#aa2b4d3747ff3ce6998e1e1423f2c6051">X509_check_private_key</a>(signer, pk))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a33310fdd60839acfda68c53c7cf41209">CMS_F_CMS_ADD1_SIGNER</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#a4f3e4ec51eccf1e1fa8c225f4165e35b">CMS_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        sd = cms_signed_data_init(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!sd)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        si = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__SignerInfo__st.html">CMS_SignerInfo</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!si)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        <a class="code" href="v3__purp_8c.html#ad14cac500b50cb3b5b1392af85d35e0d">X509_check_purpose</a>(signer, -1, -1);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="crypto_8h.html#ab8556c4f12443f1876ce487dd0c8db27">CRYPTO_add</a>(&amp;pk-&gt;<a class="code" href="structevp__pkey__st.html#a89b11b788ffad7d747d1c7eed4cf279f">references</a>, 1, <a class="code" href="crypto_8h.html#aee0129d89ab09d6bccecd1ce55307584">CRYPTO_LOCK_EVP_PKEY</a>);</div>
<div class="line">        <a class="code" href="crypto_8h.html#ab8556c4f12443f1876ce487dd0c8db27">CRYPTO_add</a>(&amp;signer-&gt;<a class="code" href="structx509__st.html#ab1114b325664bca1cdfd6854f247a4d5">references</a>, 1, <a class="code" href="crypto_8h.html#abcd6591ef6acea51bf9f6edb6bb05bca">CRYPTO_LOCK_X509</a>);</div>
<div class="line"></div>
<div class="line">        si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a031a060e636d6bbd2fb77c04cfd00d58">pkey</a> = pk;</div>
<div class="line">        si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#ae23016eba59a8997ce007bc66cc74219">signer</a> = signer;</div>
<div class="line">        <a class="code" href="digest_8c.html#afe58145aa88a8ee187d858c762c00399">EVP_MD_CTX_init</a>(&amp;si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aa3b8138df00f7ba614925bb5f831ce4a">mctx</a>);</div>
<div class="line">        si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#af2308aafc9e8f1b1ec2fd885a168870c">pctx</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#ae4670dfe3e27c5494ea55bc9f7a70296">CMS_USE_KEYID</a>)</div>
<div class="line">                {</div>
<div class="line">                si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#ad243577fd14766c90b12254ec3648d39">version</a> = 3;</div>
<div class="line">                <span class="keywordflow">if</span> (sd-&gt;<a class="code" href="structCMS__SignedData__st.html#a46be0df1ce89115c84a063894b0b94b1">version</a> &lt; 3)</div>
<div class="line">                        sd-&gt;<a class="code" href="structCMS__SignedData__st.html#a46be0df1ce89115c84a063894b0b94b1">version</a> = 3;</div>
<div class="line">                type = <a class="code" href="cms_8h.html#ad42a4799f8919e59919223af98623ca0">CMS_SIGNERINFO_KEYIDENTIFIER</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                type = <a class="code" href="cms_8h.html#aa90a5540395664981482a8f6aa9e5e33">CMS_SIGNERINFO_ISSUER_SERIAL</a>;</div>
<div class="line">                si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#ad243577fd14766c90b12254ec3648d39">version</a> = 1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="cms__lcl_8h.html#ae2f46d9be341636d0e22d58d86fb7c1e">cms_set1_SignerIdentifier</a>(si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a5c2475b3f78c9362b3b0bbb8e56cbdf4">sid</a>, signer, type))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (md == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordtype">int</span> def_nid;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#ab97462edded31d985db968904ce5488c">EVP_PKEY_get_default_digest_nid</a>(pk, &amp;def_nid) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                md = <a class="code" href="evp_8h.html#af21731974d1c9b9467b3bf209d378e36">EVP_get_digestbynid</a>(def_nid);</div>
<div class="line">                <span class="keywordflow">if</span> (md == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a33310fdd60839acfda68c53c7cf41209">CMS_F_CMS_ADD1_SIGNER</a>, <a class="code" href="cms_8h.html#abaa0a56b68d2bed5aa3456bcf05b6b73">CMS_R_NO_DEFAULT_DIGEST</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!md)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a33310fdd60839acfda68c53c7cf41209">CMS_F_CMS_ADD1_SIGNER</a>, <a class="code" href="cms_8h.html#a51319470b072ceafad8d6f8bbf32ff81">CMS_R_NO_DIGEST_SET</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="x509_8h.html#ab44f4d3bad3d1c20afa59b4c38772cf3">X509_ALGOR_set_md</a>(si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a97656c5d82a9704229706ac22a328615">digestAlgorithm</a>, md);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* See if digest is present in digestAlgorithms */</span></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a94c75bbf81b8ad2a5ae09b10c8e47719">sk_X509_ALGOR_num</a>(sd-&gt;digestAlgorithms); i++)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *aoid;</div>
<div class="line">                alg = <a class="code" href="safestack_8h.html#a6f0738d8fab06b164ea825826b366fd0">sk_X509_ALGOR_value</a>(sd-&gt;digestAlgorithms, i);</div>
<div class="line">                <a class="code" href="x509_8h.html#acfea022df77108974470fa98aa88d9b9">X509_ALGOR_get0</a>(&amp;aoid, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, alg);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(aoid) == <a class="code" href="evp_8h.html#aff41d734c0cba5932bf15eba86eadf8f">EVP_MD_type</a>(md))</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (i == <a class="code" href="safestack_8h.html#a94c75bbf81b8ad2a5ae09b10c8e47719">sk_X509_ALGOR_num</a>(sd-&gt;digestAlgorithms))</div>
<div class="line">                {</div>
<div class="line">                alg = X509_ALGOR_new();</div>
<div class="line">                <span class="keywordflow">if</span> (!alg)</div>
<div class="line">                        <span class="keywordflow">goto</span> merr;</div>
<div class="line">                <a class="code" href="x509_8h.html#ab44f4d3bad3d1c20afa59b4c38772cf3">X509_ALGOR_set_md</a>(alg, md);</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#affb785b9b1d003ce8d76019bd5ecd46d">sk_X509_ALGOR_push</a>(sd-&gt;digestAlgorithms, alg))</div>
<div class="line">                        {</div>
<div class="line">                        X509_ALGOR_free(alg);</div>
<div class="line">                        <span class="keywordflow">goto</span> merr;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#afcd7a48a3b9f4a217ad110d7b4adc5ba">CMS_KEY_PARAM</a>) &amp;&amp; !cms_sd_asn1_ctrl(si, 0))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#a55173b8e2b621059aec758e57360c043">CMS_NOATTR</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="comment">/* Initialialize signed attributes strutucture so other</span></div>
<div class="line"><span class="comment">                 * attributes such as signing time etc are added later</span></div>
<div class="line"><span class="comment">                 * even if we add none here.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                <span class="keywordflow">if</span> (!si-&gt;signedAttrs)</div>
<div class="line">                        {</div>
<div class="line">                        si-&gt;signedAttrs = <a class="code" href="safestack_8h.html#a19fe352db05d7fb6ef53031d73644609">sk_X509_ATTRIBUTE_new_null</a>();</div>
<div class="line">                        <span class="keywordflow">if</span> (!si-&gt;signedAttrs)</div>
<div class="line">                                <span class="keywordflow">goto</span> merr;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#ac1f8028ac155516a5750f6c35a294f24">CMS_NOSMIMECAP</a>))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structX509__algor__st.html">X509_ALGOR</a>) *smcap = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        i = <a class="code" href="cms_8h.html#aafde25928ef5918da9c63d3e74236a58">CMS_add_standard_smimecap</a>(&amp;smcap);</div>
<div class="line">                        <span class="keywordflow">if</span> (i)</div>
<div class="line">                                i = <a class="code" href="cms_8h.html#a90229c07fd143aba2279b472319f7bf8">CMS_add_smimecap</a>(si, smcap);</div>
<div class="line">                        <a class="code" href="safestack_8h.html#a36bd4e666109f68887de0ce1b8aaff5a">sk_X509_ALGOR_pop_free</a>(smcap, X509_ALGOR_free);</div>
<div class="line">                        <span class="keywordflow">if</span> (!i)</div>
<div class="line">                                <span class="keywordflow">goto</span> merr;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#a925a18a0aeb4d0f8cdec3b24ffa9774b">CMS_REUSE_DIGEST</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (!cms_copy_messageDigest(cms, si))</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        <span class="keywordflow">if</span> (!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; (<a class="code" href="cms_8h.html#a20b64bc8c182f7ac666da5bcb0190c07">CMS_PARTIAL</a>|CMS_KEY_PARAM)) &amp;&amp;</div>
<div class="line">                                        !<a class="code" href="cms_8h.html#a426439b64ded9f572e4afd97bdfb4015">CMS_SignerInfo_sign</a>(si))</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#aebd9b8ff6570442e29aa864e3b91d645">CMS_NOCERTS</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="comment">/* NB ignore -1 return for duplicate cert */</span></div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="cms_8h.html#a9ba4ef68ee60c507f65b0a18e38de4fe">CMS_add1_cert</a>(cms, signer))</div>
<div class="line">                        <span class="keywordflow">goto</span> merr;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; CMS_KEY_PARAM)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; CMS_NOATTR)</div>
<div class="line">                        {</div>
<div class="line">                        si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#af2308aafc9e8f1b1ec2fd885a168870c">pctx</a> = <a class="code" href="evp_8h.html#a23d1c787f99b2aaa6d8283c2db325eea">EVP_PKEY_CTX_new</a>(si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a031a060e636d6bbd2fb77c04cfd00d58">pkey</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                        <span class="keywordflow">if</span> (!si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#af2308aafc9e8f1b1ec2fd885a168870c">pctx</a>)</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#a423a99ea5dbdd496bbf6fe31ca3b275e">EVP_PKEY_sign_init</a>(si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#af2308aafc9e8f1b1ec2fd885a168870c">pctx</a>) &lt;= 0)</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#a743ec645aadfb7f5ff5cbfc134c105a9">EVP_PKEY_CTX_set_signature_md</a>(si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#af2308aafc9e8f1b1ec2fd885a168870c">pctx</a>, md) &lt;= 0)</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#a6e42bb779758e541a2987e52223e7e50">EVP_DigestSignInit</a>(&amp;si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aa3b8138df00f7ba614925bb5f831ce4a">mctx</a>, &amp;si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#af2308aafc9e8f1b1ec2fd885a168870c">pctx</a>, md, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, pk) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!sd-&gt;signerInfos)</div>
<div class="line">                sd-&gt;signerInfos = <a class="code" href="safestack_8h.html#a80c53a144056a5ab2d14abfaa537099b">sk_CMS_SignerInfo_new_null</a>();</div>
<div class="line">        <span class="keywordflow">if</span> (!sd-&gt;signerInfos ||</div>
<div class="line">                !<a class="code" href="safestack_8h.html#a758754120cfb1cc07767043ae902bdc9">sk_CMS_SignerInfo_push</a>(sd-&gt;signerInfos, si))</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> si;</div>
<div class="line"></div>
<div class="line">        merr:</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a33310fdd60839acfda68c53c7cf41209">CMS_F_CMS_ADD1_SIGNER</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (si)</div>
<div class="line">                <a class="code" href="asn1_8h.html#a64344e58b69188c21fd5ec2abe3a4a38">M_ASN1_free_of</a>(si, <a class="code" href="structCMS__SignerInfo__st.html">CMS_SignerInfo</a>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8dbdee035fa4fe59e9de524f28f941ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_add_simple_smimecap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a>)**&#160;</td>
          <td class="paramname"><em>algs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>algnid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keysize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00976">976</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structX509__algor__st.html">X509_ALGOR</a> *alg;</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_INTEGER</a> *<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (keysize &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                key = ASN1_INTEGER_new();</div>
<div class="line">                <span class="keywordflow">if</span> (!key || !<a class="code" href="a__int_8c.html#a5716313a70738f4ab0c80c7d19c5f2d5">ASN1_INTEGER_set</a>(key, keysize))</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        alg = X509_ALGOR_new();</div>
<div class="line">        <span class="keywordflow">if</span> (!alg)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (key)</div>
<div class="line">                        ASN1_INTEGER_free(key);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">        <a class="code" href="x509_8h.html#a5c289a6fbc3107fefb5dc6184b5b7cc4">X509_ALGOR_set0</a>(alg, <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(algnid),</div>
<div class="line">                                key ? <a class="code" href="asn1_8h.html#a0fc996672dd3dd88bfcd087456a6796b">V_ASN1_INTEGER</a> : <a class="code" href="asn1_8h.html#ae9ce601db9cb8ba6fa09b69d399d7475">V_ASN1_UNDEF</a>, key);</div>
<div class="line">        <span class="keywordflow">if</span> (!*algs)</div>
<div class="line">                *algs = <a class="code" href="safestack_8h.html#a842fb6bbef61a34c4082669e43dd4080">sk_X509_ALGOR_new_null</a>();</div>
<div class="line">        <span class="keywordflow">if</span> (!*algs || !<a class="code" href="safestack_8h.html#affb785b9b1d003ce8d76019bd5ecd46d">sk_X509_ALGOR_push</a>(*algs, alg))</div>
<div class="line">                {</div>
<div class="line">                X509_ALGOR_free(alg);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a90229c07fd143aba2279b472319f7bf8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_add_smimecap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a>)*&#160;</td>
          <td class="paramname"><em>algs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00963">963</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *smder = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> smderlen, r;</div>
<div class="line">        smderlen = i2d_X509_ALGORS(algs, &amp;smder);</div>
<div class="line">        <span class="keywordflow">if</span> (smderlen &lt;= 0)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        r = <a class="code" href="cms_8h.html#ac54e63b2827670c7b82c449f536ae59d">CMS_signed_add1_attr_by_NID</a>(si, <a class="code" href="obj__mac_8h.html#ad60ad571a28cfcbb886f20b64dd633b3">NID_SMIMECapabilities</a>,</div>
<div class="line">                                        <a class="code" href="asn1_8h.html#ab76fef5a089d894b827029a84a6f4f7a">V_ASN1_SEQUENCE</a>, smder, smderlen);</div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(smder);</div>
<div class="line">        <span class="keywordflow">return</span> r;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aafde25928ef5918da9c63d3e74236a58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_add_standard_smimecap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a>)**&#160;</td>
          <td class="paramname"><em>smcap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l01023">1023</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (!cms_add_cipher_smcap(smcap, <a class="code" href="obj__mac_8h.html#a720aea1da22b9537f4a540d3721e0d85">NID_aes_256_cbc</a>, -1)</div>
<div class="line">                || !cms_add_digest_smcap(smcap, <a class="code" href="obj__mac_8h.html#a2b8776188557eae155d3fa6a91452390">NID_id_GostR3411_94</a>, -1)</div>
<div class="line">                || !cms_add_cipher_smcap(smcap, <a class="code" href="obj__mac_8h.html#acbf14fbfaa2119f12d3ff9e2f1931172">NID_id_Gost28147_89</a>, -1)</div>
<div class="line">                || !cms_add_cipher_smcap(smcap, <a class="code" href="obj__mac_8h.html#a79a7937ec024133a05e76d7644dd8127">NID_aes_192_cbc</a>, -1)</div>
<div class="line">                || !cms_add_cipher_smcap(smcap, <a class="code" href="obj__mac_8h.html#a8ebaffe01b7df98d5da9d0e43edc80ac">NID_aes_128_cbc</a>, -1)</div>
<div class="line">                || !cms_add_cipher_smcap(smcap, <a class="code" href="obj__mac_8h.html#a8a1e8ea0dceb665cd7a19b2fb1a99ad2">NID_des_ede3_cbc</a>, -1)</div>
<div class="line">                || !cms_add_cipher_smcap(smcap, <a class="code" href="obj__mac_8h.html#abd186c6b6e3a641e4f1da0cf38d4bdac">NID_rc2_cbc</a>, 128)</div>
<div class="line">                || !cms_add_cipher_smcap(smcap, <a class="code" href="obj__mac_8h.html#abd186c6b6e3a641e4f1da0cf38d4bdac">NID_rc2_cbc</a>, 64)</div>
<div class="line">                || !cms_add_cipher_smcap(smcap, <a class="code" href="obj__mac_8h.html#ac6062b978d3b452f0dba5bdf37efd56f">NID_des_cbc</a>, -1)</div>
<div class="line">                || !cms_add_cipher_smcap(smcap, <a class="code" href="obj__mac_8h.html#abd186c6b6e3a641e4f1da0cf38d4bdac">NID_rc2_cbc</a>, 40))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaeca81397f9282a2834272b3eabd35c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* CMS_compress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>comp_nid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00946">946</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a7c2ae2d56e874d77e44af42ef89eb680">CMS_F_CMS_COMPRESS</a>, <a class="code" href="cms_8h.html#a93634ca62d329411640a389df0392f5d">CMS_R_UNSUPPORTED_COMPRESSION_ALGORITHM</a>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af982b5d6dc72ed24c93441b27bc0a746"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00158">158</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *cont;</div>
<div class="line">        <span class="keywordtype">int</span> r;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(<a class="code" href="cms_8h.html#a416a06af57cce1e9339ff9d981160f13">CMS_get0_type</a>(cms)) != <a class="code" href="obj__mac_8h.html#a13d08edbaf91c1fd310b3e4cbd9f98a9">NID_pkcs7_data</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a47c7367f7f973cd508117a9fe8e7e6e8">CMS_F_CMS_DATA</a>, <a class="code" href="cms_8h.html#aab570bcfac19f5dab4b12ae72aa9ded9">CMS_R_TYPE_NOT_DATA</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        cont = <a class="code" href="cms_8h.html#af321d3ecf3ee6e9d3dbdbc8a7b572917">CMS_dataInit</a>(cms, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!cont)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        r = cms_copy_content(out, cont, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>);</div>
<div class="line">        <a class="code" href="bio_8h.html#a9cc47fc222c166cd863e1dfb5467a14e">BIO_free_all</a>(cont);</div>
<div class="line">        <span class="keywordflow">return</span> r;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aae9d721032654d0e5f7d990fec8a2fdb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* CMS_data_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00175">175</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a> *cms;</div>
<div class="line">        cms = <a class="code" href="cms__lcl_8h.html#ab98170e495ae6b0ee6e8a3d3d7892ea3">cms_Data_create</a>();</div>
<div class="line">        <span class="keywordflow">if</span> (!cms)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#af7c70d85fa217f66b9f10bc37281c723">CMS_STREAM</a>) || <a class="code" href="cms_8h.html#a52397f4b59560ac8a0ad14707dbd8335">CMS_final</a>(cms, in, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                <span class="keywordflow">return</span> cms;</div>
<div class="line"></div>
<div class="line">        CMS_ContentInfo_free(cms);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1c36b8225ea45f33d22fe44d16a3f98b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_dataFinal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00158">158</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> **pos = <a class="code" href="cms_8h.html#aed4845b6010a2e1988ca0234cbfa3b18">CMS_get0_content</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!pos)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="comment">/* If ebmedded content find memory BIO and set content */</span></div>
<div class="line">        <span class="keywordflow">if</span> (*pos &amp;&amp; ((*pos)-&gt;flags &amp; <a class="code" href="asn1_8h.html#a4b7ab2e2bd5b4e52b4f3d13a3a3e59bd">ASN1_STRING_FLAG_CONT</a>))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structbio__st.html">BIO</a> *mbio;</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *cont;</div>
<div class="line">                <span class="keywordtype">long</span> contlen;</div>
<div class="line">                mbio = <a class="code" href="bio_8h.html#aee7bbe95cd69d7944f939d4a8073604c">BIO_find_type</a>(cmsbio, <a class="code" href="bio_8h.html#a85fbb99a752fe49d342b1685580587b7">BIO_TYPE_MEM</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (!mbio)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a8e68562b976a1e675ef7a52b6b1601fd">CMS_F_CMS_DATAFINAL</a>, <a class="code" href="cms_8h.html#a97c0c7b0cb5dd5a7be7d6b8980f4ec18">CMS_R_CONTENT_NOT_FOUND</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                contlen = <a class="code" href="bio_8h.html#ad1cca133aa21da42cf8dac755e0b4df1">BIO_get_mem_data</a>(mbio, &amp;cont);</div>
<div class="line">                <span class="comment">/* Set bio as read only so its content can&#39;t be clobbered */</span></div>
<div class="line">                <a class="code" href="bio_8h.html#ae23cacabf82f08ca0aaf4610cdefb6d0">BIO_set_flags</a>(mbio, <a class="code" href="bio_8h.html#a24787480b006c3280e3e406c7f1a74fc">BIO_FLAGS_MEM_RDONLY</a>);</div>
<div class="line">                <a class="code" href="bio_8h.html#a11c737cf2f36d5a7f681590b6c0a2cc3">BIO_set_mem_eof_return</a>(mbio, 0);</div>
<div class="line">                <a class="code" href="asn1_8h.html#add085933f3a303f7c59acf0e9b072d63">ASN1_STRING_set0</a>(*pos, cont, contlen);</div>
<div class="line">                (*pos)-&gt;flags &amp;= ~<a class="code" href="asn1_8h.html#a4b7ab2e2bd5b4e52b4f3d13a3a3e59bd">ASN1_STRING_FLAG_CONT</a>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">switch</span> (<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#aae0b0e1c6da4732f18167de51c9eb9e5">contentType</a>))</div>
<div class="line">                {</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a13d08edbaf91c1fd310b3e4cbd9f98a9">NID_pkcs7_data</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a4587e848643383571699c4b1fdaf5710">NID_pkcs7_enveloped</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a302ab4232d763141c7b9a4f7d177a7ac">NID_pkcs7_encrypted</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a9abb7bbfc6731d3e9b72e01cbd595357">NID_id_smime_ct_compressedData</a>:</div>
<div class="line">                <span class="comment">/* Nothing to do */</span></div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a085f07bc1100332366a5675145f8fea9">NID_pkcs7_signed</a>:</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#aeaa6987a61ee75542fde7e9d4b5dbe56">cms_SignedData_final</a>(cms, cmsbio);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a5913b3f520c08ebb4000fee1be9ec0f5">NID_pkcs7_digest</a>:</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__dd_8c.html#a8a10b03dabe71726e5ba1122e0e7d521">cms_DigestedData_do_final</a>(cms, cmsbio, 0);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a8e68562b976a1e675ef7a52b6b1601fd">CMS_F_CMS_DATAFINAL</a>, <a class="code" href="cms_8h.html#ae98d3859d6d3ba3210c26fd53970be2e">CMS_R_UNSUPPORTED_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af321d3ecf3ee6e9d3dbdbc8a7b572917"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* CMS_dataInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>icont</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00105">105</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *cmsbio, *cont;</div>
<div class="line">        <span class="keywordflow">if</span> (icont)</div>
<div class="line">                cont = icont;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                cont = <a class="code" href="cms__lcl_8h.html#a8a4dbf1a9981c0b07fc164f220bae461">cms_content_bio</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!cont)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a2430638220587768d0447fc25fdd8efc">CMS_F_CMS_DATAINIT</a>, <a class="code" href="cms_8h.html#a4cb3ddc7ed52aeb2019880b240d1a74f">CMS_R_NO_CONTENT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">switch</span> (<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#aae0b0e1c6da4732f18167de51c9eb9e5">contentType</a>))</div>
<div class="line">                {</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a13d08edbaf91c1fd310b3e4cbd9f98a9">NID_pkcs7_data</a>:</div>
<div class="line">                <span class="keywordflow">return</span> cont;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a085f07bc1100332366a5675145f8fea9">NID_pkcs7_signed</a>:</div>
<div class="line">                cmsbio = <a class="code" href="cms__lcl_8h.html#a0ab3d20e8cc3de71f04703dfa7c62017">cms_SignedData_init_bio</a>(cms);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a5913b3f520c08ebb4000fee1be9ec0f5">NID_pkcs7_digest</a>:</div>
<div class="line">                cmsbio = <a class="code" href="cms__dd_8c.html#a42c657a8d92b5f24da640eb77f890416">cms_DigestedData_init_bio</a>(cms);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="preprocessor">#ifdef ZLIB</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a9abb7bbfc6731d3e9b72e01cbd595357">NID_id_smime_ct_compressedData</a>:</div>
<div class="line">                cmsbio = <a class="code" href="cms__lcl_8h.html#acf77ed7105bfbe80a22d8bf47ef62bb0">cms_CompressedData_init_bio</a>(cms);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a302ab4232d763141c7b9a4f7d177a7ac">NID_pkcs7_encrypted</a>:</div>
<div class="line">                cmsbio = <a class="code" href="cms__enc_8c.html#a55dec6744581e6a39e9b38a3bfeafb1d">cms_EncryptedData_init_bio</a>(cms);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a4587e848643383571699c4b1fdaf5710">NID_pkcs7_enveloped</a>:</div>
<div class="line">                cmsbio = <a class="code" href="cms__env_8c.html#a40e7ed2550f0b34ee904c6576f08bc57">cms_EnvelopedData_init_bio</a>(cms);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a2430638220587768d0447fc25fdd8efc">CMS_F_CMS_DATAINIT</a>, <a class="code" href="cms_8h.html#ae98d3859d6d3ba3210c26fd53970be2e">CMS_R_UNSUPPORTED_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (cmsbio)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="bio_8h.html#a4e509280cddd4eb3537fe7e3bc0827a9">BIO_push</a>(cmsbio, cont);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!icont)</div>
<div class="line">                <a class="code" href="bio_8h.html#abbfb67b5eb998ce232f2482b097da8b2">BIO_free</a>(cont);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aac00aef8326c57bb7533790e5e297aae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>pkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>dcont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00834">834</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> r;</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *cont;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(<a class="code" href="cms_8h.html#a416a06af57cce1e9339ff9d981160f13">CMS_get0_type</a>(cms)) != <a class="code" href="obj__mac_8h.html#a4587e848643383571699c4b1fdaf5710">NID_pkcs7_enveloped</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ab9907d42c5fd1d4c8a8f3859f07f74d8">CMS_F_CMS_DECRYPT</a>, <a class="code" href="cms_8h.html#ab599c716523d66f9f0e8d128adecb8a7">CMS_R_TYPE_NOT_ENVELOPED_DATA</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!dcont &amp;&amp; !check_content(cms))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#a3e910f5d1c60a64bd5c43ef26ccd43ce">CMS_DEBUG_DECRYPT</a>)</div>
<div class="line">                cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>-&gt;<a class="code" href="structCMS__EnvelopedData__st.html#a61ff72488726aa8cf3191e2e1cacc97d">encryptedContentInfo</a>-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#acac0ff1fe57132f12130a3a42d57c4fc">debug</a> = 1;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>-&gt;<a class="code" href="structCMS__EnvelopedData__st.html#a61ff72488726aa8cf3191e2e1cacc97d">encryptedContentInfo</a>-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#acac0ff1fe57132f12130a3a42d57c4fc">debug</a> = 0;</div>
<div class="line">        <span class="keywordflow">if</span> (!pk &amp;&amp; !cert &amp;&amp; !dcont &amp;&amp; !out)</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">if</span> (pk &amp;&amp; !<a class="code" href="cms_8h.html#a2964117c4d9a5d33602840a3cbe1a96a">CMS_decrypt_set1_pkey</a>(cms, pk, cert))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        cont = <a class="code" href="cms_8h.html#af321d3ecf3ee6e9d3dbdbc8a7b572917">CMS_dataInit</a>(cms, dcont);</div>
<div class="line">        <span class="keywordflow">if</span> (!cont)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        r = cms_copy_content(out, cont, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>);</div>
<div class="line">        do_free_upto(cont, dcont);</div>
<div class="line">        <span class="keywordflow">return</span> r;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a16000416939d14915dd607d0591bcfd5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_decrypt_set1_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>idlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00771">771</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>) *ris;</div>
<div class="line">        <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a> *ri;</div>
<div class="line">        <span class="keywordtype">int</span> i, r;</div>
<div class="line">        ris = CMS_get0_RecipientInfos(cms);</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a0c1e686cfaa11baf6f61c28373ba3b98">sk_CMS_RecipientInfo_num</a>(ris); i++)</div>
<div class="line">                {</div>
<div class="line">                ri = <a class="code" href="safestack_8h.html#a546bb94aa3a8b2cb44c8bcef75da1a01">sk_CMS_RecipientInfo_value</a>(ris, i);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="cms_8h.html#a3ae6eeed24d48fa38986857810a09304">CMS_RecipientInfo_type</a>(ri) != <a class="code" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>)</div>
<div class="line">                                <span class="keywordflow">continue</span>;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* If we have an id try matching RecipientInfo</span></div>
<div class="line"><span class="comment">                 * otherwise try them all.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                <span class="keywordflow">if</span> (!<span class="keywordtype">id</span> || (<a class="code" href="cms_8h.html#a3abd22c1ff8260d4935a428898030f92">CMS_RecipientInfo_kekri_id_cmp</a>(ri, <span class="keywordtype">id</span>, idlen) == 0))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="cms_8h.html#abcbf7e892f737b18c52779d636143b14">CMS_RecipientInfo_set0_key</a>(ri, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, keylen);</div>
<div class="line">                        r = <a class="code" href="cms_8h.html#a2db1d83492be468599b3be3452e98cc5">CMS_RecipientInfo_decrypt</a>(cms, ri);</div>
<div class="line">                        <a class="code" href="cms_8h.html#abcbf7e892f737b18c52779d636143b14">CMS_RecipientInfo_set0_key</a>(ri, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, 0);</div>
<div class="line">                        <span class="keywordflow">if</span> (r &gt; 0)</div>
<div class="line">                                <span class="keywordflow">return</span> 1;</div>
<div class="line">                        <span class="keywordflow">if</span> (<span class="keywordtype">id</span>)</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a78082a731cf00f28c93aa366674cd426">CMS_F_CMS_DECRYPT_SET1_KEY</a>,</div>
<div class="line">                                                <a class="code" href="cms_8h.html#ab4eef6d95bc8f30799f1fcf9d87b604b">CMS_R_DECRYPT_ERROR</a>);</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                                }</div>
<div class="line">                        <a class="code" href="err_8c.html#ae562e57f2e66f238d774cbfddc6bf7a4">ERR_clear_error</a>();</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a78082a731cf00f28c93aa366674cd426">CMS_F_CMS_DECRYPT_SET1_KEY</a>, <a class="code" href="cms_8h.html#a62cbdd81c91645c79c7353094409a385">CMS_R_NO_MATCHING_RECIPIENT</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1fa57a0854635ddd67869672167a7e72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_decrypt_set1_password </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>pass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ossl_ssize_t&#160;</td>
          <td class="paramname"><em>passlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00810">810</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>) *ris;</div>
<div class="line">        <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a> *ri;</div>
<div class="line">        <span class="keywordtype">int</span> i, r;</div>
<div class="line">        ris = CMS_get0_RecipientInfos(cms);</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a0c1e686cfaa11baf6f61c28373ba3b98">sk_CMS_RecipientInfo_num</a>(ris); i++)</div>
<div class="line">                {</div>
<div class="line">                ri = <a class="code" href="safestack_8h.html#a546bb94aa3a8b2cb44c8bcef75da1a01">sk_CMS_RecipientInfo_value</a>(ris, i);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="cms_8h.html#a3ae6eeed24d48fa38986857810a09304">CMS_RecipientInfo_type</a>(ri) != <a class="code" href="cms_8h.html#ab206c8d6ec7c2bc1c4798b3775759db5">CMS_RECIPINFO_PASS</a>)</div>
<div class="line">                                <span class="keywordflow">continue</span>;</div>
<div class="line">                <a class="code" href="cms_8h.html#a748a276eb5936a0d5760a89119e83fe4">CMS_RecipientInfo_set0_password</a>(ri, <a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>, <a class="code" href="pkcs12_8h.html#a0f676fe0b7faf04d68165e7546ffd518">passlen</a>);</div>
<div class="line">                r = <a class="code" href="cms_8h.html#a2db1d83492be468599b3be3452e98cc5">CMS_RecipientInfo_decrypt</a>(cms, ri);</div>
<div class="line">                <a class="code" href="cms_8h.html#a748a276eb5936a0d5760a89119e83fe4">CMS_RecipientInfo_set0_password</a>(ri, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, 0);</div>
<div class="line">                <span class="keywordflow">if</span> (r &gt; 0)</div>
<div class="line">                        <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#af41beccbed88ab6ec20442aed11a193f">CMS_F_CMS_DECRYPT_SET1_PASSWORD</a>, <a class="code" href="cms_8h.html#a62cbdd81c91645c79c7353094409a385">CMS_R_NO_MATCHING_RECIPIENT</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2964117c4d9a5d33602840a3cbe1a96a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_decrypt_set1_pkey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00695">695</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>) *ris;</div>
<div class="line">        <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a> *ri;</div>
<div class="line">        <span class="keywordtype">int</span> i, r, ri_type;</div>
<div class="line">        <span class="keywordtype">int</span> debug = 0;</div>
<div class="line">        ris = CMS_get0_RecipientInfos(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (ris)</div>
<div class="line">                debug = cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>-&gt;<a class="code" href="structCMS__EnvelopedData__st.html#a61ff72488726aa8cf3191e2e1cacc97d">encryptedContentInfo</a>-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#acac0ff1fe57132f12130a3a42d57c4fc">debug</a>;</div>
<div class="line">        ri_type = <a class="code" href="cms__env_8c.html#a4175d1c76c8093fb8a0f61c77a62fd86">cms_pkey_get_ri_type</a>(pk);</div>
<div class="line">        <span class="keywordflow">if</span> (ri_type == <a class="code" href="cms_8h.html#a772ce5ff5d0aea0e9003b401fe418fb0">CMS_RECIPINFO_NONE</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ab2dcd528d2ac49bb38432d451217bd24">CMS_F_CMS_DECRYPT_SET1_PKEY</a>,</div>
<div class="line">                                        <a class="code" href="cms_8h.html#a5501f38a05380b4d48562e17db5d931b">CMS_R_NOT_SUPPORTED_FOR_THIS_KEY_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a0c1e686cfaa11baf6f61c28373ba3b98">sk_CMS_RecipientInfo_num</a>(ris); i++)</div>
<div class="line">                {</div>
<div class="line">                ri = <a class="code" href="safestack_8h.html#a546bb94aa3a8b2cb44c8bcef75da1a01">sk_CMS_RecipientInfo_value</a>(ris, i);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="cms_8h.html#a3ae6eeed24d48fa38986857810a09304">CMS_RecipientInfo_type</a>(ri) != ri_type)</div>
<div class="line">                                <span class="keywordflow">continue</span>;</div>
<div class="line">                <span class="keywordflow">if</span> (ri_type == <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>)</div>
<div class="line">                        {</div>
<div class="line">                        r = cms_kari_set1_pkey(cms, ri, pk, cert);</div>
<div class="line">                        <span class="keywordflow">if</span> (r &gt; 0)</div>
<div class="line">                                <span class="keywordflow">return</span> 1;</div>
<div class="line">                        <span class="keywordflow">if</span> (r &lt; 0)</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                <span class="comment">/* If we have a cert try matching RecipientInfo</span></div>
<div class="line"><span class="comment">                 * otherwise try them all.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!cert || !<a class="code" href="cms_8h.html#ab7a3b21a9d98942c07103ea081bee640">CMS_RecipientInfo_ktri_cert_cmp</a>(ri, cert))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="cms_8h.html#a9677b76bdae4ef3dfb1da114a02b7093">CMS_RecipientInfo_set0_pkey</a>(ri, pk);</div>
<div class="line">                        r = <a class="code" href="cms_8h.html#a2db1d83492be468599b3be3452e98cc5">CMS_RecipientInfo_decrypt</a>(cms, ri);</div>
<div class="line">                        <a class="code" href="cms_8h.html#a9677b76bdae4ef3dfb1da114a02b7093">CMS_RecipientInfo_set0_pkey</a>(ri, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                        <span class="keywordflow">if</span> (cert)</div>
<div class="line">                                {</div>
<div class="line">                                <span class="comment">/* If not debugging clear any error and</span></div>
<div class="line"><span class="comment">                                 * return success to avoid leaking of</span></div>
<div class="line"><span class="comment">                                 * information useful to MMA</span></div>
<div class="line"><span class="comment">                                 */</span></div>
<div class="line">                                <span class="keywordflow">if</span> (!debug)</div>
<div class="line">                                        {</div>
<div class="line">                                        <a class="code" href="err_8c.html#ae562e57f2e66f238d774cbfddc6bf7a4">ERR_clear_error</a>();</div>
<div class="line">                                        <span class="keywordflow">return</span> 1;</div>
<div class="line">                                        }</div>
<div class="line">                                <span class="keywordflow">if</span> (r &gt; 0)</div>
<div class="line">                                        <span class="keywordflow">return</span> 1;</div>
<div class="line">                                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ab2dcd528d2ac49bb38432d451217bd24">CMS_F_CMS_DECRYPT_SET1_PKEY</a>,</div>
<div class="line">                                                <a class="code" href="cms_8h.html#ab4eef6d95bc8f30799f1fcf9d87b604b">CMS_R_DECRYPT_ERROR</a>);</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="comment">/* If no cert and not debugging don&#39;t leave loop</span></div>
<div class="line"><span class="comment">                         * after first successful decrypt. Always attempt</span></div>
<div class="line"><span class="comment">                         * to decrypt all recipients to avoid leaking timing</span></div>
<div class="line"><span class="comment">                         * of a successful decrypt.</span></div>
<div class="line"><span class="comment">                         */</span></div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r &gt; 0 &amp;&amp; debug)</div>
<div class="line">                                <span class="keywordflow">return</span> 1;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="comment">/* If no cert and not debugging always return success */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!cert &amp;&amp; !debug)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8c.html#ae562e57f2e66f238d774cbfddc6bf7a4">ERR_clear_error</a>();</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ab2dcd528d2ac49bb38432d451217bd24">CMS_F_CMS_DECRYPT_SET1_PKEY</a>, <a class="code" href="cms_8h.html#a62cbdd81c91645c79c7353094409a385">CMS_R_NO_MATCHING_RECIPIENT</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4c1f7b713a342990f8a58b307deb9c1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* CMS_digest_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#aac66cf010326fa9a927c2a34888f45d3">EVP_MD</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00214">214</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a> *cms;</div>
<div class="line">        <span class="keywordflow">if</span> (!md)</div>
<div class="line">                md = <a class="code" href="evp_8h.html#aa090d659a494a10525e38d272efb01ae">EVP_sha1</a>();</div>
<div class="line">        cms = <a class="code" href="cms__dd_8c.html#a6284ac93855f0ff2d88c4a86998d2671">cms_DigestedData_create</a>(md);</div>
<div class="line">        <span class="keywordflow">if</span> (!cms)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#a9aca14ae67c24cf5b7d0c66368fab072">CMS_DETACHED</a>))</div>
<div class="line">                <a class="code" href="cms_8h.html#a7e9044c6fa0899c711c09da4eed9d5c5">CMS_set_detached</a>(cms, 0);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#af7c70d85fa217f66b9f10bc37281c723">CMS_STREAM</a>) || <a class="code" href="cms_8h.html#a52397f4b59560ac8a0ad14707dbd8335">CMS_final</a>(cms, in, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                <span class="keywordflow">return</span> cms;</div>
<div class="line"></div>
<div class="line">        CMS_ContentInfo_free(cms);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a630cc14a0ff582151b217cccd86ef4b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_digest_verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>dcont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00190">190</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *cont;</div>
<div class="line">        <span class="keywordtype">int</span> r;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(<a class="code" href="cms_8h.html#a416a06af57cce1e9339ff9d981160f13">CMS_get0_type</a>(cms)) != <a class="code" href="obj__mac_8h.html#a5913b3f520c08ebb4000fee1be9ec0f5">NID_pkcs7_digest</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a05c0850f3d882fe12e80d8f01a5f3e10">CMS_F_CMS_DIGEST_VERIFY</a>, <a class="code" href="cms_8h.html#a7df84d87200cc308bb9773abf3ce9146">CMS_R_TYPE_NOT_DIGESTED_DATA</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!dcont &amp;&amp; !check_content(cms))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        cont = <a class="code" href="cms_8h.html#af321d3ecf3ee6e9d3dbdbc8a7b572917">CMS_dataInit</a>(cms, dcont);</div>
<div class="line">        <span class="keywordflow">if</span> (!cont)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        r = cms_copy_content(out, cont, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (r)</div>
<div class="line">                r = <a class="code" href="cms__dd_8c.html#a8a10b03dabe71726e5ba1122e0e7d521">cms_DigestedData_do_final</a>(cms, cont, 1);</div>
<div class="line">        do_free_upto(cont, dcont);</div>
<div class="line">        <span class="keywordflow">return</span> r;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a48e204531be03c765b7e307bfca35a2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* CMS_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00634">634</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a> *cms;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <a class="code" href="structx509__st.html">X509</a> *recip;</div>
<div class="line">        cms = <a class="code" href="cms_8h.html#a63d3912c2faa83a1c9330353c805ee19">CMS_EnvelopedData_create</a>(cipher);</div>
<div class="line">        <span class="keywordflow">if</span> (!cms)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#af8495d81a6dda58254c7e12528af0118">sk_X509_num</a>(certs); i++)</div>
<div class="line">                {</div>
<div class="line">                recip = <a class="code" href="safestack_8h.html#a6ce8e2d1c31859b9b27cd535caba4388">sk_X509_value</a>(certs, i);</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="cms_8h.html#aa0f430b3dda40a05acc7cf29bd4b93d8">CMS_add1_recipient_cert</a>(cms, recip, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a2711aa4754788e9c93186bbd082449bd">CMS_F_CMS_ENCRYPT</a>, <a class="code" href="cms_8h.html#a2e9f93fc79052e7a81a6dc17ca7b0f86">CMS_R_RECIPIENT_ERROR</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#a9aca14ae67c24cf5b7d0c66368fab072">CMS_DETACHED</a>))</div>
<div class="line">                <a class="code" href="cms_8h.html#a7e9044c6fa0899c711c09da4eed9d5c5">CMS_set_detached</a>(cms, 0);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; (<a class="code" href="cms_8h.html#af7c70d85fa217f66b9f10bc37281c723">CMS_STREAM</a>|<a class="code" href="cms_8h.html#a20b64bc8c182f7ac666da5bcb0190c07">CMS_PARTIAL</a>))</div>
<div class="line">                || <a class="code" href="cms_8h.html#a52397f4b59560ac8a0ad14707dbd8335">CMS_final</a>(cms, <a class="code" href="e__bf_8c.html#aac2cc005a2915c6b6212402aeee7e635">data</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                <span class="keywordflow">return</span> cms;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        merr:</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a2711aa4754788e9c93186bbd082449bd">CMS_F_CMS_ENCRYPT</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (cms)</div>
<div class="line">                CMS_ContentInfo_free(cms);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a32bd1dc9455410dde8a5090985eadb98"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_EncryptedData_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>dcont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00234">234</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *cont;</div>
<div class="line">        <span class="keywordtype">int</span> r;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(<a class="code" href="cms_8h.html#a416a06af57cce1e9339ff9d981160f13">CMS_get0_type</a>(cms)) != <a class="code" href="obj__mac_8h.html#a302ab4232d763141c7b9a4f7d177a7ac">NID_pkcs7_encrypted</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a780c677d07227dec584a1606e13fca34">CMS_F_CMS_ENCRYPTEDDATA_DECRYPT</a>,</div>
<div class="line">                                        <a class="code" href="cms_8h.html#a42a3d531b1e383257e1882aa532eed15">CMS_R_TYPE_NOT_ENCRYPTED_DATA</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!dcont &amp;&amp; !check_content(cms))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="cms_8h.html#a8f848b65aa93ae7a86ff7613e0e10bed">CMS_EncryptedData_set1_key</a>(cms, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, keylen) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        cont = <a class="code" href="cms_8h.html#af321d3ecf3ee6e9d3dbdbc8a7b572917">CMS_dataInit</a>(cms, dcont);</div>
<div class="line">        <span class="keywordflow">if</span> (!cont)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        r = cms_copy_content(out, cont, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>);</div>
<div class="line">        do_free_upto(cont, dcont);</div>
<div class="line">        <span class="keywordflow">return</span> r;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a76a86ee3243cba3813f2d7f9845de97d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* CMS_EncryptedData_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00260">260</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a> *cms;</div>
<div class="line">        <span class="keywordflow">if</span> (!cipher)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#af7ee42e04206b7dd3e2ae2547c07b596">CMS_F_CMS_ENCRYPTEDDATA_ENCRYPT</a>, <a class="code" href="cms_8h.html#aaab26e85a9411a43fd5e021b0d6a3e80">CMS_R_NO_CIPHER</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        cms = CMS_ContentInfo_new();</div>
<div class="line">        <span class="keywordflow">if</span> (!cms)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="cms_8h.html#a8f848b65aa93ae7a86ff7613e0e10bed">CMS_EncryptedData_set1_key</a>(cms, cipher, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, keylen))</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#a9aca14ae67c24cf5b7d0c66368fab072">CMS_DETACHED</a>))</div>
<div class="line">                <a class="code" href="cms_8h.html#a7e9044c6fa0899c711c09da4eed9d5c5">CMS_set_detached</a>(cms, 0);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; (<a class="code" href="cms_8h.html#af7c70d85fa217f66b9f10bc37281c723">CMS_STREAM</a>|<a class="code" href="cms_8h.html#a20b64bc8c182f7ac666da5bcb0190c07">CMS_PARTIAL</a>))</div>
<div class="line">                || <a class="code" href="cms_8h.html#a52397f4b59560ac8a0ad14707dbd8335">CMS_final</a>(cms, in, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                <span class="keywordflow">return</span> cms;</div>
<div class="line"></div>
<div class="line">        CMS_ContentInfo_free(cms);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8f848b65aa93ae7a86ff7613e0e10bed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_EncryptedData_set1_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *&#160;</td>
          <td class="paramname"><em>ciph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__enc_8c_source.html#l00257">257</a> of file <a class="el" href="cms__enc_8c_source.html">cms_enc.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__EncryptedContentInfo__st.html">CMS_EncryptedContentInfo</a> *ec;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> || !keylen)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a6ba74b36decb7067945d6bc7b97a3ffa">CMS_F_CMS_ENCRYPTEDDATA_SET1_KEY</a>, <a class="code" href="cms_8h.html#a92176674c9b5c4b87465f93a79c7cec9">CMS_R_NO_KEY</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (ciph)</div>
<div class="line">                {</div>
<div class="line">                cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#aecda2b0d84ed349f274ef28ec9dabc21">encryptedData</a> = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__EncryptedData__st.html">CMS_EncryptedData</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (!cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#aecda2b0d84ed349f274ef28ec9dabc21">encryptedData</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a6ba74b36decb7067945d6bc7b97a3ffa">CMS_F_CMS_ENCRYPTEDDATA_SET1_KEY</a>,</div>
<div class="line">                                <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#aae0b0e1c6da4732f18167de51c9eb9e5">contentType</a> = <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="obj__mac_8h.html#a302ab4232d763141c7b9a4f7d177a7ac">NID_pkcs7_encrypted</a>);</div>
<div class="line">                cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#aecda2b0d84ed349f274ef28ec9dabc21">encryptedData</a>-&gt;<a class="code" href="structCMS__EncryptedData__st.html#a9acd2de00440d6c223d54b587745acf0">version</a> = 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#aae0b0e1c6da4732f18167de51c9eb9e5">contentType</a>) != <a class="code" href="obj__mac_8h.html#a302ab4232d763141c7b9a4f7d177a7ac">NID_pkcs7_encrypted</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a6ba74b36decb7067945d6bc7b97a3ffa">CMS_F_CMS_ENCRYPTEDDATA_SET1_KEY</a>,</div>
<div class="line">                                                <a class="code" href="cms_8h.html#a868a4e6fc226d0fd080e80c78dc7ff68">CMS_R_NOT_ENCRYPTED_DATA</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        ec = cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#aecda2b0d84ed349f274ef28ec9dabc21">encryptedData</a>-&gt;<a class="code" href="structCMS__EncryptedData__st.html#ada7019d43f9e2dd51cb8fbe711e41a4e">encryptedContentInfo</a>;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="cms__enc_8c.html#abd1f18f503cb0c237d12a089de669dd4">cms_EncryptedContent_init</a>(ec, ciph, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, keylen);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a63d3912c2faa83a1c9330353c805ee19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* CMS_EnvelopedData_create </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *&#160;</td>
          <td class="paramname"><em>cipher</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00163">163</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a> *cms;</div>
<div class="line">        <a class="code" href="structCMS__EnvelopedData__st.html">CMS_EnvelopedData</a> *env;</div>
<div class="line">        cms = CMS_ContentInfo_new();</div>
<div class="line">        <span class="keywordflow">if</span> (!cms)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        env = cms_enveloped_data_init(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!env)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="cms__enc_8c.html#abd1f18f503cb0c237d12a089de669dd4">cms_EncryptedContent_init</a>(env-&gt;<a class="code" href="structCMS__EnvelopedData__st.html#a61ff72488726aa8cf3191e2e1cacc97d">encryptedContentInfo</a>,</div>
<div class="line">                                        cipher, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, 0))</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        <span class="keywordflow">return</span> cms;</div>
<div class="line">        merr:</div>
<div class="line">        <span class="keywordflow">if</span> (cms)</div>
<div class="line">                CMS_ContentInfo_free(cms);</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a2c6e13925680edf4647b340f6d2a53e7">CMS_F_CMS_ENVELOPEDDATA_CREATE</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a52397f4b59560ac8a0ad14707dbd8335"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_final </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>dcont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00863">863</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *cmsbio;</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        <span class="keywordflow">if</span> (!(cmsbio = <a class="code" href="cms_8h.html#af321d3ecf3ee6e9d3dbdbc8a7b572917">CMS_dataInit</a>(cms, dcont)))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a8c7c5d5ca9eb1a7d0a6a957d5be72b08">CMS_F_CMS_FINAL</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="asn1_8h.html#a9733cdb626618d20a99ee483bcfa55aa">SMIME_crlf_copy</a>(data, cmsbio, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>);</div>
<div class="line"></div>
<div class="line">        (void)<a class="code" href="bio_8h.html#a6e1d8242b642b53ee9aefdc79ff10f3e">BIO_flush</a>(cmsbio);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="cms_8h.html#a1c36b8225ea45f33d22fe44d16a3f98b">CMS_dataFinal</a>(cms, cmsbio))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a8c7c5d5ca9eb1a7d0a6a957d5be72b08">CMS_F_CMS_FINAL</a>,<a class="code" href="cms_8h.html#a022e051933d79d1d0c8d55d913465193">CMS_R_CMS_DATAFINAL_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        ret = 1;</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line">        do_free_upto(cmsbio, dcont);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aed4845b6010a2e1988ca0234cbfa3b18"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a>** CMS_get0_content </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00209">209</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">switch</span> (<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#aae0b0e1c6da4732f18167de51c9eb9e5">contentType</a>))</div>
<div class="line">                {</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a13d08edbaf91c1fd310b3e4cbd9f98a9">NID_pkcs7_data</a>:</div>
<div class="line">                <span class="keywordflow">return</span> &amp;cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a8935bd666aa1838143e706b534d9e1c4">data</a>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a085f07bc1100332366a5675145f8fea9">NID_pkcs7_signed</a>:</div>
<div class="line">                <span class="keywordflow">return</span> &amp;cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#aa4afa3c04a5347cfe6f27f4fe2aa94d0">signedData</a>-&gt;<a class="code" href="structCMS__SignedData__st.html#a258881ecd96a6577de4ae0bbf605980e">encapContentInfo</a>-&gt;<a class="code" href="structCMS__EncapsulatedContentInfo__st.html#ad497d005f03541cc30008b24871ed681">eContent</a>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a4587e848643383571699c4b1fdaf5710">NID_pkcs7_enveloped</a>:</div>
<div class="line">                <span class="keywordflow">return</span> &amp;cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>-&gt;<a class="code" href="structCMS__EnvelopedData__st.html#a61ff72488726aa8cf3191e2e1cacc97d">encryptedContentInfo</a>-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a00a2eda16317771b26b4a98711c08a56">encryptedContent</a>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a5913b3f520c08ebb4000fee1be9ec0f5">NID_pkcs7_digest</a>:</div>
<div class="line">                <span class="keywordflow">return</span> &amp;cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a18f598edb29c5a3440125620d3bf2602">digestedData</a>-&gt;<a class="code" href="structCMS__DigestedData__st.html#aa5cad160cc805026470f28c7837c75ad">encapContentInfo</a>-&gt;<a class="code" href="structCMS__EncapsulatedContentInfo__st.html#ad497d005f03541cc30008b24871ed681">eContent</a>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a302ab4232d763141c7b9a4f7d177a7ac">NID_pkcs7_encrypted</a>:</div>
<div class="line">                <span class="keywordflow">return</span> &amp;cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#aecda2b0d84ed349f274ef28ec9dabc21">encryptedData</a>-&gt;<a class="code" href="structCMS__EncryptedData__st.html#ada7019d43f9e2dd51cb8fbe711e41a4e">encryptedContentInfo</a>-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a00a2eda16317771b26b4a98711c08a56">encryptedContent</a>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#ac54991ead2294cfec0525841c5af2df4">NID_id_smime_ct_authData</a>:</div>
<div class="line">                <span class="keywordflow">return</span> &amp;cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#aec784ece9b812782243c916b56747106">authenticatedData</a>-&gt;<a class="code" href="structCMS__AuthenticatedData__st.html#a9bd0eec46ffaa80595a02400df2a0c09">encapContentInfo</a>-&gt;<a class="code" href="structCMS__EncapsulatedContentInfo__st.html#ad497d005f03541cc30008b24871ed681">eContent</a>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="obj__mac_8h.html#a9abb7bbfc6731d3e9b72e01cbd595357">NID_id_smime_ct_compressedData</a>:</div>
<div class="line">                <span class="keywordflow">return</span> &amp;cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#afa81de0c5acaed6a4f1f5023122c41b8">compressedData</a>-&gt;<a class="code" href="structCMS__CompressedData__st.html#ae8c118ddee01ce05348849a0f71fb2be">encapContentInfo</a>-&gt;<a class="code" href="structCMS__EncapsulatedContentInfo__st.html#ad497d005f03541cc30008b24871ed681">eContent</a>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">if</span> (cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a7c4d81a955d4abcae65888716e9ea64f">other</a>-&gt;<a class="code" href="structasn1__type__st.html#af1bd6ef16c406f3cd3fa67eb81693b54">type</a> == <a class="code" href="asn1_8h.html#ab7338bcfcfbbd8f90c680759f373663b">V_ASN1_OCTET_STRING</a>)</div>
<div class="line">                        <span class="keywordflow">return</span> &amp;cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a7c4d81a955d4abcae65888716e9ea64f">other</a>-&gt;<a class="code" href="structasn1__type__st.html#ab37a86242c23b20bd17ee2adb4678e38">value</a>.<a class="code" href="structasn1__type__st.html#a57c398f62f5af3ca6a9130b651d7bca6">octet_string</a>;</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ad1af319335c3d48e2cfacbef29f81101">CMS_F_CMS_GET0_CONTENT</a>, <a class="code" href="cms_8h.html#ac36b65bc5a5072964b6bb37d2a2641bb">CMS_R_UNSUPPORTED_CONTENT_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab0a011907cfe668a473f918ccbab301d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a>* CMS_get0_eContentType </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00279">279</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> **petype;</div>
<div class="line">        petype = cms_get0_econtent_type(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (petype)</div>
<div class="line">                <span class="keywordflow">return</span> *petype;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a416a06af57cce1e9339ff9d981160f13"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a>* CMS_get0_type </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00071">71</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#aae0b0e1c6da4732f18167de51c9eb9e5">contentType</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6f37782948eda96657c46a2a93ef11bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_is_detached </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00304">304</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> **pos;</div>
<div class="line">        pos = <a class="code" href="cms_8h.html#aed4845b6010a2e1988ca0234cbfa3b18">CMS_get0_content</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!pos)</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        <span class="keywordflow">if</span> (*pos)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7b75fd402338e1489e4730faf461ca61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientEncryptedKey_cert_cmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#aea929bebf778a99c3f2c6b5151850fc8">CMS_RecipientEncryptedKey</a> *&#160;</td>
          <td class="paramname"><em>rek</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__kari_8c_source.html#l00204">204</a> of file <a class="el" href="cms__kari_8c_source.html">cms_kari.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html">CMS_KeyAgreeRecipientIdentifier</a> *rid = rek-&gt;<a class="code" href="structCMS__RecipientEncryptedKey__st.html#a46ec8673f0d9bbdd9a66ab7b28ebc433">rid</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (rid-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#a9e09b503569a350cbe02daaa6e4334ad">type</a> == <a class="code" href="cms__lcl_8h.html#adcf4c7b7ee4fafcba3324805c9896392">CMS_REK_ISSUER_SERIAL</a>)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#a013cca1c46db1e5c849677157326d3eb">cms_ias_cert_cmp</a>(rid-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#af94b30a9481c62573166ae4982d42fbb">d</a>.<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#afb51fb2a4dafcde2a4d39ef2e29ec866">issuerAndSerialNumber</a>, cert);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rid-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#a9e09b503569a350cbe02daaa6e4334ad">type</a> == <a class="code" href="cms__lcl_8h.html#ae29b7278fde140f345e7425e33192372">CMS_REK_KEYIDENTIFIER</a>)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#ac7878a1f6e7641e2d71cc14cb69b209e">cms_keyid_cert_cmp</a>(rid-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#af94b30a9481c62573166ae4982d42fbb">d</a>.<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#a5dc8e9dd2f255a0e008f6355ec5e419f">rKeyId</a>-&gt;<a class="code" href="structCMS__RecipientKeyIdentifier__st.html#a81e57ea93d5273862f46b808b54af56b">subjectKeyIdentifier</a>, cert);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7b749be942f8aeea3a3d515526090bc8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientEncryptedKey_get0_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#aea929bebf778a99c3f2c6b5151850fc8">CMS_RecipientEncryptedKey</a> *&#160;</td>
          <td class="paramname"><em>rek</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#abd19ea5b527807ce3a516e6a41440f84">ASN1_GENERALIZEDTIME</a> **&#160;</td>
          <td class="paramname"><em>tm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#af54d24ab3b9acdc97b67988d660ede75">CMS_OtherKeyAttribute</a> **&#160;</td>
          <td class="paramname"><em>other</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> **&#160;</td>
          <td class="paramname"><em>issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **&#160;</td>
          <td class="paramname"><em>sno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__kari_8c_source.html#l00166">166</a> of file <a class="el" href="cms__kari_8c_source.html">cms_kari.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html">CMS_KeyAgreeRecipientIdentifier</a> *rid = rek-&gt;<a class="code" href="structCMS__RecipientEncryptedKey__st.html#a46ec8673f0d9bbdd9a66ab7b28ebc433">rid</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (rid-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#a9e09b503569a350cbe02daaa6e4334ad">type</a> == <a class="code" href="cms__lcl_8h.html#adcf4c7b7ee4fafcba3324805c9896392">CMS_REK_ISSUER_SERIAL</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (issuer)</div>
<div class="line">                        *issuer = rid-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#af94b30a9481c62573166ae4982d42fbb">d</a>.<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#afb51fb2a4dafcde2a4d39ef2e29ec866">issuerAndSerialNumber</a>-&gt;<a class="code" href="structCMS__IssuerAndSerialNumber__st.html#ae8924a6986383f83257f1c08c1ac301a">issuer</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (sno)</div>
<div class="line">                        *sno = rid-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#af94b30a9481c62573166ae4982d42fbb">d</a>.<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#afb51fb2a4dafcde2a4d39ef2e29ec866">issuerAndSerialNumber</a>-&gt;<a class="code" href="structCMS__IssuerAndSerialNumber__st.html#aa44d6bf4b715606d29551da6bdad464f">serialNumber</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (keyid)</div>
<div class="line">                        *keyid = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (tm)</div>
<div class="line">                        *tm = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (other)</div>
<div class="line">                        *other = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rid-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#a9e09b503569a350cbe02daaa6e4334ad">type</a> == <a class="code" href="cms__lcl_8h.html#ae29b7278fde140f345e7425e33192372">CMS_REK_KEYIDENTIFIER</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (keyid)</div>
<div class="line">                        *keyid = rid-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#af94b30a9481c62573166ae4982d42fbb">d</a>.<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#a5dc8e9dd2f255a0e008f6355ec5e419f">rKeyId</a>-&gt;<a class="code" href="structCMS__RecipientKeyIdentifier__st.html#a81e57ea93d5273862f46b808b54af56b">subjectKeyIdentifier</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (tm)</div>
<div class="line">                        *tm = rid-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#af94b30a9481c62573166ae4982d42fbb">d</a>.<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#a5dc8e9dd2f255a0e008f6355ec5e419f">rKeyId</a>-&gt;<a class="code" href="structCMS__RecipientKeyIdentifier__st.html#a38cd55bcfd0d7ec86fc18988f6d06528">date</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (other)</div>
<div class="line">                        *other = rid-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#af94b30a9481c62573166ae4982d42fbb">d</a>.<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#a5dc8e9dd2f255a0e008f6355ec5e419f">rKeyId</a>-&gt;<a class="code" href="structCMS__RecipientKeyIdentifier__st.html#a77bed5abdf9787a112c093e8c96088c8">other</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (issuer)</div>
<div class="line">                        *issuer = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (sno)</div>
<div class="line">                        *sno = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2db1d83492be468599b3be3452e98cc5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00871">871</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">switch</span>(ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>:</div>
<div class="line">                <span class="keywordflow">return</span> cms_RecipientInfo_ktri_decrypt(cms, ri);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>:</div>
<div class="line">                <span class="keywordflow">return</span> cms_RecipientInfo_kekri_decrypt(cms, ri);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#ab206c8d6ec7c2bc1c4798b3775759db5">CMS_RECIPINFO_PASS</a>:</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#a23e449de7f0b59882111f6025b6403f4">cms_RecipientInfo_pwri_crypt</a>(cms, ri, 0);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a7b61f312558cf5f0b0b6a488cad635a1">CMS_F_CMS_RECIPIENTINFO_DECRYPT</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#ab906515535f6457ebafdab611944cf32">CMS_R_UNSUPPORTED_RECPIENTINFO_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a44fec504f4ab356a6095f25527aabc46"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00891">891</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">switch</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>:</div>
<div class="line">                <span class="keywordflow">return</span> cms_RecipientInfo_ktri_encrypt(cms, ri);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>:</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__kari_8c.html#a178c4432e47cc12081fd3e4e28910092">cms_RecipientInfo_kari_encrypt</a>(cms, ri);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>:</div>
<div class="line">                <span class="keywordflow">return</span> cms_RecipientInfo_kekri_encrypt(cms, ri);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#ab206c8d6ec7c2bc1c4798b3775759db5">CMS_RECIPINFO_PASS</a>:</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#a23e449de7f0b59882111f6025b6403f4">cms_RecipientInfo_pwri_crypt</a>(cms, ri, 1);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a0327f69f5888456157c4c359ac37fb7b">CMS_F_CMS_RECIPIENTINFO_ENCRYPT</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a5dedd8ba3201a67c024aaeaa87c70c0d">CMS_R_UNSUPPORTED_RECIPIENT_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af0289104150559a8e0ea51f8111aafd1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#aaadbb75633e4460a52864970a3b875de">EVP_PKEY_CTX</a>* CMS_RecipientInfo_get0_pkey_ctx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00154">154</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> == <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>)</div>
<div class="line">                <span class="keywordflow">return</span> ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a931c9714689ab434cd072f8ae5c75cec">ktri</a>-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a29d113f1d277c1f5fc5bf0fd061c220a">pctx</a>;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> == <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>)</div>
<div class="line">                <span class="keywordflow">return</span> ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a72c16b9727ba03e41e28085f501a290b">pctx</a>;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a08fc89556c5524e7b5083845a77d0c6b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_kari_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#aea929bebf778a99c3f2c6b5151850fc8">CMS_RecipientEncryptedKey</a> *&#160;</td>
          <td class="paramname"><em>rek</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__kari_8c_source.html#l00290">290</a> of file <a class="el" href="cms__kari_8c_source.html">cms_kari.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> rv = 0;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *enckey = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, *cek = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">size_t</span> enckeylen;</div>
<div class="line">        <span class="keywordtype">size_t</span> ceklen;</div>
<div class="line">        <a class="code" href="structCMS__EncryptedContentInfo__st.html">CMS_EncryptedContentInfo</a> *ec;</div>
<div class="line">        enckeylen = rek-&gt;<a class="code" href="structCMS__RecipientEncryptedKey__st.html#af861a7676bfae5f3f4ce5c5b7ba044af">encryptedKey</a>-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>;</div>
<div class="line">        enckey = rek-&gt;<a class="code" href="structCMS__RecipientEncryptedKey__st.html#af861a7676bfae5f3f4ce5c5b7ba044af">encryptedKey</a>-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>;</div>
<div class="line">        <span class="comment">/* Setup all parameters to derive KEK */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="cms__env_8c.html#ac35f315f7ccd6ac91196b3ec171dc0cc">cms_env_asn1_ctrl</a>(ri, 1))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="comment">/* Attempt to decrypt CEK */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!cms_kek_cipher(&amp;cek, &amp;ceklen, enckey, enckeylen, ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>, 0))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        ec = cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>-&gt;<a class="code" href="structCMS__EnvelopedData__st.html#a61ff72488726aa8cf3191e2e1cacc97d">encryptedContentInfo</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="crypto_8h.html#a2aa47e40c63b05d00e9a780592f2a2b8">OPENSSL_cleanse</a>(ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a>);</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>);</div>
<div class="line">                }</div>
<div class="line">        ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a> = cek;</div>
<div class="line">        ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a> = ceklen;</div>
<div class="line">        cek = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        rv = 1;</div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (cek)</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(cek);</div>
<div class="line">        <span class="keywordflow">return</span> rv;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aef2777d4c051b819513ca63e18de9a79"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_kari_get0_alg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **&#160;</td>
          <td class="paramname"><em>palg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **&#160;</td>
          <td class="paramname"><em>pukm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__kari_8c_source.html#l00071">71</a> of file <a class="el" href="cms__kari_8c_source.html">cms_kari.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a013600bf0dcafcd84a215679ac3da0bc">CMS_F_CMS_RECIPIENTINFO_KARI_GET0_ALG</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#a3dafd7ae00cc336b974db955156f890f">CMS_R_NOT_KEY_AGREEMENT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (palg)</div>
<div class="line">                *palg = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#ae2eb7ab77257537a7ded67b008cb4121">keyEncryptionAlgorithm</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (pukm)</div>
<div class="line">                *pukm = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a8e70cb76571b0665b96cf4d89e4bbd03">ukm</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa8de84f2733f37b3dcbda807c489186a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#aab2bd6a044e1d31ebc2fe82b3b0b3d9a">EVP_CIPHER_CTX</a>* CMS_RecipientInfo_kari_get0_ctx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__kari_8c_source.html#l00238">238</a> of file <a class="el" href="cms__kari_8c_source.html">cms_kari.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> == <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>)</div>
<div class="line">                <span class="keywordflow">return</span> &amp;ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#ab0c12e18345ceaf9e13cfed347fa040e">ctx</a>;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a209691a56cb96974cf86e9cebb345f91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_kari_get0_orig_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **&#160;</td>
          <td class="paramname"><em>pubalg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af837aaa00e151b1e8773aea5a8fe1cc4">ASN1_BIT_STRING</a> **&#160;</td>
          <td class="paramname"><em>pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> **&#160;</td>
          <td class="paramname"><em>issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **&#160;</td>
          <td class="paramname"><em>sno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__kari_8c_source.html#l00101">101</a> of file <a class="el" href="cms__kari_8c_source.html">cms_kari.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html">CMS_OriginatorIdentifierOrKey</a> *oik;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#acd27a4f555ea6daf92dd1f33c3d68ce2">CMS_F_CMS_RECIPIENTINFO_KARI_GET0_ORIG_ID</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#a3dafd7ae00cc336b974db955156f890f">CMS_R_NOT_KEY_AGREEMENT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        oik = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a5230303cf63716c151f7f7cc2b86d816">originator</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (issuer)</div>
<div class="line">                *issuer = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (sno)</div>
<div class="line">                *sno = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (keyid)</div>
<div class="line">                *keyid = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (pubalg)</div>
<div class="line">                *pubalg = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (pubkey)</div>
<div class="line">                *pubkey = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a005783130889ef0e2100e219fc19ae02">type</a> == <a class="code" href="cms__lcl_8h.html#ab3e6514a619e47cba48f870966361f89">CMS_OIK_ISSUER_SERIAL</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (issuer)</div>
<div class="line">                        *issuer = oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a28bc4aea3dfb2aa4c8f27cb7d0d4f673">d</a>.<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a7749a66890198b91e870e419046230e0">issuerAndSerialNumber</a>-&gt;<a class="code" href="structCMS__IssuerAndSerialNumber__st.html#ae8924a6986383f83257f1c08c1ac301a">issuer</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (sno)</div>
<div class="line">                        *sno = oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a28bc4aea3dfb2aa4c8f27cb7d0d4f673">d</a>.<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a7749a66890198b91e870e419046230e0">issuerAndSerialNumber</a>-&gt;<a class="code" href="structCMS__IssuerAndSerialNumber__st.html#aa44d6bf4b715606d29551da6bdad464f">serialNumber</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a005783130889ef0e2100e219fc19ae02">type</a> == <a class="code" href="cms__lcl_8h.html#ab07ddd1f14d39875f458d6f2affd1105">CMS_OIK_KEYIDENTIFIER</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (keyid)</div>
<div class="line">                        *keyid = oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a28bc4aea3dfb2aa4c8f27cb7d0d4f673">d</a>.<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#aa14ec757305f7250c3fe470b01577ecc">subjectKeyIdentifier</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a005783130889ef0e2100e219fc19ae02">type</a> == <a class="code" href="cms__lcl_8h.html#a7ca4de9879cff722eab3b9ebf9cc73ea">CMS_OIK_PUBKEY</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (pubalg)</div>
<div class="line">                        *pubalg = oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a28bc4aea3dfb2aa4c8f27cb7d0d4f673">d</a>.<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#ac5559321f5be1422ebbc138590e48c96">originatorKey</a>-&gt;<a class="code" href="structCMS__OriginatorPublicKey__st.html#a0e680efe1c4723d4a9dd29173afab388">algorithm</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (pubkey)</div>
<div class="line">                        *pubkey = oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a28bc4aea3dfb2aa4c8f27cb7d0d4f673">d</a>.<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#ac5559321f5be1422ebbc138590e48c96">originatorKey</a>-&gt;<a class="code" href="structCMS__OriginatorPublicKey__st.html#a3076802e285887b3529616743a7f7f75">publicKey</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4ca315f531e49cf12f7e108431318f3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_kari_orig_id_cmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__kari_8c_source.html#l00149">149</a> of file <a class="el" href="cms__kari_8c_source.html">cms_kari.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html">CMS_OriginatorIdentifierOrKey</a> *oik;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a4c54f31257bf8a91ed5a502ab1a111de">CMS_F_CMS_RECIPIENTINFO_KARI_ORIG_ID_CMP</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#a3dafd7ae00cc336b974db955156f890f">CMS_R_NOT_KEY_AGREEMENT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> -2;</div>
<div class="line">                }</div>
<div class="line">        oik = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a5230303cf63716c151f7f7cc2b86d816">originator</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a005783130889ef0e2100e219fc19ae02">type</a> == <a class="code" href="cms__lcl_8h.html#ab3e6514a619e47cba48f870966361f89">CMS_OIK_ISSUER_SERIAL</a>)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#a013cca1c46db1e5c849677157326d3eb">cms_ias_cert_cmp</a>(oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a28bc4aea3dfb2aa4c8f27cb7d0d4f673">d</a>.<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a7749a66890198b91e870e419046230e0">issuerAndSerialNumber</a>, cert);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a005783130889ef0e2100e219fc19ae02">type</a> == <a class="code" href="cms__lcl_8h.html#ab07ddd1f14d39875f458d6f2affd1105">CMS_OIK_KEYIDENTIFIER</a>)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#ac7878a1f6e7641e2d71cc14cb69b209e">cms_keyid_cert_cmp</a>(oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a28bc4aea3dfb2aa4c8f27cb7d0d4f673">d</a>.<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#aa14ec757305f7250c3fe470b01577ecc">subjectKeyIdentifier</a>, cert);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a585f407ee2d6046d19e919ad35cfd1e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_kari_set0_pkey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>pk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__kari_8c_source.html#l00216">216</a> of file <a class="el" href="cms__kari_8c_source.html">cms_kari.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structevp__pkey__ctx__st.html">EVP_PKEY_CTX</a> *pctx;</div>
<div class="line">        <a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html">CMS_KeyAgreeRecipientInfo</a> *kari = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (kari-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a72c16b9727ba03e41e28085f501a290b">pctx</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="evp_8h.html#a9a2d5ac99985dda36f15bd92d83c1621">EVP_PKEY_CTX_free</a>(kari-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a72c16b9727ba03e41e28085f501a290b">pctx</a>);</div>
<div class="line">                kari-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a72c16b9727ba03e41e28085f501a290b">pctx</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!pk)</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">        pctx = <a class="code" href="evp_8h.html#a23d1c787f99b2aaa6d8283c2db325eea">EVP_PKEY_CTX_new</a>(pk, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!pctx || !<a class="code" href="evp_8h.html#ae524c385eebb1b65ad9b719636245e18">EVP_PKEY_derive_init</a>(pctx))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        kari-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a72c16b9727ba03e41e28085f501a290b">pctx</a> = pctx;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (pctx)</div>
<div class="line">                <a class="code" href="evp_8h.html#a9a2d5ac99985dda36f15bd92d83c1621">EVP_PKEY_CTX_free</a>(pctx);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5605ce2e902d1a84e651ef14a569e92a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_kekri_get0_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **&#160;</td>
          <td class="paramname"><em>palg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#abd19ea5b527807ce3a516e6a41440f84">ASN1_GENERALIZEDTIME</a> **&#160;</td>
          <td class="paramname"><em>pdate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> **&#160;</td>
          <td class="paramname"><em>potherid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="asn1_8h.html#a7895e03d9fee2bc4963faf2a31a9439e">ASN1_TYPE</a> **&#160;</td>
          <td class="paramname"><em>pothertype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00676">676</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__KEKIdentifier__st.html">CMS_KEKIdentifier</a> *rkid;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ad4b5d7960f63c3a1c4665c55436f69c0">CMS_F_CMS_RECIPIENTINFO_KEKRI_GET0_ID</a>, <a class="code" href="cms_8h.html#ac555a8ace3e9e0226535c7221b63bf26">CMS_R_NOT_KEK</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        rkid =  ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a>-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (palg)</div>
<div class="line">                *palg = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a>-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a5f51b5cad62639eafec3e3948e82784c">keyEncryptionAlgorithm</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (pid)</div>
<div class="line">                *pid = rkid-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a62da3e7a25399bba4bb209bba467ad53">keyIdentifier</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (pdate)</div>
<div class="line">                *pdate = rkid-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#aa5dc596530ce6f9f57d2515085808aac">date</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (potherid)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (rkid-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>)</div>
<div class="line">                        *potherid = rkid-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>-&gt;<a class="code" href="structCMS__OtherKeyAttribute__st.html#ae77e87e21328fc0456d48c96a4d5b9ea">keyAttrId</a>;</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        *potherid = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (pothertype)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (rkid-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>)</div>
<div class="line">                        *pothertype = rkid-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>-&gt;<a class="code" href="structCMS__OtherKeyAttribute__st.html#a09e2b7c3fa802c038198ba99dbc11406">keyAttr</a>;</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        *pothertype = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3abd22c1ff8260d4935a428898030f92"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_kekri_id_cmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>idlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00526">526</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> tmp_os;</div>
<div class="line">        <a class="code" href="structCMS__KEKRecipientInfo__st.html">CMS_KEKRecipientInfo</a> *kekri;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a4823452068827ce9dff504d3dbd729d1">CMS_F_CMS_RECIPIENTINFO_KEKRI_ID_CMP</a>, <a class="code" href="cms_8h.html#ac555a8ace3e9e0226535c7221b63bf26">CMS_R_NOT_KEK</a>);</div>
<div class="line">                <span class="keywordflow">return</span> -2;</div>
<div class="line">                }</div>
<div class="line">        kekri = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a>;</div>
<div class="line">        tmp_os.<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a> = <a class="code" href="asn1_8h.html#ab7338bcfcfbbd8f90c680759f373663b">V_ASN1_OCTET_STRING</a>;</div>
<div class="line">        tmp_os.<a class="code" href="structasn1__string__st.html#a166fa78d828cb41bb2499ad411c1774c">flags</a> = 0;</div>
<div class="line">        tmp_os.<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<span class="keywordtype">id</span>;</div>
<div class="line">        tmp_os.<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a> = (int)idlen;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="a__octet_8c.html#a9a5442543cd9a35a1bb6c50c21f890c4">ASN1_OCTET_STRING_cmp</a>(&amp;tmp_os, kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a62da3e7a25399bba4bb209bba467ad53">keyIdentifier</a>);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab7a3b21a9d98942c07103ea081bee640"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_ktri_cert_cmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00341">341</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ac01c397092c078cb18f70f732d9c7349">CMS_F_CMS_RECIPIENTINFO_KTRI_CERT_CMP</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#abb0895b04040c42d03a5ca1178f7a54e">CMS_R_NOT_KEY_TRANSPORT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> -2;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#ae15c777be21e1c02be97ddf5bc27dc54">cms_SignerIdentifier_cert_cmp</a>(ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a931c9714689ab434cd072f8ae5c75cec">ktri</a>-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a764a06ad68a0fc1c4238adbf56cd50de">rid</a>, cert);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7a862d5cd26243bae2f833aed5a955c2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_ktri_get0_algs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> **&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> **&#160;</td>
          <td class="paramname"><em>recip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **&#160;</td>
          <td class="paramname"><em>palg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00301">301</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__KeyTransRecipientInfo__st.html">CMS_KeyTransRecipientInfo</a> *ktri;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#aaad41bb8ee537e69bf8a2f56f59337e5">CMS_F_CMS_RECIPIENTINFO_KTRI_GET0_ALGS</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#abb0895b04040c42d03a5ca1178f7a54e">CMS_R_NOT_KEY_TRANSPORT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        ktri = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a931c9714689ab434cd072f8ae5c75cec">ktri</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (pk)</div>
<div class="line">                *pk = ktri-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a9ec467fb7deec1d82c9c730b8c2db000">pkey</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (recip)</div>
<div class="line">                *recip = ktri-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#aea7ab78fb17ede96eb50ed8c3fb5f83c">recip</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (palg)</div>
<div class="line">                *palg = ktri-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a2f49476da086ed4758604e67cd0a6ebe">keyEncryptionAlgorithm</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8f598cf775da0d77f02950fe395deac8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_ktri_get0_signer_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> **&#160;</td>
          <td class="paramname"><em>issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **&#160;</td>
          <td class="paramname"><em>sno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00324">324</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__KeyTransRecipientInfo__st.html">CMS_KeyTransRecipientInfo</a> *ktri;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a59b981b457a264b21809375134e4256d">CMS_F_CMS_RECIPIENTINFO_KTRI_GET0_SIGNER_ID</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#abb0895b04040c42d03a5ca1178f7a54e">CMS_R_NOT_KEY_TRANSPORT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        ktri = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a931c9714689ab434cd072f8ae5c75cec">ktri</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#a73e3ae14ece4aba2d5bcc38796b23907">cms_SignerIdentifier_get0_signer_id</a>(ktri-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a764a06ad68a0fc1c4238adbf56cd50de">rid</a>,</div>
<div class="line">                                                        keyid, issuer, sno);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abcbf7e892f737b18c52779d636143b14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_set0_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00713">713</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__KEKRecipientInfo__st.html">CMS_KEKRecipientInfo</a> *kekri;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ade9eabf14d47c561634a7a5e28cfb3a9">CMS_F_CMS_RECIPIENTINFO_SET0_KEY</a>, <a class="code" href="cms_8h.html#ac555a8ace3e9e0226535c7221b63bf26">CMS_R_NOT_KEK</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        kekri = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a>;</div>
<div class="line">        kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#ac82292d2f82c4e2a01b18ce48cbced3d">key</a> = <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>;</div>
<div class="line">        kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#ad588a2c59910bbaa2e54e09d4de4144f">keylen</a> = keylen;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a748a276eb5936a0d5760a89119e83fe4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_set0_password </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>pass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ossl_ssize_t&#160;</td>
          <td class="paramname"><em>passlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__pwri_8c_source.html#l00065">65</a> of file <a class="el" href="cms__pwri_8c_source.html">cms_pwri.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__PasswordRecipientInfo__st.html">CMS_PasswordRecipientInfo</a> *pwri;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#ab206c8d6ec7c2bc1c4798b3775759db5">CMS_RECIPINFO_PASS</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a860876d446accfddfa742b1f05347174">CMS_F_CMS_RECIPIENTINFO_SET0_PASSWORD</a>, <a class="code" href="cms_8h.html#a2798816e9b3824ba2970145c31561d99">CMS_R_NOT_PWRI</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        pwri = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#af50e43fa59b8416cfc0a31cc74805aca">pwri</a>;</div>
<div class="line">        pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#ac8796b7e1a95c563a56015c5f42eb47e">pass</a> = <a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a> &amp;&amp; <a class="code" href="pkcs12_8h.html#a0f676fe0b7faf04d68165e7546ffd518">passlen</a> &lt; 0)</div>
<div class="line">                <a class="code" href="pkcs12_8h.html#a0f676fe0b7faf04d68165e7546ffd518">passlen</a> = strlen((<span class="keywordtype">char</span> *)<a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>);</div>
<div class="line">        pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#ab064037ca54c55063d6f422ad094323f">passlen</a> = <a class="code" href="pkcs12_8h.html#a0f676fe0b7faf04d68165e7546ffd518">passlen</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9677b76bdae4ef3dfb1da114a02b7093"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_set0_pkey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>pkey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00352">352</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a2a8cd121b59b934d82e0affaf42bbe29">CMS_F_CMS_RECIPIENTINFO_SET0_PKEY</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#abb0895b04040c42d03a5ca1178f7a54e">CMS_R_NOT_KEY_TRANSPORT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a931c9714689ab434cd072f8ae5c75cec">ktri</a>-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a9ec467fb7deec1d82c9c730b8c2db000">pkey</a> = pkey;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3ae6eeed24d48fa38986857810a09304"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_type </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00149">149</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a244b5fc1d06ba187897439827c5fec70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_set1_eContentType </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *&#160;</td>
          <td class="paramname"><em>oid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00288">288</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> **petype, *etype;</div>
<div class="line">        petype = cms_get0_econtent_type(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!petype)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (!oid)</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">        etype = <a class="code" href="obj__lib_8c.html#a583a60a4931f9b09624a437c3516cecf">OBJ_dup</a>(oid);</div>
<div class="line">        <span class="keywordflow">if</span> (!etype)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <a class="code" href="a__object_8c.html#ad2c99806f355ca34ae6af600b5fcb055">ASN1_OBJECT_free</a>(*petype);</div>
<div class="line">        *petype = etype;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af91d09ff17c46f9f6e98828152c6e1f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_set1_signers_certs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00555">555</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__SignedData__st.html">CMS_SignedData</a> *sd;</div>
<div class="line">        <a class="code" href="structCMS__SignerInfo__st.html">CMS_SignerInfo</a> *si;</div>
<div class="line">        <a class="code" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a> *cch;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a>) *certs;</div>
<div class="line">        <a class="code" href="structx509__st.html">X509</a> *<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>;</div>
<div class="line">        <span class="keywordtype">int</span> i, j;</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        sd = cms_get0_signed(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!sd)</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        certs = sd-&gt;certificates;</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a60f8dafbf2a20918520d0f334fcd8be6">sk_CMS_SignerInfo_num</a>(sd-&gt;signerInfos); i++)</div>
<div class="line">                {</div>
<div class="line">                si = <a class="code" href="safestack_8h.html#a6b01d6da466a0cfe0bf35f47870735ae">sk_CMS_SignerInfo_value</a>(sd-&gt;signerInfos, i);</div>
<div class="line">                <span class="keywordflow">if</span> (si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#ae23016eba59a8997ce007bc66cc74219">signer</a>)</div>
<div class="line">                        <span class="keywordflow">continue</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="safestack_8h.html#af8495d81a6dda58254c7e12528af0118">sk_X509_num</a>(scerts); j++)</div>
<div class="line">                        {</div>
<div class="line">                        x = <a class="code" href="safestack_8h.html#a6ce8e2d1c31859b9b27cd535caba4388">sk_X509_value</a>(scerts, j);</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="cms_8h.html#a844f95e7b7bf9837c05c16989f0dd634">CMS_SignerInfo_cert_cmp</a>(si, x) == 0)</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="cms_8h.html#a6c7423a2fbefe9e3519679784265c973">CMS_SignerInfo_set1_signer_cert</a>(si, x);</div>
<div class="line">                                ret++;</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#ae23016eba59a8997ce007bc66cc74219">signer</a> || (<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#a7e17b533e127751bf3bea0370437c365">CMS_NOINTERN</a>))</div>
<div class="line">                        <span class="keywordflow">continue</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="safestack_8h.html#a809f17e57bc4cd94f16649dbd6301fc0">sk_CMS_CertificateChoices_num</a>(certs); j++)</div>
<div class="line">                        {</div>
<div class="line">                        cch = <a class="code" href="safestack_8h.html#a2c8ace5f3a7bb9a157622cf42340c1fa">sk_CMS_CertificateChoices_value</a>(certs, j);</div>
<div class="line">                        <span class="keywordflow">if</span> (cch-&gt;<a class="code" href="structCMS__CertificateChoices.html#af446184e0fdd56690ad06c6c4a0dba5c">type</a> != 0)</div>
<div class="line">                                <span class="keywordflow">continue</span>;</div>
<div class="line">                        x = cch-&gt;<a class="code" href="structCMS__CertificateChoices.html#a9d8fa9df292b45f229970f4a41273cff">d</a>.<a class="code" href="structCMS__CertificateChoices.html#a73bb916b33aef426bc1d27b8261feaeb">certificate</a>;</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="cms_8h.html#a844f95e7b7bf9837c05c16989f0dd634">CMS_SignerInfo_cert_cmp</a>(si, x) == 0)</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="cms_8h.html#a6c7423a2fbefe9e3519679784265c973">CMS_SignerInfo_set1_signer_cert</a>(si, x);</div>
<div class="line">                                ret++;</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7e9044c6fa0899c711c09da4eed9d5c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_set_detached </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>detached</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00315">315</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> **pos;</div>
<div class="line">        pos = <a class="code" href="cms_8h.html#aed4845b6010a2e1988ca0234cbfa3b18">CMS_get0_content</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!pos)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (detached)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (*pos)</div>
<div class="line">                        {</div>
<div class="line">                        ASN1_OCTET_STRING_free(*pos);</div>
<div class="line">                        *pos = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!*pos)</div>
<div class="line">                *pos = ASN1_OCTET_STRING_new();</div>
<div class="line">        <span class="keywordflow">if</span> (*pos)</div>
<div class="line">                {</div>
<div class="line">                <span class="comment">/* NB: special flag to show content is created and not</span></div>
<div class="line"><span class="comment">                 * read in.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                (*pos)-&gt;flags |= <a class="code" href="asn1_8h.html#a4b7ab2e2bd5b4e52b4f3d13a3a3e59bd">ASN1_STRING_FLAG_CONT</a>;</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a78ff9c6d6fbf031ca2a347d710431e9c">CMS_F_CMS_SET_DETACHED</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a64ee2c9fa6bef977abba1d8728b3284e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_SharedInfo_encode </td>
          <td>(</td>
          <td class="paramtype">unsigned char **&#160;</td>
          <td class="paramname"><em>pder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> *&#160;</td>
          <td class="paramname"><em>kekalg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> *&#160;</td>
          <td class="paramname"><em>ukm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7d5544dd9b2126fb5b8885f8eb9dff41"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* CMS_sign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>signcert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>pkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00519">519</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a> *cms;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line"></div>
<div class="line">        cms = CMS_ContentInfo_new();</div>
<div class="line">        <span class="keywordflow">if</span> (!cms || !<a class="code" href="cms_8h.html#a1644c2838a48d575d251f2b658ae4034">CMS_SignedData_init</a>(cms))</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#a2dff043317948b4c2c08a305cf10b478">CMS_ASCIICRLF</a> &amp;&amp; !<a class="code" href="cms_8h.html#a244b5fc1d06ba187897439827c5fec70">CMS_set1_eContentType</a>(cms, <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="obj__mac_8h.html#a3a13721d9d7725f2b28b633d1af24a47">NID_id_ct_asciiTextWithCRLF</a>)))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (pkey &amp;&amp; !<a class="code" href="cms_8h.html#a2eb58dd50af8338432ec5b09c11becbc">CMS_add1_signer</a>(cms, signcert, pkey, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a5744bb322983fa8b30cc21a73f769d99">CMS_F_CMS_SIGN</a>, <a class="code" href="cms_8h.html#a362420679074443818711ec9aa3a14a6">CMS_R_ADD_SIGNER_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#af8495d81a6dda58254c7e12528af0118">sk_X509_num</a>(certs); i++)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structx509__st.html">X509</a> *<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a> = <a class="code" href="safestack_8h.html#a6ce8e2d1c31859b9b27cd535caba4388">sk_X509_value</a>(certs, i);</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="cms_8h.html#a9ba4ef68ee60c507f65b0a18e38de4fe">CMS_add1_cert</a>(cms, x))</div>
<div class="line">                        <span class="keywordflow">goto</span> merr;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#a9aca14ae67c24cf5b7d0c66368fab072">CMS_DETACHED</a>))</div>
<div class="line">                <a class="code" href="cms_8h.html#a7e9044c6fa0899c711c09da4eed9d5c5">CMS_set_detached</a>(cms, 0);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; (<a class="code" href="cms_8h.html#af7c70d85fa217f66b9f10bc37281c723">CMS_STREAM</a>|<a class="code" href="cms_8h.html#a20b64bc8c182f7ac666da5bcb0190c07">CMS_PARTIAL</a>))</div>
<div class="line">                || <a class="code" href="cms_8h.html#a52397f4b59560ac8a0ad14707dbd8335">CMS_final</a>(cms, data, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                <span class="keywordflow">return</span> cms;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        merr:</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a5744bb322983fa8b30cc21a73f769d99">CMS_F_CMS_SIGN</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (cms)</div>
<div class="line">                CMS_ContentInfo_free(cms);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a318fdac3de75759689ec06b66d4806ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* CMS_sign_receipt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>signcert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>pkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00562">562</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__SignerInfo__st.html">CMS_SignerInfo</a> *rct_si;</div>
<div class="line">        <a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a> *cms = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> **pos, *os;</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *rct_cont = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> r = 0;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp;= ~(<a class="code" href="cms_8h.html#af7c70d85fa217f66b9f10bc37281c723">CMS_STREAM</a>|<a class="code" href="cms_8h.html#a6386aad1cceb6f5561003c28bbf2dcb3">CMS_TEXT</a>);</div>
<div class="line">        <span class="comment">/* Not really detached but avoids content being allocated */</span></div>
<div class="line">        <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> |= <a class="code" href="cms_8h.html#a20b64bc8c182f7ac666da5bcb0190c07">CMS_PARTIAL</a>|<a class="code" href="cms_8h.html#a26044c9210eb8c5e3308d023ae4d5245">CMS_BINARY</a>|<a class="code" href="cms_8h.html#a9aca14ae67c24cf5b7d0c66368fab072">CMS_DETACHED</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (!pkey || !signcert)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a576d9f3b720f6ebbb7e8c6e5ebd0e339">CMS_F_CMS_SIGN_RECEIPT</a>, <a class="code" href="cms_8h.html#a6de6edfaddc9f8be340cb2fba91a7bd8">CMS_R_NO_KEY_OR_CERT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initialize signed data */</span></div>
<div class="line"></div>
<div class="line">        cms = <a class="code" href="cms_8h.html#a7d5544dd9b2126fb5b8885f8eb9dff41">CMS_sign</a>(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, certs, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!cms)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Set inner content type to signed receipt */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="cms_8h.html#a244b5fc1d06ba187897439827c5fec70">CMS_set1_eContentType</a>(cms, <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="obj__mac_8h.html#af2ef6f53a32ba0f8dd0b3377bedc02d0">NID_id_smime_ct_receipt</a>)))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        rct_si = <a class="code" href="cms_8h.html#a2eb58dd50af8338432ec5b09c11becbc">CMS_add1_signer</a>(cms, signcert, pkey, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!rct_si)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a576d9f3b720f6ebbb7e8c6e5ebd0e339">CMS_F_CMS_SIGN_RECEIPT</a>, <a class="code" href="cms_8h.html#a362420679074443818711ec9aa3a14a6">CMS_R_ADD_SIGNER_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        os = <a class="code" href="cms__ess_8c.html#a052ae32c1ce228c85b2d5f772c0b38c6">cms_encode_Receipt</a>(si);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!os)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Set content to digest */</span></div>
<div class="line">        rct_cont = <a class="code" href="bio_8h.html#a3c93aa21db46e50b7002f434b641d218">BIO_new_mem_buf</a>(os-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>, os-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!rct_cont)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Add msgSigDigest attribute */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="cms__ess_8c.html#a59155921f635636542bf47f780acc979">cms_msgSigDigest_add1</a>(rct_si, si))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Finalize structure */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="cms_8h.html#a52397f4b59560ac8a0ad14707dbd8335">CMS_final</a>(cms, rct_cont, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Set embedded content */</span></div>
<div class="line">        pos = <a class="code" href="cms_8h.html#aed4845b6010a2e1988ca0234cbfa3b18">CMS_get0_content</a>(cms);</div>
<div class="line">        *pos = os;</div>
<div class="line"></div>
<div class="line">        r = 1;</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (rct_cont)</div>
<div class="line">                <a class="code" href="bio_8h.html#abbfb67b5eb998ce232f2482b097da8b2">BIO_free</a>(rct_cont);</div>
<div class="line">        <span class="keywordflow">if</span> (r)</div>
<div class="line">                <span class="keywordflow">return</span> cms;</div>
<div class="line">        CMS_ContentInfo_free(cms);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a05741723badc0ac44ff55b797bda2143"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_signed_add1_attr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509_8h.html#aa4f1a62a9d2dd8cb6780fe2713737c0f">X509_ATTRIBUTE</a> *&#160;</td>
          <td class="paramname"><em>attr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00090">90</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(X509at_add1_attr(&amp;si-&gt;signedAttrs, attr)) <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac54e63b2827670c7b82c449f536ae59d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_signed_add1_attr_by_NID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00105">105</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(X509at_add1_attr_by_NID(&amp;si-&gt;signedAttrs, <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>,</div>
<div class="line">                                <a class="code" href="e__aes_8c.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>, <a class="code" href="x509_8h.html#a3fb78b1e1dea1301c549fdcb5a6ddc11">bytes</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)) <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af0cfd0420a7f32a63087f311ff6f59bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_signed_add1_attr_by_OBJ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00096">96</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(X509at_add1_attr_by_OBJ(&amp;si-&gt;signedAttrs, obj,</div>
<div class="line">                                <a class="code" href="e__aes_8c.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>, <a class="code" href="x509_8h.html#a3fb78b1e1dea1301c549fdcb5a6ddc11">bytes</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)) <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae302bd9f0942e92744a6af8c89b96f4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_signed_add1_attr_by_txt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>attrname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00114">114</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(X509at_add1_attr_by_txt(&amp;si-&gt;signedAttrs, <a class="code" href="x509_8h.html#a78f646207493cc73cd624c99da84424d">attrname</a>,</div>
<div class="line">                                <a class="code" href="e__aes_8c.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>, <a class="code" href="x509_8h.html#a3fb78b1e1dea1301c549fdcb5a6ddc11">bytes</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)) <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8d4b8c7d93b46ed722be5c6436941a82"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="x509_8h.html#aa4f1a62a9d2dd8cb6780fe2713737c0f">X509_ATTRIBUTE</a>* CMS_signed_delete_attr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00085">85</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#af15cb2869fa36a1b357e18a483795d1d">X509at_delete_attr</a>(si-&gt;signedAttrs, <a class="code" href="x509_8h.html#aebdbf0bfc23402adcaa55cb1fb6f2dd7">loc</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af1803123210af8b7304b66eb4c704941"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* CMS_signed_get0_data_by_OBJ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *&#160;</td>
          <td class="paramname"><em>oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lastpos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00123">123</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#a0fd094db82b5269617ef9a0202d6c639">X509at_get0_data_by_OBJ</a>(si-&gt;signedAttrs, oid, lastpos, <a class="code" href="e__aes_8c.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a689dc22b400fa430b81d4bbee527291c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="x509_8h.html#aa4f1a62a9d2dd8cb6780fe2713737c0f">X509_ATTRIBUTE</a>* CMS_signed_get_attr </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00080">80</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#abcb5b650f7f7096a9457bf3bb851aab5">X509at_get_attr</a>(si-&gt;signedAttrs, <a class="code" href="x509_8h.html#aebdbf0bfc23402adcaa55cb1fb6f2dd7">loc</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab1a10728ac6fa2defa464eea43912184"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_signed_get_attr_by_NID </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lastpos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00068">68</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#a7d1db5ae5a45c4ae962ca84bc2a22f25">X509at_get_attr_by_NID</a>(si-&gt;signedAttrs, <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>, lastpos);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aee280884edf261b5edd53bc4a662f86e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_signed_get_attr_by_OBJ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lastpos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00074">74</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#ac611e62608ad210b9ff9883763152fe3">X509at_get_attr_by_OBJ</a>(si-&gt;signedAttrs, obj, lastpos);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad32fc38b6df05652fe4543b813366550"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_signed_get_attr_count </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00063">63</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#aee2c757c40eca626e3645abee0c8e9f4">X509at_get_attr_count</a>(si-&gt;signedAttrs);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1644c2838a48d575d251f2b658ae4034"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_SignedData_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00101">101</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (cms_signed_data_init(cms))</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a844f95e7b7bf9837c05c16989f0dd634"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_SignerInfo_cert_cmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00550">550</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#ae15c777be21e1c02be97ddf5bc27dc54">cms_SignerIdentifier_cert_cmp</a>(si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a5c2475b3f78c9362b3b0bbb8e56cbdf4">sid</a>, cert);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a41425496f0226eec3323fb81c66172f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CMS_SignerInfo_get0_algs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> **&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> **&#160;</td>
          <td class="paramname"><em>signer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **&#160;</td>
          <td class="paramname"><em>pdig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **&#160;</td>
          <td class="paramname"><em>psig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00606">606</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (pk)</div>
<div class="line">                *pk = si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a031a060e636d6bbd2fb77c04cfd00d58">pkey</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (signer)</div>
<div class="line">                *signer = si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#ae23016eba59a8997ce007bc66cc74219">signer</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (pdig)</div>
<div class="line">                *pdig = si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a97656c5d82a9704229706ac22a328615">digestAlgorithm</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (psig)</div>
<div class="line">                *psig = si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aa67b68149892bbe6f7a5b9e97c66e1ca">signatureAlgorithm</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acb3b0881dbad94057600a0f166d44b96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a69cda4d21bd068f01c469222c1dd92fe">EVP_MD_CTX</a>* CMS_SignerInfo_get0_md_ctx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00487">487</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> &amp;si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aa3b8138df00f7ba614925bb5f831ce4a">mctx</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af51972010dbe8b59ad7afdc9f0b8fb16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#aaadbb75633e4460a52864970a3b875de">EVP_PKEY_CTX</a>* CMS_SignerInfo_get0_pkey_ctx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00482">482</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#af2308aafc9e8f1b1ec2fd885a168870c">pctx</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a02ea025a7f70db116cdd2aefc4d3c355"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a>* CMS_SignerInfo_get0_signature </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00619">619</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aee2347ee93351b9d44fb978a71295ca8">signature</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af9530c8048cf7bece6d09717f7e4e737"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_SignerInfo_get0_signer_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> **&#160;</td>
          <td class="paramname"><em>issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **&#160;</td>
          <td class="paramname"><em>sno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00543">543</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#a73e3ae14ece4aba2d5bcc38796b23907">cms_SignerIdentifier_get0_signer_id</a>(si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a5c2475b3f78c9362b3b0bbb8e56cbdf4">sid</a>, keyid, issuer, sno);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6c7423a2fbefe9e3519679784265c973"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CMS_SignerInfo_set1_signer_cert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>signer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00529">529</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (signer)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="crypto_8h.html#ab8556c4f12443f1876ce487dd0c8db27">CRYPTO_add</a>(&amp;signer-&gt;<a class="code" href="structx509__st.html#ab1114b325664bca1cdfd6854f247a4d5">references</a>, 1, <a class="code" href="crypto_8h.html#abcd6591ef6acea51bf9f6edb6bb05bca">CRYPTO_LOCK_X509</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a031a060e636d6bbd2fb77c04cfd00d58">pkey</a>)</div>
<div class="line">                        <a class="code" href="evp_8h.html#a448d9f9209a54694aff045d403850db7">EVP_PKEY_free</a>(si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a031a060e636d6bbd2fb77c04cfd00d58">pkey</a>);</div>
<div class="line">                si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a031a060e636d6bbd2fb77c04cfd00d58">pkey</a> = <a class="code" href="x509_8h.html#a97c3703b14a1f4a987c5d31cdf6cb205">X509_get_pubkey</a>(signer);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#ae23016eba59a8997ce007bc66cc74219">signer</a>)</div>
<div class="line">                X509_free(si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#ae23016eba59a8997ce007bc66cc74219">signer</a>);</div>
<div class="line">        si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#ae23016eba59a8997ce007bc66cc74219">signer</a> = signer;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a426439b64ded9f572e4afd97bdfb4015"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_SignerInfo_sign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00733">733</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structenv__md__ctx__st.html">EVP_MD_CTX</a> *mctx = &amp;si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aa3b8138df00f7ba614925bb5f831ce4a">mctx</a>;</div>
<div class="line">        <a class="code" href="structevp__pkey__ctx__st.html">EVP_PKEY_CTX</a> *pctx;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *abuf = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> alen;</div>
<div class="line">        <span class="keywordtype">size_t</span> siglen;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structenv__md__st.html">EVP_MD</a> *md = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        md = <a class="code" href="evp_8h.html#afd1d14292f13b363355410634e00ec09">EVP_get_digestbyobj</a>(si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a97656c5d82a9704229706ac22a328615">digestAlgorithm</a>-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (md == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="cms_8h.html#ab1a10728ac6fa2defa464eea43912184">CMS_signed_get_attr_by_NID</a>(si, <a class="code" href="obj__mac_8h.html#a8709600c4bef59170abf4f94e1b3b7b3">NID_pkcs9_signingTime</a>, -1) &lt; 0)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!cms_add1_signingTime(si, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#af2308aafc9e8f1b1ec2fd885a168870c">pctx</a>)</div>
<div class="line">                pctx = si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#af2308aafc9e8f1b1ec2fd885a168870c">pctx</a>;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="digest_8c.html#afe58145aa88a8ee187d858c762c00399">EVP_MD_CTX_init</a>(mctx);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#a6e42bb779758e541a2987e52223e7e50">EVP_DigestSignInit</a>(mctx, &amp;pctx, md, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a031a060e636d6bbd2fb77c04cfd00d58">pkey</a>) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#ac215192017d713cda37872ad4d9daf54">EVP_PKEY_CTX_ctrl</a>(pctx, -1, <a class="code" href="evp_8h.html#ad018f5b3f98b2eb5d6886e8b47dc5858">EVP_PKEY_OP_SIGN</a>,</div>
<div class="line">                                <a class="code" href="evp_8h.html#a23b89039f51a7a3296c8c6b1b535af9d">EVP_PKEY_CTRL_CMS_SIGN</a>, 0, si) &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#accf2f06fdd0b93862ba1da22b2b7eaf2">CMS_F_CMS_SIGNERINFO_SIGN</a>, <a class="code" href="cms_8h.html#acaacc3148004af71679e726810e7d532">CMS_R_CTRL_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        alen = <a class="code" href="asn1_8h.html#ada80d0bea54b10298b0668eabba68e9e">ASN1_item_i2d</a>((<a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> *)si-&gt;signedAttrs,&amp;abuf,</div>
<div class="line">                                <a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(CMS_Attributes_Sign));</div>
<div class="line">        <span class="keywordflow">if</span>(!abuf)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#a03bbc2d5a147ccea2adb2aa8cfc43972">EVP_DigestSignUpdate</a>(mctx, abuf, alen) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#a44b11e0cf78f36a8650277e36cf4a65e">EVP_DigestSignFinal</a>(mctx, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, &amp;siglen) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(abuf);</div>
<div class="line">        abuf = <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(siglen);</div>
<div class="line">        <span class="keywordflow">if</span>(!abuf)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#a44b11e0cf78f36a8650277e36cf4a65e">EVP_DigestSignFinal</a>(mctx, abuf, &amp;siglen) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#ac215192017d713cda37872ad4d9daf54">EVP_PKEY_CTX_ctrl</a>(pctx, -1, <a class="code" href="evp_8h.html#ad018f5b3f98b2eb5d6886e8b47dc5858">EVP_PKEY_OP_SIGN</a>,</div>
<div class="line">                                <a class="code" href="evp_8h.html#a23b89039f51a7a3296c8c6b1b535af9d">EVP_PKEY_CTRL_CMS_SIGN</a>, 1, si) &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#accf2f06fdd0b93862ba1da22b2b7eaf2">CMS_F_CMS_SIGNERINFO_SIGN</a>, <a class="code" href="cms_8h.html#acaacc3148004af71679e726810e7d532">CMS_R_CTRL_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="digest_8c.html#ac6c8c38d6c8e3e274c9a974792b8342d">EVP_MD_CTX_cleanup</a>(mctx);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="asn1_8h.html#add085933f3a303f7c59acf0e9b072d63">ASN1_STRING_set0</a>(si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aee2347ee93351b9d44fb978a71295ca8">signature</a>, abuf, siglen);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (abuf)</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(abuf);</div>
<div class="line">        <a class="code" href="digest_8c.html#ac6c8c38d6c8e3e274c9a974792b8342d">EVP_MD_CTX_cleanup</a>(mctx);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a37e31a3a3362596f3e950cefddb10678"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_SignerInfo_verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00805">805</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structenv__md__ctx__st.html">EVP_MD_CTX</a> *mctx = &amp;si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aa3b8138df00f7ba614925bb5f831ce4a">mctx</a>;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *abuf = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> alen, r = -1;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structenv__md__st.html">EVP_MD</a> *md = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a031a060e636d6bbd2fb77c04cfd00d58">pkey</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ae5b35633f5666771cb9488c601b51ee7">CMS_F_CMS_SIGNERINFO_VERIFY</a>, <a class="code" href="cms_8h.html#af3a4a80c8965f53fded432c7cd39c1fb">CMS_R_NO_PUBLIC_KEY</a>);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        md = <a class="code" href="evp_8h.html#afd1d14292f13b363355410634e00ec09">EVP_get_digestbyobj</a>(si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a97656c5d82a9704229706ac22a328615">digestAlgorithm</a>-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (md == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        <a class="code" href="digest_8c.html#afe58145aa88a8ee187d858c762c00399">EVP_MD_CTX_init</a>(mctx);</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#aeb9e942f3ca5a391d66cc1080b7cfd19">EVP_DigestVerifyInit</a>(mctx, &amp;si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#af2308aafc9e8f1b1ec2fd885a168870c">pctx</a>, md, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a031a060e636d6bbd2fb77c04cfd00d58">pkey</a>) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!cms_sd_asn1_ctrl(si, 1))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        alen = <a class="code" href="asn1_8h.html#ada80d0bea54b10298b0668eabba68e9e">ASN1_item_i2d</a>((<a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> *)si-&gt;signedAttrs,&amp;abuf,</div>
<div class="line">                                <a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(CMS_Attributes_Verify));</div>
<div class="line">        <span class="keywordflow">if</span>(!abuf)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        r = <a class="code" href="evp_8h.html#a007a74a80271ebc873d58c4a280bb58b">EVP_DigestVerifyUpdate</a>(mctx, abuf, alen);</div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(abuf);</div>
<div class="line">        <span class="keywordflow">if</span> (r &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                r = -1;</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        r = <a class="code" href="evp_8h.html#aef90373183ab6f9b06aa26b8a38b46bf">EVP_DigestVerifyFinal</a>(mctx,</div>
<div class="line">                        si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aee2347ee93351b9d44fb978a71295ca8">signature</a>-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>, si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aee2347ee93351b9d44fb978a71295ca8">signature</a>-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (r &lt;= 0)</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ae5b35633f5666771cb9488c601b51ee7">CMS_F_CMS_SIGNERINFO_VERIFY</a>, <a class="code" href="cms_8h.html#aa49b30049d0eb233a76d8c3396f72d7a">CMS_R_VERIFICATION_FAILURE</a>);</div>
<div class="line">        err:</div>
<div class="line">        <a class="code" href="digest_8c.html#ac6c8c38d6c8e3e274c9a974792b8342d">EVP_MD_CTX_cleanup</a>(mctx);</div>
<div class="line">        <span class="keywordflow">return</span> r;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3892cb7d22ea2d5bcb409c1404409857"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_SignerInfo_verify_content </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>chain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00880">880</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> *os = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structenv__md__ctx__st.html">EVP_MD_CTX</a> mctx;</div>
<div class="line">        <a class="code" href="structevp__pkey__ctx__st.html">EVP_PKEY_CTX</a> *pkctx = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> r = -1;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> mval[<a class="code" href="evp_8h.html#a71bfc78a168f00f0c4ffd2535082b129">EVP_MAX_MD_SIZE</a>];</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mlen;</div>
<div class="line">        <a class="code" href="digest_8c.html#afe58145aa88a8ee187d858c762c00399">EVP_MD_CTX_init</a>(&amp;mctx);</div>
<div class="line">        <span class="comment">/* If we have any signed attributes look for messageDigest value */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="cms_8h.html#ad32fc38b6df05652fe4543b813366550">CMS_signed_get_attr_count</a>(si) &gt;= 0)</div>
<div class="line">                {</div>
<div class="line">                os = <a class="code" href="cms_8h.html#af1803123210af8b7304b66eb4c704941">CMS_signed_get0_data_by_OBJ</a>(si,</div>
<div class="line">                                        <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="obj__mac_8h.html#aeaaf631dea9b53302214ef2d461cfc40">NID_pkcs9_messageDigest</a>),</div>
<div class="line">                                        -3, <a class="code" href="asn1_8h.html#ab7338bcfcfbbd8f90c680759f373663b">V_ASN1_OCTET_STRING</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (!os)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a24e6725e6b743b3ac25a447c7385f1f8">CMS_F_CMS_SIGNERINFO_VERIFY_CONTENT</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#ac98cad4079e4febb50fb1652d6268b7c">CMS_R_ERROR_READING_MESSAGEDIGEST_ATTRIBUTE</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="cms__lcl_8h.html#a061cd98f90341e462ce7050fafe88768">cms_DigestAlgorithm_find_ctx</a>(&amp;mctx, chain, si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a97656c5d82a9704229706ac22a328615">digestAlgorithm</a>))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="digest_8c.html#a3c3bec018dd4bdf73a3f14d27ea9b718">EVP_DigestFinal_ex</a>(&amp;mctx, mval, &amp;mlen) &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a24e6725e6b743b3ac25a447c7385f1f8">CMS_F_CMS_SIGNERINFO_VERIFY_CONTENT</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#a60859dfda32464c93da459b430439950">CMS_R_UNABLE_TO_FINALIZE_CONTEXT</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* If messageDigest found compare it */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (os)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (mlen != (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)os-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a24e6725e6b743b3ac25a447c7385f1f8">CMS_F_CMS_SIGNERINFO_VERIFY_CONTENT</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a8769c8c179d967156e761dd9d4b89503">CMS_R_MESSAGEDIGEST_ATTRIBUTE_WRONG_LENGTH</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (memcmp(mval, os-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>, mlen))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a24e6725e6b743b3ac25a447c7385f1f8">CMS_F_CMS_SIGNERINFO_VERIFY_CONTENT</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#aa49b30049d0eb233a76d8c3396f72d7a">CMS_R_VERIFICATION_FAILURE</a>);</div>
<div class="line">                        r = 0;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        r = 1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="structenv__md__st.html">EVP_MD</a> *md = <a class="code" href="evp_8h.html#a71fed39076aec9a43d618177317e3691">EVP_MD_CTX_md</a>(&amp;mctx);</div>
<div class="line">                pkctx = <a class="code" href="evp_8h.html#a23d1c787f99b2aaa6d8283c2db325eea">EVP_PKEY_CTX_new</a>(si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#a031a060e636d6bbd2fb77c04cfd00d58">pkey</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#ac8a26ed0478363046e96e20c1b16273b">EVP_PKEY_verify_init</a>(pkctx) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#a743ec645aadfb7f5ff5cbfc134c105a9">EVP_PKEY_CTX_set_signature_md</a>(pkctx, md) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#af2308aafc9e8f1b1ec2fd885a168870c">pctx</a> = pkctx;</div>
<div class="line">                <span class="keywordflow">if</span> (!cms_sd_asn1_ctrl(si, 1))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                r = <a class="code" href="evp_8h.html#a6dca630e7d00cafcf91277e67781278c">EVP_PKEY_verify</a>(pkctx, si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aee2347ee93351b9d44fb978a71295ca8">signature</a>-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>,</div>
<div class="line">                                        si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aee2347ee93351b9d44fb978a71295ca8">signature</a>-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>,</div>
<div class="line">                                        mval, mlen);</div>
<div class="line">                <span class="keywordflow">if</span> (r &lt;= 0)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a24e6725e6b743b3ac25a447c7385f1f8">CMS_F_CMS_SIGNERINFO_VERIFY_CONTENT</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#aa49b30049d0eb233a76d8c3396f72d7a">CMS_R_VERIFICATION_FAILURE</a>);</div>
<div class="line">                        r = 0;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (pkctx)</div>
<div class="line">                <a class="code" href="evp_8h.html#a9a2d5ac99985dda36f15bd92d83c1621">EVP_PKEY_CTX_free</a>(pkctx);</div>
<div class="line">        <a class="code" href="digest_8c.html#ac6c8c38d6c8e3e274c9a974792b8342d">EVP_MD_CTX_cleanup</a>(&amp;mctx);</div>
<div class="line">        <span class="keywordflow">return</span> r;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a52b2995cc0a11ac3dda054475f2bdd3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_stream </td>
          <td>(</td>
          <td class="paramtype">unsigned char ***&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__io_8c_source.html#l00061">61</a> of file <a class="el" href="cms__io_8c_source.html">cms_io.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> **pos;</div>
<div class="line">        pos = <a class="code" href="cms_8h.html#aed4845b6010a2e1988ca0234cbfa3b18">CMS_get0_content</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!pos)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (!*pos)</div>
<div class="line">                *pos = ASN1_OCTET_STRING_new();</div>
<div class="line">        <span class="keywordflow">if</span> (*pos)</div>
<div class="line">                {</div>
<div class="line">                (*pos)-&gt;flags |= <a class="code" href="asn1_8h.html#acfd3d2e84baac0730e8c99d260a7fba9">ASN1_STRING_FLAG_NDEF</a>;</div>
<div class="line">                (*pos)-&gt;flags &amp;= ~<a class="code" href="asn1_8h.html#a4b7ab2e2bd5b4e52b4f3d13a3a3e59bd">ASN1_STRING_FLAG_CONT</a>;</div>
<div class="line">                *boundary = &amp;(*pos)-&gt;data;</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#aa04abb521f92d49dc2a4e01a8357e764">CMS_F_CMS_STREAM</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a49597406d7d4b9fb0e1fea4e4893a1fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_uncompress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>dcont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00939">939</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ad92dc2fe717459b8dbd407eb3af535c6">CMS_F_CMS_UNCOMPRESS</a>, <a class="code" href="cms_8h.html#a93634ca62d329411640a389df0392f5d">CMS_R_UNSUPPORTED_COMPRESSION_ALGORITHM</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a39cbda7e0124c4b183a13a3737d8eb5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_unsigned_add1_attr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509_8h.html#aa4f1a62a9d2dd8cb6780fe2713737c0f">X509_ATTRIBUTE</a> *&#160;</td>
          <td class="paramname"><em>attr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00156">156</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(X509at_add1_attr(&amp;si-&gt;unsignedAttrs, attr)) <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6fdfc96a16752e94eac03599ecf073d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_unsigned_add1_attr_by_NID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00171">171</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(X509at_add1_attr_by_NID(&amp;si-&gt;unsignedAttrs, <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>,</div>
<div class="line">                                <a class="code" href="e__aes_8c.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>, <a class="code" href="x509_8h.html#a3fb78b1e1dea1301c549fdcb5a6ddc11">bytes</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)) <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa3454289f8f2fd2e3c08e36c78fc7622"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_unsigned_add1_attr_by_OBJ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00162">162</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(X509at_add1_attr_by_OBJ(&amp;si-&gt;unsignedAttrs, obj,</div>
<div class="line">                                <a class="code" href="e__aes_8c.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>, <a class="code" href="x509_8h.html#a3fb78b1e1dea1301c549fdcb5a6ddc11">bytes</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)) <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a501c408a5e353af44ecfa15acec45673"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_unsigned_add1_attr_by_txt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>attrname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00180">180</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(X509at_add1_attr_by_txt(&amp;si-&gt;unsignedAttrs, <a class="code" href="x509_8h.html#a78f646207493cc73cd624c99da84424d">attrname</a>,</div>
<div class="line">                                <a class="code" href="e__aes_8c.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>, <a class="code" href="x509_8h.html#a3fb78b1e1dea1301c549fdcb5a6ddc11">bytes</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)) <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac3646520e1d5ff39914e86446dbe16e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="x509_8h.html#aa4f1a62a9d2dd8cb6780fe2713737c0f">X509_ATTRIBUTE</a>* CMS_unsigned_delete_attr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00151">151</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#af15cb2869fa36a1b357e18a483795d1d">X509at_delete_attr</a>(si-&gt;unsignedAttrs, <a class="code" href="x509_8h.html#aebdbf0bfc23402adcaa55cb1fb6f2dd7">loc</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab8d3e30cbe48334e56607c510527093f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* CMS_unsigned_get0_data_by_OBJ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *&#160;</td>
          <td class="paramname"><em>oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lastpos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00189">189</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#a0fd094db82b5269617ef9a0202d6c639">X509at_get0_data_by_OBJ</a>(si-&gt;unsignedAttrs, oid, lastpos, <a class="code" href="e__aes_8c.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae1d3af13add0207b601c81b5bf784bd7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="x509_8h.html#aa4f1a62a9d2dd8cb6780fe2713737c0f">X509_ATTRIBUTE</a>* CMS_unsigned_get_attr </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00146">146</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#abcb5b650f7f7096a9457bf3bb851aab5">X509at_get_attr</a>(si-&gt;unsignedAttrs, <a class="code" href="x509_8h.html#aebdbf0bfc23402adcaa55cb1fb6f2dd7">loc</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a37d0e5e65912b3b7e40e6871f66c950a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_unsigned_get_attr_by_NID </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lastpos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00134">134</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#a7d1db5ae5a45c4ae962ca84bc2a22f25">X509at_get_attr_by_NID</a>(si-&gt;unsignedAttrs, <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>, lastpos);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a459983c73ba7344710043a453f870727"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_unsigned_get_attr_by_OBJ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lastpos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00140">140</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#ac611e62608ad210b9ff9883763152fe3">X509at_get_attr_by_OBJ</a>(si-&gt;unsignedAttrs, obj, lastpos);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5fd75c09a2b0ecdc976750a8c8f0160e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_unsigned_get_attr_count </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__att_8c_source.html#l00129">129</a> of file <a class="el" href="cms__att_8c_source.html">cms_att.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#aee2c757c40eca626e3645abee0c8e9f4">X509at_get_attr_count</a>(si-&gt;unsignedAttrs);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6043f2a317d9144607c845f7b9c2599f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a3a2b800bae08729d11bc28f12b795597">X509_STORE</a> *&#160;</td>
          <td class="paramname"><em>store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>dcont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00324">324</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__SignerInfo__st.html">CMS_SignerInfo</a> *si;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__SignerInfo__st.html">CMS_SignerInfo</a>) *sinfos;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *cms_certs = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structX509__crl__st.html">X509_CRL</a>) *crls = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structx509__st.html">X509</a> *signer;</div>
<div class="line">        <span class="keywordtype">int</span> i, scount = 0, ret = 0;</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *cmsbio = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, *tmpin = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, *tmpout = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!dcont &amp;&amp; !check_content(cms))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (dcont &amp;&amp; !(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#a26044c9210eb8c5e3308d023ae4d5245">CMS_BINARY</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *coid = <a class="code" href="cms_8h.html#ab0a011907cfe668a473f918ccbab301d">CMS_get0_eContentType</a>(cms);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(coid) == <a class="code" href="obj__mac_8h.html#a3a13721d9d7725f2b28b633d1af24a47">NID_id_ct_asciiTextWithCRLF</a>)</div>
<div class="line">                        <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> |= <a class="code" href="cms_8h.html#a2dff043317948b4c2c08a305cf10b478">CMS_ASCIICRLF</a>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Attempt to find all signer certificates */</span></div>
<div class="line"></div>
<div class="line">        sinfos = CMS_get0_SignerInfos(cms);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="safestack_8h.html#a60f8dafbf2a20918520d0f334fcd8be6">sk_CMS_SignerInfo_num</a>(sinfos) &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a65dd513977bf4a58a9933e443a4f414f">CMS_F_CMS_VERIFY</a>, <a class="code" href="cms_8h.html#a12d6fe11e8573f82a382fe65bd458462">CMS_R_NO_SIGNERS</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a60f8dafbf2a20918520d0f334fcd8be6">sk_CMS_SignerInfo_num</a>(sinfos); i++)</div>
<div class="line">                {</div>
<div class="line">                si = <a class="code" href="safestack_8h.html#a6b01d6da466a0cfe0bf35f47870735ae">sk_CMS_SignerInfo_value</a>(sinfos, i);</div>
<div class="line">                <a class="code" href="cms_8h.html#a41425496f0226eec3323fb81c66172f5">CMS_SignerInfo_get0_algs</a>(si, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, &amp;signer, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (signer)</div>
<div class="line">                        scount++;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (scount != <a class="code" href="safestack_8h.html#a60f8dafbf2a20918520d0f334fcd8be6">sk_CMS_SignerInfo_num</a>(sinfos))</div>
<div class="line">                scount += <a class="code" href="cms_8h.html#af91d09ff17c46f9f6e98828152c6e1f7">CMS_set1_signers_certs</a>(cms, certs, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (scount != <a class="code" href="safestack_8h.html#a60f8dafbf2a20918520d0f334fcd8be6">sk_CMS_SignerInfo_num</a>(sinfos))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a65dd513977bf4a58a9933e443a4f414f">CMS_F_CMS_VERIFY</a>, <a class="code" href="cms_8h.html#a45a9953862e357e43ef69f4ea0d9e7b9">CMS_R_SIGNER_CERTIFICATE_NOT_FOUND</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Attempt to verify all signers certs */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#ac1582d4bdb24ac326ebfb0168df964c8">CMS_NO_SIGNER_CERT_VERIFY</a>))</div>
<div class="line">                {</div>
<div class="line">                cms_certs = CMS_get1_certs(cms);</div>
<div class="line">                <span class="keywordflow">if</span> (!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#a98467ee02388202556ca48bb523b8509">CMS_NOCRL</a>))</div>
<div class="line">                        crls = CMS_get1_crls(cms);</div>
<div class="line">                <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a60f8dafbf2a20918520d0f334fcd8be6">sk_CMS_SignerInfo_num</a>(sinfos); i++)</div>
<div class="line">                        {</div>
<div class="line">                        si = <a class="code" href="safestack_8h.html#a6b01d6da466a0cfe0bf35f47870735ae">sk_CMS_SignerInfo_value</a>(sinfos, i);</div>
<div class="line">                        <span class="keywordflow">if</span> (!cms_signerinfo_verify_cert(si, store,</div>
<div class="line">                                                        cms_certs, crls, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Attempt to verify all SignerInfo signed attribute signatures */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#acb04c24ec58a4dec438798d4801d0315">CMS_NO_ATTR_VERIFY</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a60f8dafbf2a20918520d0f334fcd8be6">sk_CMS_SignerInfo_num</a>(sinfos); i++)</div>
<div class="line">                        {</div>
<div class="line">                        si = <a class="code" href="safestack_8h.html#a6b01d6da466a0cfe0bf35f47870735ae">sk_CMS_SignerInfo_value</a>(sinfos, i);</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="cms_8h.html#ad32fc38b6df05652fe4543b813366550">CMS_signed_get_attr_count</a>(si) &lt; 0)</div>
<div class="line">                                <span class="keywordflow">continue</span>;</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="cms_8h.html#a37e31a3a3362596f3e950cefddb10678">CMS_SignerInfo_verify</a>(si) &lt;= 0)</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Performance optimization: if the content is a memory BIO then</span></div>
<div class="line"><span class="comment">         * store its contents in a temporary read only memory BIO. This</span></div>
<div class="line"><span class="comment">         * avoids potentially large numbers of slow copies of data which will</span></div>
<div class="line"><span class="comment">         * occur when reading from a read write memory BIO when signatures</span></div>
<div class="line"><span class="comment">         * are calculated.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (dcont &amp;&amp; (<a class="code" href="bio_8h.html#a96ecbb07b3727908e41b304bac2586c9">BIO_method_type</a>(dcont) == <a class="code" href="bio_8h.html#a85fbb99a752fe49d342b1685580587b7">BIO_TYPE_MEM</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordtype">char</span> *ptr;</div>
<div class="line">                <span class="keywordtype">long</span> <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                len = <a class="code" href="bio_8h.html#ad1cca133aa21da42cf8dac755e0b4df1">BIO_get_mem_data</a>(dcont, &amp;ptr);</div>
<div class="line">                tmpin = <a class="code" href="bio_8h.html#a3c93aa21db46e50b7002f434b641d218">BIO_new_mem_buf</a>(ptr, len);</div>
<div class="line">                <span class="keywordflow">if</span> (tmpin == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a65dd513977bf4a58a9933e443a4f414f">CMS_F_CMS_VERIFY</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                tmpin = dcont;</div>
<div class="line">        <span class="comment">/* If not binary mode and detached generate digests by *writing*</span></div>
<div class="line"><span class="comment">         * through the BIO. That makes it possible to canonicalise the</span></div>
<div class="line"><span class="comment">         * input.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="pkcs7_8h.html#a8b3711e984e8d68ac47fa26ac179dbb6">SMIME_BINARY</a>) &amp;&amp; dcont)</div>
<div class="line">                {</div>
<div class="line">                <span class="comment">/* Create output BIO so we can either handle text or to</span></div>
<div class="line"><span class="comment">                 * ensure included content doesn&#39;t override detached content.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                tmpout = cms_get_text_bio(out, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>);</div>
<div class="line">                <span class="keywordflow">if</span>(!tmpout)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a65dd513977bf4a58a9933e443a4f414f">CMS_F_CMS_VERIFY</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                cmsbio = <a class="code" href="cms_8h.html#af321d3ecf3ee6e9d3dbdbc8a7b572917">CMS_dataInit</a>(cms, tmpout);</div>
<div class="line">                <span class="keywordflow">if</span> (!cmsbio)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="comment">/* Don&#39;t use SMIME_TEXT for verify: it adds headers and</span></div>
<div class="line"><span class="comment">                 * we want to remove them.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                <a class="code" href="asn1_8h.html#a9733cdb626618d20a99ee483bcfa55aa">SMIME_crlf_copy</a>(dcont, cmsbio, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; ~<a class="code" href="pkcs7_8h.html#ad1e2a025c0e863a04c7e32b25b62f7e0">SMIME_TEXT</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#a6386aad1cceb6f5561003c28bbf2dcb3">CMS_TEXT</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (!<a class="code" href="asn1_8h.html#aa0b7d82a31e8f480bc15b164dee35b4b">SMIME_text</a>(tmpout, out))</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a65dd513977bf4a58a9933e443a4f414f">CMS_F_CMS_VERIFY</a>,<a class="code" href="cms_8h.html#a3898cca630348d95716a7318fc35b321">CMS_R_SMIME_TEXT_ERROR</a>);</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                cmsbio=<a class="code" href="cms_8h.html#af321d3ecf3ee6e9d3dbdbc8a7b572917">CMS_dataInit</a>(cms, tmpin);</div>
<div class="line">                <span class="keywordflow">if</span> (!cmsbio)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (!cms_copy_content(out, cmsbio, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#adda58aee98a505082601471e313a61f4">CMS_NO_CONTENT_VERIFY</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a60f8dafbf2a20918520d0f334fcd8be6">sk_CMS_SignerInfo_num</a>(sinfos); i++)</div>
<div class="line">                        {</div>
<div class="line">                        si = <a class="code" href="safestack_8h.html#a6b01d6da466a0cfe0bf35f47870735ae">sk_CMS_SignerInfo_value</a>(sinfos, i);</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="cms_8h.html#a3892cb7d22ea2d5bcb409c1404409857">CMS_SignerInfo_verify_content</a>(si, cmsbio) &lt;= 0)</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a65dd513977bf4a58a9933e443a4f414f">CMS_F_CMS_VERIFY</a>,</div>
<div class="line">                                        <a class="code" href="cms_8h.html#a6a655244aa4b45127f0c43388eb7d59a">CMS_R_CONTENT_VERIFY_ERROR</a>);</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        ret = 1;</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; SMIME_BINARY) &amp;&amp; dcont)</div>
<div class="line">                {</div>
<div class="line">                do_free_upto(cmsbio, tmpout);</div>
<div class="line">                <span class="keywordflow">if</span> (tmpin != dcont)</div>
<div class="line">                        <a class="code" href="bio_8h.html#abbfb67b5eb998ce232f2482b097da8b2">BIO_free</a>(tmpin);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (dcont &amp;&amp; (tmpin == dcont))</div>
<div class="line">                        do_free_upto(cmsbio, dcont);</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        <a class="code" href="bio_8h.html#a9cc47fc222c166cd863e1dfb5467a14e">BIO_free_all</a>(cmsbio);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (tmpout &amp;&amp; out != tmpout)</div>
<div class="line">                <a class="code" href="bio_8h.html#a9cc47fc222c166cd863e1dfb5467a14e">BIO_free_all</a>(tmpout);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (cms_certs)</div>
<div class="line">                <a class="code" href="safestack_8h.html#a9f351ddac9a3f1d94fcdfacfc9083312">sk_X509_pop_free</a>(cms_certs, X509_free);</div>
<div class="line">        <span class="keywordflow">if</span> (crls)</div>
<div class="line">                <a class="code" href="safestack_8h.html#a3777ee7a3d1530421f5e57afbe41adbb">sk_X509_CRL_pop_free</a>(crls, X509_CRL_free);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7098a596f5bd761782d27ae6b3f5a8f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_verify_receipt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>rcms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>ocms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a3a2b800bae08729d11bc28f12b795597">X509_STORE</a> *&#160;</td>
          <td class="paramname"><em>store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__smime_8c_source.html#l00507">507</a> of file <a class="el" href="cms__smime_8c_source.html">cms_smime.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> r;</div>
<div class="line">        <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp;= ~(<a class="code" href="cms_8h.html#a9aca14ae67c24cf5b7d0c66368fab072">CMS_DETACHED</a>|<a class="code" href="cms_8h.html#a6386aad1cceb6f5561003c28bbf2dcb3">CMS_TEXT</a>);</div>
<div class="line">        r = <a class="code" href="cms_8h.html#a6043f2a317d9144607c845f7b9c2599f">CMS_verify</a>(rcms, certs, store, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (r &lt;= 0)</div>
<div class="line">                <span class="keywordflow">return</span> r;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="cms__ess_8c.html#a8e3f30d1637a47523fdb553550a6aaf6">cms_Receipt_verify</a>(rcms, ocms);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5abce8bd2d355f6ab7d91a05bbef2a59"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* d2i_CMS_bio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> **&#160;</td>
          <td class="paramname"><em>cms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__io_8c_source.html#l00080">80</a> of file <a class="el" href="cms__io_8c_source.html">cms_io.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="a__d2i__fp_8c.html#ab9a262b7e81a7c1d093477645588b614">ASN1_item_d2i_bio</a>(<a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(<a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a>), bp, cms);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4f4348ca22044e1900f589356cd4655a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERR_load_CMS_strings </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__err_8c_source.html#l00246">246</a> of file <a class="el" href="cms__err_8c_source.html">cms_err.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line"><span class="preprocessor">#ifndef OPENSSL_NO_ERR</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="err_8c.html#a2ed805099ef84b85d1d7ab85cc2bfdab">ERR_func_error_string</a>(CMS_str_functs[0].<a class="code" href="des_8c.html#a11614f44ef4d939bdd984953346a7572">error</a>) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8c.html#aee5d8d46a525d9b2751c2266b4c49c76">ERR_load_strings</a>(0,CMS_str_functs);</div>
<div class="line">                <a class="code" href="err_8c.html#aee5d8d46a525d9b2751c2266b4c49c76">ERR_load_strings</a>(0,CMS_str_reasons);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0477bcc5b3df214f1797cd771f0b88c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int i2d_CMS_bio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__io_8c_source.html#l00085">85</a> of file <a class="el" href="cms__io_8c_source.html">cms_io.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="a__i2d__fp_8c.html#aa8834981e76236333cfead252fc3aa0d">ASN1_item_i2d_bio</a>(<a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(<a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a>), bp, cms);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afb5d07b3feb027024e41d858b6f7da7b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int i2d_CMS_bio_stream </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__io_8c_source.html#l00100">100</a> of file <a class="el" href="cms__io_8c_source.html">cms_io.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="asn1_8h.html#ad841ed3964f453427276196becaa9d5f">i2d_ASN1_bio_stream</a>(out, (<a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> *)cms, in, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>,</div>
<div class="line">                                        <a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(<a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a>));</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a45e17ba0610b74bba77154a178bf8854"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PEM_write_bio_CMS_stream </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__io_8c_source.html#l00106">106</a> of file <a class="el" href="cms__io_8c_source.html">cms_io.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="asn1_8h.html#a388d05c56973084b5d51fef31546ed6d">PEM_write_bio_ASN1_stream</a>(out, (<a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> *) cms, in, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>,</div>
<div class="line">                                        <span class="stringliteral">&quot;CMS&quot;</span>,</div>
<div class="line">                                        <a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(<a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a>));</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a06a74deca8bbbe696408ef93393de087"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* SMIME_read_CMS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> **&#160;</td>
          <td class="paramname"><em>bcont</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__io_8c_source.html#l00128">128</a> of file <a class="el" href="cms__io_8c_source.html">cms_io.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> (<a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a> *)<a class="code" href="asn1_8h.html#ad1223792f16994da711058087f5bea5d">SMIME_read_ASN1</a>(bio, bcont,</div>
<div class="line">                                        <a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(<a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a>));</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac187dbf572f1f1d79db727458d2c61d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SMIME_write_CMS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__io_8c_source.html#l00113">113</a> of file <a class="el" href="cms__io_8c_source.html">cms_io.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structX509__algor__st.html">X509_ALGOR</a>) *mdalgs;</div>
<div class="line">        <span class="keywordtype">int</span> ctype_nid = <a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#aae0b0e1c6da4732f18167de51c9eb9e5">contentType</a>);</div>
<div class="line">        <span class="keywordtype">int</span> econt_nid = <a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(<a class="code" href="cms_8h.html#ab0a011907cfe668a473f918ccbab301d">CMS_get0_eContentType</a>(cms));</div>
<div class="line">        <span class="keywordflow">if</span> (ctype_nid == <a class="code" href="obj__mac_8h.html#a085f07bc1100332366a5675145f8fea9">NID_pkcs7_signed</a>)</div>
<div class="line">                mdalgs = cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#aa4afa3c04a5347cfe6f27f4fe2aa94d0">signedData</a>-&gt;digestAlgorithms;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                mdalgs = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="asn1_8h.html#a78c99cbbb90fbb7aed945f72eb25c980">SMIME_write_ASN1</a>(bio, (<a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> *)cms, data, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>,</div>
<div class="line">                                        ctype_nid, econt_nid, mdalgs,</div>
<div class="line">                                        <a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(<a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a>));       </div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a86f8e8f6e4c410be96765c142445ff99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STACK_OF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00544">544</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *certs = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a> *cch;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a>) **pcerts;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        pcerts = cms_get0_certificate_choices(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!pcerts)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a809f17e57bc4cd94f16649dbd6301fc0">sk_CMS_CertificateChoices_num</a>(*pcerts); i++)</div>
<div class="line">                {</div>
<div class="line">                cch = <a class="code" href="safestack_8h.html#a2c8ace5f3a7bb9a157622cf42340c1fa">sk_CMS_CertificateChoices_value</a>(*pcerts, i);</div>
<div class="line">                <span class="keywordflow">if</span> (cch-&gt;<a class="code" href="structCMS__CertificateChoices.html#af446184e0fdd56690ad06c6c4a0dba5c">type</a> == 0)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (!certs)</div>
<div class="line">                                {</div>
<div class="line">                                certs = <a class="code" href="safestack_8h.html#a44ae44bd51bbf3d40058762ac4f0d377">sk_X509_new_null</a>();</div>
<div class="line">                                <span class="keywordflow">if</span> (!certs)</div>
<div class="line">                                        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#a725eaf517607b2a1c8be5c25c8771003">sk_X509_push</a>(certs, cch-&gt;<a class="code" href="structCMS__CertificateChoices.html#a9d8fa9df292b45f229970f4a41273cff">d</a>.<a class="code" href="structCMS__CertificateChoices.html#a73bb916b33aef426bc1d27b8261feaeb">certificate</a>))</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="safestack_8h.html#a9f351ddac9a3f1d94fcdfacfc9083312">sk_X509_pop_free</a>(certs, X509_free);</div>
<div class="line">                                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                                }</div>
<div class="line">                        <a class="code" href="crypto_8h.html#ab8556c4f12443f1876ce487dd0c8db27">CRYPTO_add</a>(&amp;cch-&gt;<a class="code" href="structCMS__CertificateChoices.html#a9d8fa9df292b45f229970f4a41273cff">d</a>.<a class="code" href="structCMS__CertificateChoices.html#a73bb916b33aef426bc1d27b8261feaeb">certificate</a>-&gt;<a class="code" href="structx509__st.html#ab1114b325664bca1cdfd6854f247a4d5">references</a>,</div>
<div class="line">                                                1, <a class="code" href="crypto_8h.html#abcd6591ef6acea51bf9f6edb6bb05bca">CRYPTO_LOCK_X509</a>);</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> certs;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af38c10f1531317974f19062a90fea4b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STACK_OF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00140">140</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__EnvelopedData__st.html">CMS_EnvelopedData</a> *env;</div>
<div class="line">        env = <a class="code" href="cms__env_8c.html#a904bcd4685600e69c9cadfc48e4c3e7c">cms_get0_enveloped</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!env)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">return</span> env-&gt;recipientInfos;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae1c0071645cb5cdab38d7a940ec49b23"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STACK_OF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00577">577</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structX509__crl__st.html">X509_CRL</a>) *crls = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__RevocationInfoChoice__st.html">CMS_RevocationInfoChoice</a>) **pcrls;</div>
<div class="line">        <a class="code" href="structCMS__RevocationInfoChoice__st.html">CMS_RevocationInfoChoice</a> *rch;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        pcrls = cms_get0_revocation_choices(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!pcrls)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a0119585c093d2e4f8b9450c80e846cc8">sk_CMS_RevocationInfoChoice_num</a>(*pcrls); i++)</div>
<div class="line">                {</div>
<div class="line">                rch = <a class="code" href="safestack_8h.html#aac93bdb7f24c7c738366f9cef3d7cbcc">sk_CMS_RevocationInfoChoice_value</a>(*pcrls, i);</div>
<div class="line">                <span class="keywordflow">if</span> (rch-&gt;<a class="code" href="structCMS__RevocationInfoChoice__st.html#a97c3144337544cb6c734b324939b74d7">type</a> == 0)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (!crls)</div>
<div class="line">                                {</div>
<div class="line">                                crls = <a class="code" href="safestack_8h.html#a83712bb061837263f2e6458373140f60">sk_X509_CRL_new_null</a>();</div>
<div class="line">                                <span class="keywordflow">if</span> (!crls)</div>
<div class="line">                                        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#a7224ae8175823920f5a786351e74961d">sk_X509_CRL_push</a>(crls, rch-&gt;<a class="code" href="structCMS__RevocationInfoChoice__st.html#a7bc8b06bbdb92b5d7e7ebf21bf08e7de">d</a>.<a class="code" href="structCMS__RevocationInfoChoice__st.html#ad7af71309ed9d760419b9f4d722ead46">crl</a>))</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="safestack_8h.html#a3777ee7a3d1530421f5e57afbe41adbb">sk_X509_CRL_pop_free</a>(crls, X509_CRL_free);</div>
<div class="line">                                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                                }</div>
<div class="line">                        <a class="code" href="crypto_8h.html#ab8556c4f12443f1876ce487dd0c8db27">CRYPTO_add</a>(&amp;rch-&gt;<a class="code" href="structCMS__RevocationInfoChoice__st.html#a7bc8b06bbdb92b5d7e7ebf21bf08e7de">d</a>.<a class="code" href="structCMS__RevocationInfoChoice__st.html#ad7af71309ed9d760419b9f4d722ead46">crl</a>-&gt;<a class="code" href="structX509__crl__st.html#aa143dabd3c77e3ef347835fc2f92b5a8">references</a>,</div>
<div class="line">                                                1, <a class="code" href="crypto_8h.html#acc0c636f451144eadad19883527a0a1a">CRYPTO_LOCK_X509_CRL</a>);</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> crls;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a886d105de38166c73da9baa1d01153ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STACK_OF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00492">492</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__SignedData__st.html">CMS_SignedData</a> *sd;</div>
<div class="line">        sd = cms_get0_signed(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!sd)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">return</span> sd-&gt;signerInfos;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a57282c85361b0236945d82ca60e4e22a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STACK_OF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#aea929bebf778a99c3f2c6b5151850fc8">CMS_RecipientEncryptedKey</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__kari_8c_source.html#l00090">90</a> of file <a class="el" href="cms__kari_8c_source.html">cms_kari.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;type != <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a649b88a59acb6c0ada5c46c8e02e3d1b">CMS_F_CMS_RECIPIENTINFO_KARI_GET0_REKS</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#a3dafd7ae00cc336b974db955156f890f">CMS_R_NOT_KEY_AGREEMENT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> ri-&gt;d.kari-&gt;recipientEncryptedKeys;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
