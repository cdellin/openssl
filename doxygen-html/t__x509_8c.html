<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/asn1/t_x509.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_4789766cb6a80a806f336711a14ff3d1.html">asn1</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">t_x509.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="cryptlib_8h_source.html">cryptlib.h</a>&quot;</code><br/>
<code>#include &lt;openssl/buffer.h&gt;</code><br/>
<code>#include &lt;openssl/bn.h&gt;</code><br/>
<code>#include &lt;openssl/rsa.h&gt;</code><br/>
<code>#include &lt;openssl/dsa.h&gt;</code><br/>
<code>#include &lt;openssl/ec.h&gt;</code><br/>
<code>#include &lt;openssl/objects.h&gt;</code><br/>
<code>#include &lt;openssl/x509.h&gt;</code><br/>
<code>#include &lt;openssl/x509v3.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="asn1__locl_8h_source.html">asn1_locl.h</a>&quot;</code><br/>
</div>
<p><a href="t__x509_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3b71ccfcc6da2300749255927750feef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="t__x509_8c.html#a3b71ccfcc6da2300749255927750feef">X509_print_fp</a> (FILE *<a class="el" href="conf_8h.html#aa065f30aa9f5f9a42132c82c787ee70b">fp</a>, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)</td></tr>
<tr class="memitem:a591ef0dd8ebbd54a2bdf666046a8dd62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="t__x509_8c.html#a591ef0dd8ebbd54a2bdf666046a8dd62">X509_print_ex_fp</a> (FILE *<a class="el" href="conf_8h.html#aa065f30aa9f5f9a42132c82c787ee70b">fp</a>, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, unsigned long nmflag, unsigned long <a class="el" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a>)</td></tr>
<tr class="memitem:a3334cd2019f6197e4a2be131fd6932ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="t__x509_8c.html#a3334cd2019f6197e4a2be131fd6932ff">X509_print</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)</td></tr>
<tr class="memitem:af52f29e9cada747b7e736b995770e2cd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="t__x509_8c.html#af52f29e9cada747b7e736b995770e2cd">X509_print_ex</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, unsigned long nmflags, unsigned long <a class="el" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a>)</td></tr>
<tr class="memitem:afe3181432ee09e8bf31321389bbc58f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="t__x509_8c.html#afe3181432ee09e8bf31321389bbc58f8">X509_ocspid_print</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)</td></tr>
<tr class="memitem:a4dbd1e03d8806b59605ba17f596eb6fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="t__x509_8c.html#a4dbd1e03d8806b59605ba17f596eb6fe">X509_signature_dump</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>, const <a class="el" href="ossl__typ_8h.html#ad37610875e38aa6c59f5e6e0b437e65c">ASN1_STRING</a> *sig, int indent)</td></tr>
<tr class="memitem:a1d852fdf5ad040f62dcdc271e190ce8c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="t__x509_8c.html#a1d852fdf5ad040f62dcdc271e190ce8c">X509_signature_print</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>, <a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> *sigalg, <a class="el" href="ossl__typ_8h.html#ad37610875e38aa6c59f5e6e0b437e65c">ASN1_STRING</a> *sig)</td></tr>
<tr class="memitem:a15c83054ff641f25461f09834ba531dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="t__x509_8c.html#a15c83054ff641f25461f09834ba531dc">ASN1_STRING_print</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>, const <a class="el" href="ossl__typ_8h.html#ad37610875e38aa6c59f5e6e0b437e65c">ASN1_STRING</a> *v)</td></tr>
<tr class="memitem:a158fe64ea7c3fb477b83c8e3ede27bf5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="t__x509_8c.html#a158fe64ea7c3fb477b83c8e3ede27bf5">ASN1_TIME_print</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>, const <a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *tm)</td></tr>
<tr class="memitem:aa341de9f830256349cc0d05c738a5b4b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="t__x509_8c.html#aa341de9f830256349cc0d05c738a5b4b">ASN1_GENERALIZEDTIME_print</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>, const <a class="el" href="ossl__typ_8h.html#abd19ea5b527807ce3a516e6a41440f84">ASN1_GENERALIZEDTIME</a> *tm)</td></tr>
<tr class="memitem:a0bc525802900b85ab5b2ff9776c6490e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="t__x509_8c.html#a0bc525802900b85ab5b2ff9776c6490e">ASN1_UTCTIME_print</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>, const <a class="el" href="ossl__typ_8h.html#af919cffc24215ead48adbe4eb24f8370">ASN1_UTCTIME</a> *tm)</td></tr>
<tr class="memitem:a7c9f3d2421ff2af59d300662a80c4351"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="t__x509_8c.html#a7c9f3d2421ff2af59d300662a80c4351">X509_NAME_print</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>, <a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> *name, int obase)</td></tr>
</table>
<h2>Function Documentation</h2>
<a class="anchor" id="aa341de9f830256349cc0d05c738a5b4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ASN1_GENERALIZEDTIME_print </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#abd19ea5b527807ce3a516e6a41440f84">ASN1_GENERALIZEDTIME</a> *&#160;</td>
          <td class="paramname"><em>tm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="t__x509_8c_source.html#l00404">404</a> of file <a class="el" href="t__x509_8c_source.html">t_x509.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">char</span> *v;</div>
<div class="line">        <span class="keywordtype">int</span> gmt=0;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">int</span> y=0,M=0,d=0,<a class="code" href="ec__curve_8c.html#a5138e082c1d42b393c076f8f796b3c96">h</a>=0,m=0,s=0;</div>
<div class="line">        <span class="keywordtype">char</span> *f = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> f_len = 0;</div>
<div class="line"></div>
<div class="line">        i=tm-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>;</div>
<div class="line">        v=(<span class="keywordtype">char</span> *)tm-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>;</div>
<div class="line"></div>
<div class="line">        if (i &lt; 12) <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (v[i-1] == <span class="charliteral">&#39;Z&#39;</span>) gmt=1;</div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i&lt;12; i++)</div>
<div class="line">                <span class="keywordflow">if</span> ((v[i] &gt; <span class="charliteral">&#39;9&#39;</span>) || (v[i] &lt; <span class="charliteral">&#39;0&#39;</span>)) <span class="keywordflow">goto</span> err;</div>
<div class="line">        y= (v[0]-<span class="charliteral">&#39;0&#39;</span>)*1000+(v[1]-<span class="charliteral">&#39;0&#39;</span>)*100 + (v[2]-<span class="charliteral">&#39;0&#39;</span>)*10+(v[3]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">        M= (v[4]-<span class="charliteral">&#39;0&#39;</span>)*10+(v[5]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> ((M &gt; 12) || (M &lt; 1)) <span class="keywordflow">goto</span> err;</div>
<div class="line">        d= (v[6]-<span class="charliteral">&#39;0&#39;</span>)*10+(v[7]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">        <a class="code" href="ec__curve_8c.html#a5138e082c1d42b393c076f8f796b3c96">h</a>= (v[8]-<span class="charliteral">&#39;0&#39;</span>)*10+(v[9]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">        m=  (v[10]-<span class="charliteral">&#39;0&#39;</span>)*10+(v[11]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (tm-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a> &gt;= 14 &amp;&amp;</div>
<div class="line">            (v[12] &gt;= <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (v[12] &lt;= <span class="charliteral">&#39;9&#39;</span>) &amp;&amp;</div>
<div class="line">            (v[13] &gt;= <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (v[13] &lt;= <span class="charliteral">&#39;9&#39;</span>))</div>
<div class="line">                {</div>
<div class="line">                s=  (v[12]-<span class="charliteral">&#39;0&#39;</span>)*10+(v[13]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">                <span class="comment">/* Check for fractions of seconds. */</span></div>
<div class="line">                <span class="keywordflow">if</span> (tm-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a> &gt;= 15 &amp;&amp; v[14] == <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordtype">int</span> l = tm-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>;</div>
<div class="line">                        f = &amp;v[14];     <span class="comment">/* The decimal point. */</span></div>
<div class="line">                        f_len = 1;</div>
<div class="line">                        <span class="keywordflow">while</span> (14 + f_len &lt; l &amp;&amp; f[f_len] &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; f[f_len] &lt;= <span class="charliteral">&#39;9&#39;</span>)</div>
<div class="line">                                ++f_len;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;%s %2d %02d:%02d:%02d%.*s %d%s&quot;</span>,</div>
<div class="line">                mon[M-1],d,<a class="code" href="ec__curve_8c.html#a5138e082c1d42b393c076f8f796b3c96">h</a>,m,s,f_len,f,y,(gmt)?<span class="stringliteral">&quot; GMT&quot;</span>:<span class="stringliteral">&quot;&quot;</span>) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">return</span>(0);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span>(1);</div>
<div class="line">err:</div>
<div class="line">        <a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;Bad time value&quot;</span>,14);</div>
<div class="line">        <span class="keywordflow">return</span>(0);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a15c83054ff641f25461f09834ba531dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ASN1_STRING_print </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#ad37610875e38aa6c59f5e6e0b437e65c">ASN1_STRING</a> *&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="t__x509_8c_source.html#l00359">359</a> of file <a class="el" href="t__x509_8c_source.html">t_x509.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> i,n;</div>
<div class="line">        <span class="keywordtype">char</span> buf[80];</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *p;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (v == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <span class="keywordflow">return</span>(0);</div>
<div class="line">        n=0;</div>
<div class="line">        p=(<span class="keyword">const</span> <span class="keywordtype">char</span> *)v-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>;</div>
<div class="line">        for (i=0; i&lt;v-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>; i++)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> ((p[i] &gt; <span class="charliteral">&#39;~&#39;</span>) || ((p[i] &lt; <span class="charliteral">&#39; &#39;</span>) &amp;&amp;</div>
<div class="line">                        (p[i] != <span class="charliteral">&#39;\n&#39;</span>) &amp;&amp; (p[i] != <span class="charliteral">&#39;\r&#39;</span>)))</div>
<div class="line">                        buf[n]=<span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        buf[n]=p[i];</div>
<div class="line">                n++;</div>
<div class="line">                <span class="keywordflow">if</span> (n &gt;= 80)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,buf,n) &lt;= 0)</div>
<div class="line">                                <span class="keywordflow">return</span>(0);</div>
<div class="line">                        n=0;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (n &gt; 0)</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,buf,n) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">return</span>(0);</div>
<div class="line">        <span class="keywordflow">return</span>(1);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a158fe64ea7c3fb477b83c8e3ede27bf5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ASN1_TIME_print </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *&#160;</td>
          <td class="paramname"><em>tm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="t__x509_8c_source.html#l00389">389</a> of file <a class="el" href="t__x509_8c_source.html">t_x509.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(tm-&gt;<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a> == <a class="code" href="asn1_8h.html#a2a8dd01504f7ee166a07e05cb0707634">V_ASN1_UTCTIME</a>) <span class="keywordflow">return</span> <a class="code" href="asn1_8h.html#a588242fd14e1a75b7114b708b8fc77e4">ASN1_UTCTIME_print</a>(bp, tm);</div>
<div class="line">        <span class="keywordflow">if</span>(tm-&gt;<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a> == <a class="code" href="asn1_8h.html#a7ec32dd2efb9a8765ccd91b2ab0721a3">V_ASN1_GENERALIZEDTIME</a>)</div>
<div class="line">                                <span class="keywordflow">return</span> <a class="code" href="asn1_8h.html#a3dbbb0e03c42355bd43f75cd40f67d2c">ASN1_GENERALIZEDTIME_print</a>(bp, tm);</div>
<div class="line">        <a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;Bad time value&quot;</span>,14);</div>
<div class="line">        <span class="keywordflow">return</span>(0);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0bc525802900b85ab5b2ff9776c6490e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ASN1_UTCTIME_print </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#af919cffc24215ead48adbe4eb24f8370">ASN1_UTCTIME</a> *&#160;</td>
          <td class="paramname"><em>tm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="t__x509_8c_source.html#l00452">452</a> of file <a class="el" href="t__x509_8c_source.html">t_x509.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *v;</div>
<div class="line">        <span class="keywordtype">int</span> gmt=0;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">int</span> y=0,M=0,d=0,<a class="code" href="ec__curve_8c.html#a5138e082c1d42b393c076f8f796b3c96">h</a>=0,m=0,s=0;</div>
<div class="line"></div>
<div class="line">        i=tm-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>;</div>
<div class="line">        v=(<span class="keyword">const</span> <span class="keywordtype">char</span> *)tm-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>;</div>
<div class="line"></div>
<div class="line">        if (i &lt; 10) <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (v[i-1] == <span class="charliteral">&#39;Z&#39;</span>) gmt=1;</div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i&lt;10; i++)</div>
<div class="line">                <span class="keywordflow">if</span> ((v[i] &gt; <span class="charliteral">&#39;9&#39;</span>) || (v[i] &lt; <span class="charliteral">&#39;0&#39;</span>)) <span class="keywordflow">goto</span> err;</div>
<div class="line">        y= (v[0]-<span class="charliteral">&#39;0&#39;</span>)*10+(v[1]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (y &lt; 50) y+=100;</div>
<div class="line">        M= (v[2]-<span class="charliteral">&#39;0&#39;</span>)*10+(v[3]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> ((M &gt; 12) || (M &lt; 1)) <span class="keywordflow">goto</span> err;</div>
<div class="line">        d= (v[4]-<span class="charliteral">&#39;0&#39;</span>)*10+(v[5]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">        <a class="code" href="ec__curve_8c.html#a5138e082c1d42b393c076f8f796b3c96">h</a>= (v[6]-<span class="charliteral">&#39;0&#39;</span>)*10+(v[7]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">        m=  (v[8]-<span class="charliteral">&#39;0&#39;</span>)*10+(v[9]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (tm-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a> &gt;=12 &amp;&amp;</div>
<div class="line">            (v[10] &gt;= <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (v[10] &lt;= <span class="charliteral">&#39;9&#39;</span>) &amp;&amp;</div>
<div class="line">            (v[11] &gt;= <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (v[11] &lt;= <span class="charliteral">&#39;9&#39;</span>))</div>
<div class="line">                s=  (v[10]-<span class="charliteral">&#39;0&#39;</span>)*10+(v[11]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;%s %2d %02d:%02d:%02d %d%s&quot;</span>,</div>
<div class="line">                mon[M-1],d,<a class="code" href="ec__curve_8c.html#a5138e082c1d42b393c076f8f796b3c96">h</a>,m,s,y+1900,(gmt)?<span class="stringliteral">&quot; GMT&quot;</span>:<span class="stringliteral">&quot;&quot;</span>) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">return</span>(0);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span>(1);</div>
<div class="line">err:</div>
<div class="line">        <a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;Bad time value&quot;</span>,14);</div>
<div class="line">        <span class="keywordflow">return</span>(0);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7c9f3d2421ff2af59d300662a80c4351"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_NAME_print </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>obase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="t__x509_8c_source.html#l00488">488</a> of file <a class="el" href="t__x509_8c_source.html">t_x509.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">char</span> *s,*<a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>,*<a class="code" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>;</div>
<div class="line">        <span class="keywordtype">int</span> ret=0,l,i;</div>
<div class="line"></div>
<div class="line">        l=80-2-obase;</div>
<div class="line"></div>
<div class="line">        b=<a class="code" href="x509_8h.html#a5f4ca5972b28da5c63da204422fb9636">X509_NAME_oneline</a>(name,<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>,0);</div>
<div class="line">        <span class="keywordflow">if</span> (!*b)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(b);</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line">        s=b+1; <span class="comment">/* skip the first slash */</span></div>
<div class="line"></div>
<div class="line">        c=s;</div>
<div class="line">        <span class="keywordflow">for</span> (;;)</div>
<div class="line">                {</div>
<div class="line"><span class="preprocessor">#ifndef CHARSET_EBCDIC</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">if</span> (    ((*s == <span class="charliteral">&#39;/&#39;</span>) &amp;&amp;</div>
<div class="line">                                ((s[1] &gt;= <span class="charliteral">&#39;A&#39;</span>) &amp;&amp; (s[1] &lt;= <span class="charliteral">&#39;Z&#39;</span>) &amp;&amp; (</div>
<div class="line">                                        (s[2] == <span class="charliteral">&#39;=&#39;</span>) ||</div>
<div class="line">                                        ((s[2] &gt;= <span class="charliteral">&#39;A&#39;</span>) &amp;&amp; (s[2] &lt;= <span class="charliteral">&#39;Z&#39;</span>) &amp;&amp;</div>
<div class="line">                                        (s[3] == <span class="charliteral">&#39;=&#39;</span>))</div>
<div class="line">                                 ))) ||</div>
<div class="line">                        (*s == <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">if</span> (    ((*s == <span class="charliteral">&#39;/&#39;</span>) &amp;&amp;</div>
<div class="line">                                (isupper(s[1]) &amp;&amp; (</div>
<div class="line">                                        (s[2] == <span class="charliteral">&#39;=&#39;</span>) ||</div>
<div class="line">                                        (isupper(s[2]) &amp;&amp;</div>
<div class="line">                                        (s[3] == <span class="charliteral">&#39;=&#39;</span>))</div>
<div class="line">                                 ))) ||</div>
<div class="line">                        (*s == <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                        {</div>
<div class="line">                        i=s-c;</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,c,i) != i) <span class="keywordflow">goto</span> err;</div>
<div class="line">                        c=s+1;  <span class="comment">/* skip following slash */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (*s != <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line">                                {</div>
<div class="line">                                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;, &quot;</span>,2) != 2) <span class="keywordflow">goto</span> err;</div>
<div class="line">                                }</div>
<div class="line">                        l--;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;\0&#39;</span>) <span class="keywordflow">break</span>;</div>
<div class="line">                s++;</div>
<div class="line">                l--;</div>
<div class="line">                }</div>
<div class="line">        </div>
<div class="line">        ret=1;</div>
<div class="line">        <span class="keywordflow">if</span> (0)</div>
<div class="line">                {</div>
<div class="line">err:</div>
<div class="line">                <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a17a6b3229fdb39a590efe543b4d79caf">X509_F_X509_NAME_PRINT</a>,<a class="code" href="err_8h.html#a04f1ebca61c5a9b5c9cd20ae820ea448">ERR_R_BUF_LIB</a>);</div>
<div class="line">                }</div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(b);</div>
<div class="line">        <span class="keywordflow">return</span>(ret);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afe3181432ee09e8bf31321389bbc58f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_ocspid_print </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="t__x509_8c_source.html#l00264">264</a> of file <a class="el" href="t__x509_8c_source.html">t_x509.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *der=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *dertmp;</div>
<div class="line">        <span class="keywordtype">int</span> derlen;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> SHA1md[<a class="code" href="sha_8h.html#a1a715db7b4403fe6c165e49a32f5fe3d">SHA_DIGEST_LENGTH</a>];</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* display the hash of the subject as it would appear</span></div>
<div class="line"><span class="comment">           in OCSP requests */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;        Subject OCSP hash: &quot;</span>) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        derlen = i2d_X509_NAME(x-&gt;<a class="code" href="structx509__st.html#abbae6a9fb14b3145b04b98f24128be71">cert_info</a>-&gt;<a class="code" href="structx509__cinf__st.html#acb4d49364d293a9f6166ce759965ac54">subject</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        <span class="keywordflow">if</span> ((der = dertmp = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a> (derlen)) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        i2d_X509_NAME(x-&gt;<a class="code" href="structx509__st.html#abbae6a9fb14b3145b04b98f24128be71">cert_info</a>-&gt;<a class="code" href="structx509__cinf__st.html#acb4d49364d293a9f6166ce759965ac54">subject</a>, &amp;dertmp);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="digest_8c.html#aaf1dcfa403148677376101633deb9025">EVP_Digest</a>(der, derlen, SHA1md, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="evp_8h.html#aa090d659a494a10525e38d272efb01ae">EVP_sha1</a>(), <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i &lt; <a class="code" href="sha_8h.html#a1a715db7b4403fe6c165e49a32f5fe3d">SHA_DIGEST_LENGTH</a>; i++)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;%02X&quot;</span>,SHA1md[i]) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a> (der);</div>
<div class="line">        der=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* display the hash of the public key as it would appear</span></div>
<div class="line"><span class="comment">           in OCSP requests */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;\n        Public key OCSP hash: &quot;</span>) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="digest_8c.html#aaf1dcfa403148677376101633deb9025">EVP_Digest</a>(x-&gt;<a class="code" href="structx509__st.html#abbae6a9fb14b3145b04b98f24128be71">cert_info</a>-&gt;<a class="code" href="structx509__cinf__st.html#ad4ae834b88db41b67f7c54193267cd34">key</a>-&gt;<a class="code" href="structX509__pubkey__st.html#ae2fae3c3fa6b2d0a28b5873da1361250">public_key</a>-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>,</div>
<div class="line">                        x-&gt;<a class="code" href="structx509__st.html#abbae6a9fb14b3145b04b98f24128be71">cert_info</a>-&gt;<a class="code" href="structx509__cinf__st.html#ad4ae834b88db41b67f7c54193267cd34">key</a>-&gt;<a class="code" href="structX509__pubkey__st.html#ae2fae3c3fa6b2d0a28b5873da1361250">public_key</a>-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>,</div>
<div class="line">                        SHA1md, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="evp_8h.html#aa090d659a494a10525e38d272efb01ae">EVP_sha1</a>(), <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i &lt; <a class="code" href="sha_8h.html#a1a715db7b4403fe6c165e49a32f5fe3d">SHA_DIGEST_LENGTH</a>; i++)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;%02X&quot;</span>,SHA1md[i]) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> (1);</div>
<div class="line">err:</div>
<div class="line">        <span class="keywordflow">if</span> (der != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(der);</div>
<div class="line">        <span class="keywordflow">return</span>(0);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3334cd2019f6197e4a2be131fd6932ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_print </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="t__x509_8c_source.html#l00100">100</a> of file <a class="el" href="t__x509_8c_source.html">t_x509.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="t__x509_8c.html#af52f29e9cada747b7e736b995770e2cd">X509_print_ex</a>(bp, x, <a class="code" href="x509_8h.html#a6d6f2876d75ff35a1950da77d4546b31">XN_FLAG_COMPAT</a>, <a class="code" href="x509_8h.html#a9d0c659e07efcd86a40b07fafffe3eba">X509_FLAG_COMPAT</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af52f29e9cada747b7e736b995770e2cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_print_ex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>nmflags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>cflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="t__x509_8c_source.html#l00105">105</a> of file <a class="el" href="t__x509_8c_source.html">t_x509.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">long</span> l;</div>
<div class="line">        <span class="keywordtype">int</span> ret=0,i;</div>
<div class="line">        <span class="keywordtype">char</span> *m=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>,mlch = <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line">        <span class="keywordtype">int</span> nmindent = 0;</div>
<div class="line">        <a class="code" href="structx509__cinf__st.html">X509_CINF</a> *ci;</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_INTEGER</a> *bs;</div>
<div class="line">        <a class="code" href="structevp__pkey__st.html">EVP_PKEY</a> *pkey=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *neg;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>((nmflags &amp; <a class="code" href="x509_8h.html#a1b1689a5bc2f58988606fe68762df1c3">XN_FLAG_SEP_MASK</a>) == <a class="code" href="x509_8h.html#a98d4a052476c4cb69a6a03d4b5df12e3">XN_FLAG_SEP_MULTILINE</a>) {</div>
<div class="line">                        mlch = <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">                        nmindent = 12;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(nmflags == <a class="code" href="x509_8h.html#a9d0c659e07efcd86a40b07fafffe3eba">X509_FLAG_COMPAT</a>)</div>
<div class="line">                nmindent = 16;</div>
<div class="line"></div>
<div class="line">        ci=x-&gt;<a class="code" href="structx509__st.html#abbae6a9fb14b3145b04b98f24128be71">cert_info</a>;</div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a> &amp; <a class="code" href="x509_8h.html#af21169b1b0a88be5e0f1ec8dacbb1071">X509_FLAG_NO_HEADER</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;Certificate:\n&quot;</span>,13) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;    Data:\n&quot;</span>,10) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a> &amp; <a class="code" href="x509_8h.html#a2fb551b8e0506a7727bde3cc3560e597">X509_FLAG_NO_VERSION</a>))</div>
<div class="line">                {</div>
<div class="line">                l=<a class="code" href="x509_8h.html#a14789fcbbf4dac2c595097be489736ed">X509_get_version</a>(x);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;%8sVersion: %lu (0x%lx)\n&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,l+1,l) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a> &amp; <a class="code" href="x509_8h.html#a453733d395c9f471c8c924d06ccb5d31">X509_FLAG_NO_SERIAL</a>))</div>
<div class="line">                {</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;        Serial Number:&quot;</span>,22) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">                bs=<a class="code" href="x509_8h.html#a667af4dd51a9a8cafefc3f6fb8fc23b8">X509_get_serialNumber</a>(x);</div>
<div class="line">                <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a> &lt;= (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">long</span>))</div>
<div class="line">                        {</div>
<div class="line">                        l=<a class="code" href="a__int_8c.html#a393b205ec62b7ebe476c20c523e44d12">ASN1_INTEGER_get</a>(bs);</div>
<div class="line">                        <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a> == <a class="code" href="asn1_8h.html#a5a0bb74c35cee59ea1ee2c64cd396a8e">V_ASN1_NEG_INTEGER</a>)</div>
<div class="line">                                {</div>
<div class="line">                                l= -l;</div>
<div class="line">                                neg=<span class="stringliteral">&quot;-&quot;</span>;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                                neg=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot; %s%lu (%s0x%lx)\n&quot;</span>,neg,l,neg,l) &lt;= 0)</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                        neg=(bs-&gt;<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a> == <a class="code" href="asn1_8h.html#a5a0bb74c35cee59ea1ee2c64cd396a8e">V_ASN1_NEG_INTEGER</a>)?<span class="stringliteral">&quot; (Negative)&quot;</span>:<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;\n%12s%s&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,neg) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">for</span> (i=0; i&lt;bs-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>; i++)</div>
<div class="line">                                {</div>
<div class="line">                                <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;%02x%c&quot;</span>,bs-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>[i],</div>
<div class="line">                                        ((i+1 == bs-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>)?<span class="charliteral">&#39;\n&#39;</span>:<span class="charliteral">&#39;:&#39;</span>)) &lt;= 0)</div>
<div class="line">                                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a> &amp; <a class="code" href="x509_8h.html#a6fea8842b3bb319d3b6bb36985de3328">X509_FLAG_NO_SIGNAME</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span>(<a class="code" href="t__x509_8c.html#a1d852fdf5ad040f62dcdc271e190ce8c">X509_signature_print</a>(bp, x-&gt;<a class="code" href="structx509__st.html#a90d06c88fff740923082fa98b7b86b27">sig_alg</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="preprocessor">#if 0</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;%8sSignature Algorithm: &quot;</span>,<span class="stringliteral">&quot;&quot;</span>) &lt;= 0) </div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="a__object_8c.html#a9ab481e8e603f42dbcf6f256bdea39a5">i2a_ASN1_OBJECT</a>(bp, ci-&gt;<a class="code" href="structx509__cinf__st.html#a09006fd313228489ac13ebe6730c6362">signature</a>-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a>) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a69ef4de9bee4e518fbcebd999d1b3358">BIO_puts</a>(bp, <span class="stringliteral">&quot;\n&quot;</span>) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a> &amp; <a class="code" href="x509_8h.html#aea3ec300656a72d04b8317bae2a1b331">X509_FLAG_NO_ISSUER</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;        Issuer:%c&quot;</span>,mlch) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="a__strex_8c.html#a5deb7d6e18030dc66a61c22614e11411">X509_NAME_print_ex</a>(bp,<a class="code" href="x509_8h.html#ade3220b850537708545f660ee272d4e4">X509_get_issuer_name</a>(x),nmindent, nmflags) &lt; 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;\n&quot;</span>,1) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a> &amp; <a class="code" href="x509_8h.html#a93bae4e35946de530b98cac7d32e7fd7">X509_FLAG_NO_VALIDITY</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;        Validity\n&quot;</span>,17) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;            Not Before: &quot;</span>,24) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="asn1_8h.html#aa92fd40bc0d1b7efb3bc1aaaca81de49">ASN1_TIME_print</a>(bp,<a class="code" href="x509_8h.html#a55b3a02e67d4e7db8bce103d5e58b044">X509_get_notBefore</a>(x))) <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;\n            Not After : &quot;</span>,25) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="asn1_8h.html#aa92fd40bc0d1b7efb3bc1aaaca81de49">ASN1_TIME_print</a>(bp,<a class="code" href="x509_8h.html#a548f2ef91ebf8847b8fc3aa58d9c296d">X509_get_notAfter</a>(x))) <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;\n&quot;</span>,1) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a> &amp; <a class="code" href="x509_8h.html#ac8c2c4a9e4451b63f1866acb35bbcaf7">X509_FLAG_NO_SUBJECT</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;        Subject:%c&quot;</span>,mlch) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="a__strex_8c.html#a5deb7d6e18030dc66a61c22614e11411">X509_NAME_print_ex</a>(bp,<a class="code" href="x509_8h.html#aff52c219295ce864fb20f88050f9963c">X509_get_subject_name</a>(x),nmindent, nmflags) &lt; 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;\n&quot;</span>,1) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a> &amp; <a class="code" href="x509_8h.html#a322d37e122ea3b540e8f8dfce10ba477">X509_FLAG_NO_PUBKEY</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;        Subject Public Key Info:\n&quot;</span>,33) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;%12sPublic Key Algorithm: &quot;</span>,<span class="stringliteral">&quot;&quot;</span>) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="a__object_8c.html#a9ab481e8e603f42dbcf6f256bdea39a5">i2a_ASN1_OBJECT</a>(bp, ci-&gt;<a class="code" href="structx509__cinf__st.html#ad4ae834b88db41b67f7c54193267cd34">key</a>-&gt;<a class="code" href="structX509__pubkey__st.html#a0fb9c56d9396c7fffdb67e9c758be102">algor</a>-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a>) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a69ef4de9bee4e518fbcebd999d1b3358">BIO_puts</a>(bp, <span class="stringliteral">&quot;\n&quot;</span>) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">                pkey=<a class="code" href="x509_8h.html#a97c3703b14a1f4a987c5d31cdf6cb205">X509_get_pubkey</a>(x);</div>
<div class="line">                <span class="keywordflow">if</span> (pkey == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;%12sUnable to load Public Key\n&quot;</span>,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">                        <a class="code" href="err_8h.html#a7acfad1722fbc676a207323d785b61aa">ERR_print_errors</a>(bp);</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="evp_8h.html#a78621ea4b475b93b5ab1191895864cbf">EVP_PKEY_print_public</a>(bp, pkey, 16, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                        <a class="code" href="evp_8h.html#a448d9f9209a54694aff045d403850db7">EVP_PKEY_free</a>(pkey);</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a> &amp; <a class="code" href="x509_8h.html#a8110afd6d9515ddfb6bee0a3d8c50ba7">X509_FLAG_NO_IDS</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (ci-&gt;<a class="code" href="structx509__cinf__st.html#a39d82c3b8a147a5e8ed99ee24a79f791">issuerUID</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;%8sIssuer Unique ID: &quot;</span>,<span class="stringliteral">&quot;&quot;</span>) &lt;= 0) </div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        <span class="keywordflow">if</span> (!<a class="code" href="t__x509_8c.html#a4dbd1e03d8806b59605ba17f596eb6fe">X509_signature_dump</a>(bp, ci-&gt;<a class="code" href="structx509__cinf__st.html#a39d82c3b8a147a5e8ed99ee24a79f791">issuerUID</a>, 12))</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (ci-&gt;<a class="code" href="structx509__cinf__st.html#a5a8aba3df2b00582cee4b51ab9c9588a">subjectUID</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;%8sSubject Unique ID: &quot;</span>,<span class="stringliteral">&quot;&quot;</span>) &lt;= 0) </div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        <span class="keywordflow">if</span> (!<a class="code" href="t__x509_8c.html#a4dbd1e03d8806b59605ba17f596eb6fe">X509_signature_dump</a>(bp, ci-&gt;<a class="code" href="structx509__cinf__st.html#a5a8aba3df2b00582cee4b51ab9c9588a">subjectUID</a>, 12))</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(<a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a> &amp; <a class="code" href="x509_8h.html#af2e3f5da2f3dd9b228f4d0a2463b17fd">X509_FLAG_NO_EXTENSIONS</a>))</div>
<div class="line">                <a class="code" href="v3__prn_8c.html#a80dc0f354849ae93d05404b8a131dab4">X509V3_extensions_print</a>(bp, <span class="stringliteral">&quot;X509v3 extensions&quot;</span>,</div>
<div class="line">                                        ci-&gt;extensions, <a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a>, 8);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a> &amp; <a class="code" href="x509_8h.html#a5deff4f1ccfb3e834ce34d5ded772f54">X509_FLAG_NO_SIGDUMP</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span>(<a class="code" href="t__x509_8c.html#a1d852fdf5ad040f62dcdc271e190ce8c">X509_signature_print</a>(bp, x-&gt;<a class="code" href="structx509__st.html#a90d06c88fff740923082fa98b7b86b27">sig_alg</a>, x-&gt;<a class="code" href="structx509__st.html#a8a1e43923e1855fb1dbfe15730cd5e7f">signature</a>) &lt;= 0) <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a> &amp; <a class="code" href="x509_8h.html#ac68c565be90f11d08c2cac231a2a287d">X509_FLAG_NO_AUX</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="t__x509a_8c.html#a29dfd6927ddb0f81105edd854715c404">X509_CERT_AUX_print</a>(bp, x-&gt;<a class="code" href="structx509__st.html#aa65a773dc5963a057790ccc63ca0a169">aux</a>, 0)) <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        ret=1;</div>
<div class="line">err:</div>
<div class="line">        <span class="keywordflow">if</span> (m != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(m);</div>
<div class="line">        <span class="keywordflow">return</span>(ret);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a591ef0dd8ebbd54a2bdf666046a8dd62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_print_ex_fp </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>nmflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>cflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="t__x509_8c_source.html#l00083">83</a> of file <a class="el" href="t__x509_8c_source.html">t_x509.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *<a class="code" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>;</div>
<div class="line">        <span class="keywordtype">int</span> ret;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((b=<a class="code" href="bio_8h.html#a581a4f51e785ab7df2d032d38f589259">BIO_new</a>(<a class="code" href="bio_8h.html#a4091a209afb974a6c415dc754b6ec765">BIO_s_file</a>())) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a54af53f6bb6102968310d8811491f11d">X509_F_X509_PRINT_EX_FP</a>,<a class="code" href="err_8h.html#a04f1ebca61c5a9b5c9cd20ae820ea448">ERR_R_BUF_LIB</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(0);</div>
<div class="line">                }</div>
<div class="line">        <a class="code" href="bio_8h.html#ac10c60df288237b41b78857433bbbfe9">BIO_set_fp</a>(b,<a class="code" href="conf_8h.html#aa065f30aa9f5f9a42132c82c787ee70b">fp</a>,<a class="code" href="bio_8h.html#a1a7b8e855fc9a5c077b9da272c870517">BIO_NOCLOSE</a>);</div>
<div class="line">        ret=<a class="code" href="t__x509_8c.html#af52f29e9cada747b7e736b995770e2cd">X509_print_ex</a>(b, x, nmflag, <a class="code" href="des_8c.html#afbb9b1dda8ad9915e753c7a84be13489">cflag</a>);</div>
<div class="line">        <a class="code" href="bio_8h.html#abbfb67b5eb998ce232f2482b097da8b2">BIO_free</a>(b);</div>
<div class="line">        <span class="keywordflow">return</span>(ret);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3b71ccfcc6da2300749255927750feef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_print_fp </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="t__x509_8c_source.html#l00078">78</a> of file <a class="el" href="t__x509_8c_source.html">t_x509.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="t__x509_8c.html#a591ef0dd8ebbd54a2bdf666046a8dd62">X509_print_ex_fp</a>(<a class="code" href="conf_8h.html#aa065f30aa9f5f9a42132c82c787ee70b">fp</a>, x, <a class="code" href="x509_8h.html#a6d6f2876d75ff35a1950da77d4546b31">XN_FLAG_COMPAT</a>, <a class="code" href="x509_8h.html#a9d0c659e07efcd86a40b07fafffe3eba">X509_FLAG_COMPAT</a>);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4dbd1e03d8806b59605ba17f596eb6fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_signature_dump </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#ad37610875e38aa6c59f5e6e0b437e65c">ASN1_STRING</a> *&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>indent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="t__x509_8c_source.html#l00312">312</a> of file <a class="el" href="t__x509_8c_source.html">t_x509.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *s;</div>
<div class="line">        <span class="keywordtype">int</span> i, n;</div>
<div class="line"></div>
<div class="line">        n=sig-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>;</div>
<div class="line">        s=sig-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i&lt;n; i++)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> ((i%18) == 0)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;\n&quot;</span>,1) &lt;= 0) <span class="keywordflow">return</span> 0;</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a0d1ef94367a6ac4dad8886c661df4e1c">BIO_indent</a>(bp, indent, indent) &lt;= 0) <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(bp,<span class="stringliteral">&quot;%02x%s&quot;</span>,s[i],</div>
<div class="line">                                ((i+1) == n)?<span class="stringliteral">&quot;&quot;</span>:<span class="stringliteral">&quot;:&quot;</span>) &lt;= 0) <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(bp,<span class="stringliteral">&quot;\n&quot;</span>,1) != 1) <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1d852fdf5ad040f62dcdc271e190ce8c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_signature_print </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> *&#160;</td>
          <td class="paramname"><em>sigalg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ad37610875e38aa6c59f5e6e0b437e65c">ASN1_STRING</a> *&#160;</td>
          <td class="paramname"><em>sig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="t__x509_8c_source.html#l00334">334</a> of file <a class="el" href="t__x509_8c_source.html">t_x509.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> sig_nid;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a69ef4de9bee4e518fbcebd999d1b3358">BIO_puts</a>(bp,<span class="stringliteral">&quot;    Signature Algorithm: &quot;</span>) &lt;= 0) <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="a__object_8c.html#a9ab481e8e603f42dbcf6f256bdea39a5">i2a_ASN1_OBJECT</a>(bp, sigalg-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a>) &lt;= 0) <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        sig_nid = <a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(sigalg-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (sig_nid != <a class="code" href="obj__mac_8h.html#ad115d9b07ddf7f48ea5feb47299a8894">NID_undef</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordtype">int</span> pkey_nid, dig_nid;</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="structevp__pkey__asn1__method__st.html">EVP_PKEY_ASN1_METHOD</a> *ameth;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="obj__xref_8c.html#a16ed324be068159707f17e7b8eb8c65c">OBJ_find_sigid_algs</a>(sig_nid, &amp;dig_nid, &amp;pkey_nid))</div>
<div class="line">                        {</div>
<div class="line">                        ameth = <a class="code" href="ameth__lib_8c.html#a23406c37c74bde73467f569da758a34c">EVP_PKEY_asn1_find</a>(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, pkey_nid);</div>
<div class="line">                        <span class="keywordflow">if</span> (ameth &amp;&amp; ameth-&gt;<a class="code" href="structevp__pkey__asn1__method__st.html#a493f45e5a591d8b00c83fac69a604db6">sig_print</a>)</div>
<div class="line">                                <span class="keywordflow">return</span> ameth-&gt;<a class="code" href="structevp__pkey__asn1__method__st.html#a493f45e5a591d8b00c83fac69a604db6">sig_print</a>(bp, sigalg, sig, 9, 0);</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (sig)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="t__x509_8c.html#a4dbd1e03d8806b59605ba17f596eb6fe">X509_signature_dump</a>(bp, sig, 9);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a69ef4de9bee4e518fbcebd999d1b3358">BIO_puts</a>(bp, <span class="stringliteral">&quot;\n&quot;</span>) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
