<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/cms/cms_env.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_7882632c4dffce91474d1f2c5c940725.html">cms</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">cms_env.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="cryptlib_8h_source.html">cryptlib.h</a>&quot;</code><br/>
<code>#include &lt;openssl/asn1t.h&gt;</code><br/>
<code>#include &lt;openssl/pem.h&gt;</code><br/>
<code>#include &lt;openssl/x509v3.h&gt;</code><br/>
<code>#include &lt;openssl/err.h&gt;</code><br/>
<code>#include &lt;openssl/cms.h&gt;</code><br/>
<code>#include &lt;openssl/rand.h&gt;</code><br/>
<code>#include &lt;openssl/aes.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="asn1__locl_8h_source.html">asn1_locl.h</a>&quot;</code><br/>
</div>
<p><a href="cms__env_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a904bcd4685600e69c9cadfc48e4c3e7c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms__lcl_8h.html#a4cb65b7d7c915efc367f5e1e999440d9">CMS_EnvelopedData</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#a904bcd4685600e69c9cadfc48e4c3e7c">cms_get0_enveloped</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:ac35f315f7ccd6ac91196b3ec171dc0cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#ac35f315f7ccd6ac91196b3ec171dc0cc">cms_env_asn1_ctrl</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, int cmd)</td></tr>
<tr class="memitem:a719ae32943146855c021262d71a46233"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#a719ae32943146855c021262d71a46233">STACK_OF</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a>)</td></tr>
<tr class="memitem:a3ae6eeed24d48fa38986857810a09304"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#a3ae6eeed24d48fa38986857810a09304">CMS_RecipientInfo_type</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri)</td></tr>
<tr class="memitem:af0289104150559a8e0ea51f8111aafd1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#aaadbb75633e4460a52864970a3b875de">EVP_PKEY_CTX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#af0289104150559a8e0ea51f8111aafd1">CMS_RecipientInfo_get0_pkey_ctx</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri)</td></tr>
<tr class="memitem:a63d3912c2faa83a1c9330353c805ee19"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#a63d3912c2faa83a1c9330353c805ee19">CMS_EnvelopedData_create</a> (const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *cipher)</td></tr>
<tr class="memitem:aa0f430b3dda40a05acc7cf29bd4b93d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#aa0f430b3dda40a05acc7cf29bd4b93d8">CMS_add1_recipient_cert</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *recip, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a7a862d5cd26243bae2f833aed5a955c2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#a7a862d5cd26243bae2f833aed5a955c2">CMS_RecipientInfo_ktri_get0_algs</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> **pk, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> **recip, <a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **palg)</td></tr>
<tr class="memitem:a8f598cf775da0d77f02950fe395deac8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#a8f598cf775da0d77f02950fe395deac8">CMS_RecipientInfo_ktri_get0_signer_id</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **keyid, <a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> **issuer, <a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **sno)</td></tr>
<tr class="memitem:ab7a3b21a9d98942c07103ea081bee640"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#ab7a3b21a9d98942c07103ea081bee640">CMS_RecipientInfo_ktri_cert_cmp</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:a9677b76bdae4ef3dfb1da114a02b7093"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#a9677b76bdae4ef3dfb1da114a02b7093">CMS_RecipientInfo_set0_pkey</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *pkey)</td></tr>
<tr class="memitem:a3abd22c1ff8260d4935a428898030f92"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#a3abd22c1ff8260d4935a428898030f92">CMS_RecipientInfo_kekri_id_cmp</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, const unsigned char *id, size_t idlen)</td></tr>
<tr class="memitem:abc79183fe66f31806a18c02cd3b0c118"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#abc79183fe66f31806a18c02cd3b0c118">CMS_add0_recipient_key</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, int <a class="el" href="x509_8h.html#a7235ef62e89328f5155846dc59c6fc37">nid</a>, unsigned char *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, size_t keylen, unsigned char *id, size_t idlen, <a class="el" href="ossl__typ_8h.html#abd19ea5b527807ce3a516e6a41440f84">ASN1_GENERALIZEDTIME</a> *date, <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *otherTypeId, <a class="el" href="asn1_8h.html#a7895e03d9fee2bc4963faf2a31a9439e">ASN1_TYPE</a> *otherType)</td></tr>
<tr class="memitem:a5605ce2e902d1a84e651ef14a569e92a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#a5605ce2e902d1a84e651ef14a569e92a">CMS_RecipientInfo_kekri_get0_id</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **palg, <a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **pid, <a class="el" href="ossl__typ_8h.html#abd19ea5b527807ce3a516e6a41440f84">ASN1_GENERALIZEDTIME</a> **pdate, <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> **potherid, <a class="el" href="asn1_8h.html#a7895e03d9fee2bc4963faf2a31a9439e">ASN1_TYPE</a> **pothertype)</td></tr>
<tr class="memitem:abcbf7e892f737b18c52779d636143b14"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#abcbf7e892f737b18c52779d636143b14">CMS_RecipientInfo_set0_key</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, unsigned char *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, size_t keylen)</td></tr>
<tr class="memitem:a2db1d83492be468599b3be3452e98cc5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#a2db1d83492be468599b3be3452e98cc5">CMS_RecipientInfo_decrypt</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri)</td></tr>
<tr class="memitem:a44fec504f4ab356a6095f25527aabc46"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#a44fec504f4ab356a6095f25527aabc46">CMS_RecipientInfo_encrypt</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri)</td></tr>
<tr class="memitem:a40e7ed2550f0b34ee904c6576f08bc57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#a40e7ed2550f0b34ee904c6576f08bc57">cms_EnvelopedData_init_bio</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a4175d1c76c8093fb8a0f61c77a62fd86"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__env_8c.html#a4175d1c76c8093fb8a0f61c77a62fd86">cms_pkey_get_ri_type</a> (<a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *pk)</td></tr>
</table>
<h2>Function Documentation</h2>
<a class="anchor" id="abc79183fe66f31806a18c02cd3b0c118"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a>* CMS_add0_recipient_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>idlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#abd19ea5b527807ce3a516e6a41440f84">ASN1_GENERALIZEDTIME</a> *&#160;</td>
          <td class="paramname"><em>date</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *&#160;</td>
          <td class="paramname"><em>otherTypeId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="asn1_8h.html#a7895e03d9fee2bc4963faf2a31a9439e">ASN1_TYPE</a> *&#160;</td>
          <td class="paramname"><em>otherType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00564">564</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a> *ri = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structCMS__EnvelopedData__st.html">CMS_EnvelopedData</a> *env;</div>
<div class="line">        <a class="code" href="structCMS__KEKRecipientInfo__st.html">CMS_KEKRecipientInfo</a> *kekri;</div>
<div class="line">        env = <a class="code" href="cms__env_8c.html#a904bcd4685600e69c9cadfc48e4c3e7c">cms_get0_enveloped</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!env)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a> == <a class="code" href="obj__mac_8h.html#ad115d9b07ddf7f48ea5feb47299a8894">NID_undef</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">switch</span> (keylen)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">case</span> 16:</div>
<div class="line">                        <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a> = <a class="code" href="obj__mac_8h.html#a8cc0ccb8b81faeb60a81c0fbbbf52842">NID_id_aes128_wrap</a>;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">case</span>  24:</div>
<div class="line">                        <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a> = <a class="code" href="obj__mac_8h.html#a3bb82f36dff0dbecd25e14637f903741">NID_id_aes192_wrap</a>;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">case</span>  32:</div>
<div class="line">                        <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a> = <a class="code" href="obj__mac_8h.html#acb67f0c443c4a1ec2b2e501859397b84">NID_id_aes256_wrap</a>;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">default</span>:</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a8d53d170864f78c0dc99b2fbaa0957e7">CMS_F_CMS_ADD0_RECIPIENT_KEY</a>,</div>
<div class="line">                                                <a class="code" href="cms_8h.html#ad72973d78eacc1a9b5794588665614d2">CMS_R_INVALID_KEY_LENGTH</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line"></div>
<div class="line">                <span class="keywordtype">size_t</span> exp_keylen = aes_wrap_keylen(<a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (!exp_keylen)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a8d53d170864f78c0dc99b2fbaa0957e7">CMS_F_CMS_ADD0_RECIPIENT_KEY</a>,</div>
<div class="line">                                        <a class="code" href="cms_8h.html#a17e31d84518bd96633f70c05d3586b60">CMS_R_UNSUPPORTED_KEK_ALGORITHM</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (keylen != exp_keylen)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a8d53d170864f78c0dc99b2fbaa0957e7">CMS_F_CMS_ADD0_RECIPIENT_KEY</a>,</div>
<div class="line">                                        <a class="code" href="cms_8h.html#ad72973d78eacc1a9b5794588665614d2">CMS_R_INVALID_KEY_LENGTH</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initialize recipient info */</span></div>
<div class="line">        ri = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!ri)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line"></div>
<div class="line">        ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a> = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__KEKRecipientInfo__st.html">CMS_KEKRecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> = <a class="code" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>;</div>
<div class="line"></div>
<div class="line">        kekri = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (otherTypeId)</div>
<div class="line">                {</div>
<div class="line">                kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a> = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__OtherKeyAttribute__st.html">CMS_OtherKeyAttribute</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        <span class="keywordflow">goto</span> merr;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#abbb67eae173733f0fabb2d8c4f2c9f0a">sk_CMS_RecipientInfo_push</a>(env-&gt;recipientInfos, ri))</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* After this point no calls can fail */</span></div>
<div class="line"></div>
<div class="line">        kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a45bab15d4cf10c9f4cb739f3aacd606e">version</a> = 4;</div>
<div class="line"></div>
<div class="line">        kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#ac82292d2f82c4e2a01b18ce48cbced3d">key</a> = <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>;</div>
<div class="line">        kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#ad588a2c59910bbaa2e54e09d4de4144f">keylen</a> = keylen;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="asn1_8h.html#add085933f3a303f7c59acf0e9b072d63">ASN1_STRING_set0</a>(kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a62da3e7a25399bba4bb209bba467ad53">keyIdentifier</a>, <span class="keywordtype">id</span>, idlen);</div>
<div class="line"></div>
<div class="line">        kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#aa5dc596530ce6f9f57d2515085808aac">date</a> = date;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>)</div>
<div class="line">                {</div>
<div class="line">                kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>-&gt;<a class="code" href="structCMS__OtherKeyAttribute__st.html#ae77e87e21328fc0456d48c96a4d5b9ea">keyAttrId</a> = otherTypeId;</div>
<div class="line">                kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>-&gt;<a class="code" href="structCMS__OtherKeyAttribute__st.html#a09e2b7c3fa802c038198ba99dbc11406">keyAttr</a> = otherType;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="x509_8h.html#a5c289a6fbc3107fefb5dc6184b5b7cc4">X509_ALGOR_set0</a>(kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a5f51b5cad62639eafec3e3948e82784c">keyEncryptionAlgorithm</a>,</div>
<div class="line">                                <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>), <a class="code" href="asn1_8h.html#ae9ce601db9cb8ba6fa09b69d399d7475">V_ASN1_UNDEF</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> ri;</div>
<div class="line"></div>
<div class="line">        merr:</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a8d53d170864f78c0dc99b2fbaa0957e7">CMS_F_CMS_ADD0_RECIPIENT_KEY</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (ri)</div>
<div class="line">                <a class="code" href="asn1_8h.html#a64344e58b69188c21fd5ec2abe3a4a38">M_ASN1_free_of</a>(ri, <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa0f430b3dda40a05acc7cf29bd4b93d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a>* CMS_add1_recipient_cert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>recip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00240">240</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a> *ri = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structCMS__EnvelopedData__st.html">CMS_EnvelopedData</a> *env;</div>
<div class="line">        <a class="code" href="structevp__pkey__st.html">EVP_PKEY</a> *pk = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        env = <a class="code" href="cms__env_8c.html#a904bcd4685600e69c9cadfc48e4c3e7c">cms_get0_enveloped</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!env)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initialize recipient info */</span></div>
<div class="line">        ri = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!ri)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line"></div>
<div class="line">        pk = <a class="code" href="x509_8h.html#a97c3703b14a1f4a987c5d31cdf6cb205">X509_get_pubkey</a>(recip);</div>
<div class="line">        <span class="keywordflow">if</span> (!pk)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a466fc9af20c872ac00dbf5e414c769d6">CMS_F_CMS_ADD1_RECIPIENT_CERT</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#ae8e40f58dd5746e3df367d40bf5a11dd">CMS_R_ERROR_GETTING_PUBLIC_KEY</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">switch</span> (<a class="code" href="cms__env_8c.html#a4175d1c76c8093fb8a0f61c77a62fd86">cms_pkey_get_ri_type</a>(pk))</div>
<div class="line">                {</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>:</div>
<div class="line">                <span class="keywordflow">if</span> (!cms_RecipientInfo_ktri_init(ri, recip, pk, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>:</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="cms__kari_8c.html#acf47dd02ab24b071a4539c0eae072a73">cms_RecipientInfo_kari_init</a>(ri, recip, pk, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a466fc9af20c872ac00dbf5e414c769d6">CMS_F_CMS_ADD1_RECIPIENT_CERT</a>,</div>
<div class="line">                                        <a class="code" href="cms_8h.html#a5501f38a05380b4d48562e17db5d931b">CMS_R_NOT_SUPPORTED_FOR_THIS_KEY_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#abbb67eae173733f0fabb2d8c4f2c9f0a">sk_CMS_RecipientInfo_push</a>(env-&gt;recipientInfos, ri))</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="evp_8h.html#a448d9f9209a54694aff045d403850db7">EVP_PKEY_free</a>(pk);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> ri;</div>
<div class="line"></div>
<div class="line">        merr:</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a466fc9af20c872ac00dbf5e414c769d6">CMS_F_CMS_ADD1_RECIPIENT_CERT</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (ri)</div>
<div class="line">                <a class="code" href="asn1_8h.html#a64344e58b69188c21fd5ec2abe3a4a38">M_ASN1_free_of</a>(ri, <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (pk)</div>
<div class="line">                <a class="code" href="evp_8h.html#a448d9f9209a54694aff045d403850db7">EVP_PKEY_free</a>(pk);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac35f315f7ccd6ac91196b3ec171dc0cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_env_asn1_ctrl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cmd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00106">106</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structevp__pkey__st.html">EVP_PKEY</a> *pkey;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> == <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>)</div>
<div class="line">                pkey = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a931c9714689ab434cd072f8ae5c75cec">ktri</a>-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a9ec467fb7deec1d82c9c730b8c2db000">pkey</a>;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> == <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structevp__pkey__ctx__st.html">EVP_PKEY_CTX</a> *pctx = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a72c16b9727ba03e41e28085f501a290b">pctx</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (!pctx)</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                pkey = <a class="code" href="evp_8h.html#a94df22cd02656bd24b1849d2ab620260">EVP_PKEY_CTX_get0_pkey</a>(pctx);</div>
<div class="line">                <span class="keywordflow">if</span> (!pkey)</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (!pkey-&gt;<a class="code" href="structevp__pkey__st.html#a89d9cab6071d889719126a8ebc03b673">ameth</a> || !pkey-&gt;<a class="code" href="structevp__pkey__st.html#a89d9cab6071d889719126a8ebc03b673">ameth</a>-&gt;<a class="code" href="structevp__pkey__asn1__method__st.html#acf78fd1a5c1abf3cf46222e3c2bfc659">pkey_ctrl</a>)</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">        i = pkey-&gt;<a class="code" href="structevp__pkey__st.html#a89d9cab6071d889719126a8ebc03b673">ameth</a>-&gt;<a class="code" href="structevp__pkey__asn1__method__st.html#acf78fd1a5c1abf3cf46222e3c2bfc659">pkey_ctrl</a>(pkey, <a class="code" href="evp_8h.html#a53beaded425f9afdfb4fd5cd3f91a9d3">ASN1_PKEY_CTRL_CMS_ENVELOPE</a>, cmd, ri);</div>
<div class="line">        <span class="keywordflow">if</span> (i == -2)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#af36b801b1dec357f689eff8c68fb16b4">CMS_F_CMS_ENV_ASN1_CTRL</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a5501f38a05380b4d48562e17db5d931b">CMS_R_NOT_SUPPORTED_FOR_THIS_KEY_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (i &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#af36b801b1dec357f689eff8c68fb16b4">CMS_F_CMS_ENV_ASN1_CTRL</a>, <a class="code" href="cms_8h.html#a8d038f601b36de5ab9b0ee6829f41d2a">CMS_R_CTRL_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a63d3912c2faa83a1c9330353c805ee19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* CMS_EnvelopedData_create </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *&#160;</td>
          <td class="paramname"><em>cipher</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00163">163</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a> *cms;</div>
<div class="line">        <a class="code" href="structCMS__EnvelopedData__st.html">CMS_EnvelopedData</a> *env;</div>
<div class="line">        cms = CMS_ContentInfo_new();</div>
<div class="line">        <span class="keywordflow">if</span> (!cms)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        env = cms_enveloped_data_init(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!env)</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="cms__enc_8c.html#abd1f18f503cb0c237d12a089de669dd4">cms_EncryptedContent_init</a>(env-&gt;<a class="code" href="structCMS__EnvelopedData__st.html#a61ff72488726aa8cf3191e2e1cacc97d">encryptedContentInfo</a>,</div>
<div class="line">                                        cipher, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, 0))</div>
<div class="line">                <span class="keywordflow">goto</span> merr;</div>
<div class="line">        <span class="keywordflow">return</span> cms;</div>
<div class="line">        merr:</div>
<div class="line">        <span class="keywordflow">if</span> (cms)</div>
<div class="line">                CMS_ContentInfo_free(cms);</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a2c6e13925680edf4647b340f6d2a53e7">CMS_F_CMS_ENVELOPEDDATA_CREATE</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a40e7ed2550f0b34ee904c6576f08bc57"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* cms_EnvelopedData_init_bio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00988">988</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__EncryptedContentInfo__st.html">CMS_EncryptedContentInfo</a> *ec;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>) *rinfos;</div>
<div class="line">        <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a> *ri;</div>
<div class="line">        <span class="keywordtype">int</span> i, ok = 0;</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *ret;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Get BIO first to set up key */</span></div>
<div class="line"></div>
<div class="line">        ec = cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>-&gt;<a class="code" href="structCMS__EnvelopedData__st.html#a61ff72488726aa8cf3191e2e1cacc97d">encryptedContentInfo</a>;</div>
<div class="line">        ret = <a class="code" href="cms__enc_8c.html#a8b6dfda01af260a20f9cb2b29b24b94b">cms_EncryptedContent_init_bio</a>(ec);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* If error or no cipher end of processing */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!ret || !ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a42d15187520e31613b3d2c47c79fa8dd">cipher</a>)</div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Now encrypt content key according to each RecipientInfo type */</span></div>
<div class="line"></div>
<div class="line">        rinfos = cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>-&gt;recipientInfos;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a0c1e686cfaa11baf6f61c28373ba3b98">sk_CMS_RecipientInfo_num</a>(rinfos); i++)</div>
<div class="line">                {</div>
<div class="line">                ri = <a class="code" href="safestack_8h.html#a546bb94aa3a8b2cb44c8bcef75da1a01">sk_CMS_RecipientInfo_value</a>(rinfos, i);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="cms_8h.html#a44fec504f4ab356a6095f25527aabc46">CMS_RecipientInfo_encrypt</a>(cms, ri) &lt;= 0)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ae35927bfd818290e5affff1a96ef33c6">CMS_F_CMS_ENVELOPEDDATA_INIT_BIO</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#ab0d306b14288eeebeec749a1fddbbe82">CMS_R_ERROR_SETTING_RECIPIENTINFO</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        cms_env_set_version(cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>);</div>
<div class="line"></div>
<div class="line">        ok = 1;</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line">        ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a42d15187520e31613b3d2c47c79fa8dd">cipher</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="crypto_8h.html#a2aa47e40c63b05d00e9a780592f2a2b8">OPENSSL_cleanse</a>(ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a>);</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>);</div>
<div class="line">                ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a> = 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (ok)</div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line">        <a class="code" href="bio_8h.html#abbfb67b5eb998ce232f2482b097da8b2">BIO_free</a>(ret);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a904bcd4685600e69c9cadfc48e4c3e7c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms__lcl_8h.html#a4cb65b7d7c915efc367f5e1e999440d9">CMS_EnvelopedData</a>* cms_get0_enveloped </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00074">74</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#aae0b0e1c6da4732f18167de51c9eb9e5">contentType</a>) != <a class="code" href="obj__mac_8h.html#a4587e848643383571699c4b1fdaf5710">NID_pkcs7_enveloped</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a024f46d6ce854beb8be94aa80426e2cd">CMS_F_CMS_GET0_ENVELOPED</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a0407e04d7aee2109eaa028cc17096869">CMS_R_CONTENT_TYPE_NOT_ENVELOPED_DATA</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4175d1c76c8093fb8a0f61c77a62fd86"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_pkey_get_ri_type </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>pk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l01043">1043</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (pk-&gt;<a class="code" href="structevp__pkey__st.html#a89d9cab6071d889719126a8ebc03b673">ameth</a> &amp;&amp; pk-&gt;<a class="code" href="structevp__pkey__st.html#a89d9cab6071d889719126a8ebc03b673">ameth</a>-&gt;<a class="code" href="structevp__pkey__asn1__method__st.html#acf78fd1a5c1abf3cf46222e3c2bfc659">pkey_ctrl</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordtype">int</span> i, r;</div>
<div class="line">                i = pk-&gt;<a class="code" href="structevp__pkey__st.html#a89d9cab6071d889719126a8ebc03b673">ameth</a>-&gt;<a class="code" href="structevp__pkey__asn1__method__st.html#acf78fd1a5c1abf3cf46222e3c2bfc659">pkey_ctrl</a>(pk, <a class="code" href="evp_8h.html#aee6545cbc20437eaa64a9cbdaf593619">ASN1_PKEY_CTRL_CMS_RI_TYPE</a>, 0, &amp;r);</div>
<div class="line">                <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line">                        <span class="keywordflow">return</span> r;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2db1d83492be468599b3be3452e98cc5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00871">871</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">switch</span>(ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>:</div>
<div class="line">                <span class="keywordflow">return</span> cms_RecipientInfo_ktri_decrypt(cms, ri);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>:</div>
<div class="line">                <span class="keywordflow">return</span> cms_RecipientInfo_kekri_decrypt(cms, ri);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#ab206c8d6ec7c2bc1c4798b3775759db5">CMS_RECIPINFO_PASS</a>:</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#a23e449de7f0b59882111f6025b6403f4">cms_RecipientInfo_pwri_crypt</a>(cms, ri, 0);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a7b61f312558cf5f0b0b6a488cad635a1">CMS_F_CMS_RECIPIENTINFO_DECRYPT</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#ab906515535f6457ebafdab611944cf32">CMS_R_UNSUPPORTED_RECPIENTINFO_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a44fec504f4ab356a6095f25527aabc46"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00891">891</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">switch</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>:</div>
<div class="line">                <span class="keywordflow">return</span> cms_RecipientInfo_ktri_encrypt(cms, ri);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>:</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__kari_8c.html#a178c4432e47cc12081fd3e4e28910092">cms_RecipientInfo_kari_encrypt</a>(cms, ri);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>:</div>
<div class="line">                <span class="keywordflow">return</span> cms_RecipientInfo_kekri_encrypt(cms, ri);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#ab206c8d6ec7c2bc1c4798b3775759db5">CMS_RECIPINFO_PASS</a>:</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#a23e449de7f0b59882111f6025b6403f4">cms_RecipientInfo_pwri_crypt</a>(cms, ri, 1);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a0327f69f5888456157c4c359ac37fb7b">CMS_F_CMS_RECIPIENTINFO_ENCRYPT</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a5dedd8ba3201a67c024aaeaa87c70c0d">CMS_R_UNSUPPORTED_RECIPIENT_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af0289104150559a8e0ea51f8111aafd1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#aaadbb75633e4460a52864970a3b875de">EVP_PKEY_CTX</a>* CMS_RecipientInfo_get0_pkey_ctx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00154">154</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> == <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>)</div>
<div class="line">                <span class="keywordflow">return</span> ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a931c9714689ab434cd072f8ae5c75cec">ktri</a>-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a29d113f1d277c1f5fc5bf0fd061c220a">pctx</a>;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> == <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>)</div>
<div class="line">                <span class="keywordflow">return</span> ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a72c16b9727ba03e41e28085f501a290b">pctx</a>;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5605ce2e902d1a84e651ef14a569e92a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_kekri_get0_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **&#160;</td>
          <td class="paramname"><em>palg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#abd19ea5b527807ce3a516e6a41440f84">ASN1_GENERALIZEDTIME</a> **&#160;</td>
          <td class="paramname"><em>pdate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> **&#160;</td>
          <td class="paramname"><em>potherid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="asn1_8h.html#a7895e03d9fee2bc4963faf2a31a9439e">ASN1_TYPE</a> **&#160;</td>
          <td class="paramname"><em>pothertype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00676">676</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__KEKIdentifier__st.html">CMS_KEKIdentifier</a> *rkid;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ad4b5d7960f63c3a1c4665c55436f69c0">CMS_F_CMS_RECIPIENTINFO_KEKRI_GET0_ID</a>, <a class="code" href="cms_8h.html#ac555a8ace3e9e0226535c7221b63bf26">CMS_R_NOT_KEK</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        rkid =  ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a>-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (palg)</div>
<div class="line">                *palg = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a>-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a5f51b5cad62639eafec3e3948e82784c">keyEncryptionAlgorithm</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (pid)</div>
<div class="line">                *pid = rkid-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a62da3e7a25399bba4bb209bba467ad53">keyIdentifier</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (pdate)</div>
<div class="line">                *pdate = rkid-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#aa5dc596530ce6f9f57d2515085808aac">date</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (potherid)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (rkid-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>)</div>
<div class="line">                        *potherid = rkid-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>-&gt;<a class="code" href="structCMS__OtherKeyAttribute__st.html#ae77e87e21328fc0456d48c96a4d5b9ea">keyAttrId</a>;</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        *potherid = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (pothertype)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (rkid-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>)</div>
<div class="line">                        *pothertype = rkid-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a9bc4030cca9d3a127f84f78e75cae668">other</a>-&gt;<a class="code" href="structCMS__OtherKeyAttribute__st.html#a09e2b7c3fa802c038198ba99dbc11406">keyAttr</a>;</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        *pothertype = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3abd22c1ff8260d4935a428898030f92"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_kekri_id_cmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>idlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00526">526</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> tmp_os;</div>
<div class="line">        <a class="code" href="structCMS__KEKRecipientInfo__st.html">CMS_KEKRecipientInfo</a> *kekri;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a4823452068827ce9dff504d3dbd729d1">CMS_F_CMS_RECIPIENTINFO_KEKRI_ID_CMP</a>, <a class="code" href="cms_8h.html#ac555a8ace3e9e0226535c7221b63bf26">CMS_R_NOT_KEK</a>);</div>
<div class="line">                <span class="keywordflow">return</span> -2;</div>
<div class="line">                }</div>
<div class="line">        kekri = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a>;</div>
<div class="line">        tmp_os.<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a> = <a class="code" href="asn1_8h.html#ab7338bcfcfbbd8f90c680759f373663b">V_ASN1_OCTET_STRING</a>;</div>
<div class="line">        tmp_os.<a class="code" href="structasn1__string__st.html#a166fa78d828cb41bb2499ad411c1774c">flags</a> = 0;</div>
<div class="line">        tmp_os.<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<span class="keywordtype">id</span>;</div>
<div class="line">        tmp_os.<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a> = (int)idlen;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="a__octet_8c.html#a9a5442543cd9a35a1bb6c50c21f890c4">ASN1_OCTET_STRING_cmp</a>(&amp;tmp_os, kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#a568bd1034d85d1a8c7317f2821b981c5">kekid</a>-&gt;<a class="code" href="structCMS__KEKIdentifier__st.html#a62da3e7a25399bba4bb209bba467ad53">keyIdentifier</a>);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab7a3b21a9d98942c07103ea081bee640"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_ktri_cert_cmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00341">341</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ac01c397092c078cb18f70f732d9c7349">CMS_F_CMS_RECIPIENTINFO_KTRI_CERT_CMP</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#abb0895b04040c42d03a5ca1178f7a54e">CMS_R_NOT_KEY_TRANSPORT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> -2;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#ae15c777be21e1c02be97ddf5bc27dc54">cms_SignerIdentifier_cert_cmp</a>(ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a931c9714689ab434cd072f8ae5c75cec">ktri</a>-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a764a06ad68a0fc1c4238adbf56cd50de">rid</a>, cert);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7a862d5cd26243bae2f833aed5a955c2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_ktri_get0_algs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> **&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> **&#160;</td>
          <td class="paramname"><em>recip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> **&#160;</td>
          <td class="paramname"><em>palg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00301">301</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__KeyTransRecipientInfo__st.html">CMS_KeyTransRecipientInfo</a> *ktri;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#aaad41bb8ee537e69bf8a2f56f59337e5">CMS_F_CMS_RECIPIENTINFO_KTRI_GET0_ALGS</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#abb0895b04040c42d03a5ca1178f7a54e">CMS_R_NOT_KEY_TRANSPORT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        ktri = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a931c9714689ab434cd072f8ae5c75cec">ktri</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (pk)</div>
<div class="line">                *pk = ktri-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a9ec467fb7deec1d82c9c730b8c2db000">pkey</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (recip)</div>
<div class="line">                *recip = ktri-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#aea7ab78fb17ede96eb50ed8c3fb5f83c">recip</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (palg)</div>
<div class="line">                *palg = ktri-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a2f49476da086ed4758604e67cd0a6ebe">keyEncryptionAlgorithm</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8f598cf775da0d77f02950fe395deac8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_ktri_get0_signer_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> **&#160;</td>
          <td class="paramname"><em>issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **&#160;</td>
          <td class="paramname"><em>sno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00324">324</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__KeyTransRecipientInfo__st.html">CMS_KeyTransRecipientInfo</a> *ktri;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a59b981b457a264b21809375134e4256d">CMS_F_CMS_RECIPIENTINFO_KTRI_GET0_SIGNER_ID</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#abb0895b04040c42d03a5ca1178f7a54e">CMS_R_NOT_KEY_TRANSPORT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        ktri = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a931c9714689ab434cd072f8ae5c75cec">ktri</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#a73e3ae14ece4aba2d5bcc38796b23907">cms_SignerIdentifier_get0_signer_id</a>(ktri-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a764a06ad68a0fc1c4238adbf56cd50de">rid</a>,</div>
<div class="line">                                                        keyid, issuer, sno);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abcbf7e892f737b18c52779d636143b14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_set0_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00713">713</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__KEKRecipientInfo__st.html">CMS_KEKRecipientInfo</a> *kekri;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a2e860541fc9b71e68774a92635e7c03a">CMS_RECIPINFO_KEK</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ade9eabf14d47c561634a7a5e28cfb3a9">CMS_F_CMS_RECIPIENTINFO_SET0_KEY</a>, <a class="code" href="cms_8h.html#ac555a8ace3e9e0226535c7221b63bf26">CMS_R_NOT_KEK</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        kekri = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a285c95b30c13d3d3c38de44878cad517">kekri</a>;</div>
<div class="line">        kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#ac82292d2f82c4e2a01b18ce48cbced3d">key</a> = <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>;</div>
<div class="line">        kekri-&gt;<a class="code" href="structCMS__KEKRecipientInfo__st.html#ad588a2c59910bbaa2e54e09d4de4144f">keylen</a> = keylen;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9677b76bdae4ef3dfb1da114a02b7093"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_set0_pkey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>pkey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00352">352</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a2a8cd121b59b934d82e0affaf42bbe29">CMS_F_CMS_RECIPIENTINFO_SET0_PKEY</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#abb0895b04040c42d03a5ca1178f7a54e">CMS_R_NOT_KEY_TRANSPORT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a931c9714689ab434cd072f8ae5c75cec">ktri</a>-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a9ec467fb7deec1d82c9c730b8c2db000">pkey</a> = pkey;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3ae6eeed24d48fa38986857810a09304"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CMS_RecipientInfo_type </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00149">149</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a719ae32943146855c021262d71a46233"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STACK_OF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00140">140</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__EnvelopedData__st.html">CMS_EnvelopedData</a> *env;</div>
<div class="line">        env = <a class="code" href="cms__env_8c.html#a904bcd4685600e69c9cadfc48e4c3e7c">cms_get0_enveloped</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!env)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">return</span> env-&gt;recipientInfos;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
