<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/modes/modes.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_616d12f6b71e387af74f171a574db691.html">modes</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">modes.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stddef.h&gt;</code><br/>
</div>
<p><a href="modes_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ac59f1132af4a41c5c644c63e901189ec"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> )(const unsigned char <a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[16], unsigned char <a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[16], const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>)</td></tr>
<tr class="memitem:a0eed6ee3d31ba9aea497696eabda5df4"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a0eed6ee3d31ba9aea497696eabda5df4">cbc128_f</a> )(const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], int enc)</td></tr>
<tr class="memitem:a733a81250b14ef18c1a889dfc12caa6d"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a733a81250b14ef18c1a889dfc12caa6d">ctr128_f</a> )(const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t blocks, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, const unsigned char ivec[16])</td></tr>
<tr class="memitem:ae1caef5ce91a332503164f3d73a6afb7"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#ae1caef5ce91a332503164f3d73a6afb7">ccm128_f</a> )(const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t blocks, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, const unsigned char ivec[16], unsigned char cmac[16])</td></tr>
<tr class="memitem:a2a7f451298d420760e290671f2235c61"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structgcm128__context.html">gcm128_context</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a></td></tr>
<tr class="memitem:a95fba40cd3d7febce85290bf899662e1"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structccm128__context.html">ccm128_context</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a></td></tr>
<tr class="memitem:ad233eb07e4ab07fd32a8cf18e477dd71"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structxts128__context.html">xts128_context</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#ad233eb07e4ab07fd32a8cf18e477dd71">XTS128_CONTEXT</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5cbe79f5b3a935a6e49ac72e3f3e4fb2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a5cbe79f5b3a935a6e49ac72e3f3e4fb2">CRYPTO_cbc128_encrypt</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:a009400dbb93db1cb23550cdb66eac5ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a009400dbb93db1cb23550cdb66eac5ad">CRYPTO_cbc128_decrypt</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:af30a43dd23d0d25cc94a01f1a41f0746"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#af30a43dd23d0d25cc94a01f1a41f0746">CRYPTO_ctr128_encrypt</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], unsigned char ecount_buf[16], unsigned int *num, <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:a52c2dc3d1a797a15ad1a33be01e010ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a52c2dc3d1a797a15ad1a33be01e010ab">CRYPTO_ctr128_encrypt_ctr32</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], unsigned char ecount_buf[16], unsigned int *num, <a class="el" href="modes_8h.html#a733a81250b14ef18c1a889dfc12caa6d">ctr128_f</a> ctr)</td></tr>
<tr class="memitem:ab90b380cc595d52baa19a00926dc8841"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#ab90b380cc595d52baa19a00926dc8841">CRYPTO_ofb128_encrypt</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], int *num, <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:a5c982e56a8f27559f7e64364ef36c868"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a5c982e56a8f27559f7e64364ef36c868">CRYPTO_cfb128_encrypt</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], int *num, int enc, <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:a355e4bb29e1947a73449857b4a126f1d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a355e4bb29e1947a73449857b4a126f1d">CRYPTO_cfb128_8_encrypt</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], int *num, int enc, <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:aca08c600331f017ca56a250bf9f5d2ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#aca08c600331f017ca56a250bf9f5d2ee">CRYPTO_cfb128_1_encrypt</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509v3_8h.html#ab3c186980893d6836a68407d221ae9c9">bits</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], int *num, int enc, <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:a3e32a5c536863c9590e9225a918d364b"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a3e32a5c536863c9590e9225a918d364b">CRYPTO_cts128_encrypt_block</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:ae6348ad0b524fd00afff759c2a3c52cc"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#ae6348ad0b524fd00afff759c2a3c52cc">CRYPTO_cts128_encrypt</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], <a class="el" href="modes_8h.html#a0eed6ee3d31ba9aea497696eabda5df4">cbc128_f</a> cbc)</td></tr>
<tr class="memitem:a1002021ed22fe1dd0f7d78fa7907a525"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a1002021ed22fe1dd0f7d78fa7907a525">CRYPTO_cts128_decrypt_block</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:aee42bf2d060845035b7eff0f884fd6a8"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#aee42bf2d060845035b7eff0f884fd6a8">CRYPTO_cts128_decrypt</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], <a class="el" href="modes_8h.html#a0eed6ee3d31ba9aea497696eabda5df4">cbc128_f</a> cbc)</td></tr>
<tr class="memitem:a060f48b9d4bfa421c2eae7c31144bede"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a060f48b9d4bfa421c2eae7c31144bede">CRYPTO_nistcts128_encrypt_block</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:a3dbdc940a0b01185acd3ad3a95bef5c8"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a3dbdc940a0b01185acd3ad3a95bef5c8">CRYPTO_nistcts128_encrypt</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], <a class="el" href="modes_8h.html#a0eed6ee3d31ba9aea497696eabda5df4">cbc128_f</a> cbc)</td></tr>
<tr class="memitem:aa8122dbed2b240fea20843ab391aee29"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#aa8122dbed2b240fea20843ab391aee29">CRYPTO_nistcts128_decrypt_block</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:a541156458b0b57b6f3ec115180b7a348"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a541156458b0b57b6f3ec115180b7a348">CRYPTO_nistcts128_decrypt</a> (const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], <a class="el" href="modes_8h.html#a0eed6ee3d31ba9aea497696eabda5df4">cbc128_f</a> cbc)</td></tr>
<tr class="memitem:a48f9d5df65f104833881965e6dbe03d9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a48f9d5df65f104833881965e6dbe03d9">CRYPTO_gcm128_new</a> (void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:a2119af4cceb3e52127662ff851df4f9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a2119af4cceb3e52127662ff851df4f9f">CRYPTO_gcm128_init</a> (<a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *ctx, void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:a0ebf35e4119a3d747eaae4ab5624be17"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a0ebf35e4119a3d747eaae4ab5624be17">CRYPTO_gcm128_setiv</a> (<a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *ctx, const unsigned char *iv, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:a3a3e9723bbfebd1d36b278815e226460"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a3a3e9723bbfebd1d36b278815e226460">CRYPTO_gcm128_aad</a> (<a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *ctx, const unsigned char *aad, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:a9779f2d0133e20bf5d6a2ff9833bd698"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a9779f2d0133e20bf5d6a2ff9833bd698">CRYPTO_gcm128_encrypt</a> (<a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *ctx, const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:ac29699ec140758465503d86f7d1460cf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#ac29699ec140758465503d86f7d1460cf">CRYPTO_gcm128_decrypt</a> (<a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *ctx, const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:a81916efacf50d25fbffb8c36afc8de11"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a81916efacf50d25fbffb8c36afc8de11">CRYPTO_gcm128_encrypt_ctr32</a> (<a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *ctx, const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, <a class="el" href="modes_8h.html#a733a81250b14ef18c1a889dfc12caa6d">ctr128_f</a> stream)</td></tr>
<tr class="memitem:a3abd2326aa2402ca5afaeac5dba2df8e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a3abd2326aa2402ca5afaeac5dba2df8e">CRYPTO_gcm128_decrypt_ctr32</a> (<a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *ctx, const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, <a class="el" href="modes_8h.html#a733a81250b14ef18c1a889dfc12caa6d">ctr128_f</a> stream)</td></tr>
<tr class="memitem:a8d5bac0494d173f96c5cb73790f1353d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a8d5bac0494d173f96c5cb73790f1353d">CRYPTO_gcm128_finish</a> (<a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *ctx, const unsigned char *tag, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:a995a320240beba7ff1cffb97567f15a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a995a320240beba7ff1cffb97567f15a2">CRYPTO_gcm128_tag</a> (<a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *ctx, unsigned char *tag, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:a811fe4518c95944c68547b6cf5c32f07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a811fe4518c95944c68547b6cf5c32f07">CRYPTO_gcm128_release</a> (<a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *ctx)</td></tr>
<tr class="memitem:a3ddbc4bdd19aae3401864491151aa540"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a3ddbc4bdd19aae3401864491151aa540">CRYPTO_ccm128_init</a> (<a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *ctx, unsigned int M, unsigned int L, void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:ad3346f6edb53cb6830375d6fdd6d52f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#ad3346f6edb53cb6830375d6fdd6d52f7">CRYPTO_ccm128_setiv</a> (<a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *ctx, const unsigned char *nonce, size_t nlen, size_t mlen)</td></tr>
<tr class="memitem:a63223bfff050bf85cf1f2170369321b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a63223bfff050bf85cf1f2170369321b0">CRYPTO_ccm128_aad</a> (<a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *ctx, const unsigned char *aad, size_t alen)</td></tr>
<tr class="memitem:a8f33d493c1a71fb89ba125fab5e5d2ea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a8f33d493c1a71fb89ba125fab5e5d2ea">CRYPTO_ccm128_encrypt</a> (<a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *ctx, const unsigned char *inp, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:ace9974c12c5fe3514a5fedd0d5368c91"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#ace9974c12c5fe3514a5fedd0d5368c91">CRYPTO_ccm128_decrypt</a> (<a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *ctx, const unsigned char *inp, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:a7d0d967f2e7e647114e368b9aefa8ee8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a7d0d967f2e7e647114e368b9aefa8ee8">CRYPTO_ccm128_encrypt_ccm64</a> (<a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *ctx, const unsigned char *inp, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, <a class="el" href="modes_8h.html#ae1caef5ce91a332503164f3d73a6afb7">ccm128_f</a> stream)</td></tr>
<tr class="memitem:a2c9a2ccd17de9383a4b6d66a7d682d32"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a2c9a2ccd17de9383a4b6d66a7d682d32">CRYPTO_ccm128_decrypt_ccm64</a> (<a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *ctx, const unsigned char *inp, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, <a class="el" href="modes_8h.html#ae1caef5ce91a332503164f3d73a6afb7">ccm128_f</a> stream)</td></tr>
<tr class="memitem:ae2a130dc00b30de17ea9e550864d8d54"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#ae2a130dc00b30de17ea9e550864d8d54">CRYPTO_ccm128_tag</a> (<a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *ctx, unsigned char *tag, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:aadd968198321806f284908b57c1fc133"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#aadd968198321806f284908b57c1fc133">CRYPTO_xts128_encrypt</a> (const <a class="el" href="modes_8h.html#ad233eb07e4ab07fd32a8cf18e477dd71">XTS128_CONTEXT</a> *ctx, const unsigned char iv[16], const unsigned char *inp, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, int enc)</td></tr>
<tr class="memitem:a3d855d0592a75d11347ac614c2f1deb6"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a3d855d0592a75d11347ac614c2f1deb6">CRYPTO_128_wrap</a> (void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, const unsigned char *iv, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, size_t inlen, <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
<tr class="memitem:a9eb5206f42f6a0c5c92072369a7c5842"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="modes_8h.html#a9eb5206f42f6a0c5c92072369a7c5842">CRYPTO_128_unwrap</a> (void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, const unsigned char *iv, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, size_t inlen, <a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block)</td></tr>
</table>
<h2>Typedef Documentation</h2>
<a class="anchor" id="ac59f1132af4a41c5c644c63e901189ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* block128_f)(const unsigned char <a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[16], unsigned char <a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[16], const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="modes_8h_source.html#l00010">10</a> of file <a class="el" href="modes_8h_source.html">modes.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0eed6ee3d31ba9aea497696eabda5df4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* cbc128_f)(const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, unsigned char ivec[16], int enc)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="modes_8h_source.html#l00014">14</a> of file <a class="el" href="modes_8h_source.html">modes.h</a>.</p>

</div>
</div>
<a class="anchor" id="a95fba40cd3d7febce85290bf899662e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structccm128__context.html">ccm128_context</a> <a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="modes_8h_source.html#l00112">112</a> of file <a class="el" href="modes_8h_source.html">modes.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae1caef5ce91a332503164f3d73a6afb7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* ccm128_f)(const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t blocks, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, const unsigned char ivec[16], unsigned char cmac[16])</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="modes_8h_source.html#l00022">22</a> of file <a class="el" href="modes_8h_source.html">modes.h</a>.</p>

</div>
</div>
<a class="anchor" id="a733a81250b14ef18c1a889dfc12caa6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* ctr128_f)(const unsigned char *<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, unsigned char *<a class="el" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, size_t blocks, const void *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, const unsigned char ivec[16])</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="modes_8h_source.html#l00018">18</a> of file <a class="el" href="modes_8h_source.html">modes.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2a7f451298d420760e290671f2235c61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structgcm128__context.html">gcm128_context</a> <a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="modes_8h_source.html#l00087">87</a> of file <a class="el" href="modes_8h_source.html">modes.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad233eb07e4ab07fd32a8cf18e477dd71"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structxts128__context.html">xts128_context</a> <a class="el" href="modes_8h.html#ad233eb07e4ab07fd32a8cf18e477dd71">XTS128_CONTEXT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="modes_8h_source.html#l00132">132</a> of file <a class="el" href="modes_8h_source.html">modes.h</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a9eb5206f42f6a0c5c92072369a7c5842"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CRYPTO_128_unwrap </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="wrap128_8c_source.html#l00102">102</a> of file <a class="el" href="wrap128_8c_source.html">wrap128.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *A, <a class="code" href="sha512_8c.html#af2b2656e2da2f64498d6b4a7b0237eae">B</a>[16], *R;</div>
<div class="line">        <span class="keywordtype">size_t</span> i, j, <a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>;</div>
<div class="line">        inlen -= 8;</div>
<div class="line">        <span class="keywordflow">if</span> ((inlen &amp; 0x7) || (inlen &lt; 8) || (inlen &gt; <a class="code" href="wrap128_8c.html#af36c1cba40fb9ba7b2fe69ecd4fa8a3f">CRYPTO128_WRAP_MAX</a>))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        A = <a class="code" href="sha512_8c.html#af2b2656e2da2f64498d6b4a7b0237eae">B</a>;</div>
<div class="line">        t =  6 * (inlen &gt;&gt; 3);</div>
<div class="line">        memcpy(A, <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, 8);</div>
<div class="line">        memcpy(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> + 8, inlen);</div>
<div class="line">        <span class="keywordflow">for</span> (j = 0; j &lt; 6; j++)</div>
<div class="line">                {</div>
<div class="line">                R = <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> + inlen - 8;</div>
<div class="line">                <span class="keywordflow">for</span> (i = 0; i &lt; inlen; i += 8, t--, R -= 8)</div>
<div class="line">                        {</div>
<div class="line">                        A[7] ^= (<span class="keywordtype">unsigned</span> char)(t &amp; 0xff);</div>
<div class="line">                        <span class="keywordflow">if</span> (t &gt; 0xff)   </div>
<div class="line">                                {</div>
<div class="line">                                A[6] ^= (<span class="keywordtype">unsigned</span> char)((t &gt;&gt; 8) &amp; 0xff);</div>
<div class="line">                                A[5] ^= (<span class="keywordtype">unsigned</span> char)((t &gt;&gt; 16) &amp; 0xff);</div>
<div class="line">                                A[4] ^= (<span class="keywordtype">unsigned</span> char)((t &gt;&gt; 24) &amp; 0xff);</div>
<div class="line">                                }</div>
<div class="line">                        memcpy(B + 8, R, 8);</div>
<div class="line">                        block(B, B, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        memcpy(R, B + 8, 8);</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!iv)</div>
<div class="line">                iv = default_iv;</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(A, iv, 8))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="crypto_8h.html#a2aa47e40c63b05d00e9a780592f2a2b8">OPENSSL_cleanse</a>(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, inlen);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> inlen;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3d855d0592a75d11347ac614c2f1deb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CRYPTO_128_wrap </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="wrap128_8c_source.html#l00065">65</a> of file <a class="el" href="wrap128_8c_source.html">wrap128.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *A, <a class="code" href="sha512_8c.html#af2b2656e2da2f64498d6b4a7b0237eae">B</a>[16], *R;</div>
<div class="line">        <span class="keywordtype">size_t</span> i, j, <a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>;</div>
<div class="line">        <span class="keywordflow">if</span> ((inlen &amp; 0x7) || (inlen &lt; 8) || (inlen &gt; <a class="code" href="wrap128_8c.html#af36c1cba40fb9ba7b2fe69ecd4fa8a3f">CRYPTO128_WRAP_MAX</a>))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        A = <a class="code" href="sha512_8c.html#af2b2656e2da2f64498d6b4a7b0237eae">B</a>;</div>
<div class="line">        t = 1;</div>
<div class="line">        memcpy(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> + 8, <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, inlen);</div>
<div class="line">        <span class="keywordflow">if</span> (!iv)</div>
<div class="line">                iv = default_iv;</div>
<div class="line"></div>
<div class="line">        memcpy(A, iv, 8);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (j = 0; j &lt; 6; j++)</div>
<div class="line">                {</div>
<div class="line">                R = <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> + 8;</div>
<div class="line">                <span class="keywordflow">for</span> (i = 0; i &lt; inlen; i += 8, t++, R += 8)</div>
<div class="line">                        {</div>
<div class="line">                        memcpy(B + 8, R, 8);</div>
<div class="line">                        block(B, B, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        A[7] ^= (<span class="keywordtype">unsigned</span> char)(t &amp; 0xff);</div>
<div class="line">                        <span class="keywordflow">if</span> (t &gt; 0xff)   </div>
<div class="line">                                {</div>
<div class="line">                                A[6] ^= (<span class="keywordtype">unsigned</span> char)((t &gt;&gt; 8) &amp; 0xff);</div>
<div class="line">                                A[5] ^= (<span class="keywordtype">unsigned</span> char)((t &gt;&gt; 16) &amp; 0xff);</div>
<div class="line">                                A[4] ^= (<span class="keywordtype">unsigned</span> char)((t &gt;&gt; 24) &amp; 0xff);</div>
<div class="line">                                }</div>
<div class="line">                        memcpy(R, B + 8, 8);</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        memcpy(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, A, 8);</div>
<div class="line">        <span class="keywordflow">return</span> inlen + 8;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a009400dbb93db1cb23550cdb66eac5ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_cbc128_decrypt </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cbc128_8c_source.html#l00115">115</a> of file <a class="el" href="cbc128_8c_source.html">cbc128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">size_t</span> n;</div>
<div class="line">        <span class="keyword">union </span>{ <span class="keywordtype">size_t</span> <a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>[16/<span class="keyword">sizeof</span>(size_t)]; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[16]; } tmp;</div>
<div class="line"></div>
<div class="line">        assert(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if !defined(OPENSSL_SMALL_FOOTPRINT)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> != <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>) {</div>
<div class="line">                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *iv = ivec;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="modes__lcl_8h.html#a4a08897c30cd03e8f3b9d908d69778a7">STRICT_ALIGNMENT</a> &amp;&amp;</div>
<div class="line">                    ((<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>|(<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>|(<span class="keywordtype">size_t</span>)ivec)%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) != 0) {</div>
<div class="line">                        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                                (*block)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                                <span class="keywordflow">for</span>(n=0; n&lt;16; ++n)</div>
<div class="line">                                        out[n] ^= iv[n];</div>
<div class="line">                                iv = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line">                                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                                in  += 16;</div>
<div class="line">                                out += 16;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span>  <span class="keywordflow">if</span> (16%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) == 0) { <span class="comment">/* always true */</span></div>
<div class="line">                        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                                <span class="keywordtype">size_t</span> *out_t=(<span class="keywordtype">size_t</span> *)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, *iv_t=(<span class="keywordtype">size_t</span> *)iv;</div>
<div class="line"></div>
<div class="line">                                (*block)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                                <span class="keywordflow">for</span>(n=0; n&lt;16/<span class="keyword">sizeof</span>(size_t); n++)</div>
<div class="line">                                        out_t[n] ^= iv_t[n];</div>
<div class="line">                                iv = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line">                                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                                in  += 16;</div>
<div class="line">                                out += 16;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                memcpy(ivec,iv,16);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="modes__lcl_8h.html#a4a08897c30cd03e8f3b9d908d69778a7">STRICT_ALIGNMENT</a> &amp;&amp;</div>
<div class="line">                    ((<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>|(<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>|(<span class="keywordtype">size_t</span>)ivec)%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) != 0) {</div>
<div class="line">                        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>;</div>
<div class="line">                        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                                (*block)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, tmp.c, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                                <span class="keywordflow">for</span>(n=0; n&lt;16; ++n) {</div>
<div class="line">                                        c = in[n];</div>
<div class="line">                                        <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n] = tmp.c[n] ^ ivec[n];</div>
<div class="line">                                        ivec[n] = c;</div>
<div class="line">                                }</div>
<div class="line">                                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                                in  += 16;</div>
<div class="line">                                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += 16;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (16%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) == 0) { <span class="comment">/* always true */</span></div>
<div class="line">                        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                                <span class="keywordtype">size_t</span> c, *out_t=(<span class="keywordtype">size_t</span> *)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, *ivec_t=(<span class="keywordtype">size_t</span> *)ivec;</div>
<div class="line">                                <span class="keyword">const</span> <span class="keywordtype">size_t</span> *in_t=(<span class="keyword">const</span> <span class="keywordtype">size_t</span> *)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line"></div>
<div class="line">                                (*block)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, tmp.c, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                                <span class="keywordflow">for</span>(n=0; n&lt;16/<span class="keyword">sizeof</span>(size_t); n++) {</div>
<div class="line">                                        c = in_t[n];</div>
<div class="line">                                        out_t[n] = tmp.t[n] ^ ivec_t[n];</div>
<div class="line">                                        ivec_t[n] = c;</div>
<div class="line">                                }</div>
<div class="line">                                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                                in  += 16;</div>
<div class="line">                                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += 16;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c;</div>
<div class="line">                (*block)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, tmp.c, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                <span class="keywordflow">for</span>(n=0; n&lt;16 &amp;&amp; n&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>; ++n) {</div>
<div class="line">                        c = in[n];</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n] = tmp.c[n] ^ ivec[n];</div>
<div class="line">                        ivec[n] = c;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (len&lt;=16) {</div>
<div class="line">                        <span class="keywordflow">for</span> (; n&lt;16; ++n)</div>
<div class="line">                                ivec[n] = in[n];</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                len -= 16;</div>
<div class="line">                in  += 16;</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += 16;</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5cbe79f5b3a935a6e49ac72e3f3e4fb2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_cbc128_encrypt </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cbc128_8c_source.html#l00066">66</a> of file <a class="el" href="cbc128_8c_source.html">cbc128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">size_t</span> n;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *iv = ivec;</div>
<div class="line"></div>
<div class="line">        assert(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if !defined(OPENSSL_SMALL_FOOTPRINT)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (<a class="code" href="modes__lcl_8h.html#a4a08897c30cd03e8f3b9d908d69778a7">STRICT_ALIGNMENT</a> &amp;&amp;</div>
<div class="line">            ((<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>|(<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>|(<span class="keywordtype">size_t</span>)ivec)%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) != 0) {</div>
<div class="line">                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                        <span class="keywordflow">for</span>(n=0; n&lt;16; ++n)</div>
<div class="line">                                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n] = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n] ^ iv[n];</div>
<div class="line">                        (*block)(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        iv = <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>;</div>
<div class="line">                        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += 16;</div>
<div class="line">                        out += 16;</div>
<div class="line">                }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                        <span class="keywordflow">for</span>(n=0; n&lt;16; n+=<span class="keyword">sizeof</span>(size_t))</div>
<div class="line">                                *(<span class="keywordtype">size_t</span>*)(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>+n) =</div>
<div class="line">                                *(<span class="keywordtype">size_t</span>*)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>+n) ^ *(<span class="keywordtype">size_t</span>*)(iv+n);</div>
<div class="line">                        (*block)(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        iv = <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>;</div>
<div class="line">                        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += 16;</div>
<div class="line">                        out += 16;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                <span class="keywordflow">for</span>(n=0; n&lt;16 &amp;&amp; n&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>; ++n)</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n] = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n] ^ iv[n];</div>
<div class="line">                <span class="keywordflow">for</span>(; n&lt;16; ++n)</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n] = iv[n];</div>
<div class="line">                (*block)(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                iv = <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (len&lt;=16) <span class="keywordflow">break</span>;</div>
<div class="line">                len -= 16;</div>
<div class="line">                <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += 16;</div>
<div class="line">                out += 16;</div>
<div class="line">        }</div>
<div class="line">        memcpy(ivec,iv,16);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a63223bfff050bf85cf1f2170369321b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_ccm128_aad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>aad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>alen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccm128_8c_source.html#l00104">104</a> of file <a class="el" href="ccm128_8c_source.html">ccm128.c</a>.</p>
<div class="fragment"><div class="line">{       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line">        <a class="code" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block = ctx-&gt;<a class="code" href="structccm128__context.html#aa638afbe234c07148a22eef92d1b18a9">block</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (alen==0) <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] |= 0x40;        <span class="comment">/* set Adata flag */</span></div>
<div class="line">        (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a23a1e69ff01072f546bc54c907b77959">key</a>),</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7502836a59889b3b11af57068228e8c1">blocks</a>++;</div>
<div class="line"></div>
<div class="line">        if (alen&lt;(0x10000-0x100)) {</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(alen&gt;&gt;8);</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[1] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)alen;</div>
<div class="line">                i=2;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(alen)==8 &amp;&amp; alen&gt;=(size_t)1&lt;&lt;(32%(<span class="keyword">sizeof</span>(alen)*8))) {</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] ^= 0xFF;</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[1] ^= 0xFF;</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[2] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(alen&gt;&gt;(56%(<span class="keyword">sizeof</span>(alen)*8)));</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[3] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(alen&gt;&gt;(48%(<span class="keyword">sizeof</span>(alen)*8)));</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[4] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(alen&gt;&gt;(40%(<span class="keyword">sizeof</span>(alen)*8)));</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[5] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(alen&gt;&gt;(32%(<span class="keyword">sizeof</span>(alen)*8)));</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[6] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(alen&gt;&gt;24);</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[7] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(alen&gt;&gt;16);</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[8] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(alen&gt;&gt;8);</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[9] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)alen;</div>
<div class="line">                i=10;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] ^= 0xFF;</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[1] ^= 0xFE;</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[2] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(alen&gt;&gt;24);</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[3] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(alen&gt;&gt;16);</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[4] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(alen&gt;&gt;8);</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[5] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)alen;</div>
<div class="line">                i=6;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">do</span> {</div>
<div class="line">                <span class="keywordflow">for</span>(;i&lt;16 &amp;&amp; alen;++i,++aad,--alen)</div>
<div class="line">                        ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i] ^= *aad;</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a23a1e69ff01072f546bc54c907b77959">key</a>),</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7502836a59889b3b11af57068228e8c1">blocks</a>++;</div>
<div class="line">                i=0;</div>
<div class="line">        } <span class="keywordflow">while</span> (alen);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ace9974c12c5fe3514a5fedd0d5368c91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CRYPTO_ccm128_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccm128_8c_source.html#l00245">245</a> of file <a class="el" href="ccm128_8c_source.html">ccm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">size_t</span>          n;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    i,L;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   flags0  = ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0];</div>
<div class="line">        <a class="code" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>      block   = ctx-&gt;<a class="code" href="structccm128__context.html#aa638afbe234c07148a22eef92d1b18a9">block</a>;</div>
<div class="line">        <span class="keywordtype">void</span> *          <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>     = ctx-&gt;<a class="code" href="structccm128__context.html#a23a1e69ff01072f546bc54c907b77959">key</a>;</div>
<div class="line">        <span class="keyword">union </span>{ <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>[2]; <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[16]; } scratch;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(flags0&amp;0x40))</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] = L = flags0&amp;7;</div>
<div class="line">        <span class="keywordflow">for</span> (n=0,i=15-L;i&lt;15;++i) {</div>
<div class="line">                n |= ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i];</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i]=0;</div>
<div class="line">                n &lt;&lt;= 8;</div>
<div class="line">        }</div>
<div class="line">        n |= ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[15];  <span class="comment">/* reconstructed length */</span></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[15]=1;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (n!=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keyword">union </span>{ <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>[2]; <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[16]; } temp;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,scratch.c,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                ctr64_inc(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>);</div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                memcpy (temp.c,inp,16);</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[0] ^= (scratch.u[0] ^= temp.u[0]);</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[1] ^= (scratch.u[1] ^= temp.u[1]);</div>
<div class="line">                memcpy (<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,scratch.c,16);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[0] ^= (((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>)[0] = scratch.u[0]^((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)inp)[0]);</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[1] ^= (((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>)[1] = scratch.u[1]^((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)inp)[1]);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line"></div>
<div class="line">                inp += 16;</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += 16;</div>
<div class="line">                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,scratch.c,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>; ++i)</div>
<div class="line">                        ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i] ^= (<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[i] = scratch.c[i]^inp[i]);</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i=15-L;i&lt;16;++i)</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i]=0;</div>
<div class="line"></div>
<div class="line">        (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,scratch.c,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[0] ^= scratch.u[0];</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[1] ^= scratch.u[1];</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] = flags0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2c9a2ccd17de9383a4b6d66a7d682d32"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CRYPTO_ccm128_decrypt_ccm64 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ae1caef5ce91a332503164f3d73a6afb7">ccm128_f</a>&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccm128_8c_source.html#l00381">381</a> of file <a class="el" href="ccm128_8c_source.html">ccm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">size_t</span>          n;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    i,L;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   flags0  = ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0];</div>
<div class="line">        <a class="code" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>      block   = ctx-&gt;<a class="code" href="structccm128__context.html#aa638afbe234c07148a22eef92d1b18a9">block</a>;</div>
<div class="line">        <span class="keywordtype">void</span> *          <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>     = ctx-&gt;<a class="code" href="structccm128__context.html#a23a1e69ff01072f546bc54c907b77959">key</a>;</div>
<div class="line">        <span class="keyword">union </span>{ <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>[2]; <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[16]; } scratch;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(flags0&amp;0x40))</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] = L = flags0&amp;7;</div>
<div class="line">        <span class="keywordflow">for</span> (n=0,i=15-L;i&lt;15;++i) {</div>
<div class="line">                n |= ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i];</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i]=0;</div>
<div class="line">                n &lt;&lt;= 8;</div>
<div class="line">        }</div>
<div class="line">        n |= ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[15];  <span class="comment">/* reconstructed length */</span></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[15]=1;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (n!=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((n=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>/16)) {</div>
<div class="line">                (*stream)(inp,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,n,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>);</div>
<div class="line">                n   *= 16;</div>
<div class="line">                inp += n;</div>
<div class="line">                out += n;</div>
<div class="line">                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= n;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) ctr64_add(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,n/16);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,scratch.c,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>; ++i)</div>
<div class="line">                        ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i] ^= (out[i] = scratch.c[i]^inp[i]);</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i=15-L;i&lt;16;++i)</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i]=0;</div>
<div class="line"></div>
<div class="line">        (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,scratch.c,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[0] ^= scratch.u[0];</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[1] ^= scratch.u[1];</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] = flags0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8f33d493c1a71fb89ba125fab5e5d2ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CRYPTO_ccm128_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccm128_8c_source.html#l00170">170</a> of file <a class="el" href="ccm128_8c_source.html">ccm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">size_t</span>          n;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    i,L;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   flags0  = ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0];</div>
<div class="line">        <a class="code" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>      block   = ctx-&gt;<a class="code" href="structccm128__context.html#aa638afbe234c07148a22eef92d1b18a9">block</a>;</div>
<div class="line">        <span class="keywordtype">void</span> *          <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>     = ctx-&gt;<a class="code" href="structccm128__context.html#a23a1e69ff01072f546bc54c907b77959">key</a>;</div>
<div class="line">        <span class="keyword">union </span>{ <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>[2]; <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[16]; } scratch;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(flags0&amp;0x40))</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>),</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7502836a59889b3b11af57068228e8c1">blocks</a>++;</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] = L = flags0&amp;7;</div>
<div class="line">        for (n=0,i=15-L;i&lt;15;++i) {</div>
<div class="line">                n |= ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i];</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i]=0;</div>
<div class="line">                n &lt;&lt;= 8;</div>
<div class="line">        }</div>
<div class="line">        n |= ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[15];  <span class="comment">/* reconstructed length */</span></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[15]=1;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (n!=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) <span class="keywordflow">return</span> -1;  <span class="comment">/* length mismatch */</span></div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7502836a59889b3b11af57068228e8c1">blocks</a> += ((<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>+15)&gt;&gt;3)|1;</div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structccm128__context.html#a7502836a59889b3b11af57068228e8c1">blocks</a> &gt; (<a class="code" href="aes__x86core_8c.html#ae5a6272795b1b8e0045aa7a4319dceb8">U64</a>(1)&lt;&lt;61)) <span class="keywordflow">return</span> -2; <span class="comment">/* too much data */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keyword">union </span>{ <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>[2]; <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[16]; } temp;</div>
<div class="line"></div>
<div class="line">                memcpy (temp.c,inp,16);</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[0] ^= temp.u[0];</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[1] ^= temp.u[1];</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[0] ^= ((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)inp)[0];</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[1] ^= ((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)inp)[1];</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,scratch.c,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                ctr64_inc(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>);</div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                temp.u[0] ^= scratch.u[0];</div>
<div class="line">                temp.u[1] ^= scratch.u[1];</div>
<div class="line">                memcpy(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,temp.c,16);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                ((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>)[0] = scratch.u[0]^((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)inp)[0];</div>
<div class="line">                ((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>)[1] = scratch.u[1]^((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)inp)[1];</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                inp += 16;</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += 16;</div>
<div class="line">                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>; ++i) ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i] ^= inp[i];</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,scratch.c,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>; ++i) <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[i] = scratch.c[i]^inp[i];</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i=15-L;i&lt;16;++i)</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i]=0;</div>
<div class="line"></div>
<div class="line">        (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,scratch.c,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[0] ^= scratch.u[0];</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[1] ^= scratch.u[1];</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] = flags0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7d0d967f2e7e647114e368b9aefa8ee8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CRYPTO_ccm128_encrypt_ccm64 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ae1caef5ce91a332503164f3d73a6afb7">ccm128_f</a>&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccm128_8c_source.html#l00324">324</a> of file <a class="el" href="ccm128_8c_source.html">ccm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">size_t</span>          n;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    i,L;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   flags0  = ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0];</div>
<div class="line">        <a class="code" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>      block   = ctx-&gt;<a class="code" href="structccm128__context.html#aa638afbe234c07148a22eef92d1b18a9">block</a>;</div>
<div class="line">        <span class="keywordtype">void</span> *          <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>     = ctx-&gt;<a class="code" href="structccm128__context.html#a23a1e69ff01072f546bc54c907b77959">key</a>;</div>
<div class="line">        <span class="keyword">union </span>{ <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>[2]; <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[16]; } scratch;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(flags0&amp;0x40))</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>),</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7502836a59889b3b11af57068228e8c1">blocks</a>++;</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] = L = flags0&amp;7;</div>
<div class="line">        for (n=0,i=15-L;i&lt;15;++i) {</div>
<div class="line">                n |= ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i];</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i]=0;</div>
<div class="line">                n &lt;&lt;= 8;</div>
<div class="line">        }</div>
<div class="line">        n |= ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[15];  <span class="comment">/* reconstructed length */</span></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[15]=1;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (n!=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) <span class="keywordflow">return</span> -1;  <span class="comment">/* length mismatch */</span></div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7502836a59889b3b11af57068228e8c1">blocks</a> += ((<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>+15)&gt;&gt;3)|1;</div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structccm128__context.html#a7502836a59889b3b11af57068228e8c1">blocks</a> &gt; (<a class="code" href="aes__x86core_8c.html#ae5a6272795b1b8e0045aa7a4319dceb8">U64</a>(1)&lt;&lt;61)) <span class="keywordflow">return</span> -2; <span class="comment">/* too much data */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((n=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>/16)) {</div>
<div class="line">                (*stream)(inp,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,n,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>);</div>
<div class="line">                n   *= 16;</div>
<div class="line">                inp += n;</div>
<div class="line">                out += n;</div>
<div class="line">                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= n;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) ctr64_add(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,n/16);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>; ++i) ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i] ^= inp[i];</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,scratch.c,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>; ++i) out[i] = scratch.c[i]^inp[i];</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i=15-L;i&lt;16;++i)</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[i]=0;</div>
<div class="line"></div>
<div class="line">        (*block)(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,scratch.c,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[0] ^= scratch.u[0];</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[1] ^= scratch.u[1];</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] = flags0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3ddbc4bdd19aae3401864491151aa540"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_ccm128_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccm128_8c_source.html#l00063">63</a> of file <a class="el" href="ccm128_8c_source.html">ccm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        memset(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,0,<span class="keyword">sizeof</span>(ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>));</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] = ((<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(L-1)&amp;7) | (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(((M-2)/2)&amp;7)&lt;&lt;3;</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7502836a59889b3b11af57068228e8c1">blocks</a> = 0;</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#aa638afbe234c07148a22eef92d1b18a9">block</a> = block;</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a23a1e69ff01072f546bc54c907b77959">key</a> = <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad3346f6edb53cb6830375d6fdd6d52f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CRYPTO_ccm128_setiv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>mlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccm128_8c_source.html#l00076">76</a> of file <a class="el" href="ccm128_8c_source.html">ccm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> L = ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0]&amp;7;     <span class="comment">/* the L parameter */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (nlen&lt;(14-L)) <span class="keywordflow">return</span> -1;             <span class="comment">/* nonce is too short */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(mlen)==8 &amp;&amp; L&gt;=3) {</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[8]  = (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(mlen&gt;&gt;(56%(<span class="keyword">sizeof</span>(mlen)*8)));</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[9]  = (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(mlen&gt;&gt;(48%(<span class="keyword">sizeof</span>(mlen)*8)));</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[10] = (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(mlen&gt;&gt;(40%(<span class="keyword">sizeof</span>(mlen)*8)));</div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[11] = (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(mlen&gt;&gt;(32%(<span class="keyword">sizeof</span>(mlen)*8)));</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#a4423b57053a10d3c79ef1d12451218db">u</a>[1] = 0;</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[12] = (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(mlen&gt;&gt;24);</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[13] = (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(mlen&gt;&gt;16);</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[14] = (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(mlen&gt;&gt;8);</div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[15] = (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)mlen;</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0] &amp;= ~0x40;       <span class="comment">/* clear Adata flag */</span></div>
<div class="line">        memcpy(&amp;ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[1],nonce,14-L);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae2a130dc00b30de17ea9e550864d8d54"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CRYPTO_ccm128_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a95fba40cd3d7febce85290bf899662e1">CCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccm128_8c_source.html#l00434">434</a> of file <a class="el" href="ccm128_8c_source.html">ccm128.c</a>.</p>
<div class="fragment"><div class="line">{       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> M = (ctx-&gt;<a class="code" href="structccm128__context.html#a7bf21ca43ab787fb0509df4735b6875e">nonce</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>[0]&gt;&gt;3)&amp;7;        <span class="comment">/* the M parameter */</span></div>
<div class="line"></div>
<div class="line">        M *= 2; M += 2;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&lt;M)      <span class="keywordflow">return</span> 0;</div>
<div class="line">        memcpy(tag,ctx-&gt;<a class="code" href="structccm128__context.html#a9afe1c4c2b2579ea7707b7009c087230">cmac</a>.<a class="code" href="structccm128__context.html#ada3aaca1cb2e8485f6e173d4ab6b447e">c</a>,M);</div>
<div class="line">        <span class="keywordflow">return</span> M;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aca08c600331f017ca56a250bf9f5d2ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_cfb128_1_encrypt </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>bits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>enc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cfb128_8c_source.html#l00209">209</a> of file <a class="el" href="cfb128_8c_source.html">cfb128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> n;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[1],d[1];</div>
<div class="line"></div>
<div class="line">    assert(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec &amp;&amp; num);</div>
<div class="line">    assert(*num == 0);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>(n=0 ; n&lt;<a class="code" href="x509v3_8h.html#ab3c186980893d6836a68407d221ae9c9">bits</a> ; ++n)</div>
<div class="line">        {</div>
<div class="line">        c[0]=(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n/8]&amp;(1 &lt;&lt; (7-n%8))) ? 0x80 : 0;</div>
<div class="line">        cfbr_encrypt_block(c,d,1,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,enc,block);</div>
<div class="line">        <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n/8]=(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n/8]&amp;~(1 &lt;&lt; (<span class="keywordtype">unsigned</span> int)(7-n%8))) |</div>
<div class="line">                 ((d[0]&amp;0x80) &gt;&gt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(n%8));</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a355e4bb29e1947a73449857b4a126f1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_cfb128_8_encrypt </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>enc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cfb128_8c_source.html#l00229">229</a> of file <a class="el" href="cfb128_8c_source.html">cfb128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> n;</div>
<div class="line"></div>
<div class="line">    assert(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec &amp;&amp; num);</div>
<div class="line">    assert(*num == 0);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>(n=0 ; n&lt;<a class="code" href="asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a> ; ++n)</div>
<div class="line">        cfbr_encrypt_block(&amp;<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n],&amp;<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n],8,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,enc,block);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5c982e56a8f27559f7e64364ef36c868"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_cfb128_encrypt </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>enc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cfb128_8c_source.html#l00066">66</a> of file <a class="el" href="cfb128_8c_source.html">cfb128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n;</div>
<div class="line">    <span class="keywordtype">size_t</span> l = 0;</div>
<div class="line"></div>
<div class="line">    assert(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec &amp;&amp; num);</div>
<div class="line"></div>
<div class="line">    n = *num;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (enc) {</div>
<div class="line"><span class="preprocessor">#if !defined(OPENSSL_SMALL_FOOTPRINT)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (16%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) == 0) <span class="keywordflow">do</span> {        <span class="comment">/* always true actually */</span></div>
<div class="line">                <span class="keywordflow">while</span> (n &amp;&amp; <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        *(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>++) = ivec[n] ^= *(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>++);</div>
<div class="line">                        --<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                        n = (n+1) % 16;</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">if</span> (((<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>|(size_t)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>|(<span class="keywordtype">size_t</span>)ivec)%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) != 0)</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                        (*block)(ivec, ivec, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        <span class="keywordflow">for</span> (; n&lt;16; n+=<span class="keyword">sizeof</span>(size_t)) {</div>
<div class="line">                                *(<span class="keywordtype">size_t</span>*)(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>+n) =</div>
<div class="line">                                *(<span class="keywordtype">size_t</span>*)(ivec+n) ^= *(<span class="keywordtype">size_t</span>*)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>+n);</div>
<div class="line">                        }</div>
<div class="line">                        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += 16;</div>
<div class="line">                        n = 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        (*block)(ivec, ivec, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>--) {</div>
<div class="line">                                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n] = ivec[n] ^= <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n];</div>
<div class="line">                                ++n;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                *num = n;</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        } <span class="keywordflow">while</span> (0);</div>
<div class="line">        <span class="comment">/* the rest would be commonly eliminated by x86* compiler */</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">while</span> (l&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">                        (*block)(ivec, ivec, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                }</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[l] = ivec[n] ^= <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[l];</div>
<div class="line">                ++l;</div>
<div class="line">                n = (n+1) % 16;</div>
<div class="line">        }</div>
<div class="line">        *num = n;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="preprocessor">#if !defined(OPENSSL_SMALL_FOOTPRINT)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (16%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) == 0) <span class="keywordflow">do</span> {        <span class="comment">/* always true actually */</span></div>
<div class="line">                <span class="keywordflow">while</span> (n &amp;&amp; <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>;</div>
<div class="line">                        *(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>++) = ivec[n] ^ (c = *(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>++)); ivec[n] = c;</div>
<div class="line">                        --<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                        n = (n+1) % 16;</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">if</span> (((<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>|(size_t)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>|(<span class="keywordtype">size_t</span>)ivec)%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) != 0)</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                        (*block)(ivec, ivec, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        <span class="keywordflow">for</span> (; n&lt;16; n+=<span class="keyword">sizeof</span>(size_t)) {</div>
<div class="line">                                <span class="keywordtype">size_t</span> <a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a> = *(<span class="keywordtype">size_t</span>*)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>+n);</div>
<div class="line">                                *(<span class="keywordtype">size_t</span>*)(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>+n) = *(<span class="keywordtype">size_t</span>*)(ivec+n) ^ <a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>;</div>
<div class="line">                                *(<span class="keywordtype">size_t</span>*)(ivec+n) = <a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>;</div>
<div class="line">                        }</div>
<div class="line">                        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += 16;</div>
<div class="line">                        n = 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        (*block)(ivec, ivec, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>--) {</div>
<div class="line">                                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c;</div>
<div class="line">                                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n] = ivec[n] ^ (c = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n]); ivec[n] = c;</div>
<div class="line">                                ++n;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                *num = n;</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        } <span class="keywordflow">while</span> (0);</div>
<div class="line">        <span class="comment">/* the rest would be commonly eliminated by x86* compiler */</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">while</span> (l&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c;</div>
<div class="line">                <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">                        (*block)(ivec, ivec, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                }</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[l] = ivec[n] ^ (c = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[l]); ivec[n] = c;</div>
<div class="line">                ++l;</div>
<div class="line">                n = (n+1) % 16;</div>
<div class="line">        }</div>
<div class="line">        *num=n;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af30a43dd23d0d25cc94a01f1a41f0746"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_ctr128_encrypt </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ecount_buf</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ctr128_8c_source.html#l00114">114</a> of file <a class="el" href="ctr128_8c_source.html">ctr128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n;</div>
<div class="line">        <span class="keywordtype">size_t</span> l=0;</div>
<div class="line"></div>
<div class="line">        assert(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ecount_buf &amp;&amp; num);</div>
<div class="line">        assert(*num &lt; 16);</div>
<div class="line"></div>
<div class="line">        n = *num;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if !defined(OPENSSL_SMALL_FOOTPRINT)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (16%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) == 0) <span class="keywordflow">do</span> { <span class="comment">/* always true actually */</span></div>
<div class="line">                <span class="keywordflow">while</span> (n &amp;&amp; <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        *(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>++) = *(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>++) ^ ecount_buf[n];</div>
<div class="line">                        --<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                        n = (n+1) % 16;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">if</span> (((<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>|(size_t)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>|(<span class="keywordtype">size_t</span>)ivec)%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) != 0)</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                        (*block)(ivec, ecount_buf, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        ctr128_inc_aligned(ivec);</div>
<div class="line">                        <span class="keywordflow">for</span> (; n&lt;16; n+=<span class="keyword">sizeof</span>(size_t))</div>
<div class="line">                                *(<span class="keywordtype">size_t</span> *)(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>+n) =</div>
<div class="line">                                *(<span class="keywordtype">size_t</span> *)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>+n) ^ *(<span class="keywordtype">size_t</span> *)(ecount_buf+n);</div>
<div class="line">                        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += 16;</div>
<div class="line">                        n = 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        (*block)(ivec, ecount_buf, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        ctr128_inc_aligned(ivec);</div>
<div class="line">                        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>--) {</div>
<div class="line">                                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n] = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n] ^ ecount_buf[n];</div>
<div class="line">                                ++n;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                *num = n;</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        } <span class="keywordflow">while</span>(0);</div>
<div class="line">        <span class="comment">/* the rest would be commonly eliminated by x86* compiler */</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">while</span> (l&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                <span class="keywordflow">if</span> (n==0) {</div>
<div class="line">                        (*block)(ivec, ecount_buf, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        ctr128_inc(ivec);</div>
<div class="line">                }</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[l] = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[l] ^ ecount_buf[n];</div>
<div class="line">                ++l;</div>
<div class="line">                n = (n+1) % 16;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        *num=n;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a52c2dc3d1a797a15ad1a33be01e010ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_ctr128_encrypt_ctr32 </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ecount_buf</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a733a81250b14ef18c1a889dfc12caa6d">ctr128_f</a>&#160;</td>
          <td class="paramname"><em>ctr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ctr128_8c_source.html#l00190">190</a> of file <a class="el" href="ctr128_8c_source.html">ctr128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n,ctr32;</div>
<div class="line"></div>
<div class="line">        assert(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ecount_buf &amp;&amp; num);</div>
<div class="line">        assert(*num &lt; 16);</div>
<div class="line"></div>
<div class="line">        n = *num;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">while</span> (n &amp;&amp; <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                *(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>++) = *(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>++) ^ ecount_buf[n];</div>
<div class="line">                --<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                n = (n+1) % 16;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        ctr32 = <a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(ivec+12);</div>
<div class="line">        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                <span class="keywordtype">size_t</span> blocks = <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>/16;</div>
<div class="line">                <span class="comment">/*</span></div>
<div class="line"><span class="comment">                 * 1&lt;&lt;28 is just a not-so-small yet not-so-large number...</span></div>
<div class="line"><span class="comment">                 * Below condition is practically never met, but it has to</span></div>
<div class="line"><span class="comment">                 * be checked for code correctness.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>)&gt;<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) &amp;&amp; blocks&gt;(1U&lt;&lt;28))</div>
<div class="line">                        blocks = (1U&lt;&lt;28);</div>
<div class="line">                <span class="comment">/*</span></div>
<div class="line"><span class="comment">                 * As (*func) operates on 32-bit counter, caller</span></div>
<div class="line"><span class="comment">                 * has to handle overflow. &#39;if&#39; below detects the</span></div>
<div class="line"><span class="comment">                 * overflow, which is then handled by limiting the</span></div>
<div class="line"><span class="comment">                 * amount of blocks to the exact overflow point...</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                ctr32 += (<a class="code" href="aes__locl_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>)blocks;</div>
<div class="line">                <span class="keywordflow">if</span> (ctr32 &lt; blocks) {</div>
<div class="line">                        blocks -= ctr32;</div>
<div class="line">                        ctr32   = 0;</div>
<div class="line">                }</div>
<div class="line">                (*func)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,blocks,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec);</div>
<div class="line">                <span class="comment">/* (*ctr) does not update ivec, caller does: */</span></div>
<div class="line">                <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ivec+12,ctr32);</div>
<div class="line">                <span class="comment">/* ... overflow was detected, propogate carry. */</span></div>
<div class="line">                <span class="keywordflow">if</span> (ctr32 == 0) ctr96_inc(ivec);</div>
<div class="line">                blocks *= 16;</div>
<div class="line">                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= blocks;</div>
<div class="line">                out += blocks;</div>
<div class="line">                in  += blocks;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                memset(ecount_buf,0,16);</div>
<div class="line">                (*func)(ecount_buf,ecount_buf,1,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec);</div>
<div class="line">                ++ctr32;</div>
<div class="line">                <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ivec+12,ctr32);</div>
<div class="line">                <span class="keywordflow">if</span> (ctr32 == 0) ctr96_inc(ivec);</div>
<div class="line">                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>--) {</div>
<div class="line">                        out[n] = in[n] ^ ecount_buf[n];</div>
<div class="line">                        ++n;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        *num=n;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aee42bf2d060845035b7eff0f884fd6a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CRYPTO_cts128_decrypt </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a0eed6ee3d31ba9aea497696eabda5df4">cbc128_f</a>&#160;</td>
          <td class="paramname"><em>cbc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cts128_8c_source.html#l00230">230</a> of file <a class="el" href="cts128_8c_source.html">cts128.c</a>.</p>
<div class="fragment"><div class="line">{       <span class="keywordtype">size_t</span> residue;</div>
<div class="line">        <span class="keyword">union </span>{ <span class="keywordtype">size_t</span> align; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[32]; } tmp;</div>
<div class="line"></div>
<div class="line">        assert (<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&lt;=16) <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((residue=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>%16) == 0) residue = 16;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16+residue;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                (*cbc)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,0);</div>
<div class="line">                in  += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                out += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        memset(tmp.c,0,<span class="keyword">sizeof</span>(tmp));</div>
<div class="line">        <span class="comment">/* this places in[16] at &amp;tmp.c[16] and decrypted block at &amp;tmp.c[0] */</span></div>
<div class="line">        (*cbc)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,tmp.c,16,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,tmp.c+16,0);</div>
<div class="line"></div>
<div class="line">        memcpy(tmp.c,in+16,residue);</div>
<div class="line"><span class="preprocessor">#if defined(CBC_HANDLES_TRUNCATED_IO)</span></div>
<div class="line"><span class="preprocessor"></span>        (*cbc)(tmp.c,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,16+residue,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,0);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        (*cbc)(tmp.c,tmp.c,32,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,0);</div>
<div class="line">        memcpy(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,tmp.c,16+residue);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">return</span> 16+<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>+residue;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1002021ed22fe1dd0f7d78fa7907a525"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CRYPTO_cts128_decrypt_block </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cts128_8c_source.html#l00150">150</a> of file <a class="el" href="cts128_8c_source.html">cts128.c</a>.</p>
<div class="fragment"><div class="line">{       <span class="keywordtype">size_t</span> residue, n;</div>
<div class="line">        <span class="keyword">union </span>{ <span class="keywordtype">size_t</span> align; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[32]; } tmp;</div>
<div class="line"></div>
<div class="line">        assert (<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&lt;=16) <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((residue=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>%16) == 0) residue = 16;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16+residue;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                <a class="code" href="cbc128_8c.html#a009400dbb93db1cb23550cdb66eac5ad">CRYPTO_cbc128_decrypt</a>(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,block);</div>
<div class="line">                <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        (*block)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,tmp.c+16,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line"></div>
<div class="line">        memcpy(tmp.c,tmp.c+16,16);</div>
<div class="line">        memcpy(tmp.c,in+16,residue);</div>
<div class="line">        (*block)(tmp.c,tmp.c,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(n=0; n&lt;16; ++n) {</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a> = in[n];</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n] = tmp.c[n] ^ ivec[n];</div>
<div class="line">                ivec[n] = c;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">for</span>(residue+=16; n&lt;residue; ++n)</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n] = tmp.c[n] ^ in[n];</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 16+<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>+residue;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae6348ad0b524fd00afff759c2a3c52cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CRYPTO_cts128_encrypt </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a0eed6ee3d31ba9aea497696eabda5df4">cbc128_f</a>&#160;</td>
          <td class="paramname"><em>cbc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cts128_8c_source.html#l00087">87</a> of file <a class="el" href="cts128_8c_source.html">cts128.c</a>.</p>
<div class="fragment"><div class="line">{       <span class="keywordtype">size_t</span> residue;</div>
<div class="line">        <span class="keyword">union </span>{ <span class="keywordtype">size_t</span> align; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[16]; } tmp;</div>
<div class="line"></div>
<div class="line">        assert (<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> &lt;= 16) <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((residue=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>%16) == 0) residue = 16;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= residue;</div>
<div class="line"></div>
<div class="line">        (*cbc)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,1);</div>
<div class="line"></div>
<div class="line">        in  += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        out += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if defined(CBC_HANDLES_TRUNCATED_IO)</span></div>
<div class="line"><span class="preprocessor"></span>        memcpy(tmp.c,out-16,16);</div>
<div class="line">        (*cbc)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,out-16,residue,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,1);</div>
<div class="line">        memcpy(out,tmp.c,residue);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        memset(tmp.c,0,<span class="keyword">sizeof</span>(tmp));</div>
<div class="line">        memcpy(tmp.c,in,residue);</div>
<div class="line">        memcpy(out,out-16,residue);</div>
<div class="line">        (*cbc)(tmp.c,out-16,16,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,1);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">return</span> len+residue;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3e32a5c536863c9590e9225a918d364b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CRYPTO_cts128_encrypt_block </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cts128_8c_source.html#l00032">32</a> of file <a class="el" href="cts128_8c_source.html">cts128.c</a>.</p>
<div class="fragment"><div class="line">{       <span class="keywordtype">size_t</span> residue, n;</div>
<div class="line"></div>
<div class="line">        assert (<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> &lt;= 16) <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((residue=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>%16) == 0) residue = 16;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= residue;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="cbc128_8c.html#a5cbe79f5b3a935a6e49ac72e3f3e4fb2">CRYPTO_cbc128_encrypt</a>(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,block);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (n=0; n&lt;residue; ++n)</div>
<div class="line">                ivec[n] ^= <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n];</div>
<div class="line">        (*block)(ivec,ivec,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">        memcpy(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>-16,residue);</div>
<div class="line">        memcpy(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>-16,ivec,16); </div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>+residue;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3a3e9723bbfebd1d36b278815e226460"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CRYPTO_gcm128_aad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>aad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="gcm128_8c_source.html#l00871">871</a> of file <a class="el" href="gcm128_8c_source.html">gcm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">size_t</span> i;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n;</div>
<div class="line">        <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> alen = ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[0];</div>
<div class="line"><span class="preprocessor">#ifdef GCM_FUNCREF_4BIT</span></div>
<div class="line"><span class="preprocessor"></span>        void (*gcm_gmult_p)(<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> Xi[2],<span class="keyword">const</span> <a class="code" href="structu128.html">u128</a> Htable[16])    = ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a>;</div>
<div class="line"># ifdef <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a></div>
<div class="line">        void (*gcm_ghash_p)(<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> Xi[2],<span class="keyword">const</span> <a class="code" href="structu128.html">u128</a> Htable[16],</div>
<div class="line">                                <span class="keyword">const</span> <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> *inp,<span class="keywordtype">size_t</span> <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)       = ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a>;</div>
<div class="line"># endif</div>
<div class="line">#endif</div>
<div class="line"></div>
<div class="line">        if (ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1]) <span class="keywordflow">return</span> -2;</div>
<div class="line"></div>
<div class="line">        alen += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (alen&gt;(<a class="code" href="aes__x86core_8c.html#ae5a6272795b1b8e0045aa7a4319dceb8">U64</a>(1)&lt;&lt;61) || (<span class="keyword">sizeof</span>(<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)==8 &amp;&amp; alen&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>))</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[0] = alen;</div>
<div class="line"></div>
<div class="line">        n = ctx-&gt;<a class="code" href="structgcm128__context.html#addb55a4b34d2c51313a254b4e45b8ba0">ares</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (n) {</div>
<div class="line">                <span class="keywordflow">while</span> (n &amp;&amp; <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n] ^= *(aad++);</div>
<div class="line">                        --<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                        n = (n+1)%16;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (n==0) <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">                <span class="keywordflow">else</span> {</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#addb55a4b34d2c51313a254b4e45b8ba0">ares</a> = n;</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifdef GHASH</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> ((i = (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&amp;(<span class="keywordtype">size_t</span>)-16))) {</div>
<div class="line">                <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a>(ctx,aad,i);</div>
<div class="line">                aad += i;</div>
<div class="line">                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= i;</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                <span class="keywordflow">for</span> (i=0; i&lt;16; ++i) ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[i] ^= aad[i];</div>
<div class="line">                <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">                aad += 16;</div>
<div class="line">                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                n = (<span class="keywordtype">unsigned</span> int)<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>; ++i) ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[i] ^= aad[i];</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#addb55a4b34d2c51313a254b4e45b8ba0">ares</a> = n;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac29699ec140758465503d86f7d1460cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CRYPTO_gcm128_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="gcm128_8c_source.html#l01108">1108</a> of file <a class="el" href="gcm128_8c_source.html">gcm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">union </span>{ <span class="keywordtype">long</span> one; <span class="keywordtype">char</span> little; } is_endian = {1};</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, ctr;</div>
<div class="line">        <span class="keywordtype">size_t</span> i;</div>
<div class="line">        <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>        mlen  = ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1];</div>
<div class="line">        <a class="code" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block = ctx-&gt;<a class="code" href="structgcm128__context.html#a2cc964a91c87a576820bc105a33c580e">block</a>;</div>
<div class="line">        <span class="keywordtype">void</span>      *<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>   = ctx-&gt;<a class="code" href="structgcm128__context.html#aa8914ce246bf1f9d885409534aeb43f0">key</a>;</div>
<div class="line"><span class="preprocessor">#ifdef GCM_FUNCREF_4BIT</span></div>
<div class="line"><span class="preprocessor"></span>        void (*gcm_gmult_p)(<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> Xi[2],<span class="keyword">const</span> <a class="code" href="structu128.html">u128</a> Htable[16])    = ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a>;</div>
<div class="line"># ifdef <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a></div>
<div class="line">        void (*gcm_ghash_p)(<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> Xi[2],<span class="keyword">const</span> <a class="code" href="structu128.html">u128</a> Htable[16],</div>
<div class="line">                                <span class="keyword">const</span> <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> *inp,<span class="keywordtype">size_t</span> <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)       = ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a>;</div>
<div class="line"># endif</div>
<div class="line">#endif</div>
<div class="line"></div>
<div class="line">        mlen += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        if (mlen&gt;((<a class="code" href="aes__x86core_8c.html#ae5a6272795b1b8e0045aa7a4319dceb8">U64</a>(1)&lt;&lt;36)-32) || (<span class="keyword">sizeof</span>(<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)==8 &amp;&amp; mlen&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>))</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1] = mlen;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structgcm128__context.html#addb55a4b34d2c51313a254b4e45b8ba0">ares</a>) {</div>
<div class="line">                <span class="comment">/* First call to decrypt finalizes GHASH(AAD) */</span></div>
<div class="line">                <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#addb55a4b34d2c51313a254b4e45b8ba0">ares</a> = 0;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                ctr = BSWAP4(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3]);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                ctr = <a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">else</span></div>
<div class="line">                ctr = ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3];</div>
<div class="line"></div>
<div class="line">        n = ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a>;</div>
<div class="line"><span class="preprocessor">#if !defined(OPENSSL_SMALL_FOOTPRINT)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (16%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) == 0) <span class="keywordflow">do</span> {        <span class="comment">/* always true actually */</span></div>
<div class="line">                <span class="keywordflow">if</span> (n) {</div>
<div class="line">                        <span class="keywordflow">while</span> (n &amp;&amp; <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                                <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a> = *(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>++);</div>
<div class="line">                                *(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>++) = c^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n];</div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n] ^= c;</div>
<div class="line">                                --<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                                n = (n+1)%16;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">if</span> (n==0) <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a> (ctx,Xi);</div>
<div class="line">                        <span class="keywordflow">else</span> {</div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a> = n;</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">if</span> (((<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>|(<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>)%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) != 0)</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#if defined(GHASH) &amp;&amp; defined(GHASH_CHUNK)</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=<a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>) {</div>
<div class="line">                    <span class="keywordtype">size_t</span> j=<a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>;</div>
<div class="line"></div>
<div class="line">                    <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a>(ctx,<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>);</div>
<div class="line">                    <span class="keywordflow">while</span> (j) {</div>
<div class="line">                        <span class="keywordtype">size_t</span> *out_t=(<span class="keywordtype">size_t</span> *)out;</div>
<div class="line">                        <span class="keyword">const</span> <span class="keywordtype">size_t</span> *in_t=(<span class="keyword">const</span> <span class="keywordtype">size_t</span> *)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line"></div>
<div class="line">                        (*block)(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        ++ctr;</div>
<div class="line">                        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                                <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                        <span class="keywordflow">else</span></div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                        <span class="keywordflow">for</span> (i=0; i&lt;16/<span class="keyword">sizeof</span>(size_t); ++i)</div>
<div class="line">                                out_t[i] = in_t[i]^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#aa12fe219e932cef150d109733a56e1cd">t</a>[i];</div>
<div class="line">                        out += 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += 16;</div>
<div class="line">                        j   -= 16;</div>
<div class="line">                    }</div>
<div class="line">                    <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= <a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> ((i = (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&amp;(<span class="keywordtype">size_t</span>)-16))) {</div>
<div class="line">                    <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a>(ctx,<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,i);</div>
<div class="line">                    <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                        <span class="keywordtype">size_t</span> *out_t=(<span class="keywordtype">size_t</span> *)out;</div>
<div class="line">                        <span class="keyword">const</span> <span class="keywordtype">size_t</span> *in_t=(<span class="keyword">const</span> <span class="keywordtype">size_t</span> *)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line"></div>
<div class="line">                        (*block)(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        ++ctr;</div>
<div class="line">                        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                                <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                        <span class="keywordflow">else</span></div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                        <span class="keywordflow">for</span> (i=0; i&lt;16/<span class="keyword">sizeof</span>(size_t); ++i)</div>
<div class="line">                                out_t[i] = in_t[i]^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#aa12fe219e932cef150d109733a56e1cd">t</a>[i];</div>
<div class="line">                        out += 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += 16;</div>
<div class="line">                        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                        <span class="keywordtype">size_t</span> *out_t=(<span class="keywordtype">size_t</span> *)out;</div>
<div class="line">                        <span class="keyword">const</span> <span class="keywordtype">size_t</span> *in_t=(<span class="keyword">const</span> <span class="keywordtype">size_t</span> *)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line"></div>
<div class="line">                        (*block)(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        ++ctr;</div>
<div class="line">                        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                                <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                        <span class="keywordflow">else</span></div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                        <span class="keywordflow">for</span> (i=0; i&lt;16/<span class="keyword">sizeof</span>(size_t); ++i) {</div>
<div class="line">                                <span class="keywordtype">size_t</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a> = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[i];</div>
<div class="line">                                out[i] = c^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#aa12fe219e932cef150d109733a56e1cd">t</a>[i];</div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#aa12fe219e932cef150d109733a56e1cd">t</a>[i] ^= c;</div>
<div class="line">                        }</div>
<div class="line">                        <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">                        out += 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += 16;</div>
<div class="line">                        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        (*block)(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        ++ctr;</div>
<div class="line">                        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                                <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                        <span class="keywordflow">else</span></div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>--) {</div>
<div class="line">                                <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a> = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n];</div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n] ^= c;</div>
<div class="line">                                out[n] = c^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n];</div>
<div class="line">                                ++n;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a> = n;</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        } <span class="keywordflow">while</span>(0);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;++i) {</div>
<div class="line">                <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (n==0) {</div>
<div class="line">                        (*block)(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        ++ctr;</div>
<div class="line">                        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                                <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                        <span class="keywordflow">else</span></div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                }</div>
<div class="line">                c = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[i];</div>
<div class="line">                out[i] = c^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n];</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n] ^= c;</div>
<div class="line">                n = (n+1)%16;</div>
<div class="line">                <span class="keywordflow">if</span> (n==0)</div>
<div class="line">                        <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a> = n;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3abd2326aa2402ca5afaeac5dba2df8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CRYPTO_gcm128_decrypt_ctr32 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a733a81250b14ef18c1a889dfc12caa6d">ctr128_f</a>&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="gcm128_8c_source.html#l01407">1407</a> of file <a class="el" href="gcm128_8c_source.html">gcm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">union </span>{ <span class="keywordtype">long</span> one; <span class="keywordtype">char</span> little; } is_endian = {1};</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, ctr;</div>
<div class="line">        <span class="keywordtype">size_t</span> i;</div>
<div class="line">        <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>   mlen = ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1];</div>
<div class="line">        <span class="keywordtype">void</span> *<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>  = ctx-&gt;<a class="code" href="structgcm128__context.html#aa8914ce246bf1f9d885409534aeb43f0">key</a>;</div>
<div class="line"><span class="preprocessor">#ifdef GCM_FUNCREF_4BIT</span></div>
<div class="line"><span class="preprocessor"></span>        void (*gcm_gmult_p)(<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> Xi[2],<span class="keyword">const</span> <a class="code" href="structu128.html">u128</a> Htable[16])    = ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a>;</div>
<div class="line"># ifdef <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a></div>
<div class="line">        void (*gcm_ghash_p)(<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> Xi[2],<span class="keyword">const</span> <a class="code" href="structu128.html">u128</a> Htable[16],</div>
<div class="line">                                <span class="keyword">const</span> <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> *inp,<span class="keywordtype">size_t</span> <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)       = ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a>;</div>
<div class="line"># endif</div>
<div class="line">#endif</div>
<div class="line"></div>
<div class="line">        mlen += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        if (mlen&gt;((<a class="code" href="aes__x86core_8c.html#ae5a6272795b1b8e0045aa7a4319dceb8">U64</a>(1)&lt;&lt;36)-32) || (<span class="keyword">sizeof</span>(<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)==8 &amp;&amp; mlen&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>))</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1] = mlen;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structgcm128__context.html#addb55a4b34d2c51313a254b4e45b8ba0">ares</a>) {</div>
<div class="line">                <span class="comment">/* First call to decrypt finalizes GHASH(AAD) */</span></div>
<div class="line">                <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#addb55a4b34d2c51313a254b4e45b8ba0">ares</a> = 0;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                ctr = BSWAP4(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3]);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                ctr = <a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">else</span></div>
<div class="line">                ctr = ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3];</div>
<div class="line"></div>
<div class="line">        n = ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (n) {</div>
<div class="line">                <span class="keywordflow">while</span> (n &amp;&amp; <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a> = *(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>++);</div>
<div class="line">                        *(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>++) = c^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n];</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n] ^= c;</div>
<div class="line">                        --<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                        n = (n+1)%16;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (n==0) <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a> (ctx,Xi);</div>
<div class="line">                <span class="keywordflow">else</span> {</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a> = n;</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#if defined(GHASH) &amp;&amp; !defined(OPENSSL_SMALL_FOOTPRINT)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=<a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>) {</div>
<div class="line">                <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a>(ctx,<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>);</div>
<div class="line">                (*stream)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,<a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>/16,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>);</div>
<div class="line">                ctr += <a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>/16;</div>
<div class="line">                <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                        <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">else</span></div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                out += <a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>;</div>
<div class="line">                in  += <a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>;</div>
<div class="line">                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= <a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>;</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> ((i = (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&amp;(<span class="keywordtype">size_t</span>)-16))) {</div>
<div class="line">                <span class="keywordtype">size_t</span> j=i/16;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if defined(GHASH)</span></div>
<div class="line"><span class="preprocessor"></span>                <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a>(ctx,in,i);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">while</span> (j--) {</div>
<div class="line">                        <span class="keywordtype">size_t</span> <a class="code" href="ideatest_8c.html#affd277b0419eb3509477eb517aa904ce">k</a>;</div>
<div class="line">                        <span class="keywordflow">for</span> (k=0;k&lt;16;++<a class="code" href="ideatest_8c.html#affd277b0419eb3509477eb517aa904ce">k</a>) ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[k] ^= in[k];</div>
<div class="line">                        <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">                        in += 16;</div>
<div class="line">                }</div>
<div class="line">                j   = i/16;</div>
<div class="line">                in -= i;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                (*stream)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,j,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>);</div>
<div class="line">                ctr += (<span class="keywordtype">unsigned</span> int)j;</div>
<div class="line">                <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                        <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">else</span></div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                out += i;</div>
<div class="line">                in  += i;</div>
<div class="line">                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= i;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                (*ctx-&gt;<a class="code" href="structgcm128__context.html#a2cc964a91c87a576820bc105a33c580e">block</a>)(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,key);</div>
<div class="line">                ++ctr;</div>
<div class="line">                <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                        <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">else</span></div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>--) {</div>
<div class="line">                        <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a> = in[n];</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n] ^= c;</div>
<div class="line">                        out[n] = c^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n];</div>
<div class="line">                        ++n;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a> = n;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9779f2d0133e20bf5d6a2ff9833bd698"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CRYPTO_gcm128_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="gcm128_8c_source.html#l00928">928</a> of file <a class="el" href="gcm128_8c_source.html">gcm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">union </span>{ <span class="keywordtype">long</span> one; <span class="keywordtype">char</span> little; } is_endian = {1};</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, ctr;</div>
<div class="line">        <span class="keywordtype">size_t</span> i;</div>
<div class="line">        <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>        mlen  = ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1];</div>
<div class="line">        <a class="code" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a> block = ctx-&gt;<a class="code" href="structgcm128__context.html#a2cc964a91c87a576820bc105a33c580e">block</a>;</div>
<div class="line">        <span class="keywordtype">void</span>      *<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>   = ctx-&gt;<a class="code" href="structgcm128__context.html#aa8914ce246bf1f9d885409534aeb43f0">key</a>;</div>
<div class="line"><span class="preprocessor">#ifdef GCM_FUNCREF_4BIT</span></div>
<div class="line"><span class="preprocessor"></span>        void (*gcm_gmult_p)(<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> Xi[2],<span class="keyword">const</span> <a class="code" href="structu128.html">u128</a> Htable[16])    = ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a>;</div>
<div class="line"># ifdef <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a></div>
<div class="line">        void (*gcm_ghash_p)(<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> Xi[2],<span class="keyword">const</span> <a class="code" href="structu128.html">u128</a> Htable[16],</div>
<div class="line">                                <span class="keyword">const</span> <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> *inp,<span class="keywordtype">size_t</span> <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)       = ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a>;</div>
<div class="line"># endif</div>
<div class="line">#endif</div>
<div class="line"></div>
<div class="line">#<span class="keywordflow">if</span> 0</div>
<div class="line">        n = (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)mlen%16; <span class="comment">/* alternative to ctx-&gt;mres */</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        mlen += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (mlen&gt;((<a class="code" href="aes__x86core_8c.html#ae5a6272795b1b8e0045aa7a4319dceb8">U64</a>(1)&lt;&lt;36)-32) || (<span class="keyword">sizeof</span>(<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)==8 &amp;&amp; mlen&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>))</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1] = mlen;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structgcm128__context.html#addb55a4b34d2c51313a254b4e45b8ba0">ares</a>) {</div>
<div class="line">                <span class="comment">/* First call to encrypt finalizes GHASH(AAD) */</span></div>
<div class="line">                <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#addb55a4b34d2c51313a254b4e45b8ba0">ares</a> = 0;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                ctr = BSWAP4(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3]);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                ctr = <a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">else</span></div>
<div class="line">                ctr = ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3];</div>
<div class="line"></div>
<div class="line">        n = ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a>;</div>
<div class="line"><span class="preprocessor">#if !defined(OPENSSL_SMALL_FOOTPRINT)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (16%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) == 0) <span class="keywordflow">do</span> {        <span class="comment">/* always true actually */</span></div>
<div class="line">                <span class="keywordflow">if</span> (n) {</div>
<div class="line">                        <span class="keywordflow">while</span> (n &amp;&amp; <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n] ^= *(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>++) = *(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>++)^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n];</div>
<div class="line">                                --<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                                n = (n+1)%16;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">if</span> (n==0) <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">                        <span class="keywordflow">else</span> {</div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a> = n;</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">if</span> (((<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>|(<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>)%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) != 0)</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#if defined(GHASH) &amp;&amp; defined(GHASH_CHUNK)</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=<a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>) {</div>
<div class="line">                    <span class="keywordtype">size_t</span> j=<a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>;</div>
<div class="line"></div>
<div class="line">                    <span class="keywordflow">while</span> (j) {</div>
<div class="line">                        <span class="keywordtype">size_t</span> *out_t=(<span class="keywordtype">size_t</span> *)out;</div>
<div class="line">                        <span class="keyword">const</span> <span class="keywordtype">size_t</span> *in_t=(<span class="keyword">const</span> <span class="keywordtype">size_t</span> *)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line"></div>
<div class="line">                        (*block)(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        ++ctr;</div>
<div class="line">                        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                                <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                        <span class="keywordflow">else</span></div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                        <span class="keywordflow">for</span> (i=0; i&lt;16/<span class="keyword">sizeof</span>(size_t); ++i)</div>
<div class="line">                                out_t[i] = in_t[i] ^ ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#aa12fe219e932cef150d109733a56e1cd">t</a>[i];</div>
<div class="line">                        out += 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += 16;</div>
<div class="line">                        j   -= 16;</div>
<div class="line">                    }</div>
<div class="line">                    <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a>(ctx,out-<a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>,<a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>);</div>
<div class="line">                    <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= <a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> ((i = (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&amp;(<span class="keywordtype">size_t</span>)-16))) {</div>
<div class="line">                    <span class="keywordtype">size_t</span> j=i;</div>
<div class="line"></div>
<div class="line">                    <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                        <span class="keywordtype">size_t</span> *out_t=(<span class="keywordtype">size_t</span> *)out;</div>
<div class="line">                        <span class="keyword">const</span> <span class="keywordtype">size_t</span> *in_t=(<span class="keyword">const</span> <span class="keywordtype">size_t</span> *)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line"></div>
<div class="line">                        (*block)(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        ++ctr;</div>
<div class="line">                        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                                <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                        <span class="keywordflow">else</span></div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                        <span class="keywordflow">for</span> (i=0; i&lt;16/<span class="keyword">sizeof</span>(size_t); ++i)</div>
<div class="line">                                out_t[i] = in_t[i] ^ ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#aa12fe219e932cef150d109733a56e1cd">t</a>[i];</div>
<div class="line">                        out += 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += 16;</div>
<div class="line">                        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                    }</div>
<div class="line">                    <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a>(ctx,out-j,j);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                        <span class="keywordtype">size_t</span> *out_t=(<span class="keywordtype">size_t</span> *)out;</div>
<div class="line">                        <span class="keyword">const</span> <span class="keywordtype">size_t</span> *in_t=(<span class="keyword">const</span> <span class="keywordtype">size_t</span> *)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line"></div>
<div class="line">                        (*block)(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        ++ctr;</div>
<div class="line">                        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                                <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                        <span class="keywordflow">else</span></div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                        <span class="keywordflow">for</span> (i=0; i&lt;16/<span class="keyword">sizeof</span>(size_t); ++i)</div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#aa12fe219e932cef150d109733a56e1cd">t</a>[i] ^=</div>
<div class="line">                                out_t[i] = in_t[i]^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#aa12fe219e932cef150d109733a56e1cd">t</a>[i];</div>
<div class="line">                        <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">                        out += 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += 16;</div>
<div class="line">                        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        (*block)(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        ++ctr;</div>
<div class="line">                        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                                <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                        <span class="keywordflow">else</span></div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>--) {</div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n] ^= out[n] = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n]^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n];</div>
<div class="line">                                ++n;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a> = n;</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        } <span class="keywordflow">while</span>(0);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;++i) {</div>
<div class="line">                <span class="keywordflow">if</span> (n==0) {</div>
<div class="line">                        (*block)(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        ++ctr;</div>
<div class="line">                        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                                <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                        <span class="keywordflow">else</span></div>
<div class="line">                                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                }</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n] ^= out[i] = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[i]^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n];</div>
<div class="line">                n = (n+1)%16;</div>
<div class="line">                <span class="keywordflow">if</span> (n==0)</div>
<div class="line">                        <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a> = n;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a81916efacf50d25fbffb8c36afc8de11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CRYPTO_gcm128_encrypt_ctr32 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a733a81250b14ef18c1a889dfc12caa6d">ctr128_f</a>&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="gcm128_8c_source.html#l01292">1292</a> of file <a class="el" href="gcm128_8c_source.html">gcm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">union </span>{ <span class="keywordtype">long</span> one; <span class="keywordtype">char</span> little; } is_endian = {1};</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, ctr;</div>
<div class="line">        <span class="keywordtype">size_t</span> i;</div>
<div class="line">        <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>   mlen = ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1];</div>
<div class="line">        <span class="keywordtype">void</span> *<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>  = ctx-&gt;<a class="code" href="structgcm128__context.html#aa8914ce246bf1f9d885409534aeb43f0">key</a>;</div>
<div class="line"><span class="preprocessor">#ifdef GCM_FUNCREF_4BIT</span></div>
<div class="line"><span class="preprocessor"></span>        void (*gcm_gmult_p)(<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> Xi[2],<span class="keyword">const</span> <a class="code" href="structu128.html">u128</a> Htable[16])    = ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a>;</div>
<div class="line"># ifdef <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a></div>
<div class="line">        void (*gcm_ghash_p)(<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> Xi[2],<span class="keyword">const</span> <a class="code" href="structu128.html">u128</a> Htable[16],</div>
<div class="line">                                <span class="keyword">const</span> <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> *inp,<span class="keywordtype">size_t</span> <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)       = ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a>;</div>
<div class="line"># endif</div>
<div class="line">#endif</div>
<div class="line"></div>
<div class="line">        mlen += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        if (mlen&gt;((<a class="code" href="aes__x86core_8c.html#ae5a6272795b1b8e0045aa7a4319dceb8">U64</a>(1)&lt;&lt;36)-32) || (<span class="keyword">sizeof</span>(<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)==8 &amp;&amp; mlen&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>))</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1] = mlen;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structgcm128__context.html#addb55a4b34d2c51313a254b4e45b8ba0">ares</a>) {</div>
<div class="line">                <span class="comment">/* First call to encrypt finalizes GHASH(AAD) */</span></div>
<div class="line">                <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#addb55a4b34d2c51313a254b4e45b8ba0">ares</a> = 0;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                ctr = BSWAP4(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3]);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                ctr = <a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">else</span></div>
<div class="line">                ctr = ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3];</div>
<div class="line"></div>
<div class="line">        n = ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (n) {</div>
<div class="line">                <span class="keywordflow">while</span> (n &amp;&amp; <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n] ^= *(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>++) = *(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>++)^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n];</div>
<div class="line">                        --<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                        n = (n+1)%16;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (n==0) <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">                <span class="keywordflow">else</span> {</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a> = n;</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#if defined(GHASH) &amp;&amp; !defined(OPENSSL_SMALL_FOOTPRINT)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=<a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>) {</div>
<div class="line">                (*stream)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,<a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>/16,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>);</div>
<div class="line">                ctr += <a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>/16;</div>
<div class="line">                <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                        <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">else</span></div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a>(ctx,out,<a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>);</div>
<div class="line">                out += <a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>;</div>
<div class="line">                in  += <a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>;</div>
<div class="line">                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= <a class="code" href="gcm128_8c.html#a1a20e06e7d149893a1650e96a16fd6dd">GHASH_CHUNK</a>;</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> ((i = (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&amp;(<span class="keywordtype">size_t</span>)-16))) {</div>
<div class="line">                <span class="keywordtype">size_t</span> j=i/16;</div>
<div class="line"></div>
<div class="line">                (*stream)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,j,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>);</div>
<div class="line">                ctr += (<span class="keywordtype">unsigned</span> int)j;</div>
<div class="line">                <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                        <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">else</span></div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                in  += i;</div>
<div class="line">                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= i;</div>
<div class="line"><span class="preprocessor">#if defined(GHASH)</span></div>
<div class="line"><span class="preprocessor"></span>                <a class="code" href="gcm128_8c.html#a26ef55546df14396d3b4eed07ddf2631">GHASH</a>(ctx,out,i);</div>
<div class="line">                out += i;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">while</span> (j--) {</div>
<div class="line">                        <span class="keywordflow">for</span> (i=0;i&lt;16;++i) ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[i] ^= out[i];</div>
<div class="line">                        <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line">                        out += 16;</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        }</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                (*ctx-&gt;<a class="code" href="structgcm128__context.html#a2cc964a91c87a576820bc105a33c580e">block</a>)(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,key);</div>
<div class="line">                ++ctr;</div>
<div class="line">                <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                        <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">else</span></div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>--) {</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n] ^= out[n] = in[n]^ctx-&gt;<a class="code" href="structgcm128__context.html#aa1cf846a31fbf3164cbb0281422a05c0">EKi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[n];</div>
<div class="line">                        ++n;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a> = n;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8d5bac0494d173f96c5cb73790f1353d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CRYPTO_gcm128_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="gcm128_8c_source.html#l01529">1529</a> of file <a class="el" href="gcm128_8c_source.html">gcm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">union </span>{ <span class="keywordtype">long</span> one; <span class="keywordtype">char</span> little; } is_endian = {1};</div>
<div class="line">        <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> alen = ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[0]&lt;&lt;3;</div>
<div class="line">        <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> clen = ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1]&lt;&lt;3;</div>
<div class="line"><span class="preprocessor">#ifdef GCM_FUNCREF_4BIT</span></div>
<div class="line"><span class="preprocessor"></span>        void (*gcm_gmult_p)(<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> Xi[2],<span class="keyword">const</span> <a class="code" href="structu128.html">u128</a> Htable[16])    = ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a>;</div>
<div class="line">#endif</div>
<div class="line"></div>
<div class="line">        if (ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a> || ctx-&gt;<a class="code" href="structgcm128__context.html#addb55a4b34d2c51313a254b4e45b8ba0">ares</a>)</div>
<div class="line">                <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (is_endian.little) {</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP8</span></div>
<div class="line"><span class="preprocessor"></span>                alen = BSWAP8(alen);</div>
<div class="line">                clen = BSWAP8(clen);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> *p = ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>;</div>
<div class="line"></div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[0] = alen;</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1] = clen;</div>
<div class="line"></div>
<div class="line">                alen = (<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>)<a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(p)  &lt;&lt;32|<a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(p+4);</div>
<div class="line">                clen = (<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>)<a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(p+8)&lt;&lt;32|<a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(p+12);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        }</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[0] ^= alen;</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1] ^= clen;</div>
<div class="line">        <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Xi);</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[0] ^= ctx-&gt;<a class="code" href="structgcm128__context.html#a501626e8e4da79870c3d6604da8ae567">EK0</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[0];</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1] ^= ctx-&gt;<a class="code" href="structgcm128__context.html#a501626e8e4da79870c3d6604da8ae567">EK0</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1];</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (tag &amp;&amp; <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&lt;=<span class="keyword">sizeof</span>(ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>))</div>
<div class="line">                <span class="keywordflow">return</span> memcmp(ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,tag,<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2119af4cceb3e52127662ff851df4f9f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_gcm128_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="gcm128_8c_source.html#l00707">707</a> of file <a class="el" href="gcm128_8c_source.html">gcm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">union </span>{ <span class="keywordtype">long</span> one; <span class="keywordtype">char</span> little; } is_endian = {1};</div>
<div class="line"></div>
<div class="line">        memset(ctx,0,<span class="keyword">sizeof</span>(*ctx));</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a2cc964a91c87a576820bc105a33c580e">block</a> = block;</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#aa8914ce246bf1f9d885409534aeb43f0">key</a>   = <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>;</div>
<div class="line"></div>
<div class="line">        (*block)(ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (is_endian.little) {</div>
<div class="line">                <span class="comment">/* H is stored in host byte order */</span></div>
<div class="line"><span class="preprocessor">#ifdef BSWAP8</span></div>
<div class="line"><span class="preprocessor"></span>                ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[0] = BSWAP8(ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[0]);</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1] = BSWAP8(ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1]);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> *p = ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>;</div>
<div class="line">                <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> hi,lo;</div>
<div class="line">                hi = (<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>)<a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(p)  &lt;&lt;32|<a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(p+4);</div>
<div class="line">                lo = (<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>)<a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(p+8)&lt;&lt;32|<a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(p+12);</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[0] = hi;</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1] = lo;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if     TABLE_BITS==8</span></div>
<div class="line"><span class="preprocessor"></span>        gcm_init_8bit(ctx-&gt;<a class="code" href="structgcm128__context.html#a53f4d354cef32d27e04b0de3c7179c98">Htable</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>);</div>
<div class="line"><span class="preprocessor">#elif   TABLE_BITS==4</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor"># if    defined(GHASH_ASM_X86_OR_64)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#  if   !defined(GHASH_ASM_X86) || defined(OPENSSL_IA32_SSE2)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (OPENSSL_ia32cap_P[0]&amp;(1&lt;&lt;24) &amp;&amp;     <span class="comment">/* check FXSR bit */</span></div>
<div class="line">            OPENSSL_ia32cap_P[1]&amp;(1&lt;&lt;1) ) {     <span class="comment">/* check PCLMULQDQ bit */</span></div>
<div class="line">                <span class="keywordflow">if</span> (((OPENSSL_ia32cap_P[1]&gt;&gt;22)&amp;0x41)==0x41) {  <span class="comment">/* AVX+MOVBE */</span></div>
<div class="line">                        gcm_init_avx(ctx-&gt;<a class="code" href="structgcm128__context.html#a53f4d354cef32d27e04b0de3c7179c98">Htable</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>);</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a> = gcm_gmult_avx;</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a> = gcm_ghash_avx;</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                        gcm_init_clmul(ctx-&gt;<a class="code" href="structgcm128__context.html#a53f4d354cef32d27e04b0de3c7179c98">Htable</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>);</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a> = gcm_gmult_clmul;</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a> = gcm_ghash_clmul;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#  endif</span></div>
<div class="line"><span class="preprocessor"></span>        gcm_init_4bit(ctx-&gt;<a class="code" href="structgcm128__context.html#a53f4d354cef32d27e04b0de3c7179c98">Htable</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>);</div>
<div class="line"><span class="preprocessor">#  if   defined(GHASH_ASM_X86)                  </span><span class="comment">/* x86 only */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#   if  defined(OPENSSL_IA32_SSE2)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (OPENSSL_ia32cap_P[0]&amp;(1&lt;&lt;25)) {     <span class="comment">/* check SSE bit */</span></div>
<div class="line"><span class="preprocessor">#   else</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (OPENSSL_ia32cap_P[0]&amp;(1&lt;&lt;23)) {     <span class="comment">/* check MMX bit */</span></div>
<div class="line"><span class="preprocessor">#   endif</span></div>
<div class="line"><span class="preprocessor"></span>                ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a> = gcm_gmult_4bit_mmx;</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a> = gcm_ghash_4bit_mmx;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a> = gcm_gmult_4bit_x86;</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a> = gcm_ghash_4bit_x86;</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#  else</span></div>
<div class="line"><span class="preprocessor"></span>        ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a> = gcm_gmult_4bit;</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a> = gcm_ghash_4bit;</div>
<div class="line"><span class="preprocessor">#  endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor"># elif  defined(GHASH_ASM_ARM)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (<a class="code" href="arm__arch_8h.html#ac316f3db1d9afbb900eb725b10bc0473">OPENSSL_armcap_P</a> &amp; <a class="code" href="arm__arch_8h.html#a06a654174ac7c2d5388b6c716ba03263">ARMV7_NEON</a>) {</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a> = gcm_gmult_neon;</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a> = gcm_ghash_neon;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                gcm_init_4bit(ctx-&gt;<a class="code" href="structgcm128__context.html#a53f4d354cef32d27e04b0de3c7179c98">Htable</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>);</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a> = gcm_gmult_4bit;</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a> = gcm_ghash_4bit;</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor"># elif  defined(GHASH_ASM_SPARC)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (<a class="code" href="sparcv9cap_8c.html#af66a59e32f10d874a7c9452bf38c8109">OPENSSL_sparcv9cap_P</a>[0] &amp; <a class="code" href="sparc__arch_8h.html#a811b561515ed6fba484302214c3089c9">SPARCV9_VIS3</a>) {</div>
<div class="line">                gcm_init_vis3(ctx-&gt;<a class="code" href="structgcm128__context.html#a53f4d354cef32d27e04b0de3c7179c98">Htable</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>);</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a> = gcm_gmult_vis3;</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a> = gcm_ghash_vis3;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                gcm_init_4bit(ctx-&gt;<a class="code" href="structgcm128__context.html#a53f4d354cef32d27e04b0de3c7179c98">Htable</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>);</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a> = gcm_gmult_4bit;</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a77a58f7f442de35cb290569178711825">ghash</a> = gcm_ghash_4bit;</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor"># else</span></div>
<div class="line"><span class="preprocessor"></span>        gcm_init_4bit(ctx-&gt;<a class="code" href="structgcm128__context.html#a53f4d354cef32d27e04b0de3c7179c98">Htable</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#ad3bdaa61477418766f24701e6c4710b1">H</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>);</div>
<div class="line"><span class="preprocessor"># endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a48f9d5df65f104833881965e6dbe03d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a>* CRYPTO_gcm128_new </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="gcm128_8c_source.html#l01576">1576</a> of file <a class="el" href="gcm128_8c_source.html">gcm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <a class="code" href="structgcm128__context.html">GCM128_CONTEXT</a> *ret;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((ret = (<a class="code" href="structgcm128__context.html">GCM128_CONTEXT</a> *)<a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structgcm128__context.html">GCM128_CONTEXT</a>))))</div>
<div class="line">                <a class="code" href="gcm128_8c.html#a2119af4cceb3e52127662ff851df4f9f">CRYPTO_gcm128_init</a>(ret,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,block);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a811fe4518c95944c68547b6cf5c32f07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_gcm128_release </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="gcm128_8c_source.html#l01586">1586</a> of file <a class="el" href="gcm128_8c_source.html">gcm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span> (ctx) {</div>
<div class="line">                <a class="code" href="crypto_8h.html#a2aa47e40c63b05d00e9a780592f2a2b8">OPENSSL_cleanse</a>(ctx,<span class="keyword">sizeof</span>(*ctx));</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(ctx);</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0ebf35e4119a3d747eaae4ab5624be17"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_gcm128_setiv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="gcm128_8c_source.html#l00793">793</a> of file <a class="el" href="gcm128_8c_source.html">gcm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">union </span>{ <span class="keywordtype">long</span> one; <span class="keywordtype">char</span> little; } is_endian = {1};</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctr;</div>
<div class="line"><span class="preprocessor">#ifdef GCM_FUNCREF_4BIT</span></div>
<div class="line"><span class="preprocessor"></span>        void (*gcm_gmult_p)(<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> Xi[2],<span class="keyword">const</span> <a class="code" href="structu128.html">u128</a> Htable[16])    = ctx-&gt;<a class="code" href="structgcm128__context.html#a80479f671d8af75b2548c94fcdb3b3e0">gmult</a>;</div>
<div class="line">#endif</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[0]  = 0;</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1]  = 0;</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[0]  = 0;</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1]  = 0;</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[0] = 0;      <span class="comment">/* AAD length */</span></div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a6c0d33a6dab39fe2b36f5524aaaa77bb">len</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1] = 0;      <span class="comment">/* message length */</span></div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#addb55a4b34d2c51313a254b4e45b8ba0">ares</a> = 0;</div>
<div class="line">        ctx-&gt;<a class="code" href="structgcm128__context.html#a3b5244d5391fbd9e1a6a7b27bb694e0b">mres</a> = 0;</div>
<div class="line"></div>
<div class="line">        if (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>==12) {</div>
<div class="line">                memcpy(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,iv,12);</div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[15]=1;</div>
<div class="line">                ctr=1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordtype">size_t</span> i;</div>
<div class="line">                <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> len0 = <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                        <span class="keywordflow">for</span> (i=0; i&lt;16; ++i) ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[i] ^= iv[i];</div>
<div class="line">                        <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Yi);</div>
<div class="line">                        iv += 16;</div>
<div class="line">                        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>; ++i) ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[i] ^= iv[i];</div>
<div class="line">                        <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Yi);</div>
<div class="line">                }</div>
<div class="line">                len0 &lt;&lt;= 3;</div>
<div class="line">                <span class="keywordflow">if</span> (is_endian.little) {</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP8</span></div>
<div class="line"><span class="preprocessor"></span>                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1]  ^= BSWAP8(len0);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[8]  ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(len0&gt;&gt;56);</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[9]  ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(len0&gt;&gt;48);</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[10] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(len0&gt;&gt;40);</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[11] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(len0&gt;&gt;32);</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[12] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(len0&gt;&gt;24);</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[13] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(len0&gt;&gt;16);</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[14] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(len0&gt;&gt;8);</div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>[15] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(len0);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a53b3c0ff2aab4c5ab38621d064e36d10">u</a>[1]  ^= len0;</div>
<div class="line"></div>
<div class="line">                <a class="code" href="gcm128_8c.html#a2e7932098834461fdb1fd5b8fa2c5a4a">GCM_MUL</a>(ctx,Yi);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                        ctr = BSWAP4(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3]);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                        ctr = <a class="code" href="aes__locl_8h.html#add03ff597bcc3979b5d82eaab61820cd">GETU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">else</span></div>
<div class="line">                        ctr = ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3];</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        (*ctx-&gt;<a class="code" href="structgcm128__context.html#a2cc964a91c87a576820bc105a33c580e">block</a>)(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#a501626e8e4da79870c3d6604da8ae567">EK0</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>,ctx-&gt;<a class="code" href="structgcm128__context.html#aa8914ce246bf1f9d885409534aeb43f0">key</a>);</div>
<div class="line">        ++ctr;</div>
<div class="line">        <span class="keywordflow">if</span> (is_endian.little)</div>
<div class="line"><span class="preprocessor">#ifdef BSWAP4</span></div>
<div class="line"><span class="preprocessor"></span>                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = BSWAP4(ctr);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                <a class="code" href="aes__locl_8h.html#a081bd53ea4c159e9ce643966d05d2730">PUTU32</a>(ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>+12,ctr);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;<a class="code" href="structgcm128__context.html#a12491d6b22219a525fada440843d563a">Yi</a>.<a class="code" href="structgcm128__context.html#a739af4105026c0a0fe2d6cad1a7f7303">d</a>[3] = ctr;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a995a320240beba7ff1cffb97567f15a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_gcm128_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a2a7f451298d420760e290671f2235c61">GCM128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="gcm128_8c_source.html#l01570">1570</a> of file <a class="el" href="gcm128_8c_source.html">gcm128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <a class="code" href="gcm128_8c.html#a8d5bac0494d173f96c5cb73790f1353d">CRYPTO_gcm128_finish</a>(ctx, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, 0);</div>
<div class="line">        memcpy(tag, ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&lt;=<span class="keyword">sizeof</span>(ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>)?<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>:<span class="keyword">sizeof</span>(ctx-&gt;<a class="code" href="structgcm128__context.html#ac30be2a99e85dd2190e196bd4efaed15">Xi</a>.<a class="code" href="structgcm128__context.html#a4191ca0470c9975c7109f127ee85e408">c</a>));</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a541156458b0b57b6f3ec115180b7a348"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CRYPTO_nistcts128_decrypt </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a0eed6ee3d31ba9aea497696eabda5df4">cbc128_f</a>&#160;</td>
          <td class="paramname"><em>cbc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cts128_8c_source.html#l00264">264</a> of file <a class="el" href="cts128_8c_source.html">cts128.c</a>.</p>
<div class="fragment"><div class="line">{       <span class="keywordtype">size_t</span> residue;</div>
<div class="line">        <span class="keyword">union </span>{ <span class="keywordtype">size_t</span> align; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[32]; } tmp;</div>
<div class="line"></div>
<div class="line">        assert (<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&lt;16) <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        residue=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>%16;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (residue==0) {</div>
<div class="line">                (*cbc)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,0);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16+residue;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                (*cbc)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,0);</div>
<div class="line">                in  += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                out += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        memset(tmp.c,0,<span class="keyword">sizeof</span>(tmp));</div>
<div class="line">        <span class="comment">/* this places in[16] at &amp;tmp.c[16] and decrypted block at &amp;tmp.c[0] */</span></div>
<div class="line">        (*cbc)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>+residue,tmp.c,16,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,tmp.c+16,0);</div>
<div class="line"></div>
<div class="line">        memcpy(tmp.c,<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,residue);</div>
<div class="line"><span class="preprocessor">#if defined(CBC_HANDLES_TRUNCATED_IO)</span></div>
<div class="line"><span class="preprocessor"></span>        (*cbc)(tmp.c,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,16+residue,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,0);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        (*cbc)(tmp.c,tmp.c,32,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,0);</div>
<div class="line">        memcpy(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,tmp.c,16+residue);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">return</span> 16+<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>+residue;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa8122dbed2b240fea20843ab391aee29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CRYPTO_nistcts128_decrypt_block </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cts128_8c_source.html#l00187">187</a> of file <a class="el" href="cts128_8c_source.html">cts128.c</a>.</p>
<div class="fragment"><div class="line">{       <span class="keywordtype">size_t</span> residue, n;</div>
<div class="line">        <span class="keyword">union </span>{ <span class="keywordtype">size_t</span> align; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[32]; } tmp;</div>
<div class="line"></div>
<div class="line">        assert (<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&lt;16) <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        residue=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>%16;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (residue==0) {</div>
<div class="line">                <a class="code" href="cbc128_8c.html#a009400dbb93db1cb23550cdb66eac5ad">CRYPTO_cbc128_decrypt</a>(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,block);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16+residue;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                <a class="code" href="cbc128_8c.html#a009400dbb93db1cb23550cdb66eac5ad">CRYPTO_cbc128_decrypt</a>(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,block);</div>
<div class="line">                <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        (*block)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>+residue,tmp.c+16,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line"></div>
<div class="line">        memcpy(tmp.c,tmp.c+16,16);</div>
<div class="line">        memcpy(tmp.c,<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,residue);</div>
<div class="line">        (*block)(tmp.c,tmp.c,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(n=0; n&lt;16; ++n) {</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a> = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n];</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n] = tmp.c[n] ^ ivec[n];</div>
<div class="line">                ivec[n] = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n+residue];</div>
<div class="line">                tmp.c[n] = c;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">for</span>(residue+=16; n&lt;residue; ++n)</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n] = tmp.c[n] ^ tmp.c[n-16];</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 16+<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>+residue;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3dbdc940a0b01185acd3ad3a95bef5c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CRYPTO_nistcts128_encrypt </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#a0eed6ee3d31ba9aea497696eabda5df4">cbc128_f</a>&#160;</td>
          <td class="paramname"><em>cbc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cts128_8c_source.html#l00119">119</a> of file <a class="el" href="cts128_8c_source.html">cts128.c</a>.</p>
<div class="fragment"><div class="line">{       <span class="keywordtype">size_t</span> residue;</div>
<div class="line">        <span class="keyword">union </span>{ <span class="keywordtype">size_t</span> align; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[16]; } tmp;</div>
<div class="line"></div>
<div class="line">        assert (<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> &lt; 16) <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        residue=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>%16;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= residue;</div>
<div class="line"></div>
<div class="line">        (*cbc)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,1);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (residue==0) <span class="keywordflow">return</span> <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line"></div>
<div class="line">        in  += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        out += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if defined(CBC_HANDLES_TRUNCATED_IO)</span></div>
<div class="line"><span class="preprocessor"></span>        (*cbc)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,out-16+residue,residue,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,1);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        memset(tmp.c,0,<span class="keyword">sizeof</span>(tmp));</div>
<div class="line">        memcpy(tmp.c,in,residue);</div>
<div class="line">        (*cbc)(tmp.c,out-16+residue,16,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,1);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">return</span> len+residue;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a060f48b9d4bfa421c2eae7c31144bede"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CRYPTO_nistcts128_encrypt_block </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cts128_8c_source.html#l00059">59</a> of file <a class="el" href="cts128_8c_source.html">cts128.c</a>.</p>
<div class="fragment"><div class="line">{       <span class="keywordtype">size_t</span> residue, n;</div>
<div class="line"></div>
<div class="line">        assert (<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> &lt; 16) <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        residue=<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>%16;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= residue;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="cbc128_8c.html#a5cbe79f5b3a935a6e49ac72e3f3e4fb2">CRYPTO_cbc128_encrypt</a>(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>,ivec,block);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (residue==0) <span class="keywordflow">return</span> <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (n=0; n&lt;residue; ++n)</div>
<div class="line">                ivec[n] ^= <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n];</div>
<div class="line">        (*block)(ivec,ivec,<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">        memcpy(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>-16+residue,ivec,16);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>+residue;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab90b380cc595d52baa19a00926dc8841"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CRYPTO_ofb128_encrypt </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>ivec</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modes_8h.html#ac59f1132af4a41c5c644c63e901189ec">block128_f</a>&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ofb128_8c_source.html#l00066">66</a> of file <a class="el" href="ofb128_8c_source.html">ofb128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n;</div>
<div class="line">        <span class="keywordtype">size_t</span> l=0;</div>
<div class="line"></div>
<div class="line">        assert(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> &amp;&amp; <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> &amp;&amp; <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> &amp;&amp; ivec &amp;&amp; num);</div>
<div class="line"></div>
<div class="line">        n = *num;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if !defined(OPENSSL_SMALL_FOOTPRINT)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (16%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) == 0) <span class="keywordflow">do</span> { <span class="comment">/* always true actually */</span></div>
<div class="line">                <span class="keywordflow">while</span> (n &amp;&amp; <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        *(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>++) = *(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>++) ^ ivec[n];</div>
<div class="line">                        --<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                        n = (n+1) % 16;</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">if</span> (((<span class="keywordtype">size_t</span>)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>|(size_t)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>|(<span class="keywordtype">size_t</span>)ivec)%<span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>) != 0)</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line">                        (*block)(ivec, ivec, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        <span class="keywordflow">for</span> (; n&lt;16; n+=<span class="keyword">sizeof</span>(size_t))</div>
<div class="line">                                *(<span class="keywordtype">size_t</span>*)(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>+n) =</div>
<div class="line">                                *(<span class="keywordtype">size_t</span>*)(<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>+n) ^ *(<span class="keywordtype">size_t</span>*)(ivec+n);</div>
<div class="line">                        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += 16;</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>  += 16;</div>
<div class="line">                        n = 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                        (*block)(ivec, ivec, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>--) {</div>
<div class="line">                                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[n] = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[n] ^ ivec[n];</div>
<div class="line">                                ++n;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                *num = n;</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        } <span class="keywordflow">while</span>(0);</div>
<div class="line">        <span class="comment">/* the rest would be commonly eliminated by x86* compiler */</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">while</span> (l&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>) {</div>
<div class="line">                <span class="keywordflow">if</span> (n==0) {</div>
<div class="line">                        (*block)(ivec, ivec, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>);</div>
<div class="line">                }</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[l] = <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>[l] ^ ivec[n];</div>
<div class="line">                ++l;</div>
<div class="line">                n = (n+1) % 16;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        *num=n;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aadd968198321806f284908b57c1fc133"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CRYPTO_xts128_encrypt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="modes_8h.html#ad233eb07e4ab07fd32a8cf18e477dd71">XTS128_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>iv</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>enc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="xts128_8c_source.html#l00061">61</a> of file <a class="el" href="xts128_8c_source.html">xts128.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">union </span>{ <span class="keywordtype">long</span> one; <span class="keywordtype">char</span> little; } is_endian = {1};</div>
<div class="line">        <span class="keyword">union </span>{ <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>[2]; <a class="code" href="aes__locl_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> d[4]; <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>[16]; } tweak, scratch;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&lt;16) <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">        memcpy(tweak.c, iv, 16);</div>
<div class="line"></div>
<div class="line">        (*ctx-&gt;<a class="code" href="structxts128__context.html#a4c82455a493bc86dcccbcb2d2da9cb68">block2</a>)(tweak.c,tweak.c,ctx-&gt;<a class="code" href="structxts128__context.html#aecf3dbc153905ca2808ac560c1750874">key2</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!enc &amp;&amp; (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>%16)) <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>-=16;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">while</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>&gt;=16) {</div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                memcpy(scratch.c,inp,16);</div>
<div class="line">                scratch.u[0] ^= tweak.u[0];</div>
<div class="line">                scratch.u[1] ^= tweak.u[1];</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                scratch.u[0] = ((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)inp)[0]^tweak.u[0];</div>
<div class="line">                scratch.u[1] = ((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)inp)[1]^tweak.u[1];</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                (*ctx-&gt;<a class="code" href="structxts128__context.html#a1fa1e03a95af0e244e7fbf269d4c9eec">block1</a>)(scratch.c,scratch.c,ctx-&gt;<a class="code" href="structxts128__context.html#a834b4945a12ac0bde3be150358c364cf">key1</a>);</div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                scratch.u[0] ^= tweak.u[0];</div>
<div class="line">                scratch.u[1] ^= tweak.u[1];</div>
<div class="line">                memcpy(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,scratch.c,16);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                ((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>)[0] = scratch.u[0]^=tweak.u[0];</div>
<div class="line">                ((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>)[1] = scratch.u[1]^=tweak.u[1];</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                inp += 16;</div>
<div class="line">                <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a> += 16;</div>
<div class="line">                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= 16;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>==0)     <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (is_endian.little) {</div>
<div class="line">                        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> carry,res;</div>
<div class="line">                        </div>
<div class="line">                        res = 0x87&amp;(((int)tweak.d[3])&gt;&gt;31);</div>
<div class="line">                        carry = (<span class="keywordtype">unsigned</span> int)(tweak.u[0]&gt;&gt;63);</div>
<div class="line">                        tweak.u[0] = (tweak.u[0]&lt;&lt;1)^res;</div>
<div class="line">                        tweak.u[1] = (tweak.u[1]&lt;&lt;1)|carry;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> {</div>
<div class="line">                        <span class="keywordtype">size_t</span> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">for</span> (c=0,i=0;i&lt;16;++i) {</div>
<div class="line">                                <span class="comment">/*+ substitutes for |, because c is 1 bit */</span> </div>
<div class="line">                                c += ((size_t)tweak.c[i])&lt;&lt;1;</div>
<div class="line">                                tweak.c[i] = (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)c;</div>
<div class="line">                                c = c&gt;&gt;8;</div>
<div class="line">                        }</div>
<div class="line">                        tweak.c[0] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(0x87&amp;(0-c));</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (enc) {</div>
<div class="line">                <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;++i) {</div>
<div class="line">                        <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> c = inp[i];</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[i] = scratch.c[i];</div>
<div class="line">                        scratch.c[i] = c;</div>
<div class="line">                }</div>
<div class="line">                scratch.u[0] ^= tweak.u[0];</div>
<div class="line">                scratch.u[1] ^= tweak.u[1];</div>
<div class="line">                (*ctx-&gt;<a class="code" href="structxts128__context.html#a1fa1e03a95af0e244e7fbf269d4c9eec">block1</a>)(scratch.c,scratch.c,ctx-&gt;<a class="code" href="structxts128__context.html#a834b4945a12ac0bde3be150358c364cf">key1</a>);</div>
<div class="line">                scratch.u[0] ^= tweak.u[0];</div>
<div class="line">                scratch.u[1] ^= tweak.u[1];</div>
<div class="line">                memcpy(<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>-16,scratch.c,16);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keyword">union </span>{ <a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a> <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>[2]; <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> c[16]; } tweak1;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (is_endian.little) {</div>
<div class="line">                        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> carry,res;</div>
<div class="line"></div>
<div class="line">                        res = 0x87&amp;(((int)tweak.d[3])&gt;&gt;31);</div>
<div class="line">                        carry = (<span class="keywordtype">unsigned</span> int)(tweak.u[0]&gt;&gt;63);</div>
<div class="line">                        tweak1.u[0] = (tweak.u[0]&lt;&lt;1)^res;</div>
<div class="line">                        tweak1.u[1] = (tweak.u[1]&lt;&lt;1)|carry;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> {</div>
<div class="line">                        <span class="keywordtype">size_t</span> c;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">for</span> (c=0,i=0;i&lt;16;++i) {</div>
<div class="line">                                <span class="comment">/*+ substitutes for |, because c is 1 bit */</span> </div>
<div class="line">                                c += ((size_t)tweak.c[i])&lt;&lt;1;</div>
<div class="line">                                tweak1.c[i] = (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)c;</div>
<div class="line">                                c = c&gt;&gt;8;</div>
<div class="line">                        }</div>
<div class="line">                        tweak1.c[0] ^= (<a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)(0x87&amp;(0-c));</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                memcpy(scratch.c,inp,16);</div>
<div class="line">                scratch.u[0] ^= tweak1.u[0];</div>
<div class="line">                scratch.u[1] ^= tweak1.u[1];</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                scratch.u[0] = ((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)inp)[0]^tweak1.u[0];</div>
<div class="line">                scratch.u[1] = ((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)inp)[1]^tweak1.u[1];</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                (*ctx-&gt;<a class="code" href="structxts128__context.html#a1fa1e03a95af0e244e7fbf269d4c9eec">block1</a>)(scratch.c,scratch.c,ctx-&gt;<a class="code" href="structxts128__context.html#a834b4945a12ac0bde3be150358c364cf">key1</a>);</div>
<div class="line">                scratch.u[0] ^= tweak1.u[0];</div>
<div class="line">                scratch.u[1] ^= tweak1.u[1];</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;++i) {</div>
<div class="line">                        <a class="code" href="aes__locl_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> c = inp[16+i];</div>
<div class="line">                        <a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>[16+i] = scratch.c[i];</div>
<div class="line">                        scratch.c[i] = c;</div>
<div class="line">                }</div>
<div class="line">                scratch.u[0] ^= tweak.u[0];</div>
<div class="line">                scratch.u[1] ^= tweak.u[1];</div>
<div class="line">                (*ctx-&gt;<a class="code" href="structxts128__context.html#a1fa1e03a95af0e244e7fbf269d4c9eec">block1</a>)(scratch.c,scratch.c,ctx-&gt;<a class="code" href="structxts128__context.html#a834b4945a12ac0bde3be150358c364cf">key1</a>);</div>
<div class="line"><span class="preprocessor">#if defined(STRICT_ALIGNMENT)</span></div>
<div class="line"><span class="preprocessor"></span>                scratch.u[0] ^= tweak.u[0];</div>
<div class="line">                scratch.u[1] ^= tweak.u[1];</div>
<div class="line">                memcpy (<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,scratch.c,16);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                ((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>)[0] = scratch.u[0]^tweak.u[0];</div>
<div class="line">                ((<a class="code" href="aes__x86core_8c.html#ad758b7a5c3f18ed79d2fcd23d9f16357">u64</a>*)<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>)[1] = scratch.u[1]^tweak.u[1];</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
