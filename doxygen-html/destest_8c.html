<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/des/destest.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_420208fdc66d44ef9abadce8376b5786.html">des</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">destest.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;openssl/e_os2.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;openssl/des.h&gt;</code><br/>
</div>
<p><a href="destest_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a9c4ff83dfec76adf265878861e364531"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="destest_8c.html#a9c4ff83dfec76adf265878861e364531">crypt</a>(<a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a>, s)&#160;&#160;&#160;(<a class="el" href="fcrypt_8c.html#a1da3af1c8fd59e86f5578f5a34f1d7e3">DES_crypt</a>((<a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a>),(s)))</td></tr>
<tr class="memitem:a513819cf6a35e11aa0bb36eeb6601dc2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="destest_8c.html#a513819cf6a35e11aa0bb36eeb6601dc2">NUM_TESTS</a>&#160;&#160;&#160;34</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="destest_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="a9c4ff83dfec76adf265878861e364531"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define crypt</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(<a class="el" href="fcrypt_8c.html#a1da3af1c8fd59e86f5578f5a34f1d7e3">DES_crypt</a>((<a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a>),(s)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="destest_8c_source.html#l00087">87</a> of file <a class="el" href="destest_8c_source.html">destest.c</a>.</p>

</div>
</div>
<a class="anchor" id="a513819cf6a35e11aa0bb36eeb6601dc2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_TESTS&#160;&#160;&#160;34</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="destest_8c_source.html#l00091">91</a> of file <a class="el" href="destest_8c_source.html">destest.c</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a0ddf1224851353fc92bfbff6f499fa97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="destest_8c_source.html#l00334">334</a> of file <a class="el" href="destest_8c_source.html">destest.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> j,err=0;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line">        <a class="code" href="des__old_8h.html#a34a0bf705d949f5c6bdfb16939e114ad">des_cblock</a> <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>,<a class="code" href="ideatest_8c.html#afdf65de9e264331943a9e5a248271311">out</a>,outin,iv3,iv2;</div>
<div class="line">        <a class="code" href="des__old_8h.html#af9eef9bcad78df4353e607084af2b6f2">des_key_schedule</a> ks,<a class="code" href="e__des3_8c.html#a1a3f4cc1ee0f830aac197e38bbe3b334">ks2</a>,<a class="code" href="e__des3_8c.html#a70cabb34b68b0b8328a36017817e58f5">ks3</a>;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cbc_in[40];</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cbc_out[40];</div>
<div class="line">        DES_LONG cs;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cret[8];</div>
<div class="line"><span class="preprocessor">#ifdef _CRAY</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keyword">struct </span>{</div>
<div class="line">            <span class="keywordtype">int</span> <a class="code" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>:32;</div>
<div class="line">            <span class="keywordtype">int</span> <a class="code" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>:32;</div>
<div class="line">        } lqret[2];</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        DES_LONG lqret[4];</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordtype">int</span> num;</div>
<div class="line">        <span class="keywordtype">char</span> *str;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef OPENSSL_NO_DESCBCM</span></div>
<div class="line"><span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;Doing cbcm\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> ((j=<a class="code" href="des_8h.html#a44f0916998768ca982f958da95771067">DES_set_key_checked</a>(&amp;cbc_key,&amp;ks)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Key error %d\n&quot;</span>,j);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> ((j=<a class="code" href="des_8h.html#a44f0916998768ca982f958da95771067">DES_set_key_checked</a>(&amp;cbc2_key,&amp;ks2)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Key error %d\n&quot;</span>,j);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> ((j=<a class="code" href="des_8h.html#a44f0916998768ca982f958da95771067">DES_set_key_checked</a>(&amp;cbc3_key,&amp;ks3)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Key error %d\n&quot;</span>,j);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        memset(cbc_out,0,40);</div>
<div class="line">        memset(cbc_in,0,40);</div>
<div class="line">        i=strlen((<span class="keywordtype">char</span> *)cbc_data)+1;</div>
<div class="line">        <span class="comment">/* i=((i+7)/8)*8; */</span></div>
<div class="line">        memcpy(iv3,cbc_iv,<span class="keyword">sizeof</span>(cbc_iv));</div>
<div class="line">        memset(iv2,<span class="charliteral">&#39;\0&#39;</span>,<span class="keyword">sizeof</span> iv2);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="des_8h.html#ae8604334e24501da3e17d19538ff024f">DES_ede3_cbcm_encrypt</a>(cbc_data,cbc_out,16L,&amp;ks,&amp;ks2,&amp;ks3,&amp;iv3,&amp;iv2,</div>
<div class="line">                              <a class="code" href="des_8h.html#a89730e026cc6082480f070985e91e8aa">DES_ENCRYPT</a>);</div>
<div class="line">        <a class="code" href="des_8h.html#ae8604334e24501da3e17d19538ff024f">DES_ede3_cbcm_encrypt</a>(&amp;cbc_data[16],&amp;cbc_out[16],i-16,&amp;ks,&amp;ks2,&amp;ks3,</div>
<div class="line">                              &amp;iv3,&amp;iv2,<a class="code" href="des_8h.html#a89730e026cc6082480f070985e91e8aa">DES_ENCRYPT</a>);</div>
<div class="line">        <span class="comment">/*      if (memcmp(cbc_out,cbc3_ok,</span></div>
<div class="line"><span class="comment">                (unsigned int)(strlen((char *)cbc_data)+1+7)/8*8) != 0)</span></div>
<div class="line"><span class="comment">                {</span></div>
<div class="line"><span class="comment">                printf(&quot;des_ede3_cbc_encrypt encrypt error\n&quot;);</span></div>
<div class="line"><span class="comment">                err=1;</span></div>
<div class="line"><span class="comment">                }</span></div>
<div class="line"><span class="comment">        */</span></div>
<div class="line">        memcpy(iv3,cbc_iv,<span class="keyword">sizeof</span>(cbc_iv));</div>
<div class="line">        memset(iv2,<span class="charliteral">&#39;\0&#39;</span>,<span class="keyword">sizeof</span> iv2);</div>
<div class="line">        <a class="code" href="des_8h.html#ae8604334e24501da3e17d19538ff024f">DES_ede3_cbcm_encrypt</a>(cbc_out,cbc_in,i,&amp;ks,&amp;ks2,&amp;ks3,&amp;iv3,&amp;iv2,<a class="code" href="des_8h.html#a7ca3b464dc9e6cabf82f636101b6e133">DES_DECRYPT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(cbc_in,cbc_data,strlen((<span class="keywordtype">char</span> *)cbc_data)+1) != 0)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n;</div>
<div class="line"></div>
<div class="line">                printf(<span class="stringliteral">&quot;des_ede3_cbcm_encrypt decrypt error\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">for</span>(n=0 ; n &lt; i ; ++n)</div>
<div class="line">                    printf(<span class="stringliteral">&quot; %02x&quot;</span>,cbc_data[n]);</div>
<div class="line">                printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">for</span>(n=0 ; n &lt; i ; ++n)</div>
<div class="line">                    printf(<span class="stringliteral">&quot; %02x&quot;</span>,cbc_in[n]);</div>
<div class="line">                printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Doing ecb\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="destest_8c.html#a513819cf6a35e11aa0bb36eeb6601dc2">NUM_TESTS</a>; i++)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="des_8h.html#aa174247a199fa5c0b56b240d75d2845e">DES_set_key_unchecked</a>(&amp;key_data[i],&amp;ks);</div>
<div class="line">                memcpy(in,plain_data[i],8);</div>
<div class="line">                memset(out,0,8);</div>
<div class="line">                memset(outin,0,8);</div>
<div class="line">                <a class="code" href="des__old_8h.html#a2e1f935777448a3632f4be1c14ff0fc5">des_ecb_encrypt</a>(&amp;in,&amp;out,ks,<a class="code" href="des_8h.html#a89730e026cc6082480f070985e91e8aa">DES_ENCRYPT</a>);</div>
<div class="line">                <a class="code" href="des__old_8h.html#a2e1f935777448a3632f4be1c14ff0fc5">des_ecb_encrypt</a>(&amp;out,&amp;outin,ks,<a class="code" href="des_8h.html#a7ca3b464dc9e6cabf82f636101b6e133">DES_DECRYPT</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (memcmp(out,cipher_data[i],8) != 0)</div>
<div class="line">                        {</div>
<div class="line">                        printf(<span class="stringliteral">&quot;Encryption error %2d\nk=%s p=%s o=%s act=%s\n&quot;</span>,</div>
<div class="line">                                i+1,pt(key_data[i]),pt(in),pt(cipher_data[i]),</div>
<div class="line">                                pt(out));</div>
<div class="line">                        err=1;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (memcmp(in,outin,8) != 0)</div>
<div class="line">                        {</div>
<div class="line">                        printf(<span class="stringliteral">&quot;Decryption error %2d\nk=%s p=%s o=%s act=%s\n&quot;</span>,</div>
<div class="line">                                i+1,pt(key_data[i]),pt(out),pt(in),pt(outin));</div>
<div class="line">                        err=1;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef LIBDES_LIT</span></div>
<div class="line"><span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;Doing ede ecb\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i&lt;(NUM_TESTS-2); i++)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="des_8h.html#aa174247a199fa5c0b56b240d75d2845e">DES_set_key_unchecked</a>(&amp;key_data[i],&amp;ks);</div>
<div class="line">                <a class="code" href="des_8h.html#aa174247a199fa5c0b56b240d75d2845e">DES_set_key_unchecked</a>(&amp;key_data[i+1],&amp;ks2);</div>
<div class="line">                <a class="code" href="des_8h.html#aa174247a199fa5c0b56b240d75d2845e">DES_set_key_unchecked</a>(&amp;key_data[i+2],&amp;ks3);</div>
<div class="line">                memcpy(in,plain_data[i],8);</div>
<div class="line">                memset(out,0,8);</div>
<div class="line">                memset(outin,0,8);</div>
<div class="line">                <a class="code" href="des__old_8h.html#a5b7f15cf217188349509031e544dc6df">des_ecb2_encrypt</a>(&amp;in,&amp;out,ks,ks2,<a class="code" href="des_8h.html#a89730e026cc6082480f070985e91e8aa">DES_ENCRYPT</a>);</div>
<div class="line">                <a class="code" href="des__old_8h.html#a5b7f15cf217188349509031e544dc6df">des_ecb2_encrypt</a>(&amp;out,&amp;outin,ks,ks2,<a class="code" href="des_8h.html#a7ca3b464dc9e6cabf82f636101b6e133">DES_DECRYPT</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (memcmp(out,cipher_ecb2[i],8) != 0)</div>
<div class="line">                        {</div>
<div class="line">                        printf(<span class="stringliteral">&quot;Encryption error %2d\nk=%s p=%s o=%s act=%s\n&quot;</span>,</div>
<div class="line">                                i+1,pt(key_data[i]),pt(in),pt(cipher_ecb2[i]),</div>
<div class="line">                                pt(out));</div>
<div class="line">                        err=1;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (memcmp(in,outin,8) != 0)</div>
<div class="line">                        {</div>
<div class="line">                        printf(<span class="stringliteral">&quot;Decryption error %2d\nk=%s p=%s o=%s act=%s\n&quot;</span>,</div>
<div class="line">                                i+1,pt(key_data[i]),pt(out),pt(in),pt(outin));</div>
<div class="line">                        err=1;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Doing cbc\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> ((j=<a class="code" href="des_8h.html#a44f0916998768ca982f958da95771067">DES_set_key_checked</a>(&amp;cbc_key,&amp;ks)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Key error %d\n&quot;</span>,j);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        memset(cbc_out,0,40);</div>
<div class="line">        memset(cbc_in,0,40);</div>
<div class="line">        memcpy(iv3,cbc_iv,<span class="keyword">sizeof</span>(cbc_iv));</div>
<div class="line">        <a class="code" href="des__old_8h.html#a402e6004fce7f52296ac0c8989c2e5e9">des_ncbc_encrypt</a>(cbc_data,cbc_out,strlen((<span class="keywordtype">char</span> *)cbc_data)+1,ks,</div>
<div class="line">                         &amp;iv3,<a class="code" href="des_8h.html#a89730e026cc6082480f070985e91e8aa">DES_ENCRYPT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(cbc_out,cbc_ok,32) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;cbc_encrypt encrypt error\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        memcpy(iv3,cbc_iv,<span class="keyword">sizeof</span>(cbc_iv));</div>
<div class="line">        <a class="code" href="des__old_8h.html#a402e6004fce7f52296ac0c8989c2e5e9">des_ncbc_encrypt</a>(cbc_out,cbc_in,strlen((<span class="keywordtype">char</span> *)cbc_data)+1,ks,</div>
<div class="line">                         &amp;iv3,<a class="code" href="des_8h.html#a7ca3b464dc9e6cabf82f636101b6e133">DES_DECRYPT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(cbc_in,cbc_data,strlen((<span class="keywordtype">char</span> *)cbc_data)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;cbc_encrypt decrypt error\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef LIBDES_LIT</span></div>
<div class="line"><span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;Doing desx cbc\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> ((j=<a class="code" href="des_8h.html#a44f0916998768ca982f958da95771067">DES_set_key_checked</a>(&amp;cbc_key,&amp;ks)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Key error %d\n&quot;</span>,j);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        memset(cbc_out,0,40);</div>
<div class="line">        memset(cbc_in,0,40);</div>
<div class="line">        memcpy(iv3,cbc_iv,<span class="keyword">sizeof</span>(cbc_iv));</div>
<div class="line">        <a class="code" href="des__old_8h.html#a52bac928d3149f7b672777eb1a453a07">des_xcbc_encrypt</a>(cbc_data,cbc_out,strlen((<span class="keywordtype">char</span> *)cbc_data)+1,ks,</div>
<div class="line">                         &amp;iv3,&amp;cbc2_key,&amp;cbc3_key, <a class="code" href="des_8h.html#a89730e026cc6082480f070985e91e8aa">DES_ENCRYPT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(cbc_out,xcbc_ok,32) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;des_xcbc_encrypt encrypt error\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        memcpy(iv3,cbc_iv,<span class="keyword">sizeof</span>(cbc_iv));</div>
<div class="line">        <a class="code" href="des__old_8h.html#a52bac928d3149f7b672777eb1a453a07">des_xcbc_encrypt</a>(cbc_out,cbc_in,strlen((<span class="keywordtype">char</span> *)cbc_data)+1,ks,</div>
<div class="line">                         &amp;iv3,&amp;cbc2_key,&amp;cbc3_key, <a class="code" href="des_8h.html#a7ca3b464dc9e6cabf82f636101b6e133">DES_DECRYPT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(cbc_in,cbc_data,strlen((<span class="keywordtype">char</span> *)cbc_data)+1) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;des_xcbc_encrypt decrypt error\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Doing ede cbc\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> ((j=<a class="code" href="des_8h.html#a44f0916998768ca982f958da95771067">DES_set_key_checked</a>(&amp;cbc_key,&amp;ks)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Key error %d\n&quot;</span>,j);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> ((j=<a class="code" href="des_8h.html#a44f0916998768ca982f958da95771067">DES_set_key_checked</a>(&amp;cbc2_key,&amp;ks2)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Key error %d\n&quot;</span>,j);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> ((j=<a class="code" href="des_8h.html#a44f0916998768ca982f958da95771067">DES_set_key_checked</a>(&amp;cbc3_key,&amp;ks3)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Key error %d\n&quot;</span>,j);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        memset(cbc_out,0,40);</div>
<div class="line">        memset(cbc_in,0,40);</div>
<div class="line">        i=strlen((<span class="keywordtype">char</span> *)cbc_data)+1;</div>
<div class="line">        <span class="comment">/* i=((i+7)/8)*8; */</span></div>
<div class="line">        memcpy(iv3,cbc_iv,<span class="keyword">sizeof</span>(cbc_iv));</div>
<div class="line"></div>
<div class="line">        <a class="code" href="des__old_8h.html#a479a6b816828e22e0be604a278b5f31d">des_ede3_cbc_encrypt</a>(cbc_data,cbc_out,16L,ks,ks2,ks3,&amp;iv3,</div>
<div class="line">                             <a class="code" href="des_8h.html#a89730e026cc6082480f070985e91e8aa">DES_ENCRYPT</a>);</div>
<div class="line">        <a class="code" href="des__old_8h.html#a479a6b816828e22e0be604a278b5f31d">des_ede3_cbc_encrypt</a>(&amp;(cbc_data[16]),&amp;(cbc_out[16]),i-16,ks,ks2,ks3,</div>
<div class="line">                             &amp;iv3,<a class="code" href="des_8h.html#a89730e026cc6082480f070985e91e8aa">DES_ENCRYPT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(cbc_out,cbc3_ok,</div>
<div class="line">                (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(strlen((<span class="keywordtype">char</span> *)cbc_data)+1+7)/8*8) != 0)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n;</div>
<div class="line"></div>
<div class="line">                printf(<span class="stringliteral">&quot;des_ede3_cbc_encrypt encrypt error\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">for</span>(n=0 ; n &lt; i ; ++n)</div>
<div class="line">                    printf(<span class="stringliteral">&quot; %02x&quot;</span>,cbc_out[n]);</div>
<div class="line">                printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">for</span>(n=0 ; n &lt; i ; ++n)</div>
<div class="line">                    printf(<span class="stringliteral">&quot; %02x&quot;</span>,cbc3_ok[n]);</div>
<div class="line">                printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        memcpy(iv3,cbc_iv,<span class="keyword">sizeof</span>(cbc_iv));</div>
<div class="line">        <a class="code" href="des__old_8h.html#a479a6b816828e22e0be604a278b5f31d">des_ede3_cbc_encrypt</a>(cbc_out,cbc_in,i,ks,ks2,ks3,&amp;iv3,<a class="code" href="des_8h.html#a7ca3b464dc9e6cabf82f636101b6e133">DES_DECRYPT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(cbc_in,cbc_data,strlen((<span class="keywordtype">char</span> *)cbc_data)+1) != 0)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n;</div>
<div class="line"></div>
<div class="line">                printf(<span class="stringliteral">&quot;des_ede3_cbc_encrypt decrypt error\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">for</span>(n=0 ; n &lt; i ; ++n)</div>
<div class="line">                    printf(<span class="stringliteral">&quot; %02x&quot;</span>,cbc_data[n]);</div>
<div class="line">                printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">for</span>(n=0 ; n &lt; i ; ++n)</div>
<div class="line">                    printf(<span class="stringliteral">&quot; %02x&quot;</span>,cbc_in[n]);</div>
<div class="line">                printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef LIBDES_LIT</span></div>
<div class="line"><span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;Doing pcbc\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> ((j=<a class="code" href="des_8h.html#a44f0916998768ca982f958da95771067">DES_set_key_checked</a>(&amp;cbc_key,&amp;ks)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Key error %d\n&quot;</span>,j);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        memset(cbc_out,0,40);</div>
<div class="line">        memset(cbc_in,0,40);</div>
<div class="line">        <a class="code" href="des__old_8h.html#a08dcd490bbc351c2a7c9efede7b744ac">des_pcbc_encrypt</a>(cbc_data,cbc_out,strlen((<span class="keywordtype">char</span> *)cbc_data)+1,ks,</div>
<div class="line">                         &amp;cbc_iv,<a class="code" href="des_8h.html#a89730e026cc6082480f070985e91e8aa">DES_ENCRYPT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(cbc_out,pcbc_ok,32) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;pcbc_encrypt encrypt error\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        <a class="code" href="des__old_8h.html#a08dcd490bbc351c2a7c9efede7b744ac">des_pcbc_encrypt</a>(cbc_out,cbc_in,strlen((<span class="keywordtype">char</span> *)cbc_data)+1,ks,&amp;cbc_iv,</div>
<div class="line">                         <a class="code" href="des_8h.html#a7ca3b464dc9e6cabf82f636101b6e133">DES_DECRYPT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(cbc_in,cbc_data,strlen((<span class="keywordtype">char</span> *)cbc_data)+1) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;pcbc_encrypt decrypt error\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Doing &quot;</span>);</div>
<div class="line">        printf(<span class="stringliteral">&quot;cfb8 &quot;</span>);</div>
<div class="line">        err+=cfb_test(8,cfb_cipher8);</div>
<div class="line">        printf(<span class="stringliteral">&quot;cfb16 &quot;</span>);</div>
<div class="line">        err+=cfb_test(16,cfb_cipher16);</div>
<div class="line">        printf(<span class="stringliteral">&quot;cfb32 &quot;</span>);</div>
<div class="line">        err+=cfb_test(32,cfb_cipher32);</div>
<div class="line">        printf(<span class="stringliteral">&quot;cfb48 &quot;</span>);</div>
<div class="line">        err+=cfb_test(48,cfb_cipher48);</div>
<div class="line">        printf(<span class="stringliteral">&quot;cfb64 &quot;</span>);</div>
<div class="line">        err+=cfb_test(64,cfb_cipher64);</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;cfb64() &quot;</span>);</div>
<div class="line">        err+=cfb64_test(cfb_cipher64);</div>
<div class="line"></div>
<div class="line">        memcpy(cfb_tmp,cfb_iv,<span class="keyword">sizeof</span>(cfb_iv));</div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i&lt;<span class="keyword">sizeof</span>(plain); i++)</div>
<div class="line">                <a class="code" href="des__old_8h.html#ad6323250c36aa93a162443c814a1c1eb">des_cfb_encrypt</a>(&amp;(plain[i]),&amp;(cfb_buf1[i]),</div>
<div class="line">                        8,1,ks,&amp;cfb_tmp,<a class="code" href="des_8h.html#a89730e026cc6082480f070985e91e8aa">DES_ENCRYPT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(cfb_cipher8,cfb_buf1,<span class="keyword">sizeof</span>(plain)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;cfb_encrypt small encrypt error\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        memcpy(cfb_tmp,cfb_iv,<span class="keyword">sizeof</span>(cfb_iv));</div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i&lt;<span class="keyword">sizeof</span>(plain); i++)</div>
<div class="line">                <a class="code" href="des__old_8h.html#ad6323250c36aa93a162443c814a1c1eb">des_cfb_encrypt</a>(&amp;(cfb_buf1[i]),&amp;(cfb_buf2[i]),</div>
<div class="line">                        8,1,ks,&amp;cfb_tmp,<a class="code" href="des_8h.html#a7ca3b464dc9e6cabf82f636101b6e133">DES_DECRYPT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(plain,cfb_buf2,<span class="keyword">sizeof</span>(plain)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;cfb_encrypt small decrypt error\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;ede_cfb64() &quot;</span>);</div>
<div class="line">        err+=ede_cfb64_test(cfb_cipher64);</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;done\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Doing ofb\n&quot;</span>);</div>
<div class="line">        <a class="code" href="des_8h.html#a44f0916998768ca982f958da95771067">DES_set_key_checked</a>(&amp;ofb_key,&amp;ks);</div>
<div class="line">        memcpy(ofb_tmp,ofb_iv,<span class="keyword">sizeof</span>(ofb_iv));</div>
<div class="line">        <a class="code" href="des__old_8h.html#af27a10c4f5063693309bf0300f591239">des_ofb_encrypt</a>(plain,ofb_buf1,64,<span class="keyword">sizeof</span>(plain)/8,ks,&amp;ofb_tmp);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(ofb_cipher,ofb_buf1,<span class="keyword">sizeof</span>(ofb_buf1)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;ofb_encrypt encrypt error\n&quot;</span>);</div>
<div class="line">printf(<span class="stringliteral">&quot;%02X %02X %02X %02X %02X %02X %02X %02X\n&quot;</span>,</div>
<div class="line">ofb_buf1[8+0], ofb_buf1[8+1], ofb_buf1[8+2], ofb_buf1[8+3],</div>
<div class="line">ofb_buf1[8+4], ofb_buf1[8+5], ofb_buf1[8+6], ofb_buf1[8+7]);</div>
<div class="line">printf(<span class="stringliteral">&quot;%02X %02X %02X %02X %02X %02X %02X %02X\n&quot;</span>,</div>
<div class="line">ofb_buf1[8+0], ofb_cipher[8+1], ofb_cipher[8+2], ofb_cipher[8+3],</div>
<div class="line">ofb_buf1[8+4], ofb_cipher[8+5], ofb_cipher[8+6], ofb_cipher[8+7]);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        memcpy(ofb_tmp,ofb_iv,<span class="keyword">sizeof</span>(ofb_iv));</div>
<div class="line">        <a class="code" href="des__old_8h.html#af27a10c4f5063693309bf0300f591239">des_ofb_encrypt</a>(ofb_buf1,ofb_buf2,64,<span class="keyword">sizeof</span>(ofb_buf1)/8,ks,&amp;ofb_tmp);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(plain,ofb_buf2,<span class="keyword">sizeof</span>(ofb_buf2)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;ofb_encrypt decrypt error\n&quot;</span>);</div>
<div class="line">printf(<span class="stringliteral">&quot;%02X %02X %02X %02X %02X %02X %02X %02X\n&quot;</span>,</div>
<div class="line">ofb_buf2[8+0], ofb_buf2[8+1], ofb_buf2[8+2], ofb_buf2[8+3],</div>
<div class="line">ofb_buf2[8+4], ofb_buf2[8+5], ofb_buf2[8+6], ofb_buf2[8+7]);</div>
<div class="line">printf(<span class="stringliteral">&quot;%02X %02X %02X %02X %02X %02X %02X %02X\n&quot;</span>,</div>
<div class="line">plain[8+0], plain[8+1], plain[8+2], plain[8+3],</div>
<div class="line">plain[8+4], plain[8+5], plain[8+6], plain[8+7]);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Doing ofb64\n&quot;</span>);</div>
<div class="line">        <a class="code" href="des_8h.html#a44f0916998768ca982f958da95771067">DES_set_key_checked</a>(&amp;ofb_key,&amp;ks);</div>
<div class="line">        memcpy(ofb_tmp,ofb_iv,<span class="keyword">sizeof</span>(ofb_iv));</div>
<div class="line">        memset(ofb_buf1,0,<span class="keyword">sizeof</span>(ofb_buf1));</div>
<div class="line">        memset(ofb_buf2,0,<span class="keyword">sizeof</span>(ofb_buf1));</div>
<div class="line">        num=0;</div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i&lt;<span class="keyword">sizeof</span>(plain); i++)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="des__old_8h.html#abb3f42fa3a9c634aa3e3a44bb6e70316">des_ofb64_encrypt</a>(&amp;(plain[i]),&amp;(ofb_buf1[i]),1,ks,&amp;ofb_tmp,</div>
<div class="line">                                  &amp;num);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(ofb_cipher,ofb_buf1,<span class="keyword">sizeof</span>(ofb_buf1)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;ofb64_encrypt encrypt error\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        memcpy(ofb_tmp,ofb_iv,<span class="keyword">sizeof</span>(ofb_iv));</div>
<div class="line">        num=0;</div>
<div class="line">        <a class="code" href="des__old_8h.html#abb3f42fa3a9c634aa3e3a44bb6e70316">des_ofb64_encrypt</a>(ofb_buf1,ofb_buf2,<span class="keyword">sizeof</span>(ofb_buf1),ks,&amp;ofb_tmp,</div>
<div class="line">                          &amp;num);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(plain,ofb_buf2,<span class="keyword">sizeof</span>(ofb_buf2)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;ofb64_encrypt decrypt error\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Doing ede_ofb64\n&quot;</span>);</div>
<div class="line">        <a class="code" href="des_8h.html#a44f0916998768ca982f958da95771067">DES_set_key_checked</a>(&amp;ofb_key,&amp;ks);</div>
<div class="line">        memcpy(ofb_tmp,ofb_iv,<span class="keyword">sizeof</span>(ofb_iv));</div>
<div class="line">        memset(ofb_buf1,0,<span class="keyword">sizeof</span>(ofb_buf1));</div>
<div class="line">        memset(ofb_buf2,0,<span class="keyword">sizeof</span>(ofb_buf1));</div>
<div class="line">        num=0;</div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i&lt;<span class="keyword">sizeof</span>(plain); i++)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="des__old_8h.html#a1fdf47b2b7565b897eb664e11bed6053">des_ede3_ofb64_encrypt</a>(&amp;(plain[i]),&amp;(ofb_buf1[i]),1,ks,ks,</div>
<div class="line">                                       ks,&amp;ofb_tmp,&amp;num);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(ofb_cipher,ofb_buf1,<span class="keyword">sizeof</span>(ofb_buf1)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;ede_ofb64_encrypt encrypt error\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        memcpy(ofb_tmp,ofb_iv,<span class="keyword">sizeof</span>(ofb_iv));</div>
<div class="line">        num=0;</div>
<div class="line">        <a class="code" href="des__old_8h.html#a1fdf47b2b7565b897eb664e11bed6053">des_ede3_ofb64_encrypt</a>(ofb_buf1,ofb_buf2,<span class="keyword">sizeof</span>(ofb_buf1),ks,ks,ks,</div>
<div class="line">                               &amp;ofb_tmp,&amp;num);</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(plain,ofb_buf2,<span class="keyword">sizeof</span>(ofb_buf2)) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;ede_ofb64_encrypt decrypt error\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Doing cbc_cksum\n&quot;</span>);</div>
<div class="line">        <a class="code" href="des_8h.html#a44f0916998768ca982f958da95771067">DES_set_key_checked</a>(&amp;cbc_key,&amp;ks);</div>
<div class="line">        cs=<a class="code" href="des__old_8h.html#a9990a287b9727ceeaaade759f6a406d9">des_cbc_cksum</a>(cbc_data,&amp;cret,strlen((<span class="keywordtype">char</span> *)cbc_data),ks,&amp;cbc_iv);</div>
<div class="line">        <span class="keywordflow">if</span> (cs != cbc_cksum_ret)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;bad return value (%08lX), should be %08lX\n&quot;</span>,</div>
<div class="line">                        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)cs,(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)cbc_cksum_ret);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(cret,cbc_cksum_data,8) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;bad cbc_cksum block returned\n&quot;</span>);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Doing quad_cksum\n&quot;</span>);</div>
<div class="line">        cs=<a class="code" href="des__old_8h.html#a32c8fa24ad46880044c0c10ed484a1d6">des_quad_cksum</a>(cbc_data,(<a class="code" href="des__old_8h.html#a34a0bf705d949f5c6bdfb16939e114ad">des_cblock</a> *)lqret,</div>
<div class="line">                (<span class="keywordtype">long</span>)strlen((<span class="keywordtype">char</span> *)cbc_data),2,(<a class="code" href="des__old_8h.html#a34a0bf705d949f5c6bdfb16939e114ad">des_cblock</a> *)cbc_iv);</div>
<div class="line">        <span class="keywordflow">if</span> (cs != 0x70d7a63aL)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;quad_cksum error, ret %08lx should be 70d7a63a\n&quot;</span>,</div>
<div class="line">                        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)cs);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#ifdef _CRAY</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (lqret[0].<a class="code" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a> != 0x327eba8dL)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;quad_cksum error, out[0] %08lx is not %08lx\n&quot;</span>,</div>
<div class="line">                        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)lqret[0].<a class="code" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>,0x327eba8dUL);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (lqret[0].<a class="code" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a> != 0x201a49ccL)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;quad_cksum error, out[1] %08lx is not %08lx\n&quot;</span>,</div>
<div class="line">                        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)lqret[0].<a class="code" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>,0x201a49ccUL);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (lqret[1].<a class="code" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a> != 0x70d7a63aL)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;quad_cksum error, out[2] %08lx is not %08lx\n&quot;</span>,</div>
<div class="line">                        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)lqret[1].<a class="code" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>,0x70d7a63aUL);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (lqret[1].<a class="code" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a> != 0x501c2c26L)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;quad_cksum error, out[3] %08lx is not %08lx\n&quot;</span>,</div>
<div class="line">                        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)lqret[1].<a class="code" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>,0x501c2c26UL);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (lqret[0] != 0x327eba8dL)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;quad_cksum error, out[0] %08lx is not %08lx\n&quot;</span>,</div>
<div class="line">                        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)lqret[0],0x327eba8dUL);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (lqret[1] != 0x201a49ccL)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;quad_cksum error, out[1] %08lx is not %08lx\n&quot;</span>,</div>
<div class="line">                        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)lqret[1],0x201a49ccUL);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (lqret[2] != 0x70d7a63aL)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;quad_cksum error, out[2] %08lx is not %08lx\n&quot;</span>,</div>
<div class="line">                        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)lqret[2],0x70d7a63aUL);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (lqret[3] != 0x501c2c26L)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;quad_cksum error, out[3] %08lx is not %08lx\n&quot;</span>,</div>
<div class="line">                        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)lqret[3],0x501c2c26UL);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        printf(<span class="stringliteral">&quot;input word alignment test&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i&lt;4; i++)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot; %d&quot;</span>,i);</div>
<div class="line">                <a class="code" href="des__old_8h.html#a402e6004fce7f52296ac0c8989c2e5e9">des_ncbc_encrypt</a>(&amp;(cbc_out[i]),cbc_in,</div>
<div class="line">                                 strlen((<span class="keywordtype">char</span> *)cbc_data)+1,ks,</div>
<div class="line">                                 &amp;cbc_iv,<a class="code" href="des_8h.html#a89730e026cc6082480f070985e91e8aa">DES_ENCRYPT</a>);</div>
<div class="line">                }</div>
<div class="line">        printf(<span class="stringliteral">&quot;\noutput word alignment test&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i&lt;4; i++)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot; %d&quot;</span>,i);</div>
<div class="line">                <a class="code" href="des__old_8h.html#a402e6004fce7f52296ac0c8989c2e5e9">des_ncbc_encrypt</a>(cbc_out,&amp;(cbc_in[i]),</div>
<div class="line">                                 strlen((<span class="keywordtype">char</span> *)cbc_data)+1,ks,</div>
<div class="line">                                 &amp;cbc_iv,<a class="code" href="des_8h.html#a89730e026cc6082480f070985e91e8aa">DES_ENCRYPT</a>);</div>
<div class="line">                }</div>
<div class="line">        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">        printf(<span class="stringliteral">&quot;fast crypt test &quot;</span>);</div>
<div class="line">        str=<a class="code" href="destest_8c.html#a9c4ff83dfec76adf265878861e364531">crypt</a>(<span class="stringliteral">&quot;testing&quot;</span>,<span class="stringliteral">&quot;ef&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;efGnQx2725bI2&quot;</span>,str) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;fast crypt error, %s should be efGnQx2725bI2\n&quot;</span>,str);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line">        str=<a class="code" href="destest_8c.html#a9c4ff83dfec76adf265878861e364531">crypt</a>(<span class="stringliteral">&quot;bca76;23&quot;</span>,<span class="stringliteral">&quot;yA&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;yA1Rp/1hZXIJk&quot;</span>,str) != 0)</div>
<div class="line">                {</div>
<div class="line">                printf(<span class="stringliteral">&quot;fast crypt error, %s should be yA1Rp/1hZXIJk\n&quot;</span>,str);</div>
<div class="line">                err=1;</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#ifdef OPENSSL_SYS_NETWARE</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span> (err) printf(<span class="stringliteral">&quot;ERROR: %d\n&quot;</span>, err);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>(err);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 15 2014 18:16:51 for openssl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
