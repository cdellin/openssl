<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/srp/srp.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_33d6eb1617dda4c83fcd1f9805b0ce3a.html">srp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">srp.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;openssl/safestack.h&gt;</code><br/>
<code>#include &lt;openssl/bn.h&gt;</code><br/>
<code>#include &lt;openssl/crypto.h&gt;</code><br/>
</div>
<p><a href="srp_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSRP__gN__cache__st.html">SRP_gN_cache_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSRP__user__pwd__st.html">SRP_user_pwd_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSRP__VBASE__st.html">SRP_VBASE_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSRP__gN__st.html">SRP_gN_st</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6be2311ed5b35ba26f9d6631f57c9df6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a6be2311ed5b35ba26f9d6631f57c9df6">SRP_NO_ERROR</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:ac638b96edd331d22998e1c7e23ef412d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#ac638b96edd331d22998e1c7e23ef412d">SRP_ERR_VBASE_INCOMPLETE_FILE</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:afd66c2a70f4a7462914cca8789e9ee53"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#afd66c2a70f4a7462914cca8789e9ee53">SRP_ERR_VBASE_BN_LIB</a>&#160;&#160;&#160;2</td></tr>
<tr class="memitem:ae42e777544b5332d61e8043ea222109d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#ae42e777544b5332d61e8043ea222109d">SRP_ERR_OPEN_FILE</a>&#160;&#160;&#160;3</td></tr>
<tr class="memitem:ab72c315974949551e29fa224503dd7a6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#ab72c315974949551e29fa224503dd7a6">SRP_ERR_MEMORY</a>&#160;&#160;&#160;4</td></tr>
<tr class="memitem:a3707f8643cbbecd15fe494cb55ff237e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a3707f8643cbbecd15fe494cb55ff237e">DB_srptype</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:a89994381b79b08c9c5dccfdd0d0d780d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a89994381b79b08c9c5dccfdd0d0d780d">DB_srpverifier</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:a622ceaef9f350429c1cabd0cb48589db"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a622ceaef9f350429c1cabd0cb48589db">DB_srpsalt</a>&#160;&#160;&#160;2</td></tr>
<tr class="memitem:a9d34912a71e3fabce20fc5869d2ee163"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a9d34912a71e3fabce20fc5869d2ee163">DB_srpid</a>&#160;&#160;&#160;3</td></tr>
<tr class="memitem:a4ac6404854e05eb81658de11dfd5a56e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a4ac6404854e05eb81658de11dfd5a56e">DB_srpgN</a>&#160;&#160;&#160;4</td></tr>
<tr class="memitem:adea7961992e03b2abb1344c2b7c741cb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#adea7961992e03b2abb1344c2b7c741cb">DB_srpinfo</a>&#160;&#160;&#160;5</td></tr>
<tr class="memitem:acc01d3ad7269a5bb155a9cd2eb89655e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#acc01d3ad7269a5bb155a9cd2eb89655e">DB_NUMBER</a>&#160;&#160;&#160;6</td></tr>
<tr class="memitem:a44d7ae5c7e5ef317ae226fab1dc69712"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a44d7ae5c7e5ef317ae226fab1dc69712">DB_SRP_INDEX</a>&#160;&#160;&#160;'<a class="el" href="md5__locl_8h.html#a494b31a2f2ae18c4e7f88e5912bb48d4">I</a>'</td></tr>
<tr class="memitem:a821f89d6440bd201a29e01c4db2e1548"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a821f89d6440bd201a29e01c4db2e1548">DB_SRP_VALID</a>&#160;&#160;&#160;'V'</td></tr>
<tr class="memitem:acab4925ac542f48a14e2faf9f58c6dd2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#acab4925ac542f48a14e2faf9f58c6dd2">DB_SRP_REVOKED</a>&#160;&#160;&#160;'R'</td></tr>
<tr class="memitem:afbe7692d40acd7aed59fe65b2854424f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#afbe7692d40acd7aed59fe65b2854424f">DB_SRP_MODIF</a>&#160;&#160;&#160;'v'</td></tr>
<tr class="memitem:a6ff1fa60f3a0e9d19df7ac0eddf8cfd4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a6ff1fa60f3a0e9d19df7ac0eddf8cfd4">SRP_MINIMAL_N</a>&#160;&#160;&#160;1024</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a80d3045219f016b8ec07f4a66eb4b9a9"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structSRP__gN__cache__st.html">SRP_gN_cache_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a80d3045219f016b8ec07f4a66eb4b9a9">SRP_gN_cache</a></td></tr>
<tr class="memitem:a06cf6af0b10520e22f47907f57af5832"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structSRP__user__pwd__st.html">SRP_user_pwd_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a06cf6af0b10520e22f47907f57af5832">SRP_user_pwd</a></td></tr>
<tr class="memitem:afde841f24ff8351891c31f5390a6fe4e"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structSRP__VBASE__st.html">SRP_VBASE_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#afde841f24ff8351891c31f5390a6fe4e">SRP_VBASE</a></td></tr>
<tr class="memitem:a6966df6d8d2b1ecf31e425b10b329c7d"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structSRP__gN__st.html">SRP_gN_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a6966df6d8d2b1ecf31e425b10b329c7d">SRP_gN</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac9d4de5cd9cdefb490265f72f10d22ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="srp_8h.html#afde841f24ff8351891c31f5390a6fe4e">SRP_VBASE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#ac9d4de5cd9cdefb490265f72f10d22ee">SRP_VBASE_new</a> (char *seed_key)</td></tr>
<tr class="memitem:a4df6e977f079690d4fc00bd91ab45b4e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a4df6e977f079690d4fc00bd91ab45b4e">SRP_VBASE_free</a> (<a class="el" href="srp_8h.html#afde841f24ff8351891c31f5390a6fe4e">SRP_VBASE</a> *vb)</td></tr>
<tr class="memitem:a225b895f39edcc05f248f3d6b8ed5ed2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a225b895f39edcc05f248f3d6b8ed5ed2">SRP_VBASE_init</a> (<a class="el" href="srp_8h.html#afde841f24ff8351891c31f5390a6fe4e">SRP_VBASE</a> *vb, char *verifier_file)</td></tr>
<tr class="memitem:a661ecdd3df3b1f257e03b83cd066eafe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="srp_8h.html#a06cf6af0b10520e22f47907f57af5832">SRP_user_pwd</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a661ecdd3df3b1f257e03b83cd066eafe">SRP_VBASE_get_by_user</a> (<a class="el" href="srp_8h.html#afde841f24ff8351891c31f5390a6fe4e">SRP_VBASE</a> *vb, char *username)</td></tr>
<tr class="memitem:a63be39479fe30576281ca9157737ce99"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a63be39479fe30576281ca9157737ce99">SRP_create_verifier</a> (const char *user, const char *<a class="el" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>, char **salt, char **verifier, const char *<a class="el" href="wp__block_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, const char *g)</td></tr>
<tr class="memitem:a56eb2906fc5710e40a1d9a2a329888b7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a56eb2906fc5710e40a1d9a2a329888b7">SRP_create_verifier_BN</a> (const char *user, const char *<a class="el" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> **salt, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> **verifier, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="wp__block_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *g)</td></tr>
<tr class="memitem:ae2df1ebb823c339d60eb88fc4d351304"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#ae2df1ebb823c339d60eb88fc4d351304">SRP_check_known_gN_param</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *g, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="wp__block_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</td></tr>
<tr class="memitem:aee304d9f814810909e7cefebaaece032"><td class="memItemLeft" align="right" valign="top"><a class="el" href="srp_8h.html#a6966df6d8d2b1ecf31e425b10b329c7d">SRP_gN</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#aee304d9f814810909e7cefebaaece032">SRP_get_default_gN</a> (const char *id)</td></tr>
<tr class="memitem:a1e66dacc92e722dd9f49dac59b8f9a00"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a1e66dacc92e722dd9f49dac59b8f9a00">SRP_Calc_server_key</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *A, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *v, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="wp__block_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</td></tr>
<tr class="memitem:a34d8aa187b84cbff122b602dbbea8f1d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a34d8aa187b84cbff122b602dbbea8f1d">SRP_Calc_B</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="wp__block_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *g, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *v)</td></tr>
<tr class="memitem:ac0b02662ec209ff41fd9f111aba33f2c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#ac0b02662ec209ff41fd9f111aba33f2c">SRP_Verify_A_mod_N</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *A, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="wp__block_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</td></tr>
<tr class="memitem:a5ac4526f4175b0341234b6fa0c8e112b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a5ac4526f4175b0341234b6fa0c8e112b">SRP_Calc_u</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *A, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="sha512_8c.html#af2b2656e2da2f64498d6b4a7b0237eae">B</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="wp__block_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</td></tr>
<tr class="memitem:aacc340e82bbc8c97f4a13535321db19e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#aacc340e82bbc8c97f4a13535321db19e">SRP_Calc_x</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *s, const char *user, const char *<a class="el" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>)</td></tr>
<tr class="memitem:a783b94dba8ebdd0fbe3fb249d22537b8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a783b94dba8ebdd0fbe3fb249d22537b8">SRP_Calc_A</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="wp__block_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *g)</td></tr>
<tr class="memitem:aad531db3f553e0bbce48d9950a7ae847"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#aad531db3f553e0bbce48d9950a7ae847">SRP_Calc_client_key</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="wp__block_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="sha512_8c.html#af2b2656e2da2f64498d6b4a7b0237eae">B</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *g, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>)</td></tr>
<tr class="memitem:a3235f19c44bf7ff4b4a028253a922aa8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="srp_8h.html#a3235f19c44bf7ff4b4a028253a922aa8">SRP_Verify_B_mod_N</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="sha512_8c.html#af2b2656e2da2f64498d6b4a7b0237eae">B</a>, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="wp__block_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="acc01d3ad7269a5bb155a9cd2eb89655e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_NUMBER&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00139">139</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="a44d7ae5c7e5ef317ae226fab1dc69712"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_SRP_INDEX&#160;&#160;&#160;'<a class="el" href="md5__locl_8h.html#a494b31a2f2ae18c4e7f88e5912bb48d4">I</a>'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00141">141</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="afbe7692d40acd7aed59fe65b2854424f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_SRP_MODIF&#160;&#160;&#160;'v'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00144">144</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="acab4925ac542f48a14e2faf9f58c6dd2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_SRP_REVOKED&#160;&#160;&#160;'R'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00143">143</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="a821f89d6440bd201a29e01c4db2e1548"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_SRP_VALID&#160;&#160;&#160;'V'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00142">142</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4ac6404854e05eb81658de11dfd5a56e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_srpgN&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00136">136</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9d34912a71e3fabce20fc5869d2ee163"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_srpid&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00135">135</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="adea7961992e03b2abb1344c2b7c741cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_srpinfo&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00137">137</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="a622ceaef9f350429c1cabd0cb48589db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_srpsalt&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00134">134</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3707f8643cbbecd15fe494cb55ff237e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_srptype&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00132">132</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="a89994381b79b08c9c5dccfdd0d0d780d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_srpverifier&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00133">133</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab72c315974949551e29fa224503dd7a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SRP_ERR_MEMORY&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00130">130</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae42e777544b5332d61e8043ea222109d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SRP_ERR_OPEN_FILE&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00129">129</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="afd66c2a70f4a7462914cca8789e9ee53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SRP_ERR_VBASE_BN_LIB&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00128">128</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac638b96edd331d22998e1c7e23ef412d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SRP_ERR_VBASE_INCOMPLETE_FILE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00127">127</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6ff1fa60f3a0e9d19df7ac0eddf8cfd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SRP_MINIMAL_N&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00165">165</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6be2311ed5b35ba26f9d6631f57c9df6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SRP_NO_ERROR&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp_8h_source.html#l00126">126</a> of file <a class="el" href="srp_8h_source.html">srp.h</a>.</p>

</div>
</div>
<h2>Typedef Documentation</h2>
<a class="anchor" id="a6966df6d8d2b1ecf31e425b10b329c7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structSRP__gN__st.html">SRP_gN_st</a>  <a class="el" href="srp_8h.html#a6966df6d8d2b1ecf31e425b10b329c7d">SRP_gN</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a80d3045219f016b8ec07f4a66eb4b9a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structSRP__gN__cache__st.html">SRP_gN_cache_st</a>  <a class="el" href="srp_8h.html#a80d3045219f016b8ec07f4a66eb4b9a9">SRP_gN_cache</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a06cf6af0b10520e22f47907f57af5832"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structSRP__user__pwd__st.html">SRP_user_pwd_st</a>  <a class="el" href="srp_8h.html#a06cf6af0b10520e22f47907f57af5832">SRP_user_pwd</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="afde841f24ff8351891c31f5390a6fe4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structSRP__VBASE__st.html">SRP_VBASE_st</a>  <a class="el" href="srp_8h.html#afde841f24ff8351891c31f5390a6fe4e">SRP_VBASE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a783b94dba8ebdd0fbe3fb249d22537b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a>* SRP_Calc_A </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>g</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__lib_8c_source.html#l00239">239</a> of file <a class="el" href="srp__lib_8c_source.html">srp_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbignum__ctx.html">BN_CTX</a> *bn_ctx; </div>
<div class="line">        <a class="code" href="structbignum__st.html">BIGNUM</a> * A = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (a == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || N == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || g == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ||</div>
<div class="line">                (bn_ctx = <a class="code" href="bn_8h.html#a04a38b774caf5e9bb7dea8b22c6eddc2">BN_CTX_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) </div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((A = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>()) != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> &amp;&amp;</div>
<div class="line">           !<a class="code" href="bn_8h.html#a4624503e0c5a02a37708ecd62734727c">BN_mod_exp</a>(A,g,a,N,bn_ctx))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="bn_8h.html#a2d660f4ff6015d33035484c4e9f09e88">BN_free</a>(A);</div>
<div class="line">                A = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <a class="code" href="bn_8h.html#a92238db5c582bc055f4aa86a5cddb247">BN_CTX_free</a>(bn_ctx);</div>
<div class="line">        <span class="keywordflow">return</span> A;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a34d8aa187b84cbff122b602dbbea8f1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a>* SRP_Calc_B </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__lib_8c_source.html#l00174">174</a> of file <a class="el" href="srp__lib_8c_source.html">srp_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbignum__st.html">BIGNUM</a>  *kv = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, *gb = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structbignum__st.html">BIGNUM</a> *<a class="code" href="sha512_8c.html#af2b2656e2da2f64498d6b4a7b0237eae">B</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, *<a class="code" href="ideatest_8c.html#affd277b0419eb3509477eb517aa904ce">k</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structbignum__ctx.html">BN_CTX</a> *bn_ctx;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (b == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || N == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || g == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || v == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ||</div>
<div class="line">                (bn_ctx = <a class="code" href="bn_8h.html#a04a38b774caf5e9bb7dea8b22c6eddc2">BN_CTX_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>; </div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( (kv = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ||</div>
<div class="line">                (gb = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ||</div>
<div class="line">                (B = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>())== <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* B = g**b + k*v */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a4624503e0c5a02a37708ecd62734727c">BN_mod_exp</a>(gb,g,b,N,bn_ctx) ||</div>
<div class="line">           !(k = srp_Calc_k(N,g)) ||</div>
<div class="line">           !<a class="code" href="bn_8h.html#ad0146b160c761fbfc83c1eeda4aee561">BN_mod_mul</a>(kv,v,k,N,bn_ctx) || </div>
<div class="line">           !<a class="code" href="bn_8h.html#a50cddc55ee851c397ab4ef621137edb5">BN_mod_add</a>(B,gb,kv,N,bn_ctx))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="bn_8h.html#a2d660f4ff6015d33035484c4e9f09e88">BN_free</a>(B);</div>
<div class="line">                B = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">err:</div>
<div class="line">        <a class="code" href="bn_8h.html#a92238db5c582bc055f4aa86a5cddb247">BN_CTX_free</a>(bn_ctx);</div>
<div class="line">        <a class="code" href="bn_8h.html#a56590c5516fe2b5ae9b30fbbb3874c5a">BN_clear_free</a>(kv);</div>
<div class="line">        <a class="code" href="bn_8h.html#a56590c5516fe2b5ae9b30fbbb3874c5a">BN_clear_free</a>(gb);</div>
<div class="line">        <a class="code" href="bn_8h.html#a2d660f4ff6015d33035484c4e9f09e88">BN_free</a>(k); </div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="sha512_8c.html#af2b2656e2da2f64498d6b4a7b0237eae">B</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aad531db3f553e0bbce48d9950a7ae847"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a>* SRP_Calc_client_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__lib_8c_source.html#l00259">259</a> of file <a class="el" href="srp__lib_8c_source.html">srp_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbignum__st.html">BIGNUM</a> *tmp = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, *tmp2 = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, *tmp3 = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> , *<a class="code" href="ideatest_8c.html#affd277b0419eb3509477eb517aa904ce">k</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, *K = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structbignum__ctx.html">BN_CTX</a> *bn_ctx;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (u == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || B == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || N == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || g == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || x == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || a == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ||</div>
<div class="line">                (bn_ctx = <a class="code" href="bn_8h.html#a04a38b774caf5e9bb7dea8b22c6eddc2">BN_CTX_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>; </div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((tmp = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ||</div>
<div class="line">                (tmp2 = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>())== <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ||</div>
<div class="line">                (tmp3 = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>())== <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ||</div>
<div class="line">                (K = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a4624503e0c5a02a37708ecd62734727c">BN_mod_exp</a>(tmp,g,x,N,bn_ctx))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!(k = srp_Calc_k(N,g)))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#ad0146b160c761fbfc83c1eeda4aee561">BN_mod_mul</a>(tmp2,tmp,k,N,bn_ctx))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a971fe510abbbb2afc4f65286050cf848">BN_mod_sub</a>(tmp,B,tmp2,N,bn_ctx))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#ad0146b160c761fbfc83c1eeda4aee561">BN_mod_mul</a>(tmp3,u,x,N,bn_ctx))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a50cddc55ee851c397ab4ef621137edb5">BN_mod_add</a>(tmp2,a,tmp3,N,bn_ctx))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a4624503e0c5a02a37708ecd62734727c">BN_mod_exp</a>(K,tmp,tmp2,N,bn_ctx))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">err :</div>
<div class="line">        <a class="code" href="bn_8h.html#a92238db5c582bc055f4aa86a5cddb247">BN_CTX_free</a>(bn_ctx);</div>
<div class="line">        <a class="code" href="bn_8h.html#a56590c5516fe2b5ae9b30fbbb3874c5a">BN_clear_free</a>(tmp);</div>
<div class="line">        <a class="code" href="bn_8h.html#a56590c5516fe2b5ae9b30fbbb3874c5a">BN_clear_free</a>(tmp2);</div>
<div class="line">        <a class="code" href="bn_8h.html#a56590c5516fe2b5ae9b30fbbb3874c5a">BN_clear_free</a>(tmp3);</div>
<div class="line">        <a class="code" href="bn_8h.html#a2d660f4ff6015d33035484c4e9f09e88">BN_free</a>(k);</div>
<div class="line">        <span class="keywordflow">return</span> K;       </div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1e66dacc92e722dd9f49dac59b8f9a00"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a>* SRP_Calc_server_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__lib_8c_source.html#l00147">147</a> of file <a class="el" href="srp__lib_8c_source.html">srp_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbignum__st.html">BIGNUM</a> *tmp = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, *S = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structbignum__ctx.html">BN_CTX</a> *bn_ctx; </div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (u == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || A == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || v == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || b == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || N == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>; </div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((bn_ctx = <a class="code" href="bn_8h.html#a04a38b774caf5e9bb7dea8b22c6eddc2">BN_CTX_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ||</div>
<div class="line">                (tmp = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ||</div>
<div class="line">                (S = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> )</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* S = (A*v**u) ** b */</span> </div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a4624503e0c5a02a37708ecd62734727c">BN_mod_exp</a>(tmp,v,u,N,bn_ctx))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#ad0146b160c761fbfc83c1eeda4aee561">BN_mod_mul</a>(tmp,A,tmp,N,bn_ctx))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a4624503e0c5a02a37708ecd62734727c">BN_mod_exp</a>(S,tmp,b,N,bn_ctx))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">err:</div>
<div class="line">        <a class="code" href="bn_8h.html#a92238db5c582bc055f4aa86a5cddb247">BN_CTX_free</a>(bn_ctx);</div>
<div class="line">        <a class="code" href="bn_8h.html#a56590c5516fe2b5ae9b30fbbb3874c5a">BN_clear_free</a>(tmp);</div>
<div class="line">        <span class="keywordflow">return</span> S;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5ac4526f4175b0341234b6fa0c8e112b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a>* SRP_Calc_u </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__lib_8c_source.html#l00112">112</a> of file <a class="el" href="srp__lib_8c_source.html">srp_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="comment">/* k = SHA1(PAD(A) || PAD(B) ) -- tls-srp draft 8 */</span></div>
<div class="line"></div>
<div class="line">        <a class="code" href="structbignum__st.html">BIGNUM</a> *<a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>;      </div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cu[<a class="code" href="sha_8h.html#a1a715db7b4403fe6c165e49a32f5fe3d">SHA_DIGEST_LENGTH</a>];</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *cAB;</div>
<div class="line">        <a class="code" href="structenv__md__ctx__st.html">EVP_MD_CTX</a> ctxt;</div>
<div class="line">        <span class="keywordtype">int</span> longN;  </div>
<div class="line">        <span class="keywordflow">if</span> ((A == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) ||(B == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) || (N == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        longN= <a class="code" href="bn_8h.html#a6f1f92317e94bcae2e83ae518824c01d">BN_num_bytes</a>(N);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((cAB = <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(2*longN)) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) </div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        memset(cAB, 0, longN);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="digest_8c.html#afe58145aa88a8ee187d858c762c00399">EVP_MD_CTX_init</a>(&amp;ctxt);</div>
<div class="line">        <a class="code" href="digest_8c.html#a039cce8e234ebef1284710b019075ddc">EVP_DigestInit_ex</a>(&amp;ctxt, <a class="code" href="evp_8h.html#aa090d659a494a10525e38d272efb01ae">EVP_sha1</a>(), <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        <a class="code" href="digest_8c.html#a1886b261d05d3ee8866f5ccf92184552">EVP_DigestUpdate</a>(&amp;ctxt, cAB + <a class="code" href="bn_8h.html#a72e393df20fc0ec8e761204fe5f28c17">BN_bn2bin</a>(A,cAB+longN), longN);</div>
<div class="line">        <a class="code" href="digest_8c.html#a1886b261d05d3ee8866f5ccf92184552">EVP_DigestUpdate</a>(&amp;ctxt, cAB + <a class="code" href="bn_8h.html#a72e393df20fc0ec8e761204fe5f28c17">BN_bn2bin</a>(B,cAB+longN), longN);</div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(cAB);</div>
<div class="line">        <a class="code" href="digest_8c.html#a3c3bec018dd4bdf73a3f14d27ea9b718">EVP_DigestFinal_ex</a>(&amp;ctxt, cu, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        <a class="code" href="digest_8c.html#ac6c8c38d6c8e3e274c9a974792b8342d">EVP_MD_CTX_cleanup</a>(&amp;ctxt);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(u = <a class="code" href="bn_8h.html#a9ca9a524bd4c4de12ae0947872c5182b">BN_bin2bn</a>(cu, <span class="keyword">sizeof</span>(cu), <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)))</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a8adb5a8606dfd0354a4d93b85e3996ab">BN_is_zero</a>(u))</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>;</div>
<div class="line">        <a class="code" href="bn_8h.html#a2d660f4ff6015d33035484c4e9f09e88">BN_free</a>(u);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aacc340e82bbc8c97f4a13535321db19e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a>* SRP_Calc_x </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__lib_8c_source.html#l00207">207</a> of file <a class="el" href="srp__lib_8c_source.html">srp_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> dig[<a class="code" href="sha_8h.html#a1a715db7b4403fe6c165e49a32f5fe3d">SHA_DIGEST_LENGTH</a>];</div>
<div class="line">        <a class="code" href="structenv__md__ctx__st.html">EVP_MD_CTX</a> ctxt;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *cs;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((s == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) ||</div>
<div class="line">                (user == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) ||</div>
<div class="line">                (<a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((cs = <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(<a class="code" href="bn_8h.html#a6f1f92317e94bcae2e83ae518824c01d">BN_num_bytes</a>(s))) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="digest_8c.html#afe58145aa88a8ee187d858c762c00399">EVP_MD_CTX_init</a>(&amp;ctxt);</div>
<div class="line">        <a class="code" href="digest_8c.html#a039cce8e234ebef1284710b019075ddc">EVP_DigestInit_ex</a>(&amp;ctxt, <a class="code" href="evp_8h.html#aa090d659a494a10525e38d272efb01ae">EVP_sha1</a>(), <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        <a class="code" href="digest_8c.html#a1886b261d05d3ee8866f5ccf92184552">EVP_DigestUpdate</a>(&amp;ctxt, user, strlen(user));</div>
<div class="line">        <a class="code" href="digest_8c.html#a1886b261d05d3ee8866f5ccf92184552">EVP_DigestUpdate</a>(&amp;ctxt, <span class="stringliteral">&quot;:&quot;</span>, 1);</div>
<div class="line">        <a class="code" href="digest_8c.html#a1886b261d05d3ee8866f5ccf92184552">EVP_DigestUpdate</a>(&amp;ctxt, <a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>, strlen(<a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>));</div>
<div class="line">        <a class="code" href="digest_8c.html#a3c3bec018dd4bdf73a3f14d27ea9b718">EVP_DigestFinal_ex</a>(&amp;ctxt, dig, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="digest_8c.html#a039cce8e234ebef1284710b019075ddc">EVP_DigestInit_ex</a>(&amp;ctxt, <a class="code" href="evp_8h.html#aa090d659a494a10525e38d272efb01ae">EVP_sha1</a>(), <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        <a class="code" href="bn_8h.html#a72e393df20fc0ec8e761204fe5f28c17">BN_bn2bin</a>(s,cs);</div>
<div class="line">        <a class="code" href="digest_8c.html#a1886b261d05d3ee8866f5ccf92184552">EVP_DigestUpdate</a>(&amp;ctxt, cs, <a class="code" href="bn_8h.html#a6f1f92317e94bcae2e83ae518824c01d">BN_num_bytes</a>(s));</div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(cs);</div>
<div class="line">        <a class="code" href="digest_8c.html#a1886b261d05d3ee8866f5ccf92184552">EVP_DigestUpdate</a>(&amp;ctxt, dig, <span class="keyword">sizeof</span>(dig));</div>
<div class="line">        <a class="code" href="digest_8c.html#a3c3bec018dd4bdf73a3f14d27ea9b718">EVP_DigestFinal_ex</a>(&amp;ctxt, dig, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        <a class="code" href="digest_8c.html#ac6c8c38d6c8e3e274c9a974792b8342d">EVP_MD_CTX_cleanup</a>(&amp;ctxt);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="bn_8h.html#a9ca9a524bd4c4de12ae0947872c5182b">BN_bin2bn</a>(dig, <span class="keyword">sizeof</span>(dig), <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae2df1ebb823c339d60eb88fc4d351304"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* SRP_check_known_gN_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__lib_8c_source.html#l00331">331</a> of file <a class="el" href="srp__lib_8c_source.html">srp_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">size_t</span> i;</div>
<div class="line">        <span class="keywordflow">if</span> ((g == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) || (N == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="srp__lcl_8h.html#a9250505dbc9cf658954b3ff05dc8f5f9">srp_bn_print</a>(g);</div>
<div class="line">        <a class="code" href="srp__lcl_8h.html#a9250505dbc9cf658954b3ff05dc8f5f9">srp_bn_print</a>(N);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="srp__grps_8h.html#ad71d35afce8c3de3958ab746ff394bb0">KNOWN_GN_NUMBER</a>; i++)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bn_8h.html#ac18ade9dbb4531d8cc3a38d3c970c0e0">BN_cmp</a>(knowngN[i].g, g) == 0 &amp;&amp; <a class="code" href="bn_8h.html#ac18ade9dbb4531d8cc3a38d3c970c0e0">BN_cmp</a>(knowngN[i].N, N) == 0) </div>
<div class="line">                        <span class="keywordflow">return</span> knowngN[i].id;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a63be39479fe30576281ca9157737ce99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* SRP_create_verifier </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>verifier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>g</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__vfy_8c_source.html#l00524">524</a> of file <a class="el" href="srp__vfy_8c_source.html">srp_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        <span class="keywordtype">char</span> * result=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">char</span> *vf;</div>
<div class="line">        <a class="code" href="structbignum__st.html">BIGNUM</a> *N_bn = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, *g_bn = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, *s = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, *v = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> tmp[<a class="code" href="srp__vfy_8c.html#aabf4f709c8199e41cf279c77112345fe">MAX_LEN</a>];</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> tmp2[<a class="code" href="srp__vfy_8c.html#aabf4f709c8199e41cf279c77112345fe">MAX_LEN</a>];</div>
<div class="line">        <span class="keywordtype">char</span> * defgNid = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((user == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)||</div>
<div class="line">                (<a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)||</div>
<div class="line">                (salt == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)||</div>
<div class="line">                (verifier == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="wp__block_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!(len = t_fromb64(tmp, <a class="code" href="wp__block_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>))) <span class="keywordflow">goto</span> err;</div>
<div class="line">                N_bn = <a class="code" href="bn_8h.html#a9ca9a524bd4c4de12ae0947872c5182b">BN_bin2bn</a>(tmp, len, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (!(len = t_fromb64(tmp, g))) <span class="keywordflow">goto</span> err;</div>
<div class="line">                g_bn = <a class="code" href="bn_8h.html#a9ca9a524bd4c4de12ae0947872c5182b">BN_bin2bn</a>(tmp, len, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                defgNid = <span class="stringliteral">&quot;*&quot;</span>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                { </div>
<div class="line">                <a class="code" href="structSRP__gN__st.html">SRP_gN</a> * gN = SRP_get_gN_by_id(g, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) ;</div>
<div class="line">                <span class="keywordflow">if</span> (gN == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                N_bn = gN-&gt;<a class="code" href="structSRP__gN__st.html#a4f8b9c2a5b4d2957f8a2d5702722d0ad">N</a>;</div>
<div class="line">                g_bn = gN-&gt;<a class="code" href="structSRP__gN__st.html#a4527dc1f493a42d33e790a86775ee7d2">g</a>;</div>
<div class="line">                defgNid = gN-&gt;<a class="code" href="structSRP__gN__st.html#a26863009016da8a8a42ee5d50977327a">id</a>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (*salt == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="rand_8h.html#a8a4e911a9be281eb797faa8590637ac3">RAND_pseudo_bytes</a>(tmp2, <a class="code" href="srp__vfy_8c.html#a58cda292383bc0341a0c8b2b1a7a0b12">SRP_RANDOM_SALT_LEN</a>);</div>
<div class="line"></div>
<div class="line">                s = <a class="code" href="bn_8h.html#a9ca9a524bd4c4de12ae0947872c5182b">BN_bin2bn</a>(tmp2, <a class="code" href="srp__vfy_8c.html#a58cda292383bc0341a0c8b2b1a7a0b12">SRP_RANDOM_SALT_LEN</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!(len = t_fromb64(tmp2, *salt)))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                s = <a class="code" href="bn_8h.html#a9ca9a524bd4c4de12ae0947872c5182b">BN_bin2bn</a>(tmp2, len, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!<a class="code" href="srp_8h.html#a56eb2906fc5710e40a1d9a2a329888b7">SRP_create_verifier_BN</a>(user, <a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>, &amp;s, &amp;v, N_bn, g_bn)) <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="bn_8h.html#a72e393df20fc0ec8e761204fe5f28c17">BN_bn2bin</a>(v,tmp);</div>
<div class="line">        <span class="keywordflow">if</span> (((vf = <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(<a class="code" href="bn_8h.html#a6f1f92317e94bcae2e83ae518824c01d">BN_num_bytes</a>(v)*2)) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        t_tob64(vf, tmp, <a class="code" href="bn_8h.html#a6f1f92317e94bcae2e83ae518824c01d">BN_num_bytes</a>(v));</div>
<div class="line"></div>
<div class="line">        *verifier = vf;</div>
<div class="line">        <span class="keywordflow">if</span> (*salt == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordtype">char</span> *tmp_salt;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> ((tmp_salt = <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(<a class="code" href="srp__vfy_8c.html#a58cda292383bc0341a0c8b2b1a7a0b12">SRP_RANDOM_SALT_LEN</a> * 2)) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(vf);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                t_tob64(tmp_salt, tmp2, <a class="code" href="srp__vfy_8c.html#a58cda292383bc0341a0c8b2b1a7a0b12">SRP_RANDOM_SALT_LEN</a>);</div>
<div class="line">                *salt = tmp_salt;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        result=defgNid;</div>
<div class="line"></div>
<div class="line">err:</div>
<div class="line">        <span class="keywordflow">if</span>(<a class="code" href="wp__block_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="bn_8h.html#a2d660f4ff6015d33035484c4e9f09e88">BN_free</a>(N_bn);</div>
<div class="line">                <a class="code" href="bn_8h.html#a2d660f4ff6015d33035484c4e9f09e88">BN_free</a>(g_bn);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a56eb2906fc5710e40a1d9a2a329888b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SRP_create_verifier_BN </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> **&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> **&#160;</td>
          <td class="paramname"><em>verifier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>g</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__vfy_8c_source.html#l00608">608</a> of file <a class="el" href="srp__vfy_8c_source.html">srp_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> result=0;</div>
<div class="line">        <a class="code" href="structbignum__st.html">BIGNUM</a> *<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structbignum__ctx.html">BN_CTX</a> *bn_ctx = <a class="code" href="bn_8h.html#a04a38b774caf5e9bb7dea8b22c6eddc2">BN_CTX_new</a>();</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> tmp2[<a class="code" href="srp__vfy_8c.html#aabf4f709c8199e41cf279c77112345fe">MAX_LEN</a>];</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((user == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)||</div>
<div class="line">                (<a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)||</div>
<div class="line">                (salt == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)||</div>
<div class="line">                (verifier == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)||</div>
<div class="line">                (N == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)||</div>
<div class="line">                (g == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)||</div>
<div class="line">                (bn_ctx == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="srp__lcl_8h.html#a9250505dbc9cf658954b3ff05dc8f5f9">srp_bn_print</a>(N);</div>
<div class="line">        <a class="code" href="srp__lcl_8h.html#a9250505dbc9cf658954b3ff05dc8f5f9">srp_bn_print</a>(g);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (*salt == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="rand_8h.html#a8a4e911a9be281eb797faa8590637ac3">RAND_pseudo_bytes</a>(tmp2, <a class="code" href="srp__vfy_8c.html#a58cda292383bc0341a0c8b2b1a7a0b12">SRP_RANDOM_SALT_LEN</a>);</div>
<div class="line"></div>
<div class="line">                *salt = <a class="code" href="bn_8h.html#a9ca9a524bd4c4de12ae0947872c5182b">BN_bin2bn</a>(tmp2,<a class="code" href="srp__vfy_8c.html#a58cda292383bc0341a0c8b2b1a7a0b12">SRP_RANDOM_SALT_LEN</a>,<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        x = <a class="code" href="srp_8h.html#aacc340e82bbc8c97f4a13535321db19e">SRP_Calc_x</a>(*salt,user,<a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>);</div>
<div class="line"></div>
<div class="line">        *verifier = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>();</div>
<div class="line">        <span class="keywordflow">if</span>(*verifier == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a4624503e0c5a02a37708ecd62734727c">BN_mod_exp</a>(*verifier,g,x,N,bn_ctx))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="bn_8h.html#a56590c5516fe2b5ae9b30fbbb3874c5a">BN_clear_free</a>(*verifier);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="srp__lcl_8h.html#a9250505dbc9cf658954b3ff05dc8f5f9">srp_bn_print</a>(*verifier);</div>
<div class="line"></div>
<div class="line">        result=1;</div>
<div class="line"></div>
<div class="line">err:</div>
<div class="line"></div>
<div class="line">        <a class="code" href="bn_8h.html#a56590c5516fe2b5ae9b30fbbb3874c5a">BN_clear_free</a>(x);</div>
<div class="line">        <a class="code" href="bn_8h.html#a92238db5c582bc055f4aa86a5cddb247">BN_CTX_free</a>(bn_ctx);</div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aee304d9f814810909e7cefebaaece032"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="srp_8h.html#a6966df6d8d2b1ecf31e425b10b329c7d">SRP_gN</a>* SRP_get_default_gN </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__lib_8c_source.html#l00348">348</a> of file <a class="el" href="srp__lib_8c_source.html">srp_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">size_t</span> i;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) </div>
<div class="line">                <span class="keywordflow">return</span> knowngN;</div>
<div class="line">        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="srp__grps_8h.html#ad71d35afce8c3de3958ab746ff394bb0">KNOWN_GN_NUMBER</a>; i++)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (strcmp(knowngN[i].<span class="keywordtype">id</span>, <span class="keywordtype">id</span>)==0)</div>
<div class="line">                        <span class="keywordflow">return</span> knowngN + i;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4df6e977f079690d4fc00bd91ab45b4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SRP_VBASE_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="srp_8h.html#afde841f24ff8351891c31f5390a6fe4e">SRP_VBASE</a> *&#160;</td>
          <td class="paramname"><em>vb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__vfy_8c_source.html#l00271">271</a> of file <a class="el" href="srp__vfy_8c_source.html">srp_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="safestack_8h.html#a8568e2b766bd7f927e83c873a26a1582">sk_SRP_user_pwd_pop_free</a>(vb-&gt;users_pwd,SRP_user_pwd_free);</div>
<div class="line">        <a class="code" href="safestack_8h.html#aa31aa7d1cae9057b8da2d0118a4a243f">sk_SRP_gN_cache_free</a>(vb-&gt;gN_cache);</div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(vb-&gt;<a class="code" href="structSRP__VBASE__st.html#a9f8612fe073f8d7bc07c1177c3069a66">seed_key</a>);</div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(vb);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a661ecdd3df3b1f257e03b83cd066eafe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="srp_8h.html#a06cf6af0b10520e22f47907f57af5832">SRP_user_pwd</a>* SRP_VBASE_get_by_user </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="srp_8h.html#afde841f24ff8351891c31f5390a6fe4e">SRP_VBASE</a> *&#160;</td>
          <td class="paramname"><em>vb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>username</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__vfy_8c_source.html#l00475">475</a> of file <a class="el" href="srp__vfy_8c_source.html">srp_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <a class="code" href="structSRP__user__pwd__st.html">SRP_user_pwd</a> *user;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> digv[<a class="code" href="sha_8h.html#a1a715db7b4403fe6c165e49a32f5fe3d">SHA_DIGEST_LENGTH</a>];</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> digs[<a class="code" href="sha_8h.html#a1a715db7b4403fe6c165e49a32f5fe3d">SHA_DIGEST_LENGTH</a>];</div>
<div class="line">        <a class="code" href="structenv__md__ctx__st.html">EVP_MD_CTX</a> ctxt;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (vb == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="safestack_8h.html#a6228832b83fbe5afd1741c5681b10e77">sk_SRP_user_pwd_num</a>(vb-&gt;users_pwd); i++)</div>
<div class="line">                {</div>
<div class="line">                user = <a class="code" href="safestack_8h.html#a039bd0d11528d820cf42a75953d10a5b">sk_SRP_user_pwd_value</a>(vb-&gt;users_pwd, i);</div>
<div class="line">                <span class="keywordflow">if</span> (strcmp(user-&gt;<a class="code" href="structSRP__user__pwd__st.html#aac2cd2ebc30d6a9834480589fea69085">id</a>,username)==0)</div>
<div class="line">                        <span class="keywordflow">return</span> user;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> ((vb-&gt;<a class="code" href="structSRP__VBASE__st.html#a9f8612fe073f8d7bc07c1177c3069a66">seed_key</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) ||</div>
<div class="line">                (vb-&gt;<a class="code" href="structSRP__VBASE__st.html#ad5245233a409421484ed56f3e6eba454">default_g</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) ||</div>
<div class="line">                (vb-&gt;<a class="code" href="structSRP__VBASE__st.html#a5b98cadde5a5d7c0b32f5ce9596dca87">default_N</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line"><span class="comment">/* if the user is unknown we set parameters as well if we have a seed_key */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((user = SRP_user_pwd_new()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) </div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        SRP_user_pwd_set_gN(user,vb-&gt;<a class="code" href="structSRP__VBASE__st.html#ad5245233a409421484ed56f3e6eba454">default_g</a>,vb-&gt;<a class="code" href="structSRP__VBASE__st.html#a5b98cadde5a5d7c0b32f5ce9596dca87">default_N</a>);</div>
<div class="line">                                </div>
<div class="line">        <span class="keywordflow">if</span> (!SRP_user_pwd_set_ids(user,username,<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                </div>
<div class="line">        <a class="code" href="rand_8h.html#a8a4e911a9be281eb797faa8590637ac3">RAND_pseudo_bytes</a>(digv, <a class="code" href="sha_8h.html#a1a715db7b4403fe6c165e49a32f5fe3d">SHA_DIGEST_LENGTH</a>);</div>
<div class="line">        <a class="code" href="digest_8c.html#afe58145aa88a8ee187d858c762c00399">EVP_MD_CTX_init</a>(&amp;ctxt);</div>
<div class="line">        <a class="code" href="digest_8c.html#a039cce8e234ebef1284710b019075ddc">EVP_DigestInit_ex</a>(&amp;ctxt, <a class="code" href="evp_8h.html#aa090d659a494a10525e38d272efb01ae">EVP_sha1</a>(), <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        <a class="code" href="digest_8c.html#a1886b261d05d3ee8866f5ccf92184552">EVP_DigestUpdate</a>(&amp;ctxt, vb-&gt;<a class="code" href="structSRP__VBASE__st.html#a9f8612fe073f8d7bc07c1177c3069a66">seed_key</a>, strlen(vb-&gt;<a class="code" href="structSRP__VBASE__st.html#a9f8612fe073f8d7bc07c1177c3069a66">seed_key</a>));</div>
<div class="line">        <a class="code" href="digest_8c.html#a1886b261d05d3ee8866f5ccf92184552">EVP_DigestUpdate</a>(&amp;ctxt, username, strlen(username));</div>
<div class="line">        <a class="code" href="digest_8c.html#a3c3bec018dd4bdf73a3f14d27ea9b718">EVP_DigestFinal_ex</a>(&amp;ctxt, digs, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        <a class="code" href="digest_8c.html#ac6c8c38d6c8e3e274c9a974792b8342d">EVP_MD_CTX_cleanup</a>(&amp;ctxt);</div>
<div class="line">        <span class="keywordflow">if</span> (SRP_user_pwd_set_sv_BN(user, <a class="code" href="bn_8h.html#a9ca9a524bd4c4de12ae0947872c5182b">BN_bin2bn</a>(digs,<a class="code" href="sha_8h.html#a1a715db7b4403fe6c165e49a32f5fe3d">SHA_DIGEST_LENGTH</a>,<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>), <a class="code" href="bn_8h.html#a9ca9a524bd4c4de12ae0947872c5182b">BN_bin2bn</a>(digv,<a class="code" href="sha_8h.html#a1a715db7b4403fe6c165e49a32f5fe3d">SHA_DIGEST_LENGTH</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))) </div>
<div class="line">                <span class="keywordflow">return</span> user;</div>
<div class="line"></div>
<div class="line">err:    SRP_user_pwd_free(user);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a225b895f39edcc05f248f3d6b8ed5ed2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SRP_VBASE_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="srp_8h.html#afde841f24ff8351891c31f5390a6fe4e">SRP_VBASE</a> *&#160;</td>
          <td class="paramname"><em>vb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>verifier_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__vfy_8c_source.html#l00360">360</a> of file <a class="el" href="srp__vfy_8c_source.html">srp_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> error_code ;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structSRP__gN__st.html">SRP_gN</a>) *SRP_gN_tab = <a class="code" href="safestack_8h.html#a011a4cd286e8480c823268ca344b2ddd">sk_SRP_gN_new_null</a>();</div>
<div class="line">        <span class="keywordtype">char</span> *last_index = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">char</span> **<a class="code" href="asn1_8h.html#a3b4c67b77785d8fb51a21fe9832d4822">pp</a>;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="structSRP__gN__st.html">SRP_gN</a> *gN = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structSRP__user__pwd__st.html">SRP_user_pwd</a> *user_pwd = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="structtxt__db__st.html">TXT_DB</a> *tmpdb = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> = <a class="code" href="bio_8h.html#a581a4f51e785ab7df2d032d38f589259">BIO_new</a>(<a class="code" href="bio_8h.html#a4091a209afb974a6c415dc754b6ec765">BIO_s_file</a>());</div>
<div class="line"></div>
<div class="line">        error_code = <a class="code" href="srp_8h.html#ae42e777544b5332d61e8043ea222109d">SRP_ERR_OPEN_FILE</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (in == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || <a class="code" href="bio_8h.html#af7bef4c93feac9e3543ae79bd32b7f23">BIO_read_filename</a>(in,verifier_file) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        error_code = <a class="code" href="srp_8h.html#ac638b96edd331d22998e1c7e23ef412d">SRP_ERR_VBASE_INCOMPLETE_FILE</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((tmpdb =<a class="code" href="txt__db_8c.html#a35025118342fc7bf5453032b2ba21b5e">TXT_DB_read</a>(in,<a class="code" href="srp_8h.html#acc01d3ad7269a5bb155a9cd2eb89655e">DB_NUMBER</a>)) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        error_code = <a class="code" href="srp_8h.html#ab72c315974949551e29fa224503dd7a6">SRP_ERR_MEMORY</a>;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (vb-&gt;<a class="code" href="structSRP__VBASE__st.html#a9f8612fe073f8d7bc07c1177c3069a66">seed_key</a>)</div>
<div class="line">                {</div>
<div class="line">                last_index = <a class="code" href="srp_8h.html#aee304d9f814810909e7cefebaaece032">SRP_get_default_gN</a>(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)-&gt;<a class="code" href="structSRP__gN__st.html#a26863009016da8a8a42ee5d50977327a">id</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#ac184ec4ee0b6b673c389c468f4a5e475">sk_OPENSSL_PSTRING_num</a>(tmpdb-&gt;data); i++)</div>
<div class="line">                {</div>
<div class="line">                pp = <a class="code" href="safestack_8h.html#ab1b59a942eb6c8f19fcad9cb47395c6a">sk_OPENSSL_PSTRING_value</a>(tmpdb-&gt;data,i);</div>
<div class="line">                <span class="keywordflow">if</span> (pp[<a class="code" href="srp_8h.html#a3707f8643cbbecd15fe494cb55ff237e">DB_srptype</a>][0] == <a class="code" href="srp_8h.html#a44d7ae5c7e5ef317ae226fab1dc69712">DB_SRP_INDEX</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="comment">/*we add this couple in the internal Stack */</span></div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">if</span> ((gN = (<a class="code" href="structSRP__gN__st.html">SRP_gN</a> *)<a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structSRP__gN__st.html">SRP_gN</a>))) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) </div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">if</span>  (!(gN-&gt;<a class="code" href="structSRP__gN__st.html#a26863009016da8a8a42ee5d50977327a">id</a> = <a class="code" href="buf__str_8c.html#a5fd2e2db1bea821930a6f96f2ec22ed3">BUF_strdup</a>(pp[<a class="code" href="srp_8h.html#a9d34912a71e3fabce20fc5869d2ee163">DB_srpid</a>]))</div>
<div class="line">                        ||  !(gN-&gt;<a class="code" href="structSRP__gN__st.html#a4f8b9c2a5b4d2957f8a2d5702722d0ad">N</a> = SRP_gN_place_bn(vb-&gt;gN_cache,pp[<a class="code" href="srp_8h.html#a89994381b79b08c9c5dccfdd0d0d780d">DB_srpverifier</a>]))</div>
<div class="line">                        ||  !(gN-&gt;<a class="code" href="structSRP__gN__st.html#a4527dc1f493a42d33e790a86775ee7d2">g</a> = SRP_gN_place_bn(vb-&gt;gN_cache,pp[<a class="code" href="srp_8h.html#a622ceaef9f350429c1cabd0cb48589db">DB_srpsalt</a>]))</div>
<div class="line">                        ||  <a class="code" href="safestack_8h.html#a624d239a71f07f73cb5152d247fc93f4">sk_SRP_gN_insert</a>(SRP_gN_tab,gN,0) == 0)</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">                        gN = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">if</span> (vb-&gt;<a class="code" href="structSRP__VBASE__st.html#a9f8612fe073f8d7bc07c1177c3069a66">seed_key</a> != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                                {</div>
<div class="line">                                last_index = pp[<a class="code" href="srp_8h.html#a9d34912a71e3fabce20fc5869d2ee163">DB_srpid</a>];</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pp[<a class="code" href="srp_8h.html#a3707f8643cbbecd15fe494cb55ff237e">DB_srptype</a>][0] == <a class="code" href="srp_8h.html#a821f89d6440bd201a29e01c4db2e1548">DB_SRP_VALID</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="comment">/* it is a user .... */</span></div>
<div class="line">                        <a class="code" href="structSRP__gN__st.html">SRP_gN</a> *lgN;</div>
<div class="line">                        <span class="keywordflow">if</span> ((lgN = SRP_get_gN_by_id(pp[<a class="code" href="srp_8h.html#a4ac6404854e05eb81658de11dfd5a56e">DB_srpgN</a>],SRP_gN_tab))!=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                                {</div>
<div class="line">                                error_code = <a class="code" href="srp_8h.html#ab72c315974949551e29fa224503dd7a6">SRP_ERR_MEMORY</a>;</div>
<div class="line">                                <span class="keywordflow">if</span> ((user_pwd = SRP_user_pwd_new()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) </div>
<div class="line">                                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                                </div>
<div class="line">                                SRP_user_pwd_set_gN(user_pwd,lgN-&gt;<a class="code" href="structSRP__gN__st.html#a4527dc1f493a42d33e790a86775ee7d2">g</a>,lgN-&gt;<a class="code" href="structSRP__gN__st.html#a4f8b9c2a5b4d2957f8a2d5702722d0ad">N</a>);</div>
<div class="line">                                <span class="keywordflow">if</span> (!SRP_user_pwd_set_ids(user_pwd, pp[DB_srpid],pp[<a class="code" href="srp_8h.html#adea7961992e03b2abb1344c2b7c741cb">DB_srpinfo</a>]))</div>
<div class="line">                                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                                </div>
<div class="line">                                error_code = <a class="code" href="srp_8h.html#afd66c2a70f4a7462914cca8789e9ee53">SRP_ERR_VBASE_BN_LIB</a>;</div>
<div class="line">                                <span class="keywordflow">if</span> (!SRP_user_pwd_set_sv(user_pwd, pp[DB_srpsalt],pp[DB_srpverifier]))</div>
<div class="line">                                        <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">                                <span class="keywordflow">if</span> (<a class="code" href="safestack_8h.html#a7f3f54699a5dd508d28d32625cfb796e">sk_SRP_user_pwd_insert</a>(vb-&gt;users_pwd, user_pwd, 0) == 0)</div>
<div class="line">                                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                                user_pwd = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>; <span class="comment">/* abandon responsability */</span></div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (last_index != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="comment">/* this means that we want to simulate a default user */</span></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (((gN = SRP_get_gN_by_id(last_index,SRP_gN_tab))==<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                        {</div>
<div class="line">                        error_code = <a class="code" href="srp_8h.html#afd66c2a70f4a7462914cca8789e9ee53">SRP_ERR_VBASE_BN_LIB</a>;</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                vb-&gt;<a class="code" href="structSRP__VBASE__st.html#ad5245233a409421484ed56f3e6eba454">default_g</a> = gN-&gt;<a class="code" href="structSRP__gN__st.html#a4527dc1f493a42d33e790a86775ee7d2">g</a> ;</div>
<div class="line">                vb-&gt;<a class="code" href="structSRP__VBASE__st.html#a5b98cadde5a5d7c0b32f5ce9596dca87">default_N</a> = gN-&gt;<a class="code" href="structSRP__gN__st.html#a4f8b9c2a5b4d2957f8a2d5702722d0ad">N</a> ;</div>
<div class="line">                gN = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ;</div>
<div class="line">                }</div>
<div class="line">        error_code = <a class="code" href="srp_8h.html#a6be2311ed5b35ba26f9d6631f57c9df6">SRP_NO_ERROR</a>;</div>
<div class="line"></div>
<div class="line"> err:</div>
<div class="line">        <span class="comment">/* there may be still some leaks to fix, if this fails, the application terminates most likely */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (gN != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(gN-&gt;<a class="code" href="structSRP__gN__st.html#a26863009016da8a8a42ee5d50977327a">id</a>);</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(gN);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        SRP_user_pwd_free(user_pwd);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (tmpdb) <a class="code" href="txt__db_8c.html#a3c40829cc4ad54164db561615b9b751a">TXT_DB_free</a>(tmpdb);</div>
<div class="line">        <span class="keywordflow">if</span> (in) <a class="code" href="bio_8h.html#a9cc47fc222c166cd863e1dfb5467a14e">BIO_free_all</a>(in);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="safestack_8h.html#abe358c2afb5249238607558029c76917">sk_SRP_gN_free</a>(SRP_gN_tab);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> error_code;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac9d4de5cd9cdefb490265f72f10d22ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="srp_8h.html#afde841f24ff8351891c31f5390a6fe4e">SRP_VBASE</a>* SRP_VBASE_new </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>seed_key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__vfy_8c_source.html#l00244">244</a> of file <a class="el" href="srp__vfy_8c_source.html">srp_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structSRP__VBASE__st.html">SRP_VBASE</a> *vb = (<a class="code" href="structSRP__VBASE__st.html">SRP_VBASE</a> *) <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structSRP__VBASE__st.html">SRP_VBASE</a>));</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (vb == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (!(vb-&gt;users_pwd = <a class="code" href="safestack_8h.html#a5b77e3ed286abf7ce06a54ef4824e48f">sk_SRP_user_pwd_new_null</a>()) ||</div>
<div class="line">                !(vb-&gt;gN_cache = <a class="code" href="safestack_8h.html#a556fc76e4a5299fa8bb34f8fa20e2e90">sk_SRP_gN_cache_new_null</a>()))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(vb);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        vb-&gt;<a class="code" href="structSRP__VBASE__st.html#ad5245233a409421484ed56f3e6eba454">default_g</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        vb-&gt;<a class="code" href="structSRP__VBASE__st.html#a5b98cadde5a5d7c0b32f5ce9596dca87">default_N</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        vb-&gt;<a class="code" href="structSRP__VBASE__st.html#a9f8612fe073f8d7bc07c1177c3069a66">seed_key</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> ((seed_key != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) &amp;&amp; </div>
<div class="line">                (vb-&gt;<a class="code" href="structSRP__VBASE__st.html#a9f8612fe073f8d7bc07c1177c3069a66">seed_key</a> = <a class="code" href="buf__str_8c.html#a5fd2e2db1bea821930a6f96f2ec22ed3">BUF_strdup</a>(seed_key)) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="safestack_8h.html#a903d4845493d786eaab5576ea6818f75">sk_SRP_user_pwd_free</a>(vb-&gt;users_pwd);</div>
<div class="line">                <a class="code" href="safestack_8h.html#aa31aa7d1cae9057b8da2d0118a4a243f">sk_SRP_gN_cache_free</a>(vb-&gt;gN_cache);</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(vb);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> vb;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac0b02662ec209ff41fd9f111aba33f2c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SRP_Verify_A_mod_N </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__lib_8c_source.html#l00321">321</a> of file <a class="el" href="srp__lib_8c_source.html">srp_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="comment">/* Checks if A % N == 0 */</span></div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="srp_8h.html#a3235f19c44bf7ff4b4a028253a922aa8">SRP_Verify_B_mod_N</a>(A,N) ;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3235f19c44bf7ff4b4a028253a922aa8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SRP_Verify_B_mod_N </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="srp__lib_8c_source.html#l00299">299</a> of file <a class="el" href="srp__lib_8c_source.html">srp_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbignum__st.html">BIGNUM</a> *r;</div>
<div class="line">        <a class="code" href="structbignum__ctx.html">BN_CTX</a> *bn_ctx; </div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (B == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> || N == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> ||</div>
<div class="line">                (bn_ctx = <a class="code" href="bn_8h.html#a04a38b774caf5e9bb7dea8b22c6eddc2">BN_CTX_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((r = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="comment">/* Checks if B % N == 0 */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a762a91b13a7ad118051f34eacac4e104">BN_nnmod</a>(r,B,N,bn_ctx))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        ret = !<a class="code" href="bn_8h.html#a8adb5a8606dfd0354a4d93b85e3996ab">BN_is_zero</a>(r);</div>
<div class="line">err:</div>
<div class="line">        <a class="code" href="bn_8h.html#a92238db5c582bc055f4aa86a5cddb247">BN_CTX_free</a>(bn_ctx);</div>
<div class="line">        <a class="code" href="bn_8h.html#a2d660f4ff6015d33035484c4e9f09e88">BN_free</a>(r);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
