<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/x509v3/v3_purp.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_0218cc2115166b59aa60ecc6cb3a6230.html">x509v3</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">v3_purp.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="cryptlib_8h_source.html">cryptlib.h</a>&quot;</code><br/>
<code>#include &lt;openssl/x509v3.h&gt;</code><br/>
<code>#include &lt;openssl/x509_vfy.h&gt;</code><br/>
</div>
<p><a href="v3__purp_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aac94dc6f32216783177aef605c775596"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#aac94dc6f32216783177aef605c775596">X509_PURPOSE_COUNT</a>&#160;&#160;&#160;(sizeof(xstandard)/sizeof(<a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a>))</td></tr>
<tr class="memitem:a9a344980b59ea8a562eb858ba528d254"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a9a344980b59ea8a562eb858ba528d254">V1_ROOT</a>&#160;&#160;&#160;(<a class="el" href="x509v3_8h.html#a479ec0f0f424ecafad11dc17b46a33c4">EXFLAG_V1</a>|<a class="el" href="x509v3_8h.html#a707671d68f7f76a3551aff93092b8b83">EXFLAG_SS</a>)</td></tr>
<tr class="memitem:a3ddcce65ffeef79b0019efdbffb282ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a3ddcce65ffeef79b0019efdbffb282ea">ku_reject</a>(<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, <a class="el" href="des_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a>)&#160;&#160;&#160;(((<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)-&gt;ex_flags &amp; <a class="el" href="x509v3_8h.html#af75251e163c25c0993d737fae967a32b">EXFLAG_KUSAGE</a>) &amp;&amp; !((<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)-&gt;ex_kusage &amp; (<a class="el" href="des_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a>)))</td></tr>
<tr class="memitem:a4d7cdd40971e1a8cc9cb2f8abd0a9a5e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a4d7cdd40971e1a8cc9cb2f8abd0a9a5e">xku_reject</a>(<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, <a class="el" href="des_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a>)&#160;&#160;&#160;(((<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)-&gt;ex_flags &amp; <a class="el" href="x509v3_8h.html#a32256c07c7ed3304d465a1671622d38d">EXFLAG_XKUSAGE</a>) &amp;&amp; !((<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)-&gt;ex_xkusage &amp; (<a class="el" href="des_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a>)))</td></tr>
<tr class="memitem:a0e05b524302958115f35dc31426b6671"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a0e05b524302958115f35dc31426b6671">ns_reject</a>(<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, <a class="el" href="des_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a>)&#160;&#160;&#160;(((<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)-&gt;ex_flags &amp; <a class="el" href="x509v3_8h.html#ad0dffd252efa528815d15b7745ac88a9">EXFLAG_NSCERT</a>) &amp;&amp; !((<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)-&gt;ex_nscert &amp; (<a class="el" href="des_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a>)))</td></tr>
<tr class="memitem:a8610a8a454809bf3b58066ba28798a97"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a8610a8a454809bf3b58066ba28798a97">KU_TLS</a>&#160;&#160;&#160;<a class="el" href="x509v3_8h.html#a34abc95bf0fa471e18d1dd3b295492f6">KU_DIGITAL_SIGNATURE</a>|<a class="el" href="x509v3_8h.html#a64f1e2e3dd57557fdad2ca9c07f63ec4">KU_KEY_ENCIPHERMENT</a>|<a class="el" href="x509v3_8h.html#a349ec0e59749ed5ca9ac9e030c06049f">KU_KEY_AGREEMENT</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad14cac500b50cb3b5b1392af85d35e0d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#ad14cac500b50cb3b5b1392af85d35e0d">X509_check_purpose</a> (<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, int id, int ca)</td></tr>
<tr class="memitem:aeb186bb6313bd45ab471437ec7e80d6c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#aeb186bb6313bd45ab471437ec7e80d6c">X509_PURPOSE_set</a> (int *p, int purpose)</td></tr>
<tr class="memitem:a4ff8da72d8765cb511d1937044f68243"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a4ff8da72d8765cb511d1937044f68243">X509_PURPOSE_get_count</a> (void)</td></tr>
<tr class="memitem:ac8cca20fd5afb37227f5f263d717bbae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#ac8cca20fd5afb37227f5f263d717bbae">X509_PURPOSE_get0</a> (int idx)</td></tr>
<tr class="memitem:a0e9068bfb1cd7c7b312517fcc75e1b4d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a0e9068bfb1cd7c7b312517fcc75e1b4d">X509_PURPOSE_get_by_sname</a> (char *sname)</td></tr>
<tr class="memitem:ac17b78d33baed177d7d1397a9d44d8a0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#ac17b78d33baed177d7d1397a9d44d8a0">X509_PURPOSE_get_by_id</a> (int purpose)</td></tr>
<tr class="memitem:a0bbd290d2483eb26357121d02f9adb8c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a0bbd290d2483eb26357121d02f9adb8c">X509_PURPOSE_add</a> (int id, int trust, int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>, int(*ck)(const <a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a> *, const <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *, int), char *name, char *sname, void *<a class="el" href="e__rc5_8c.html#ab61d1a51a70b259a10d7e90ff697c353">arg</a>)</td></tr>
<tr class="memitem:a284c600990c5eddd8384d2a42241d898"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a284c600990c5eddd8384d2a42241d898">X509_PURPOSE_cleanup</a> (void)</td></tr>
<tr class="memitem:a8ba60d3214cc7647b200f4e5c414fb45"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a8ba60d3214cc7647b200f4e5c414fb45">X509_PURPOSE_get_id</a> (<a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a> *xp)</td></tr>
<tr class="memitem:a96874895aee61bedc099271783e8b08b"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a96874895aee61bedc099271783e8b08b">X509_PURPOSE_get0_name</a> (<a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a> *xp)</td></tr>
<tr class="memitem:acd4fc69f6efe544b906bfaae201486bc"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#acd4fc69f6efe544b906bfaae201486bc">X509_PURPOSE_get0_sname</a> (<a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a> *xp)</td></tr>
<tr class="memitem:a250389e7760b57d7204c79086f45b0e3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a250389e7760b57d7204c79086f45b0e3">X509_PURPOSE_get_trust</a> (<a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a> *xp)</td></tr>
<tr class="memitem:a7915b639e260201e539a0be155c159ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a7915b639e260201e539a0be155c159ab">DECLARE_OBJ_BSEARCH_CMP_FN</a> (int, int, <a class="el" href="x509_8h.html#a7235ef62e89328f5155846dc59c6fc37">nid</a>)</td></tr>
<tr class="memitem:adf956b4b997d96713a658b1524a64fee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#adf956b4b997d96713a658b1524a64fee">IMPLEMENT_OBJ_BSEARCH_CMP_FN</a> (int, int, <a class="el" href="x509_8h.html#a7235ef62e89328f5155846dc59c6fc37">nid</a>)</td></tr>
<tr class="memitem:a2b5de45f4df66c9567c2fa0bf86c3980"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a2b5de45f4df66c9567c2fa0bf86c3980">X509_supported_extension</a> (<a class="el" href="x509_8h.html#ab2f7f7dc0ced8684e0cbfc818e408304">X509_EXTENSION</a> *<a class="el" href="x509_8h.html#a02ad6cc5d33c413aabdabe742adfe889">ex</a>)</td></tr>
<tr class="memitem:a1a8f7e3761b296eac19f1cde9c25b307"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a1a8f7e3761b296eac19f1cde9c25b307">X509_check_ca</a> (<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)</td></tr>
<tr class="memitem:af7b38936c32bef80f131a5c420e8c832"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#af7b38936c32bef80f131a5c420e8c832">X509_check_issued</a> (<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *issuer, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *subject)</td></tr>
<tr class="memitem:a4990a1d4b87fa94e22c6553651b0c31f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__purp_8c.html#a4990a1d4b87fa94e22c6553651b0c31f">X509_check_akid</a> (<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *issuer, <a class="el" href="ossl__typ_8h.html#a27c88725cd81ecf750f668814507bc8d">AUTHORITY_KEYID</a> *akid)</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="a3ddcce65ffeef79b0019efdbffb282ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ku_reject</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="des_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)-&gt;ex_flags &amp; <a class="el" href="x509v3_8h.html#af75251e163c25c0993d737fae967a32b">EXFLAG_KUSAGE</a>) &amp;&amp; !((<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)-&gt;ex_kusage &amp; (<a class="el" href="des_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a>)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00510">510</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8610a8a454809bf3b58066ba28798a97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KU_TLS&#160;&#160;&#160;<a class="el" href="x509v3_8h.html#a34abc95bf0fa471e18d1dd3b295492f6">KU_DIGITAL_SIGNATURE</a>|<a class="el" href="x509v3_8h.html#a64f1e2e3dd57557fdad2ca9c07f63ec4">KU_KEY_ENCIPHERMENT</a>|<a class="el" href="x509v3_8h.html#a349ec0e59749ed5ca9ac9e030c06049f">KU_KEY_AGREEMENT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00575">575</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0e05b524302958115f35dc31426b6671"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ns_reject</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="des_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)-&gt;ex_flags &amp; <a class="el" href="x509v3_8h.html#ad0dffd252efa528815d15b7745ac88a9">EXFLAG_NSCERT</a>) &amp;&amp; !((<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)-&gt;ex_nscert &amp; (<a class="el" href="des_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a>)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00514">514</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>

</div>
</div>
<a class="anchor" id="a9a344980b59ea8a562eb858ba528d254"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define V1_ROOT&#160;&#160;&#160;(<a class="el" href="x509v3_8h.html#a479ec0f0f424ecafad11dc17b46a33c4">EXFLAG_V1</a>|<a class="el" href="x509v3_8h.html#a707671d68f7f76a3551aff93092b8b83">EXFLAG_SS</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00509">509</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>

</div>
</div>
<a class="anchor" id="aac94dc6f32216783177aef605c775596"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X509_PURPOSE_COUNT&#160;&#160;&#160;(sizeof(xstandard)/sizeof(<a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00094">94</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4d7cdd40971e1a8cc9cb2f8abd0a9a5e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define xku_reject</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="des_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)-&gt;ex_flags &amp; <a class="el" href="x509v3_8h.html#a32256c07c7ed3304d465a1671622d38d">EXFLAG_XKUSAGE</a>) &amp;&amp; !((<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)-&gt;ex_xkusage &amp; (<a class="el" href="des_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a>)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00512">512</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a7915b639e260201e539a0be155c159ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DECLARE_OBJ_BSEARCH_CMP_FN </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509_8h.html#a7235ef62e89328f5155846dc59c6fc37">nid</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="adf956b4b997d96713a658b1524a64fee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IMPLEMENT_OBJ_BSEARCH_CMP_FN </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509_8h.html#a7235ef62e89328f5155846dc59c6fc37">nid</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4990a1d4b87fa94e22c6553651b0c31f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_check_akid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a27c88725cd81ecf750f668814507bc8d">AUTHORITY_KEYID</a> *&#160;</td>
          <td class="paramname"><em>akid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00740">740</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!akid)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="x509__vfy_8h.html#ac0a59adf149eda514d31e7c33881ef3c">X509_V_OK</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Check key ids (if present) */</span></div>
<div class="line">        <span class="keywordflow">if</span>(akid-&gt;<a class="code" href="structAUTHORITY__KEYID__st.html#ad9aea22a1fc62bcf0669f7feba4e38a7">keyid</a> &amp;&amp; issuer-&gt;<a class="code" href="structx509__st.html#a6ebe771c246586c77c91f2deca26b84d">skid</a> &amp;&amp;</div>
<div class="line">                 <a class="code" href="a__octet_8c.html#a9a5442543cd9a35a1bb6c50c21f890c4">ASN1_OCTET_STRING_cmp</a>(akid-&gt;<a class="code" href="structAUTHORITY__KEYID__st.html#ad9aea22a1fc62bcf0669f7feba4e38a7">keyid</a>, issuer-&gt;<a class="code" href="structx509__st.html#a6ebe771c246586c77c91f2deca26b84d">skid</a>) )</div>
<div class="line">                                <span class="keywordflow">return</span> <a class="code" href="x509__vfy_8h.html#a6fc6023209e07f2004072a267c5ddef2">X509_V_ERR_AKID_SKID_MISMATCH</a>;</div>
<div class="line">        <span class="comment">/* Check serial number */</span></div>
<div class="line">        <span class="keywordflow">if</span>(akid-&gt;<a class="code" href="structAUTHORITY__KEYID__st.html#a266ae5a8b48cee3727995cf791bc7d8c">serial</a> &amp;&amp;</div>
<div class="line">                <a class="code" href="a__int_8c.html#aad8c36259e70b4071b2d90ee9e85ebf4">ASN1_INTEGER_cmp</a>(<a class="code" href="x509_8h.html#a667af4dd51a9a8cafefc3f6fb8fc23b8">X509_get_serialNumber</a>(issuer), akid-&gt;<a class="code" href="structAUTHORITY__KEYID__st.html#a266ae5a8b48cee3727995cf791bc7d8c">serial</a>))</div>
<div class="line">                                <span class="keywordflow">return</span> <a class="code" href="x509__vfy_8h.html#a735b8c28dcdf4d04ab397a5720f88ab9">X509_V_ERR_AKID_ISSUER_SERIAL_MISMATCH</a>;</div>
<div class="line">        <span class="comment">/* Check issuer name */</span></div>
<div class="line">        <span class="keywordflow">if</span>(akid-&gt;<a class="code" href="structAUTHORITY__KEYID__st.html#a3a750d3a2a795e1a0dfb98f0e16bf339">issuer</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="comment">/* Ugh, for some peculiar reason AKID includes</span></div>
<div class="line"><span class="comment">                 * SEQUENCE OF GeneralName. So look for a DirName.</span></div>
<div class="line"><span class="comment">                 * There may be more than one but we only take any</span></div>
<div class="line"><span class="comment">                 * notice of the first.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                GENERAL_NAMES *gens;</div>
<div class="line">                <a class="code" href="structGENERAL__NAME__st.html">GENERAL_NAME</a> *<a class="code" href="x509v3_8h.html#abc75d7b679cdd06e349a20f71141c9b8">gen</a>;</div>
<div class="line">                <a class="code" href="structX509__name__st.html">X509_NAME</a> *<a class="code" href="x509__vfy_8h.html#a57a3541601842982e910946c748942ca">nm</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                <span class="keywordtype">int</span> i;</div>
<div class="line">                gens = akid-&gt;<a class="code" href="structAUTHORITY__KEYID__st.html#a3a750d3a2a795e1a0dfb98f0e16bf339">issuer</a>;</div>
<div class="line">                <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="safestack_8h.html#afb127b9d00523dab89a67b088d38b2d9">sk_GENERAL_NAME_num</a>(gens); i++)</div>
<div class="line">                        {</div>
<div class="line">                        gen = <a class="code" href="safestack_8h.html#ac0c41fef2238a18fa5bf28987d42f674">sk_GENERAL_NAME_value</a>(gens, i);</div>
<div class="line">                        <span class="keywordflow">if</span>(gen-&gt;<a class="code" href="structGENERAL__NAME__st.html#adee285a4ad25557f12d51af03e1cf0e2">type</a> == <a class="code" href="x509v3_8h.html#a65008adc3e9547b25215a5983a5bb13a">GEN_DIRNAME</a>)</div>
<div class="line">                                {</div>
<div class="line">                                nm = gen-&gt;<a class="code" href="structGENERAL__NAME__st.html#a8059e88d201d4fa25fc957e775b5afcd">d</a>.<a class="code" href="structGENERAL__NAME__st.html#a95c95a8e1ba3f1e4b86e440735712bc8">dirn</a>;</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span>(nm &amp;&amp; <a class="code" href="x509_8h.html#ab52671f661dab2939d339792e9b30d37">X509_NAME_cmp</a>(nm, <a class="code" href="x509_8h.html#ade3220b850537708545f660ee272d4e4">X509_get_issuer_name</a>(issuer)))</div>
<div class="line">                        <span class="keywordflow">return</span> <a class="code" href="x509__vfy_8h.html#a735b8c28dcdf4d04ab397a5720f88ab9">X509_V_ERR_AKID_ISSUER_SERIAL_MISMATCH</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509__vfy_8h.html#ac0a59adf149eda514d31e7c33881ef3c">X509_V_OK</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1a8f7e3761b296eac19f1cde9c25b307"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_check_ca </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00538">538</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(!(x-&gt;<a class="code" href="structx509__st.html#afc5106add019789df9b25ab6a1ff07ce">ex_flags</a> &amp; <a class="code" href="x509v3_8h.html#a1c28bff24c02c847ab945ebd48c9e155">EXFLAG_SET</a>)) {</div>
<div class="line">                <a class="code" href="crypto_8h.html#ab3735c6a4dd562addce8043981d0ecdf">CRYPTO_w_lock</a>(<a class="code" href="crypto_8h.html#abcd6591ef6acea51bf9f6edb6bb05bca">CRYPTO_LOCK_X509</a>);</div>
<div class="line">                x509v3_cache_extensions(x);</div>
<div class="line">                <a class="code" href="crypto_8h.html#a337cca587e1ea6c81accc78f0373569d">CRYPTO_w_unlock</a>(<a class="code" href="crypto_8h.html#abcd6591ef6acea51bf9f6edb6bb05bca">CRYPTO_LOCK_X509</a>);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> check_ca(x);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af7b38936c32bef80f131a5c420e8c832"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_check_issued </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>subject</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00715">715</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(<a class="code" href="x509_8h.html#ab52671f661dab2939d339792e9b30d37">X509_NAME_cmp</a>(<a class="code" href="x509_8h.html#aff52c219295ce864fb20f88050f9963c">X509_get_subject_name</a>(issuer),</div>
<div class="line">                        <a class="code" href="x509_8h.html#ade3220b850537708545f660ee272d4e4">X509_get_issuer_name</a>(subject)))</div>
<div class="line">                                <span class="keywordflow">return</span> <a class="code" href="x509__vfy_8h.html#a2bf2bf8c53131f3046657f2c85838051">X509_V_ERR_SUBJECT_ISSUER_MISMATCH</a>;</div>
<div class="line">        x509v3_cache_extensions(issuer);</div>
<div class="line">        x509v3_cache_extensions(subject);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(subject-&gt;<a class="code" href="structx509__st.html#a0e11914f6c1933ca2734bea95f06cf78">akid</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordtype">int</span> ret = <a class="code" href="v3__purp_8c.html#a4990a1d4b87fa94e22c6553651b0c31f">X509_check_akid</a>(issuer, subject-&gt;<a class="code" href="structx509__st.html#a0e11914f6c1933ca2734bea95f06cf78">akid</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (ret != <a class="code" href="x509__vfy_8h.html#ac0a59adf149eda514d31e7c33881ef3c">X509_V_OK</a>)</div>
<div class="line">                        <span class="keywordflow">return</span> ret;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(subject-&gt;<a class="code" href="structx509__st.html#afc5106add019789df9b25ab6a1ff07ce">ex_flags</a> &amp; <a class="code" href="x509v3_8h.html#a49a676737ca80ce8495501d45f8abbc8">EXFLAG_PROXY</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span>(<a class="code" href="v3__purp_8c.html#a3ddcce65ffeef79b0019efdbffb282ea">ku_reject</a>(issuer, <a class="code" href="x509v3_8h.html#a34abc95bf0fa471e18d1dd3b295492f6">KU_DIGITAL_SIGNATURE</a>))</div>
<div class="line">                        <span class="keywordflow">return</span> <a class="code" href="x509__vfy_8h.html#a26529ac99abccdbdc65143322711ea89">X509_V_ERR_KEYUSAGE_NO_DIGITAL_SIGNATURE</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="v3__purp_8c.html#a3ddcce65ffeef79b0019efdbffb282ea">ku_reject</a>(issuer, <a class="code" href="x509v3_8h.html#a5da71e896dc465af98e4004ea40eb230">KU_KEY_CERT_SIGN</a>))</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="x509__vfy_8h.html#a948a2c1b1cfd0814ac424a6d8a48515c">X509_V_ERR_KEYUSAGE_NO_CERTSIGN</a>;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509__vfy_8h.html#ac0a59adf149eda514d31e7c33881ef3c">X509_V_OK</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad14cac500b50cb3b5b1392af85d35e0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_check_purpose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ca</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00109">109</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> idx;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structx509__purpose__st.html">X509_PURPOSE</a> *<a class="code" href="md2_8c.html#a97ec5a464b223d4839ad0dd8f9c46fcd">pt</a>;</div>
<div class="line">        <span class="keywordflow">if</span>(!(x-&gt;<a class="code" href="structx509__st.html#afc5106add019789df9b25ab6a1ff07ce">ex_flags</a> &amp; <a class="code" href="x509v3_8h.html#a1c28bff24c02c847ab945ebd48c9e155">EXFLAG_SET</a>)) {</div>
<div class="line">                <a class="code" href="crypto_8h.html#ab3735c6a4dd562addce8043981d0ecdf">CRYPTO_w_lock</a>(<a class="code" href="crypto_8h.html#abcd6591ef6acea51bf9f6edb6bb05bca">CRYPTO_LOCK_X509</a>);</div>
<div class="line">                x509v3_cache_extensions(x);</div>
<div class="line">                <a class="code" href="crypto_8h.html#a337cca587e1ea6c81accc78f0373569d">CRYPTO_w_unlock</a>(<a class="code" href="crypto_8h.html#abcd6591ef6acea51bf9f6edb6bb05bca">CRYPTO_LOCK_X509</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(<span class="keywordtype">id</span> == -1) <span class="keywordflow">return</span> 1;</div>
<div class="line">        idx = <a class="code" href="v3__purp_8c.html#ac17b78d33baed177d7d1397a9d44d8a0">X509_PURPOSE_get_by_id</a>(<span class="keywordtype">id</span>);</div>
<div class="line">        <span class="keywordflow">if</span>(idx == -1) <span class="keywordflow">return</span> -1;</div>
<div class="line">        pt = <a class="code" href="v3__purp_8c.html#ac8cca20fd5afb37227f5f263d717bbae">X509_PURPOSE_get0</a>(idx);</div>
<div class="line">        <span class="keywordflow">return</span> pt-&gt;<a class="code" href="structx509__purpose__st.html#a623ef466f6eb424201d65504686e525a">check_purpose</a>(pt, x, ca);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0bbd290d2483eb26357121d02f9adb8c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_PURPOSE_add </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trust</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(const <a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a> *, const <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *, int)&#160;</td>
          <td class="paramname"><em>ck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00172">172</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> idx;</div>
<div class="line">        <a class="code" href="structx509__purpose__st.html">X509_PURPOSE</a> *ptmp;</div>
<div class="line">        <span class="comment">/* This is set according to what we change: application can&#39;t set it */</span></div>
<div class="line">        <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp;= ~<a class="code" href="x509v3_8h.html#a0bb1392b1de7a7d8641f18a5b069ae9f">X509_PURPOSE_DYNAMIC</a>;</div>
<div class="line">        <span class="comment">/* This will always be set for application modified trust entries */</span></div>
<div class="line">        <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> |= <a class="code" href="x509v3_8h.html#a234c50d7fed2e079060dfaa8613b1a7c">X509_PURPOSE_DYNAMIC_NAME</a>;</div>
<div class="line">        <span class="comment">/* Get existing entry if any */</span></div>
<div class="line">        idx = <a class="code" href="v3__purp_8c.html#ac17b78d33baed177d7d1397a9d44d8a0">X509_PURPOSE_get_by_id</a>(<span class="keywordtype">id</span>);</div>
<div class="line">        <span class="comment">/* Need a new entry */</span></div>
<div class="line">        <span class="keywordflow">if</span>(idx == -1) {</div>
<div class="line">                <span class="keywordflow">if</span>(!(ptmp = <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structx509__purpose__st.html">X509_PURPOSE</a>)))) {</div>
<div class="line">                        <a class="code" href="err_8h.html#aefffbc35d6ed0929dfb3864cdba5e11d">X509V3err</a>(<a class="code" href="x509v3_8h.html#add963452acb0c87832711a00984655ea">X509V3_F_X509_PURPOSE_ADD</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">                ptmp-&gt;<a class="code" href="structx509__purpose__st.html#ad058e4594818ca6291ac4a69586c302b">flags</a> = <a class="code" href="x509v3_8h.html#a0bb1392b1de7a7d8641f18a5b069ae9f">X509_PURPOSE_DYNAMIC</a>;</div>
<div class="line">        } <span class="keywordflow">else</span> ptmp = <a class="code" href="v3__purp_8c.html#ac8cca20fd5afb37227f5f263d717bbae">X509_PURPOSE_get0</a>(idx);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* OPENSSL_free existing name if dynamic */</span></div>
<div class="line">        <span class="keywordflow">if</span>(ptmp-&gt;<a class="code" href="structx509__purpose__st.html#ad058e4594818ca6291ac4a69586c302b">flags</a> &amp; <a class="code" href="x509v3_8h.html#a234c50d7fed2e079060dfaa8613b1a7c">X509_PURPOSE_DYNAMIC_NAME</a>) {</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(ptmp-&gt;<a class="code" href="structx509__purpose__st.html#a736be2bbe6bd7c8def80d9c42efb918f">name</a>);</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(ptmp-&gt;<a class="code" href="structx509__purpose__st.html#ada906ff4bac6b5b675a7e325e7424bc5">sname</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* dup supplied name */</span></div>
<div class="line">        ptmp-&gt;<a class="code" href="structx509__purpose__st.html#a736be2bbe6bd7c8def80d9c42efb918f">name</a> = <a class="code" href="buf__str_8c.html#a5fd2e2db1bea821930a6f96f2ec22ed3">BUF_strdup</a>(name);</div>
<div class="line">        ptmp-&gt;<a class="code" href="structx509__purpose__st.html#ada906ff4bac6b5b675a7e325e7424bc5">sname</a> = <a class="code" href="buf__str_8c.html#a5fd2e2db1bea821930a6f96f2ec22ed3">BUF_strdup</a>(sname);</div>
<div class="line">        <span class="keywordflow">if</span>(!ptmp-&gt;<a class="code" href="structx509__purpose__st.html#a736be2bbe6bd7c8def80d9c42efb918f">name</a> || !ptmp-&gt;<a class="code" href="structx509__purpose__st.html#ada906ff4bac6b5b675a7e325e7424bc5">sname</a>) {</div>
<div class="line">                <a class="code" href="err_8h.html#aefffbc35d6ed0929dfb3864cdba5e11d">X509V3err</a>(<a class="code" href="x509v3_8h.html#add963452acb0c87832711a00984655ea">X509V3_F_X509_PURPOSE_ADD</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* Keep the dynamic flag of existing entry */</span></div>
<div class="line">        ptmp-&gt;<a class="code" href="structx509__purpose__st.html#ad058e4594818ca6291ac4a69586c302b">flags</a> &amp;= <a class="code" href="x509v3_8h.html#a0bb1392b1de7a7d8641f18a5b069ae9f">X509_PURPOSE_DYNAMIC</a>;</div>
<div class="line">        <span class="comment">/* Set all other flags */</span></div>
<div class="line">        ptmp-&gt;<a class="code" href="structx509__purpose__st.html#ad058e4594818ca6291ac4a69586c302b">flags</a> |= <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>;</div>
<div class="line"></div>
<div class="line">        ptmp-&gt;<a class="code" href="structx509__purpose__st.html#ad1f43f5b4f7cd5114e7c987b5d485a42">purpose</a> = id;</div>
<div class="line">        ptmp-&gt;<a class="code" href="structx509__purpose__st.html#a2033355e7111f867d6727e2da3e92716">trust</a> = trust;</div>
<div class="line">        ptmp-&gt;<a class="code" href="structx509__purpose__st.html#a623ef466f6eb424201d65504686e525a">check_purpose</a> = ck;</div>
<div class="line">        ptmp-&gt;<a class="code" href="structx509__purpose__st.html#a50555ed3f80ed1a0bfed457c7649c600">usr_data</a> = <a class="code" href="e__aes_8c.html#a1e84538c461c4c72654eb01a281dfd68">arg</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* If its a new entry manage the dynamic table */</span></div>
<div class="line">        <span class="keywordflow">if</span>(idx == -1) {</div>
<div class="line">                <span class="keywordflow">if</span>(!xptable &amp;&amp; !(xptable = <a class="code" href="safestack_8h.html#aff64824fbc82cf3da37102d73e0be5d8">sk_X509_PURPOSE_new</a>(xp_cmp))) {</div>
<div class="line">                        <a class="code" href="err_8h.html#aefffbc35d6ed0929dfb3864cdba5e11d">X509V3err</a>(<a class="code" href="x509v3_8h.html#add963452acb0c87832711a00984655ea">X509V3_F_X509_PURPOSE_ADD</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#a20cb66114e7b08ed51cd6974b5a8e34c">sk_X509_PURPOSE_push</a>(xptable, ptmp)) {</div>
<div class="line">                        <a class="code" href="err_8h.html#aefffbc35d6ed0929dfb3864cdba5e11d">X509V3err</a>(<a class="code" href="x509v3_8h.html#add963452acb0c87832711a00984655ea">X509V3_F_X509_PURPOSE_ADD</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a284c600990c5eddd8384d2a42241d898"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509_PURPOSE_cleanup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00242">242</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line">        <a class="code" href="safestack_8h.html#a0731ade749e0604522981bb0217ac017">sk_X509_PURPOSE_pop_free</a>(xptable, xptable_free);</div>
<div class="line">        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="v3__purp_8c.html#aac94dc6f32216783177aef605c775596">X509_PURPOSE_COUNT</a>; i++) xptable_free(xstandard + i);</div>
<div class="line">        xptable = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac8cca20fd5afb37227f5f263d717bbae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a>* X509_PURPOSE_get0 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00141">141</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(idx &lt; 0) <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span>(idx &lt; (<span class="keywordtype">int</span>)<a class="code" href="v3__purp_8c.html#aac94dc6f32216783177aef605c775596">X509_PURPOSE_COUNT</a>) <span class="keywordflow">return</span> xstandard + idx;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="safestack_8h.html#a8ab40dd4a2ab6780fe4d0e56fb966eae">sk_X509_PURPOSE_value</a>(xptable, idx - X509_PURPOSE_COUNT);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a96874895aee61bedc099271783e8b08b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* X509_PURPOSE_get0_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a> *&#160;</td>
          <td class="paramname"><em>xp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00255">255</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> xp-&gt;<a class="code" href="structx509__purpose__st.html#a736be2bbe6bd7c8def80d9c42efb918f">name</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acd4fc69f6efe544b906bfaae201486bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* X509_PURPOSE_get0_sname </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a> *&#160;</td>
          <td class="paramname"><em>xp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00260">260</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> xp-&gt;<a class="code" href="structx509__purpose__st.html#ada906ff4bac6b5b675a7e325e7424bc5">sname</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac17b78d33baed177d7d1397a9d44d8a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_PURPOSE_get_by_id </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>purpose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00159">159</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <a class="code" href="structx509__purpose__st.html">X509_PURPOSE</a> tmp;</div>
<div class="line">        <span class="keywordtype">int</span> idx;</div>
<div class="line">        <span class="keywordflow">if</span>((purpose &gt;= <a class="code" href="x509v3_8h.html#a8eb36c57300b2fdc5ec5af6166599390">X509_PURPOSE_MIN</a>) &amp;&amp; (purpose &lt;= <a class="code" href="x509v3_8h.html#af91d504eeb3b33515df1c4c1a312fc7d">X509_PURPOSE_MAX</a>))</div>
<div class="line">                <span class="keywordflow">return</span> purpose - <a class="code" href="x509v3_8h.html#a8eb36c57300b2fdc5ec5af6166599390">X509_PURPOSE_MIN</a>;</div>
<div class="line">        tmp.<a class="code" href="structx509__purpose__st.html#ad1f43f5b4f7cd5114e7c987b5d485a42">purpose</a> = purpose;</div>
<div class="line">        <span class="keywordflow">if</span>(!xptable) <span class="keywordflow">return</span> -1;</div>
<div class="line">        idx = <a class="code" href="safestack_8h.html#a09f97b17d6c3e0dd85bdbee2fb40556a">sk_X509_PURPOSE_find</a>(xptable, &amp;tmp);</div>
<div class="line">        <span class="keywordflow">if</span>(idx == -1) <span class="keywordflow">return</span> -1;</div>
<div class="line">        <span class="keywordflow">return</span> idx + <a class="code" href="v3__purp_8c.html#aac94dc6f32216783177aef605c775596">X509_PURPOSE_COUNT</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0e9068bfb1cd7c7b312517fcc75e1b4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_PURPOSE_get_by_sname </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00148">148</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <a class="code" href="structx509__purpose__st.html">X509_PURPOSE</a> *xptmp;</div>
<div class="line">        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="v3__purp_8c.html#a4ff8da72d8765cb511d1937044f68243">X509_PURPOSE_get_count</a>(); i++) {</div>
<div class="line">                xptmp = <a class="code" href="v3__purp_8c.html#ac8cca20fd5afb37227f5f263d717bbae">X509_PURPOSE_get0</a>(i);</div>
<div class="line">                <span class="keywordflow">if</span>(!strcmp(xptmp-&gt;<a class="code" href="structx509__purpose__st.html#ada906ff4bac6b5b675a7e325e7424bc5">sname</a>, sname)) <span class="keywordflow">return</span> i;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4ff8da72d8765cb511d1937044f68243"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_PURPOSE_get_count </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00135">135</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(!xptable) <span class="keywordflow">return</span> <a class="code" href="v3__purp_8c.html#aac94dc6f32216783177aef605c775596">X509_PURPOSE_COUNT</a>;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="safestack_8h.html#af75745c348d25bbeeb02d8fa471f582d">sk_X509_PURPOSE_num</a>(xptable) + <a class="code" href="v3__purp_8c.html#aac94dc6f32216783177aef605c775596">X509_PURPOSE_COUNT</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8ba60d3214cc7647b200f4e5c414fb45"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_PURPOSE_get_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a> *&#160;</td>
          <td class="paramname"><em>xp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00250">250</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> xp-&gt;<a class="code" href="structx509__purpose__st.html#ad1f43f5b4f7cd5114e7c987b5d485a42">purpose</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a250389e7760b57d7204c79086f45b0e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_PURPOSE_get_trust </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a6bb858b5d3792bcc5165d91e34f9e7a6">X509_PURPOSE</a> *&#160;</td>
          <td class="paramname"><em>xp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00265">265</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> xp-&gt;<a class="code" href="structx509__purpose__st.html#a2033355e7111f867d6727e2da3e92716">trust</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeb186bb6313bd45ab471437ec7e80d6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_PURPOSE_set </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>purpose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00125">125</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">if</span>(<a class="code" href="v3__purp_8c.html#ac17b78d33baed177d7d1397a9d44d8a0">X509_PURPOSE_get_by_id</a>(purpose) == -1) {</div>
<div class="line">                <a class="code" href="err_8h.html#aefffbc35d6ed0929dfb3864cdba5e11d">X509V3err</a>(<a class="code" href="x509v3_8h.html#ae65898fb8a4dd2ea51679965c7355008">X509V3_F_X509_PURPOSE_SET</a>, <a class="code" href="x509v3_8h.html#afe8f7758f59c7c665a09430cb5ca8bb3">X509V3_R_INVALID_PURPOSE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line">        *p = purpose;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2b5de45f4df66c9567c2fa0bf86c3980"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_supported_extension </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="x509_8h.html#ab2f7f7dc0ced8684e0cbfc818e408304">X509_EXTENSION</a> *&#160;</td>
          <td class="paramname"><em>ex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__purp_8c_source.html#l00278">278</a> of file <a class="el" href="v3__purp_8c_source.html">v3_purp.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="comment">/* This table is a list of the NIDs of supported extensions:</span></div>
<div class="line"><span class="comment">         * that is those which are used by the verify process. If</span></div>
<div class="line"><span class="comment">         * an extension is critical and doesn&#39;t appear in this list</span></div>
<div class="line"><span class="comment">         * then the verify process will normally reject the certificate.</span></div>
<div class="line"><span class="comment">         * The list must be kept in numerical order because it will be</span></div>
<div class="line"><span class="comment">         * searched using bsearch.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line"></div>
<div class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> supported_nids[] = {</div>
<div class="line">                <a class="code" href="obj__mac_8h.html#aa88d5cee0b09595222d754aca1f30a2e">NID_netscape_cert_type</a>, <span class="comment">/* 71 */</span></div>
<div class="line">                <a class="code" href="obj__mac_8h.html#ada874900ac79948bc468d7a9fc156afc">NID_key_usage</a>,          <span class="comment">/* 83 */</span></div>
<div class="line">                <a class="code" href="obj__mac_8h.html#ac6914a93d8d5bf2d2e9534b2727a9dc0">NID_subject_alt_name</a>,   <span class="comment">/* 85 */</span></div>
<div class="line">                <a class="code" href="obj__mac_8h.html#a64640b767f5626bb29ccacd8475a3630">NID_basic_constraints</a>,  <span class="comment">/* 87 */</span></div>
<div class="line">                <a class="code" href="obj__mac_8h.html#a693bec9319fd5bbedcf3644152af1532">NID_certificate_policies</a>, <span class="comment">/* 89 */</span></div>
<div class="line">                <a class="code" href="obj__mac_8h.html#a0f20e16656652e9a411755abead3d0c4">NID_ext_key_usage</a>,      <span class="comment">/* 126 */</span></div>
<div class="line"><span class="preprocessor">#ifndef OPENSSL_NO_RFC3779</span></div>
<div class="line"><span class="preprocessor"></span>                <a class="code" href="obj__mac_8h.html#a29c67de37780365e34ae70de46b9199b">NID_sbgp_ipAddrBlock</a>,   <span class="comment">/* 290 */</span></div>
<div class="line">                <a class="code" href="obj__mac_8h.html#a41f1b3fc2c01b4998a0426330570466f">NID_sbgp_autonomousSysNum</a>, <span class="comment">/* 291 */</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                <a class="code" href="obj__mac_8h.html#ad0cf5434917b9941497aa0fb5ca08fea">NID_policy_constraints</a>, <span class="comment">/* 401 */</span></div>
<div class="line">                <a class="code" href="obj__mac_8h.html#ad6e685c41e4586b05c685efb4bbc3379">NID_proxyCertInfo</a>,      <span class="comment">/* 663 */</span></div>
<div class="line">                <a class="code" href="obj__mac_8h.html#a575eeed3f40abb51a35b7f950e998e78">NID_name_constraints</a>,   <span class="comment">/* 666 */</span></div>
<div class="line">                <a class="code" href="obj__mac_8h.html#aeae833eb43104d5aae25e9b5fdbb11d9">NID_policy_mappings</a>,    <span class="comment">/* 747 */</span></div>
<div class="line">                <a class="code" href="obj__mac_8h.html#aff71b6e007dcf9c9645f633aa76ce473">NID_inhibit_any_policy</a>  <span class="comment">/* 748 */</span></div>
<div class="line">        };</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> ex_nid = <a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(<a class="code" href="x509_8h.html#a55c2c7fdc9dd534a910595647b57ae97">X509_EXTENSION_get_object</a>(ex));</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ex_nid == <a class="code" href="obj__mac_8h.html#ad115d9b07ddf7f48ea5feb47299a8894">NID_undef</a>) </div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (OBJ_bsearch_nid(&amp;ex_nid, supported_nids,</div>
<div class="line">                        <span class="keyword">sizeof</span>(supported_nids)/<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)))</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 15 2014 18:16:54 for openssl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
