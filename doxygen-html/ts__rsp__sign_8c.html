<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/ts/ts_rsp_sign.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_fd67f02936ce579040fbe8641e0b0a68.html">ts</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ts_rsp_sign.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="cryptlib_8h_source.html">cryptlib.h</a>&quot;</code><br/>
<code>#include &lt;openssl/objects.h&gt;</code><br/>
<code>#include &lt;openssl/ts.h&gt;</code><br/>
<code>#include &lt;openssl/pkcs7.h&gt;</code><br/>
</div>
<p><a href="ts__rsp__sign_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aef20eb02b3dbd48988e9e212e886100c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#aef20eb02b3dbd48988e9e212e886100c">TS_RESP_CTX_accuracy_free</a>(ctx)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab52f2ea35878250a2c831ebcaa060cca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#ab52f2ea35878250a2c831ebcaa060cca">TS_RESP_CTX_new</a> ()</td></tr>
<tr class="memitem:a6665c2698906c4b82527849fd55de3e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#a6665c2698906c4b82527849fd55de3e4">TS_RESP_CTX_free</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:ace501ad5abb317c322e23e4c9f574246"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#ace501ad5abb317c322e23e4c9f574246">TS_RESP_CTX_set_signer_cert</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *signer)</td></tr>
<tr class="memitem:a2ad1034e40e7e9f33ca3422049237d83"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#a2ad1034e40e7e9f33ca3422049237d83">TS_RESP_CTX_set_signer_key</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>)</td></tr>
<tr class="memitem:a0fb724460ef8d661df8d41c9bcad2385"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#a0fb724460ef8d661df8d41c9bcad2385">TS_RESP_CTX_set_def_policy</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *def_policy)</td></tr>
<tr class="memitem:a3e01ecfe8435b0654749564045f47342"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#a3e01ecfe8435b0654749564045f47342">TS_RESP_CTX_set_certs</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, <a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*certs)</td></tr>
<tr class="memitem:aaf6372a9c955aedaf7e649a3e14aa0be"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#aaf6372a9c955aedaf7e649a3e14aa0be">TS_RESP_CTX_add_policy</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *policy)</td></tr>
<tr class="memitem:ac0a7ae67cc7d2c8333afff3f6f757ae5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#ac0a7ae67cc7d2c8333afff3f6f757ae5">TS_RESP_CTX_add_md</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, const <a class="el" href="ossl__typ_8h.html#aac66cf010326fa9a927c2a34888f45d3">EVP_MD</a> *md)</td></tr>
<tr class="memitem:a2f5b70ae938997c9f5a53b04f86c9599"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#a2f5b70ae938997c9f5a53b04f86c9599">TS_RESP_CTX_set_accuracy</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, int secs, int millis, int micros)</td></tr>
<tr class="memitem:a2db66d706b3d2cd1bccbc68dea14d80d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#a2db66d706b3d2cd1bccbc68dea14d80d">TS_RESP_CTX_add_flags</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:ad9f51f2ec16a9e93f91e9d5f41096541"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#ad9f51f2ec16a9e93f91e9d5f41096541">TS_RESP_CTX_set_serial_cb</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, <a class="el" href="ts_8h.html#a41bf93f9cc2b01382c134b2d786581d3">TS_serial_cb</a> <a class="el" href="dsagen_8c.html#aaf444bf60bdcdbb61c2afe741f506693">cb</a>, void *<a class="el" href="ec__curve_8c.html#af1780c54f65adaed36d43e53ad9afe51">data</a>)</td></tr>
<tr class="memitem:adcd87b76fa7f4416a0e6dfd26cbd91a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#adcd87b76fa7f4416a0e6dfd26cbd91a4">TS_RESP_CTX_set_time_cb</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, <a class="el" href="ts_8h.html#a017d5e0043bd581d9e81277b1a614839">TS_time_cb</a> <a class="el" href="dsagen_8c.html#aaf444bf60bdcdbb61c2afe741f506693">cb</a>, void *<a class="el" href="ec__curve_8c.html#af1780c54f65adaed36d43e53ad9afe51">data</a>)</td></tr>
<tr class="memitem:af6d550399778c2c57ea8c06152cdeddb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#af6d550399778c2c57ea8c06152cdeddb">TS_RESP_CTX_set_extension_cb</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, <a class="el" href="ts_8h.html#a7a67bb257bf3477fee7c3821cfb6c601">TS_extension_cb</a> <a class="el" href="dsagen_8c.html#aaf444bf60bdcdbb61c2afe741f506693">cb</a>, void *<a class="el" href="ec__curve_8c.html#af1780c54f65adaed36d43e53ad9afe51">data</a>)</td></tr>
<tr class="memitem:a084e706585ae4e9365b73f2c1385652f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#a084e706585ae4e9365b73f2c1385652f">TS_RESP_CTX_set_status_info</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, int status, const char *<a class="el" href="ts__rsp__verify_8c.html#a16343090e80c4472521560f30113d96c">text</a>)</td></tr>
<tr class="memitem:a87c1fbd8ae9a596fc5f87f9d12163c16"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#a87c1fbd8ae9a596fc5f87f9d12163c16">TS_RESP_CTX_set_status_info_cond</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, int status, const char *<a class="el" href="ts__rsp__verify_8c.html#a16343090e80c4472521560f30113d96c">text</a>)</td></tr>
<tr class="memitem:ae56a0a613390aea28ca8191562349136"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#ae56a0a613390aea28ca8191562349136">TS_RESP_CTX_add_failure_info</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, int failure)</td></tr>
<tr class="memitem:a3fbeb412685444df0214c60fd51d837b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ts_8h.html#a93f3c31ac980708aac81963bc9a63b10">TS_REQ</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#a3fbeb412685444df0214c60fd51d837b">TS_RESP_CTX_get_request</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:a9de1210d8e7bd7fb3a6d016135dc8ece"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ts_8h.html#a7de94faeeabec73a2241426a20ffa24f">TS_TST_INFO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#a9de1210d8e7bd7fb3a6d016135dc8ece">TS_RESP_CTX_get_tst_info</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:a947740382a46eaa47c395e239b9b4daf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#a947740382a46eaa47c395e239b9b4daf">TS_RESP_CTX_set_clock_precision_digits</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, unsigned precision)</td></tr>
<tr class="memitem:ad302ecf811964d57bad7c85a2d578cf9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ts_8h.html#ad313282099f4f12b4ff632cdaff7d1a7">TS_RESP</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__rsp__sign_8c.html#ad302ecf811964d57bad7c85a2d578cf9">TS_RESP_create_response</a> (<a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *req_bio)</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="aef20eb02b3dbd48988e9e212e886100c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TS_RESP_CTX_accuracy_free</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ctx</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">ASN1_INTEGER_free(ctx-&gt;seconds);        \</div>
<div class="line">        ctx-&gt;seconds = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;                    \</div>
<div class="line">        ASN1_INTEGER_free(ctx-&gt;millis);         \</div>
<div class="line">        ctx-&gt;millis = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;                     \</div>
<div class="line">        ASN1_INTEGER_free(ctx-&gt;micros);         \</div>
<div class="line">        ctx-&gt;micros = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00283">283</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="ad302ecf811964d57bad7c85a2d578cf9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ts_8h.html#ad313282099f4f12b4ff632cdaff7d1a7">TS_RESP</a>* TS_RESP_create_response </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>req_bio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00412">412</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *policy;</div>
<div class="line">        <a class="code" href="structTS__resp__st.html">TS_RESP</a> *response;</div>
<div class="line">        <span class="keywordtype">int</span> result = 0;</div>
<div class="line"></div>
<div class="line">        TS_RESP_CTX_init(ctx);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Creating the response object. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aff6fbaf908c062da548fb3e319d5ac68">response</a> = <a class="code" href="ts_8h.html#a8b0d281151b4efba7b7fd4d0a2427bf9">TS_RESP_new</a>())) </div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#af53063c1a302a5acd2050c9f16dc598c">TSerr</a>(<a class="code" href="ts_8h.html#ac2b5c84ff8a775677cbccacf4bc7dd1d">TS_F_TS_RESP_CREATE_RESPONSE</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> end;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Parsing DER request. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a9c66652878d500b08d3c36e258a4d974">request</a> = <a class="code" href="ts_8h.html#a1778e91e5212162d560722e654bd3b5c">d2i_TS_REQ_bio</a>(req_bio, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="ts_8h.html#a084e706585ae4e9365b73f2c1385652f">TS_RESP_CTX_set_status_info</a>(ctx, <a class="code" href="ts_8h.html#a46e43bef12bf575baf8a4424e1d0bdb5">TS_STATUS_REJECTION</a>,</div>
<div class="line">                                            <span class="stringliteral">&quot;Bad request format or &quot;</span></div>
<div class="line">                                            <span class="stringliteral">&quot;system error.&quot;</span>);</div>
<div class="line">                <a class="code" href="ts_8h.html#ae56a0a613390aea28ca8191562349136">TS_RESP_CTX_add_failure_info</a>(ctx, <a class="code" href="ts_8h.html#a0b9c20cbfa06722dc83721a3fe74b080">TS_INFO_BAD_DATA_FORMAT</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> end;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Setting default status info. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="ts_8h.html#a084e706585ae4e9365b73f2c1385652f">TS_RESP_CTX_set_status_info</a>(ctx, <a class="code" href="ts_8h.html#a1eaf64998799f4bd9e94071712c86ef5">TS_STATUS_GRANTED</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                <span class="keywordflow">goto</span> end;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Checking the request format. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!TS_RESP_check_request(ctx)) <span class="keywordflow">goto</span> end;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Checking acceptable policies. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!(policy = TS_RESP_get_policy(ctx))) <span class="keywordflow">goto</span> end;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Creating the TS_TST_INFO object. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a314c23ef39b07c6119b982b9677c844e">tst_info</a> = TS_RESP_create_tst_info(ctx, policy)))</div>
<div class="line">                <span class="keywordflow">goto</span> end;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Processing extensions. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!TS_RESP_process_extensions(ctx)) <span class="keywordflow">goto</span> end;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Generating the signature. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!TS_RESP_sign(ctx)) <span class="keywordflow">goto</span> end;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Everything was successful. */</span></div>
<div class="line">        result = 1;</div>
<div class="line"> end:</div>
<div class="line">        <span class="keywordflow">if</span> (!result)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#af53063c1a302a5acd2050c9f16dc598c">TSerr</a>(<a class="code" href="ts_8h.html#ac2b5c84ff8a775677cbccacf4bc7dd1d">TS_F_TS_RESP_CREATE_RESPONSE</a>, <a class="code" href="ts_8h.html#a570606011bf248122d047cf6f5ebd6c3">TS_R_RESPONSE_SETUP_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aff6fbaf908c062da548fb3e319d5ac68">response</a> != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="ts_8h.html#a87c1fbd8ae9a596fc5f87f9d12163c16">TS_RESP_CTX_set_status_info_cond</a>(ctx,</div>
<div class="line">                                <a class="code" href="ts_8h.html#a46e43bef12bf575baf8a4424e1d0bdb5">TS_STATUS_REJECTION</a>, <span class="stringliteral">&quot;Error during response &quot;</span></div>
<div class="line">                                <span class="stringliteral">&quot;generation.&quot;</span>) == 0)</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="ts_8h.html#ae77eefe6c5beb7d585c367736e71c1da">TS_RESP_free</a>(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aff6fbaf908c062da548fb3e319d5ac68">response</a>);</div>
<div class="line">                                ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aff6fbaf908c062da548fb3e319d5ac68">response</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        response = ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aff6fbaf908c062da548fb3e319d5ac68">response</a>;</div>
<div class="line">        ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aff6fbaf908c062da548fb3e319d5ac68">response</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;   <span class="comment">/* Ownership will be returned to caller. */</span></div>
<div class="line">        TS_RESP_CTX_cleanup(ctx);</div>
<div class="line">        <span class="keywordflow">return</span> response;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae56a0a613390aea28ca8191562349136"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_RESP_CTX_add_failure_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>failure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00380">380</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structTS__status__info__st.html">TS_STATUS_INFO</a> *si = <a class="code" href="ts_8h.html#a331539ea4d6ca4272421e0c04f8bffc9">TS_RESP_get_status_info</a>(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aff6fbaf908c062da548fb3e319d5ac68">response</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!si-&gt;<a class="code" href="structTS__status__info__st.html#a20343fe14840039fb382b1b08da0104d">failure_info</a> &amp;&amp; !(si-&gt;<a class="code" href="structTS__status__info__st.html#a20343fe14840039fb382b1b08da0104d">failure_info</a> = ASN1_BIT_STRING_new()))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="a__bitstr_8c.html#afd6fae4211f32f8cafe3d3c1ea0c09e3">ASN1_BIT_STRING_set_bit</a>(si-&gt;<a class="code" href="structTS__status__info__st.html#a20343fe14840039fb382b1b08da0104d">failure_info</a>, failure, 1))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"> err:</div>
<div class="line">        <a class="code" href="err_8h.html#af53063c1a302a5acd2050c9f16dc598c">TSerr</a>(<a class="code" href="ts_8h.html#a8a700a32f4ab2e4be1dbf45789ef81cb">TS_F_TS_RESP_CTX_ADD_FAILURE_INFO</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2db66d706b3d2cd1bccbc68dea14d80d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TS_RESP_CTX_add_flags </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00313">313</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a3c83f3eb3b737b2c62818fcfd76db5c1">flags</a> |= <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac0a7ae67cc7d2c8333afff3f6f757ae5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_RESP_CTX_add_md </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#aac66cf010326fa9a927c2a34888f45d3">EVP_MD</a> *&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00269">269</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="comment">/* Create new md stack if necessary. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!ctx-&gt;mds &amp;&amp; !(ctx-&gt;mds = <a class="code" href="safestack_8h.html#a4b69b283b5fab6cd47acde502c6923a8">sk_EVP_MD_new_null</a>())) </div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="comment">/* Add the shared md, no copy needed. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#a556471ecb206f06e22935d364b12d71b">sk_EVP_MD_push</a>(ctx-&gt;mds, (<a class="code" href="structenv__md__st.html">EVP_MD</a> *)md)) <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"> err:</div>
<div class="line">        <a class="code" href="err_8h.html#af53063c1a302a5acd2050c9f16dc598c">TSerr</a>(<a class="code" href="ts_8h.html#af920509fc64239d7acbcc73d08c946b0">TS_F_TS_RESP_CTX_ADD_MD</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaf6372a9c955aedaf7e649a3e14aa0be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_RESP_CTX_add_policy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *&#160;</td>
          <td class="paramname"><em>policy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00252">252</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *copy = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Create new policy stack if necessary. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!ctx-&gt;policies &amp;&amp; !(ctx-&gt;policies = <a class="code" href="safestack_8h.html#a02dfa6199d2f6943a4962038adb65ce4">sk_ASN1_OBJECT_new_null</a>())) </div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!(copy = <a class="code" href="obj__lib_8c.html#a583a60a4931f9b09624a437c3516cecf">OBJ_dup</a>(policy))) <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#a9ae07dd16b75a0d4a67c3377ced1131b">sk_ASN1_OBJECT_push</a>(ctx-&gt;policies, copy)) <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"> err:</div>
<div class="line">        <a class="code" href="err_8h.html#af53063c1a302a5acd2050c9f16dc598c">TSerr</a>(<a class="code" href="ts_8h.html#af8a4f7884cbb65cfc6f105d80fbab2b1">TS_F_TS_RESP_CTX_ADD_POLICY</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        <a class="code" href="a__object_8c.html#ad2c99806f355ca34ae6af600b5fcb055">ASN1_OBJECT_free</a>(copy);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6665c2698906c4b82527849fd55de3e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TS_RESP_CTX_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00185">185</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (!ctx) <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line">        X509_free(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a2f344dd9dc1e604ee5da7855251b6d57">signer_cert</a>);</div>
<div class="line">        <a class="code" href="evp_8h.html#a448d9f9209a54694aff045d403850db7">EVP_PKEY_free</a>(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a0de99406a94785a97ea96c138f8fdadf">signer_key</a>);</div>
<div class="line">        <a class="code" href="safestack_8h.html#a9f351ddac9a3f1d94fcdfacfc9083312">sk_X509_pop_free</a>(ctx-&gt;certs, X509_free);</div>
<div class="line">        <a class="code" href="safestack_8h.html#aa7bd35413713554a8a63a19b75377c35">sk_ASN1_OBJECT_pop_free</a>(ctx-&gt;policies, <a class="code" href="a__object_8c.html#ad2c99806f355ca34ae6af600b5fcb055">ASN1_OBJECT_free</a>);</div>
<div class="line">        <a class="code" href="a__object_8c.html#ad2c99806f355ca34ae6af600b5fcb055">ASN1_OBJECT_free</a>(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#ab537ae3d00451f1b0f95e54864b62b9a">default_policy</a>);</div>
<div class="line">        <a class="code" href="safestack_8h.html#a702ce263fcd8af1c97b04e2dc824410c">sk_EVP_MD_free</a>(ctx-&gt;mds);       <span class="comment">/* No EVP_MD_free method exists. */</span></div>
<div class="line">        ASN1_INTEGER_free(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#ae0758e43218c983128be53cb999d54b4">seconds</a>);</div>
<div class="line">        ASN1_INTEGER_free(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aa2b9f8a451b9976b69f484ac83f7d491">millis</a>);</div>
<div class="line">        ASN1_INTEGER_free(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a6e30be29e202581977057e896fc72311">micros</a>);</div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(ctx);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3fbeb412685444df0214c60fd51d837b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ts_8h.html#a93f3c31ac980708aac81963bc9a63b10">TS_REQ</a>* TS_RESP_CTX_get_request </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00393">393</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a9c66652878d500b08d3c36e258a4d974">request</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9de1210d8e7bd7fb3a6d016135dc8ece"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ts_8h.html#a7de94faeeabec73a2241426a20ffa24f">TS_TST_INFO</a>* TS_RESP_CTX_get_tst_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00398">398</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a314c23ef39b07c6119b982b9677c844e">tst_info</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab52f2ea35878250a2c831ebcaa060cca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a>* TS_RESP_CTX_new </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00166">166</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structTS__resp__ctx.html">TS_RESP_CTX</a> *ctx;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(ctx = (<a class="code" href="structTS__resp__ctx.html">TS_RESP_CTX</a> *) <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structTS__resp__ctx.html">TS_RESP_CTX</a>))))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#af53063c1a302a5acd2050c9f16dc598c">TSerr</a>(<a class="code" href="ts_8h.html#a090174b6cf9c0c11ac060ed0a190ccb2">TS_F_TS_RESP_CTX_NEW</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        memset(ctx, 0, <span class="keyword">sizeof</span>(<a class="code" href="structTS__resp__ctx.html">TS_RESP_CTX</a>));</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Setting default callbacks. */</span></div>
<div class="line">        ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a26180bbb9b639e92b2b0fa2c84ce30f2">serial_cb</a> = def_serial_cb;</div>
<div class="line">        ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a838a0b82016f7bcf6aabe4102f1a4ac8">time_cb</a> = def_time_cb;</div>
<div class="line">        ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a76759785bdc0835a4501abdd72954561">extension_cb</a> = def_extension_cb;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> ctx;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2f5b70ae938997c9f5a53b04f86c9599"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_RESP_CTX_set_accuracy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>secs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>millis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>micros</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00291">291</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line"></div>
<div class="line">        <a class="code" href="ts__rsp__sign_8c.html#aef20eb02b3dbd48988e9e212e886100c">TS_RESP_CTX_accuracy_free</a>(ctx);</div>
<div class="line">        <span class="keywordflow">if</span> (secs &amp;&amp; (!(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#ae0758e43218c983128be53cb999d54b4">seconds</a> = ASN1_INTEGER_new())</div>
<div class="line">                     || !<a class="code" href="a__int_8c.html#a5716313a70738f4ab0c80c7d19c5f2d5">ASN1_INTEGER_set</a>(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#ae0758e43218c983128be53cb999d54b4">seconds</a>, secs)))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (millis &amp;&amp; (!(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aa2b9f8a451b9976b69f484ac83f7d491">millis</a> = ASN1_INTEGER_new())</div>
<div class="line">                       || !<a class="code" href="a__int_8c.html#a5716313a70738f4ab0c80c7d19c5f2d5">ASN1_INTEGER_set</a>(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aa2b9f8a451b9976b69f484ac83f7d491">millis</a>, millis)))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (micros &amp;&amp; (!(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a6e30be29e202581977057e896fc72311">micros</a> = ASN1_INTEGER_new())</div>
<div class="line">                       || !<a class="code" href="a__int_8c.html#a5716313a70738f4ab0c80c7d19c5f2d5">ASN1_INTEGER_set</a>(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a6e30be29e202581977057e896fc72311">micros</a>, micros)))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"> err:</div>
<div class="line">        <a class="code" href="ts__rsp__sign_8c.html#aef20eb02b3dbd48988e9e212e886100c">TS_RESP_CTX_accuracy_free</a>(ctx);</div>
<div class="line">        <a class="code" href="err_8h.html#af53063c1a302a5acd2050c9f16dc598c">TSerr</a>(<a class="code" href="ts_8h.html#a3c53709d06c2fe0bc28e0ac37e3b25ba">TS_F_TS_RESP_CTX_SET_ACCURACY</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3e01ecfe8435b0654749564045f47342"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_RESP_CTX_set_certs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*&#160;</td>
          <td class="paramname"><em>certs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00234">234</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;certs)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="safestack_8h.html#a9f351ddac9a3f1d94fcdfacfc9083312">sk_X509_pop_free</a>(ctx-&gt;certs, X509_free);</div>
<div class="line">                ctx-&gt;certs = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!certs) <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">if</span> (!(ctx-&gt;certs = X509_chain_up_ref(certs))) </div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#af53063c1a302a5acd2050c9f16dc598c">TSerr</a>(<a class="code" href="ts_8h.html#af285e83ac6fcbf85f883aeebea5abd6a">TS_F_TS_RESP_CTX_SET_CERTS</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a947740382a46eaa47c395e239b9b4daf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_RESP_CTX_set_clock_precision_digits </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>precision</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00403">403</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">       {</div>
<div class="line">       <span class="keywordflow">if</span> (precision &gt; <a class="code" href="ts_8h.html#a675022b6db1ced7ce45974072b969568">TS_MAX_CLOCK_PRECISION_DIGITS</a>)</div>
<div class="line">               <span class="keywordflow">return</span> 0;</div>
<div class="line">       ctx-&gt;<a class="code" href="structTS__resp__ctx.html#ae73547d49818bbce3d755d7c94879c2f">clock_precision_digits</a> = precision;</div>
<div class="line">       <span class="keywordflow">return</span> 1;</div>
<div class="line">       }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0fb724460ef8d661df8d41c9bcad2385"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_RESP_CTX_set_def_policy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> *&#160;</td>
          <td class="paramname"><em>def_policy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00224">224</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structTS__resp__ctx.html#ab537ae3d00451f1b0f95e54864b62b9a">default_policy</a>) <a class="code" href="a__object_8c.html#ad2c99806f355ca34ae6af600b5fcb055">ASN1_OBJECT_free</a>(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#ab537ae3d00451f1b0f95e54864b62b9a">default_policy</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#ab537ae3d00451f1b0f95e54864b62b9a">default_policy</a> = <a class="code" href="obj__lib_8c.html#a583a60a4931f9b09624a437c3516cecf">OBJ_dup</a>(def_policy))) <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"> err:</div>
<div class="line">        <a class="code" href="err_8h.html#af53063c1a302a5acd2050c9f16dc598c">TSerr</a>(<a class="code" href="ts_8h.html#af0b912d2545742481f3a7fb340f32436">TS_F_TS_RESP_CTX_SET_DEF_POLICY</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af6d550399778c2c57ea8c06152cdeddb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TS_RESP_CTX_set_extension_cb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a7a67bb257bf3477fee7c3821cfb6c601">TS_extension_cb</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00330">330</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a76759785bdc0835a4501abdd72954561">extension_cb</a> = <a class="code" href="pem_8h.html#a8dfe7b67aa87c6713a0e86b1456c1695">cb</a>;</div>
<div class="line">        ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aa732cb381d3c1f66e3097adff0df24f0">extension_cb_data</a> = <a class="code" href="e__bf_8c.html#aac2cc005a2915c6b6212402aeee7e635">data</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad9f51f2ec16a9e93f91e9d5f41096541"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TS_RESP_CTX_set_serial_cb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a41bf93f9cc2b01382c134b2d786581d3">TS_serial_cb</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00318">318</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a26180bbb9b639e92b2b0fa2c84ce30f2">serial_cb</a> = <a class="code" href="pem_8h.html#a8dfe7b67aa87c6713a0e86b1456c1695">cb</a>;</div>
<div class="line">        ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a428e1ae893e00dea7088a4caed4ff52b">serial_cb_data</a> = <a class="code" href="e__bf_8c.html#aac2cc005a2915c6b6212402aeee7e635">data</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ace501ad5abb317c322e23e4c9f574246"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_RESP_CTX_set_signer_cert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>signer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00201">201</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="v3__purp_8c.html#ad14cac500b50cb3b5b1392af85d35e0d">X509_check_purpose</a>(signer, <a class="code" href="x509v3_8h.html#af6fdcf7790882e7a2a2a985639fbdfcc">X509_PURPOSE_TIMESTAMP_SIGN</a>, 0) != 1)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#af53063c1a302a5acd2050c9f16dc598c">TSerr</a>(<a class="code" href="ts_8h.html#a2c5d1aae836339f5ab5b8df0d6113ca4">TS_F_TS_RESP_CTX_SET_SIGNER_CERT</a>, </div>
<div class="line">                      <a class="code" href="ts_8h.html#a133c031e53c08abf2e8a5ebc3651b15d">TS_R_INVALID_SIGNER_CERTIFICATE_PURPOSE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a2f344dd9dc1e604ee5da7855251b6d57">signer_cert</a>) X509_free(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a2f344dd9dc1e604ee5da7855251b6d57">signer_cert</a>);</div>
<div class="line">        ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a2f344dd9dc1e604ee5da7855251b6d57">signer_cert</a> = signer;</div>
<div class="line">        <a class="code" href="crypto_8h.html#ab8556c4f12443f1876ce487dd0c8db27">CRYPTO_add</a>(&amp;ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a2f344dd9dc1e604ee5da7855251b6d57">signer_cert</a>-&gt;<a class="code" href="structx509__st.html#ab1114b325664bca1cdfd6854f247a4d5">references</a>, +1, <a class="code" href="crypto_8h.html#abcd6591ef6acea51bf9f6edb6bb05bca">CRYPTO_LOCK_X509</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2ad1034e40e7e9f33ca3422049237d83"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_RESP_CTX_set_signer_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00215">215</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a0de99406a94785a97ea96c138f8fdadf">signer_key</a>) <a class="code" href="evp_8h.html#a448d9f9209a54694aff045d403850db7">EVP_PKEY_free</a>(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a0de99406a94785a97ea96c138f8fdadf">signer_key</a>);</div>
<div class="line">        ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a0de99406a94785a97ea96c138f8fdadf">signer_key</a> = <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>;</div>
<div class="line">        <a class="code" href="crypto_8h.html#ab8556c4f12443f1876ce487dd0c8db27">CRYPTO_add</a>(&amp;ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a0de99406a94785a97ea96c138f8fdadf">signer_key</a>-&gt;<a class="code" href="structevp__pkey__st.html#a89b11b788ffad7d747d1c7eed4cf279f">references</a>, +1, <a class="code" href="crypto_8h.html#aee0129d89ab09d6bccecd1ce55307584">CRYPTO_LOCK_EVP_PKEY</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a084e706585ae4e9365b73f2c1385652f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_RESP_CTX_set_status_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00337">337</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structTS__status__info__st.html">TS_STATUS_INFO</a> *si = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_UTF8STRING</a> *utf8_text = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(si = <a class="code" href="ts_8h.html#a0967e2ac395cfffd39f36bd16e085c91">TS_STATUS_INFO_new</a>())) <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="a__int_8c.html#a5716313a70738f4ab0c80c7d19c5f2d5">ASN1_INTEGER_set</a>(si-&gt;<a class="code" href="structTS__status__info__st.html#a1bbc97b14de94cd43623becfd70a254e">status</a>, status)) <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="ideatest_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!(utf8_text = ASN1_UTF8STRING_new())</div>
<div class="line">                    || !<a class="code" href="asn1_8h.html#ac3d9dac6e1a10d91c46e2d9f30f9c225">ASN1_STRING_set</a>(utf8_text, <a class="code" href="ideatest_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>, strlen(<a class="code" href="ideatest_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>)))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (!si-&gt;text &amp;&amp; !(si-&gt;text = <a class="code" href="safestack_8h.html#a2be797dacf9cd4c8a01c12d2744cb797">sk_ASN1_UTF8STRING_new_null</a>()))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#a14b6fa0e76387d558cc4b01fb0adb997">sk_ASN1_UTF8STRING_push</a>(si-&gt;text, utf8_text)) <span class="keywordflow">goto</span> err;</div>
<div class="line">                utf8_text = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;       <span class="comment">/* Ownership is lost. */</span></div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="ts_8h.html#a7a6666f2924c7f208436ae5e047a29c2">TS_RESP_set_status_info</a>(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aff6fbaf908c062da548fb3e319d5ac68">response</a>, si)) <span class="keywordflow">goto</span> err;</div>
<div class="line">        ret = 1;</div>
<div class="line"> err:</div>
<div class="line">        <span class="keywordflow">if</span> (!ret)</div>
<div class="line">                <a class="code" href="err_8h.html#af53063c1a302a5acd2050c9f16dc598c">TSerr</a>(<a class="code" href="ts_8h.html#a173acbc4aa561f5635b0f239970f2e3a">TS_F_TS_RESP_CTX_SET_STATUS_INFO</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        <a class="code" href="ts_8h.html#a0dcbd35d133964d89a55484fe16bb536">TS_STATUS_INFO_free</a>(si);</div>
<div class="line">        ASN1_UTF8STRING_free(utf8_text);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a87c1fbd8ae9a596fc5f87f9d12163c16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_RESP_CTX_set_status_info_cond </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00366">366</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret = 1;</div>
<div class="line">        <a class="code" href="structTS__status__info__st.html">TS_STATUS_INFO</a> *si = <a class="code" href="ts_8h.html#a331539ea4d6ca4272421e0c04f8bffc9">TS_RESP_get_status_info</a>(ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aff6fbaf908c062da548fb3e319d5ac68">response</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="a__int_8c.html#a393b205ec62b7ebe476c20c523e44d12">ASN1_INTEGER_get</a>(si-&gt;<a class="code" href="structTS__status__info__st.html#a1bbc97b14de94cd43623becfd70a254e">status</a>) == <a class="code" href="ts_8h.html#a1eaf64998799f4bd9e94071712c86ef5">TS_STATUS_GRANTED</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="comment">/* Status has not been set, set it now. */</span></div>
<div class="line">                ret = <a class="code" href="ts_8h.html#a084e706585ae4e9365b73f2c1385652f">TS_RESP_CTX_set_status_info</a>(ctx, status, <a class="code" href="ideatest_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adcd87b76fa7f4416a0e6dfd26cbd91a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TS_RESP_CTX_set_time_cb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a017d5e0043bd581d9e81277b1a614839">TS_time_cb</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__rsp__sign_8c_source.html#l00324">324</a> of file <a class="el" href="ts__rsp__sign_8c_source.html">ts_rsp_sign.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        ctx-&gt;<a class="code" href="structTS__resp__ctx.html#a838a0b82016f7bcf6aabe4102f1a4ac8">time_cb</a> = <a class="code" href="pem_8h.html#a8dfe7b67aa87c6713a0e86b1456c1695">cb</a>;</div>
<div class="line">        ctx-&gt;<a class="code" href="structTS__resp__ctx.html#aa818a3e3400ed231cf9b6fb084fe5cd6">time_cb_data</a> = <a class="code" href="e__bf_8c.html#aac2cc005a2915c6b6212402aeee7e635">data</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
