<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/x509v3/v3_lib.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_0218cc2115166b59aa60ecc6cb3a6230.html">x509v3</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">v3_lib.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="cryptlib_8h_source.html">cryptlib.h</a>&quot;</code><br/>
<code>#include &lt;openssl/conf.h&gt;</code><br/>
<code>#include &lt;openssl/x509v3.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="ext__dat_8h_source.html">ext_dat.h</a>&quot;</code><br/>
</div>
<p><a href="v3__lib_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8fc7b49d1ee65aab2b4ae7b4dcbdd798"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__lib_8c.html#a8fc7b49d1ee65aab2b4ae7b4dcbdd798">DECLARE_OBJ_BSEARCH_CMP_FN</a> (const <a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a> *, const <a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a> *, <a class="el" href="x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>)</td></tr>
<tr class="memitem:ac3a2b7820c8688f53af1de2eb748f43f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__lib_8c.html#ac3a2b7820c8688f53af1de2eb748f43f">IMPLEMENT_OBJ_BSEARCH_CMP_FN</a> (const <a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a> *, const <a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a> *, <a class="el" href="x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>)</td></tr>
<tr class="memitem:ac70670a6159e513b1999d3d6e5ec6558"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__lib_8c.html#ac70670a6159e513b1999d3d6e5ec6558">X509V3_EXT_get_nid</a> (int <a class="el" href="x509_8h.html#a7235ef62e89328f5155846dc59c6fc37">nid</a>)</td></tr>
<tr class="memitem:a3374df66acbf61621da69c32d00961ab"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__lib_8c.html#a3374df66acbf61621da69c32d00961ab">X509V3_EXT_get</a> (<a class="el" href="x509_8h.html#ab2f7f7dc0ced8684e0cbfc818e408304">X509_EXTENSION</a> *<a class="el" href="x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>)</td></tr>
<tr class="memitem:aec2b8effc31a9b779b9e131da389feaf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__lib_8c.html#aec2b8effc31a9b779b9e131da389feaf">X509V3_EXT_add_list</a> (<a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a> *extlist)</td></tr>
<tr class="memitem:a1eb1cf52873fea9a59d4922888cd70df"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__lib_8c.html#a1eb1cf52873fea9a59d4922888cd70df">X509V3_EXT_add_alias</a> (int nid_to, int nid_from)</td></tr>
<tr class="memitem:aeac2872450867ae375f7234f45932866"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__lib_8c.html#aeac2872450867ae375f7234f45932866">X509V3_EXT_cleanup</a> (void)</td></tr>
<tr class="memitem:ab39941a71849492b6c82c57228d29321"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__lib_8c.html#ab39941a71849492b6c82c57228d29321">X509V3_add_standard_extensions</a> (void)</td></tr>
<tr class="memitem:ac2615efc1568e15d553c909ad143b805"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__lib_8c.html#ac2615efc1568e15d553c909ad143b805">X509V3_EXT_d2i</a> (<a class="el" href="x509_8h.html#ab2f7f7dc0ced8684e0cbfc818e408304">X509_EXTENSION</a> *<a class="el" href="x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>)</td></tr>
<tr class="memitem:a7d1e4b12f0a76862306c4a3e1b4882c7"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__lib_8c.html#a7d1e4b12f0a76862306c4a3e1b4882c7">X509V3_get_d2i</a> (<a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="x509_8h.html#ab2f7f7dc0ced8684e0cbfc818e408304">X509_EXTENSION</a>)*<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, int <a class="el" href="x509_8h.html#a7235ef62e89328f5155846dc59c6fc37">nid</a>, int *crit, int *idx)</td></tr>
<tr class="memitem:a2932fce5e4ec08d39af3718ed96a73f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v3__lib_8c.html#a2932fce5e4ec08d39af3718ed96a73f3">X509V3_add1_i2d</a> (<a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="x509_8h.html#ab2f7f7dc0ced8684e0cbfc818e408304">X509_EXTENSION</a>)**<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, int <a class="el" href="x509_8h.html#a7235ef62e89328f5155846dc59c6fc37">nid</a>, void *value, int crit, unsigned long <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
</table>
<h2>Function Documentation</h2>
<a class="anchor" id="a8fc7b49d1ee65aab2b4ae7b4dcbdd798"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DECLARE_OBJ_BSEARCH_CMP_FN </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac3a2b7820c8688f53af1de2eb748f43f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IMPLEMENT_OBJ_BSEARCH_CMP_FN </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2932fce5e4ec08d39af3718ed96a73f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509V3_add1_i2d </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="x509_8h.html#ab2f7f7dc0ced8684e0cbfc818e408304">X509_EXTENSION</a>)**&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__lib_8c_source.html#l00239">239</a> of file <a class="el" href="v3__lib_8c_source.html">v3_lib.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> extidx = -1;</div>
<div class="line">        <span class="keywordtype">int</span> errcode;</div>
<div class="line">        <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>, *extmp;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ext_op = <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="x509v3_8h.html#a50624cda6112b64395b392728a301a98">X509V3_ADD_OP_MASK</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* If appending we don&#39;t care if it exists, otherwise</span></div>
<div class="line"><span class="comment">         * look for existing extension.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span>(ext_op != <a class="code" href="x509v3_8h.html#a66563e044e50e5cc2604aaf55cc87a37">X509V3_ADD_APPEND</a>)</div>
<div class="line">                extidx = <a class="code" href="x509_8h.html#a4c0e1ea08d3c5c06b6c0a63ef5a99321">X509v3_get_ext_by_NID</a>(*<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>, -1);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* See if extension exists */</span></div>
<div class="line">        <span class="keywordflow">if</span>(extidx &gt;= 0) {</div>
<div class="line">                <span class="comment">/* If keep existing, nothing to do */</span></div>
<div class="line">                <span class="keywordflow">if</span>(ext_op == <a class="code" href="x509v3_8h.html#aa598c6c89411f0234fdfd28f110d9509">X509V3_ADD_KEEP_EXISTING</a>)</div>
<div class="line">                        <span class="keywordflow">return</span> 1;</div>
<div class="line">                <span class="comment">/* If default then its an error */</span></div>
<div class="line">                <span class="keywordflow">if</span>(ext_op == <a class="code" href="x509v3_8h.html#a7b479d45cf71e0845d3e21380a1bc11d">X509V3_ADD_DEFAULT</a>) {</div>
<div class="line">                        errcode = <a class="code" href="x509v3_8h.html#ab60368a79901bf90fc61c03036bbb422">X509V3_R_EXTENSION_EXISTS</a>;</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">                <span class="comment">/* If delete, just delete it */</span></div>
<div class="line">                <span class="keywordflow">if</span>(ext_op == <a class="code" href="x509v3_8h.html#a9059ad263785ca18870bba7f685cf4a3">X509V3_ADD_DELETE</a>) {</div>
<div class="line">                        <span class="keywordflow">if</span>(!<a class="code" href="safestack_8h.html#a227cd673030cd630a64b7f9dfca97bf5">sk_X509_EXTENSION_delete</a>(*<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, extidx)) <span class="keywordflow">return</span> -1;</div>
<div class="line">                        <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="comment">/* If replace existing or delete, error since </span></div>
<div class="line"><span class="comment">                 * extension must exist</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                <span class="keywordflow">if</span>((ext_op == <a class="code" href="x509v3_8h.html#acb5d5e0fa04ac7e58f917fc8c5083627">X509V3_ADD_REPLACE_EXISTING</a>) ||</div>
<div class="line">                   (ext_op == <a class="code" href="x509v3_8h.html#a9059ad263785ca18870bba7f685cf4a3">X509V3_ADD_DELETE</a>)) {</div>
<div class="line">                        errcode = <a class="code" href="x509v3_8h.html#a607e429e2755af9ba6fd7326319c6c17">X509V3_R_EXTENSION_NOT_FOUND</a>;</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* If we get this far then we have to create an extension:</span></div>
<div class="line"><span class="comment">         * could have some flags for alternative encoding schemes...</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line"></div>
<div class="line">        ext = <a class="code" href="v3__conf_8c.html#a2f9333ab3e3bd3b2a01335e4728362b9">X509V3_EXT_i2d</a>(<a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>, crit, value);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!ext) {</div>
<div class="line">                <a class="code" href="err_8h.html#aefffbc35d6ed0929dfb3864cdba5e11d">X509V3err</a>(<a class="code" href="x509v3_8h.html#a65b920fafbe22645c55be43d033a7a97">X509V3_F_X509V3_ADD1_I2D</a>, <a class="code" href="x509v3_8h.html#a0d6d1dec25eae9473052e775cfda9c65">X509V3_R_ERROR_CREATING_EXTENSION</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* If extension exists replace it.. */</span></div>
<div class="line">        <span class="keywordflow">if</span>(extidx &gt;= 0) {</div>
<div class="line">                extmp = <a class="code" href="safestack_8h.html#af0eb2413c57df772e1c6e3c171026e64">sk_X509_EXTENSION_value</a>(*<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, extidx);</div>
<div class="line">                X509_EXTENSION_free(extmp);</div>
<div class="line">                <span class="keywordflow">if</span>(!<a class="code" href="safestack_8h.html#ad3184cdd758340921968bcee81cbf24b">sk_X509_EXTENSION_set</a>(*<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, extidx, ext)) <span class="keywordflow">return</span> -1;</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!*<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a> &amp;&amp; !(*<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a> = <a class="code" href="safestack_8h.html#a902f40fe2c41a25de0145c1f4eb37aff">sk_X509_EXTENSION_new_null</a>())) <span class="keywordflow">return</span> -1;</div>
<div class="line">        <span class="keywordflow">if</span>(!<a class="code" href="safestack_8h.html#a99c69c5aaf28a9d0f8ef42e679536c2b">sk_X509_EXTENSION_push</a>(*<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, ext)) <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="x509v3_8h.html#ac6b5a6330172c5c971f132cfb99299c6">X509V3_ADD_SILENT</a>))</div>
<div class="line">                <a class="code" href="err_8h.html#aefffbc35d6ed0929dfb3864cdba5e11d">X509V3err</a>(<a class="code" href="x509v3_8h.html#a65b920fafbe22645c55be43d033a7a97">X509V3_F_X509V3_ADD1_I2D</a>, errcode);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab39941a71849492b6c82c57228d29321"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509V3_add_standard_extensions </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__lib_8c_source.html#l00161">161</a> of file <a class="el" href="v3__lib_8c_source.html">v3_lib.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1eb1cf52873fea9a59d4922888cd70df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509V3_EXT_add_alias </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nid_to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nid_from</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__lib_8c_source.html#l00127">127</a> of file <a class="el" href="v3__lib_8c_source.html">v3_lib.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structv3__ext__method.html">X509V3_EXT_METHOD</a> *<a class="code" href="x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>;</div>
<div class="line">        <a class="code" href="structv3__ext__method.html">X509V3_EXT_METHOD</a> *tmpext;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!(ext = <a class="code" href="v3__lib_8c.html#ac70670a6159e513b1999d3d6e5ec6558">X509V3_EXT_get_nid</a>(nid_from))) {</div>
<div class="line">                <a class="code" href="err_8h.html#aefffbc35d6ed0929dfb3864cdba5e11d">X509V3err</a>(<a class="code" href="x509v3_8h.html#a44a431a4b449b5d1ee9090d2bfa6d953">X509V3_F_X509V3_EXT_ADD_ALIAS</a>,<a class="code" href="x509v3_8h.html#a607e429e2755af9ba6fd7326319c6c17">X509V3_R_EXTENSION_NOT_FOUND</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(!(tmpext = (<a class="code" href="structv3__ext__method.html">X509V3_EXT_METHOD</a> *)<a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structv3__ext__method.html">X509V3_EXT_METHOD</a>)))) {</div>
<div class="line">                <a class="code" href="err_8h.html#aefffbc35d6ed0929dfb3864cdba5e11d">X509V3err</a>(<a class="code" href="x509v3_8h.html#a44a431a4b449b5d1ee9090d2bfa6d953">X509V3_F_X509V3_EXT_ADD_ALIAS</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line">        *tmpext = *<a class="code" href="x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>;</div>
<div class="line">        tmpext-&gt;<a class="code" href="structv3__ext__method.html#ad9f39327ffdb8ffb8cfdbea5a3081600">ext_nid</a> = nid_to;</div>
<div class="line">        tmpext-&gt;<a class="code" href="structv3__ext__method.html#aa3e784b4aad755aa1c7d3b21b14d68d8">ext_flags</a> |= <a class="code" href="x509v3_8h.html#ad207d8512665c6e8fece990b0a5b4519">X509V3_EXT_DYNAMIC</a>;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509v3_8h.html#a481ddb1c501de50f5595e72a59aabaa1">X509V3_EXT_add</a>(tmpext);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aec2b8effc31a9b779b9e131da389feaf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509V3_EXT_add_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a> *&#160;</td>
          <td class="paramname"><em>extlist</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__lib_8c_source.html#l00120">120</a> of file <a class="el" href="v3__lib_8c_source.html">v3_lib.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">for</span>(;extlist-&gt;<a class="code" href="structv3__ext__method.html#ad9f39327ffdb8ffb8cfdbea5a3081600">ext_nid</a>!=-1;extlist++) </div>
<div class="line">                        <span class="keywordflow">if</span>(!<a class="code" href="x509v3_8h.html#a481ddb1c501de50f5595e72a59aabaa1">X509V3_EXT_add</a>(extlist)) <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeac2872450867ae375f7234f45932866"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509V3_EXT_cleanup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__lib_8c_source.html#l00146">146</a> of file <a class="el" href="v3__lib_8c_source.html">v3_lib.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <a class="code" href="safestack_8h.html#a93685f5fe2fe64ab1c9fc63a025d15e4">sk_X509V3_EXT_METHOD_pop_free</a>(ext_list, ext_list_free);</div>
<div class="line">        ext_list = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac2615efc1568e15d553c909ad143b805"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* X509V3_EXT_d2i </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="x509_8h.html#ab2f7f7dc0ced8684e0cbfc818e408304">X509_EXTENSION</a> *&#160;</td>
          <td class="paramname"><em>ext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__lib_8c_source.html#l00168">168</a> of file <a class="el" href="v3__lib_8c_source.html">v3_lib.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structv3__ext__method.html">X509V3_EXT_METHOD</a> *method;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!(method = <a class="code" href="v3__lib_8c.html#a3374df66acbf61621da69c32d00961ab">X509V3_EXT_get</a>(ext))) <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        p = ext-&gt;<a class="code" href="structX509__extension__st.html#a670220c7ca6eef25dde30f43db492114">value</a>-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>;</div>
<div class="line">        <span class="keywordflow">if</span>(method-&gt;<a class="code" href="structv3__ext__method.html#a6f57d2623c9652447056936691e7325f">it</a>) <span class="keywordflow">return</span> <a class="code" href="asn1_8h.html#a5cd3d6660d85c72563fea0f05ca4fa8a">ASN1_item_d2i</a>(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, &amp;p, ext-&gt;<a class="code" href="structX509__extension__st.html#a670220c7ca6eef25dde30f43db492114">value</a>-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>, <a class="code" href="asn1_8h.html#ab7b2d0ca14dc279d38f94f34e20afaec">ASN1_ITEM_ptr</a>(method-&gt;<a class="code" href="structv3__ext__method.html#a6f57d2623c9652447056936691e7325f">it</a>));</div>
<div class="line">        <span class="keywordflow">return</span> method-&gt;<a class="code" href="structv3__ext__method.html#affd83034cb2127f5c95827e92532d7da">d2i</a>(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, &amp;p, ext-&gt;<a class="code" href="structX509__extension__st.html#a670220c7ca6eef25dde30f43db492114">value</a>-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3374df66acbf61621da69c32d00961ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a>* X509V3_EXT_get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="x509_8h.html#ab2f7f7dc0ced8684e0cbfc818e408304">X509_EXTENSION</a> *&#160;</td>
          <td class="paramname"><em>ext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__lib_8c_source.html#l00112">112</a> of file <a class="el" href="v3__lib_8c_source.html">v3_lib.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>;</div>
<div class="line">        <span class="keywordflow">if</span>((nid = <a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(ext-&gt;<a class="code" href="structX509__extension__st.html#a8aea7d682ad5be95235abe897c0160fa">object</a>)) == <a class="code" href="obj__mac_8h.html#ad115d9b07ddf7f48ea5feb47299a8894">NID_undef</a>) <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="v3__lib_8c.html#ac70670a6159e513b1999d3d6e5ec6558">X509V3_EXT_get_nid</a>(nid);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac70670a6159e513b1999d3d6e5ec6558"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="x509v3_8h.html#aa3d1cac3594fdc106c2f2b687a557f5f">X509V3_EXT_METHOD</a>* X509V3_EXT_get_nid </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__lib_8c_source.html#l00097">97</a> of file <a class="el" href="v3__lib_8c_source.html">v3_lib.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <a class="code" href="structv3__ext__method.html">X509V3_EXT_METHOD</a> tmp;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structv3__ext__method.html">X509V3_EXT_METHOD</a> *<a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a> = &amp;tmp, * <span class="keyword">const</span> *ret;</div>
<div class="line">        <span class="keywordtype">int</span> idx;</div>
<div class="line">        <span class="keywordflow">if</span>(<a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a> &lt; 0) <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        tmp.<a class="code" href="structv3__ext__method.html#ad9f39327ffdb8ffb8cfdbea5a3081600">ext_nid</a> = <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>;</div>
<div class="line">        ret = OBJ_bsearch_ext(&amp;t, standard_exts, <a class="code" href="ext__dat_8h.html#afcdbb881920b6ce44850b2361f16bc17">STANDARD_EXTENSION_COUNT</a>);</div>
<div class="line">        <span class="keywordflow">if</span>(ret) <span class="keywordflow">return</span> *ret;</div>
<div class="line">        <span class="keywordflow">if</span>(!ext_list) <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        idx = <a class="code" href="safestack_8h.html#af65db004361179070002058410cccc3e">sk_X509V3_EXT_METHOD_find</a>(ext_list, &amp;tmp);</div>
<div class="line">        <span class="keywordflow">if</span>(idx == -1) <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="safestack_8h.html#a2b1ddd17b5029003f58e3a3f18318e22">sk_X509V3_EXT_METHOD_value</a>(ext_list, idx);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7d1e4b12f0a76862306c4a3e1b4882c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* X509V3_get_d2i </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="x509_8h.html#ab2f7f7dc0ced8684e0cbfc818e408304">X509_EXTENSION</a>)*&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>crit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="v3__lib_8c_source.html#l00194">194</a> of file <a class="el" href="v3__lib_8c_source.html">v3_lib.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> lastpos, i;</div>
<div class="line">        <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="x509_8h.html#a02ad6cc5d33c413aabdabe742adfe889">ex</a>, *found_ex = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span>(!<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>) {</div>
<div class="line">                <span class="keywordflow">if</span>(idx) *idx = -1;</div>
<div class="line">                <span class="keywordflow">if</span>(crit) *crit = -1;</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(idx) lastpos = *idx + 1;</div>
<div class="line">        <span class="keywordflow">else</span> lastpos = 0;</div>
<div class="line">        <span class="keywordflow">if</span>(lastpos &lt; 0) lastpos = 0;</div>
<div class="line">        <span class="keywordflow">for</span>(i = lastpos; i &lt; <a class="code" href="safestack_8h.html#a1f71baa921a0a1bc6a0690818fffbb6f">sk_X509_EXTENSION_num</a>(<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>); i++)</div>
<div class="line">        {</div>
<div class="line">                ex = <a class="code" href="safestack_8h.html#af0eb2413c57df772e1c6e3c171026e64">sk_X509_EXTENSION_value</a>(<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>, i);</div>
<div class="line">                <span class="keywordflow">if</span>(<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(ex-&gt;<a class="code" href="structX509__extension__st.html#a8aea7d682ad5be95235abe897c0160fa">object</a>) == <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>) {</div>
<div class="line">                        <span class="keywordflow">if</span>(idx) {</div>
<div class="line">                                *idx = i;</div>
<div class="line">                                found_ex = <a class="code" href="x509_8h.html#a02ad6cc5d33c413aabdabe742adfe889">ex</a>;</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(found_ex) {</div>
<div class="line">                                <span class="comment">/* Found more than one */</span></div>
<div class="line">                                <span class="keywordflow">if</span>(crit) *crit = -2;</div>
<div class="line">                                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        }</div>
<div class="line">                        found_ex = <a class="code" href="x509_8h.html#a02ad6cc5d33c413aabdabe742adfe889">ex</a>;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(found_ex) {</div>
<div class="line">                <span class="comment">/* Found it */</span></div>
<div class="line">                <span class="keywordflow">if</span>(crit) *crit = <a class="code" href="x509_8h.html#a76b533df287f86ebdcb87aa97c247364">X509_EXTENSION_get_critical</a>(found_ex);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="v3__lib_8c.html#ac2615efc1568e15d553c909ad143b805">X509V3_EXT_d2i</a>(found_ex);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Extension not found */</span></div>
<div class="line">        <span class="keywordflow">if</span>(idx) *idx = -1;</div>
<div class="line">        <span class="keywordflow">if</span>(crit) *crit = -1;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 15 2014 18:16:54 for openssl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
