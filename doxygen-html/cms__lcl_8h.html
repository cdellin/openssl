<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/cms/cms_lcl.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_7882632c4dffce91474d1f2c5c940725.html">cms</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">cms_lcl.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;openssl/x509.h&gt;</code><br/>
</div>
<p><a href="cms__lcl_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__ContentInfo__st.html">CMS_ContentInfo_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__SignedData__st.html">CMS_SignedData_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__EncapsulatedContentInfo__st.html">CMS_EncapsulatedContentInfo_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__SignerInfo__st.html">CMS_SignerInfo_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__SignerIdentifier__st.html">CMS_SignerIdentifier_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__EnvelopedData__st.html">CMS_EnvelopedData_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__OriginatorInfo__st.html">CMS_OriginatorInfo_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__EncryptedContentInfo__st.html">CMS_EncryptedContentInfo_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__KeyTransRecipientInfo__st.html">CMS_KeyTransRecipientInfo_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__KeyAgreeRecipientInfo__st.html">CMS_KeyAgreeRecipientInfo_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__OriginatorIdentifierOrKey__st.html">CMS_OriginatorIdentifierOrKey_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__OriginatorPublicKey__st.html">CMS_OriginatorPublicKey_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__RecipientEncryptedKey__st.html">CMS_RecipientEncryptedKey_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__KeyAgreeRecipientIdentifier__st.html">CMS_KeyAgreeRecipientIdentifier_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__RecipientKeyIdentifier__st.html">CMS_RecipientKeyIdentifier_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__KEKRecipientInfo__st.html">CMS_KEKRecipientInfo_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__KEKIdentifier__st.html">CMS_KEKIdentifier_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__PasswordRecipientInfo__st.html">CMS_PasswordRecipientInfo_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__OtherRecipientInfo__st.html">CMS_OtherRecipientInfo_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__DigestedData__st.html">CMS_DigestedData_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__EncryptedData__st.html">CMS_EncryptedData_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__AuthenticatedData__st.html">CMS_AuthenticatedData_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__CompressedData__st.html">CMS_CompressedData_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__RevocationInfoChoice__st.html">CMS_RevocationInfoChoice_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__OtherRevocationInfoFormat__st.html">CMS_OtherRevocationInfoFormat_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__CertificateChoices.html">CMS_CertificateChoices</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__OtherCertificateFormat__st.html">CMS_OtherCertificateFormat_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__IssuerAndSerialNumber__st.html">CMS_IssuerAndSerialNumber_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__OtherKeyAttribute__st.html">CMS_OtherKeyAttribute_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCMS__Receipt__st.html">CMS_Receipt_st</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a56217290da46d71e42d5d9cba9fbcc70"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a56217290da46d71e42d5d9cba9fbcc70">CMS_REVCHOICE_CRL</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:ac59c14adf2a36ef5cd12fec4bf7ce55f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ac59c14adf2a36ef5cd12fec4bf7ce55f">CMS_REVCHOICE_OTHER</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:ac13e38ed7a0fad673c41edf5812c387d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ac13e38ed7a0fad673c41edf5812c387d">CMS_CERTCHOICE_CERT</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:a589b826d9b38461e0a5b1429d126b826"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a589b826d9b38461e0a5b1429d126b826">CMS_CERTCHOICE_EXCERT</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:a36f2d0b00fc12300fb685d0f778d1ec2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a36f2d0b00fc12300fb685d0f778d1ec2">CMS_CERTCHOICE_V1ACERT</a>&#160;&#160;&#160;2</td></tr>
<tr class="memitem:a1ddd4ccd2068c417f9e83d2cd22f2f1e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a1ddd4ccd2068c417f9e83d2cd22f2f1e">CMS_CERTCHOICE_V2ACERT</a>&#160;&#160;&#160;3</td></tr>
<tr class="memitem:af5c8e4cf55a75caf0853a7270bcbecde"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#af5c8e4cf55a75caf0853a7270bcbecde">CMS_CERTCHOICE_OTHER</a>&#160;&#160;&#160;4</td></tr>
<tr class="memitem:aa90a5540395664981482a8f6aa9e5e33"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#aa90a5540395664981482a8f6aa9e5e33">CMS_SIGNERINFO_ISSUER_SERIAL</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:ad42a4799f8919e59919223af98623ca0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ad42a4799f8919e59919223af98623ca0">CMS_SIGNERINFO_KEYIDENTIFIER</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:a716efd9e04cf578cc79bdeee854fdefa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a716efd9e04cf578cc79bdeee854fdefa">CMS_RECIPINFO_ISSUER_SERIAL</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:a35fb45fa8fa8aed132f64827bf8babf3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a35fb45fa8fa8aed132f64827bf8babf3">CMS_RECIPINFO_KEYIDENTIFIER</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:adcf4c7b7ee4fafcba3324805c9896392"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#adcf4c7b7ee4fafcba3324805c9896392">CMS_REK_ISSUER_SERIAL</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:ae29b7278fde140f345e7425e33192372"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ae29b7278fde140f345e7425e33192372">CMS_REK_KEYIDENTIFIER</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:ab3e6514a619e47cba48f870966361f89"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ab3e6514a619e47cba48f870966361f89">CMS_OIK_ISSUER_SERIAL</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:ab07ddd1f14d39875f458d6f2affd1105"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ab07ddd1f14d39875f458d6f2affd1105">CMS_OIK_KEYIDENTIFIER</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:a7ca4de9879cff722eab3b9ebf9cc73ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a7ca4de9879cff722eab3b9ebf9cc73ea">CMS_OIK_PUBKEY</a>&#160;&#160;&#160;2</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a161c64a652f5a8893905640ecf4123b9"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__IssuerAndSerialNumber__st.html">CMS_IssuerAndSerialNumber_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a161c64a652f5a8893905640ecf4123b9">CMS_IssuerAndSerialNumber</a></td></tr>
<tr class="memitem:a43d5fbe8d3d48436737af5049d312acc"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__EncapsulatedContentInfo__st.html">CMS_EncapsulatedContentInfo_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a43d5fbe8d3d48436737af5049d312acc">CMS_EncapsulatedContentInfo</a></td></tr>
<tr class="memitem:ae014235d4e06243d4ec1b9ac00cc0315"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__SignerIdentifier__st.html">CMS_SignerIdentifier_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ae014235d4e06243d4ec1b9ac00cc0315">CMS_SignerIdentifier</a></td></tr>
<tr class="memitem:abe2230f6a5d53b38935afce1134f5e59"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structCMS__SignedData__st.html">CMS_SignedData_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#abe2230f6a5d53b38935afce1134f5e59">CMS_SignedData</a></td></tr>
<tr class="memitem:a8a7037a68100a105c28714cb7167220e"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__OtherRevocationInfoFormat__st.html">CMS_OtherRevocationInfoFormat_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a8a7037a68100a105c28714cb7167220e">CMS_OtherRevocationInfoFormat</a></td></tr>
<tr class="memitem:a4c325dbee271c3317533c278d43bd6e3"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__OriginatorInfo__st.html">CMS_OriginatorInfo_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a4c325dbee271c3317533c278d43bd6e3">CMS_OriginatorInfo</a></td></tr>
<tr class="memitem:aff176e0206ddea7f5862958dbf131112"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__EncryptedContentInfo__st.html">CMS_EncryptedContentInfo_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#aff176e0206ddea7f5862958dbf131112">CMS_EncryptedContentInfo</a></td></tr>
<tr class="memitem:a4cb65b7d7c915efc367f5e1e999440d9"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structCMS__EnvelopedData__st.html">CMS_EnvelopedData_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a4cb65b7d7c915efc367f5e1e999440d9">CMS_EnvelopedData</a></td></tr>
<tr class="memitem:a23583c48b5429324f8084e6275a2242c"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structCMS__DigestedData__st.html">CMS_DigestedData_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a23583c48b5429324f8084e6275a2242c">CMS_DigestedData</a></td></tr>
<tr class="memitem:a97367bb136637cfc9362aa539c4aa0f1"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structCMS__EncryptedData__st.html">CMS_EncryptedData_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a97367bb136637cfc9362aa539c4aa0f1">CMS_EncryptedData</a></td></tr>
<tr class="memitem:ad014098c2fc9ebdedbefb1719cba0412"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__AuthenticatedData__st.html">CMS_AuthenticatedData_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ad014098c2fc9ebdedbefb1719cba0412">CMS_AuthenticatedData</a></td></tr>
<tr class="memitem:a61eba1db4f92d835d5fdb2ba14eacfab"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__CompressedData__st.html">CMS_CompressedData_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a61eba1db4f92d835d5fdb2ba14eacfab">CMS_CompressedData</a></td></tr>
<tr class="memitem:a607e2c91e4e68db49d0ccaa97ce5d7c1"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__OtherCertificateFormat__st.html">CMS_OtherCertificateFormat_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a607e2c91e4e68db49d0ccaa97ce5d7c1">CMS_OtherCertificateFormat</a></td></tr>
<tr class="memitem:a9cf59e0f39bf03604b1096dae2d94b5f"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__KeyTransRecipientInfo__st.html">CMS_KeyTransRecipientInfo_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a9cf59e0f39bf03604b1096dae2d94b5f">CMS_KeyTransRecipientInfo</a></td></tr>
<tr class="memitem:a05196d48afe66b5708a55dc10a1ea640"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__OriginatorPublicKey__st.html">CMS_OriginatorPublicKey_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a05196d48afe66b5708a55dc10a1ea640">CMS_OriginatorPublicKey</a></td></tr>
<tr class="memitem:ab3b0c12e27a4a93e217c0ba76c557776"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__OriginatorIdentifierOrKey__st.html">CMS_OriginatorIdentifierOrKey_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ab3b0c12e27a4a93e217c0ba76c557776">CMS_OriginatorIdentifierOrKey</a></td></tr>
<tr class="memitem:ac10c410f89175d84d4f753f32434a937"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__KeyAgreeRecipientInfo__st.html">CMS_KeyAgreeRecipientInfo_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ac10c410f89175d84d4f753f32434a937">CMS_KeyAgreeRecipientInfo</a></td></tr>
<tr class="memitem:a26bd3673afe7e2e7a95c254027cb7e81"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__RecipientKeyIdentifier__st.html">CMS_RecipientKeyIdentifier_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a26bd3673afe7e2e7a95c254027cb7e81">CMS_RecipientKeyIdentifier</a></td></tr>
<tr class="memitem:acafb516add3d662a5409c26641ed8f70"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__KeyAgreeRecipientIdentifier__st.html">CMS_KeyAgreeRecipientIdentifier_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#acafb516add3d662a5409c26641ed8f70">CMS_KeyAgreeRecipientIdentifier</a></td></tr>
<tr class="memitem:a34d0db06d618f85e5cc5a1053ffceda2"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structCMS__KEKIdentifier__st.html">CMS_KEKIdentifier_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a34d0db06d618f85e5cc5a1053ffceda2">CMS_KEKIdentifier</a></td></tr>
<tr class="memitem:afa726e7f6dd799ab49866eba897c29b9"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__KEKRecipientInfo__st.html">CMS_KEKRecipientInfo_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#afa726e7f6dd799ab49866eba897c29b9">CMS_KEKRecipientInfo</a></td></tr>
<tr class="memitem:a8a91002ed5166ed1ab01498f4ce1382b"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__PasswordRecipientInfo__st.html">CMS_PasswordRecipientInfo_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a8a91002ed5166ed1ab01498f4ce1382b">CMS_PasswordRecipientInfo</a></td></tr>
<tr class="memitem:a45ba7d9c55339513397c0231aa1d4f90"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structCMS__OtherRecipientInfo__st.html">CMS_OtherRecipientInfo_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a45ba7d9c55339513397c0231aa1d4f90">CMS_OtherRecipientInfo</a></td></tr>
<tr class="memitem:a835cce00809db159d9df5ce2d60e89cf"><td class="memItemLeft" align="right" valign="top">typedef struct CMS_ReceiptsFrom_st&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a835cce00809db159d9df5ce2d60e89cf">CMS_ReceiptsFrom</a></td></tr>
<tr class="memitem:a836bb2f688a31b7ec32eb11344d74350"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="cms__lcl_8h.html#ae014235d4e06243d4ec1b9ac00cc0315">CMS_SignerIdentifier</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a836bb2f688a31b7ec32eb11344d74350">CMS_RecipientIdentifier</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8a4dbf1a9981c0b07fc164f220bae461"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a8a4dbf1a9981c0b07fc164f220bae461">cms_content_bio</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:ab98170e495ae6b0ee6e8a3d3d7892ea3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ab98170e495ae6b0ee6e8a3d3d7892ea3">cms_Data_create</a> (void)</td></tr>
<tr class="memitem:a6284ac93855f0ff2d88c4a86998d2671"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a6284ac93855f0ff2d88c4a86998d2671">cms_DigestedData_create</a> (const <a class="el" href="ossl__typ_8h.html#aac66cf010326fa9a927c2a34888f45d3">EVP_MD</a> *md)</td></tr>
<tr class="memitem:a42c657a8d92b5f24da640eb77f890416"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a42c657a8d92b5f24da640eb77f890416">cms_DigestedData_init_bio</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a8a10b03dabe71726e5ba1122e0e7d521"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a8a10b03dabe71726e5ba1122e0e7d521">cms_DigestedData_do_final</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *chain, int verify)</td></tr>
<tr class="memitem:a0ab3d20e8cc3de71f04703dfa7c62017"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a0ab3d20e8cc3de71f04703dfa7c62017">cms_SignedData_init_bio</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:aeaa6987a61ee75542fde7e9d4b5dbe56"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#aeaa6987a61ee75542fde7e9d4b5dbe56">cms_SignedData_final</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *chain)</td></tr>
<tr class="memitem:ae2f46d9be341636d0e22d58d86fb7c1e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ae2f46d9be341636d0e22d58d86fb7c1e">cms_set1_SignerIdentifier</a> (<a class="el" href="cms__lcl_8h.html#ae014235d4e06243d4ec1b9ac00cc0315">CMS_SignerIdentifier</a> *sid, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert, int <a class="el" href="x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>)</td></tr>
<tr class="memitem:a73e3ae14ece4aba2d5bcc38796b23907"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a73e3ae14ece4aba2d5bcc38796b23907">cms_SignerIdentifier_get0_signer_id</a> (<a class="el" href="cms__lcl_8h.html#ae014235d4e06243d4ec1b9ac00cc0315">CMS_SignerIdentifier</a> *sid, <a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **keyid, <a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> **issuer, <a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **sno)</td></tr>
<tr class="memitem:ae15c777be21e1c02be97ddf5bc27dc54"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ae15c777be21e1c02be97ddf5bc27dc54">cms_SignerIdentifier_cert_cmp</a> (<a class="el" href="cms__lcl_8h.html#ae014235d4e06243d4ec1b9ac00cc0315">CMS_SignerIdentifier</a> *sid, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:a021dfa768bb69b86058748fc84bd2180"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a021dfa768bb69b86058748fc84bd2180">cms_CompressedData_create</a> (int comp_nid)</td></tr>
<tr class="memitem:acf77ed7105bfbe80a22d8bf47ef62bb0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#acf77ed7105bfbe80a22d8bf47ef62bb0">cms_CompressedData_init_bio</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a149b22de836f8e10d2e6671d7c5b2847"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a149b22de836f8e10d2e6671d7c5b2847">cms_DigestAlgorithm_init_bio</a> (<a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> *digestAlgorithm)</td></tr>
<tr class="memitem:a061cd98f90341e462ce7050fafe88768"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a061cd98f90341e462ce7050fafe88768">cms_DigestAlgorithm_find_ctx</a> (<a class="el" href="ossl__typ_8h.html#a69cda4d21bd068f01c469222c1dd92fe">EVP_MD_CTX</a> *mctx, <a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *chain, <a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> *mdalg)</td></tr>
<tr class="memitem:a013cca1c46db1e5c849677157326d3eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a013cca1c46db1e5c849677157326d3eb">cms_ias_cert_cmp</a> (<a class="el" href="cms__lcl_8h.html#a161c64a652f5a8893905640ecf4123b9">CMS_IssuerAndSerialNumber</a> *ias, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:ac7878a1f6e7641e2d71cc14cb69b209e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ac7878a1f6e7641e2d71cc14cb69b209e">cms_keyid_cert_cmp</a> (<a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> *keyid, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:af1abd64a7d3f7b9e06fcd1111652ea00"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#af1abd64a7d3f7b9e06fcd1111652ea00">cms_set1_ias</a> (<a class="el" href="cms__lcl_8h.html#a161c64a652f5a8893905640ecf4123b9">CMS_IssuerAndSerialNumber</a> **pias, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:aedcc935c2d546a5704b460ccf277e053"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#aedcc935c2d546a5704b460ccf277e053">cms_set1_keyid</a> (<a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **pkeyid, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:a8b6dfda01af260a20f9cb2b29b24b94b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a8b6dfda01af260a20f9cb2b29b24b94b">cms_EncryptedContent_init_bio</a> (<a class="el" href="cms__lcl_8h.html#aff176e0206ddea7f5862958dbf131112">CMS_EncryptedContentInfo</a> *ec)</td></tr>
<tr class="memitem:a55dec6744581e6a39e9b38a3bfeafb1d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a55dec6744581e6a39e9b38a3bfeafb1d">cms_EncryptedData_init_bio</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:abd1f18f503cb0c237d12a089de669dd4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#abd1f18f503cb0c237d12a089de669dd4">cms_EncryptedContent_init</a> (<a class="el" href="cms__lcl_8h.html#aff176e0206ddea7f5862958dbf131112">CMS_EncryptedContentInfo</a> *ec, const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *cipher, const unsigned char *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, size_t keylen)</td></tr>
<tr class="memitem:a8e3f30d1637a47523fdb553550a6aaf6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a8e3f30d1637a47523fdb553550a6aaf6">cms_Receipt_verify</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *req_cms)</td></tr>
<tr class="memitem:a59155921f635636542bf47f780acc979"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a59155921f635636542bf47f780acc979">cms_msgSigDigest_add1</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *dest, <a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *src)</td></tr>
<tr class="memitem:a052ae32c1ce228c85b2d5f772c0b38c6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a052ae32c1ce228c85b2d5f772c0b38c6">cms_encode_Receipt</a> (<a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *si)</td></tr>
<tr class="memitem:a40e7ed2550f0b34ee904c6576f08bc57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a40e7ed2550f0b34ee904c6576f08bc57">cms_EnvelopedData_init_bio</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:a904bcd4685600e69c9cadfc48e4c3e7c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cms__lcl_8h.html#a4cb65b7d7c915efc367f5e1e999440d9">CMS_EnvelopedData</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a904bcd4685600e69c9cadfc48e4c3e7c">cms_get0_enveloped</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms)</td></tr>
<tr class="memitem:ac35f315f7ccd6ac91196b3ec171dc0cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#ac35f315f7ccd6ac91196b3ec171dc0cc">cms_env_asn1_ctrl</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, int cmd)</td></tr>
<tr class="memitem:a4175d1c76c8093fb8a0f61c77a62fd86"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a4175d1c76c8093fb8a0f61c77a62fd86">cms_pkey_get_ri_type</a> (<a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *pk)</td></tr>
<tr class="memitem:acf47dd02ab24b071a4539c0eae072a73"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#acf47dd02ab24b071a4539c0eae072a73">cms_RecipientInfo_kari_init</a> (<a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *recip, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *pk, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a178c4432e47cc12081fd3e4e28910092"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a178c4432e47cc12081fd3e4e28910092">cms_RecipientInfo_kari_encrypt</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri)</td></tr>
<tr class="memitem:a23e449de7f0b59882111f6025b6403f4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cms__lcl_8h.html#a23e449de7f0b59882111f6025b6403f4">cms_RecipientInfo_pwri_crypt</a> (<a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *cms, <a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *ri, int en_de)</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="ac13e38ed7a0fad673c41edf5812c387d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_CERTCHOICE_CERT&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00364">364</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a589b826d9b38461e0a5b1429d126b826"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_CERTCHOICE_EXCERT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00365">365</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="af5c8e4cf55a75caf0853a7270bcbecde"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_CERTCHOICE_OTHER&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00368">368</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a36f2d0b00fc12300fb685d0f778d1ec2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_CERTCHOICE_V1ACERT&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00366">366</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1ddd4ccd2068c417f9e83d2cd22f2f1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_CERTCHOICE_V2ACERT&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00367">367</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab3e6514a619e47cba48f870966361f89"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_OIK_ISSUER_SERIAL&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00441">441</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab07ddd1f14d39875f458d6f2affd1105"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_OIK_KEYIDENTIFIER&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00442">442</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7ca4de9879cff722eab3b9ebf9cc73ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_OIK_PUBKEY&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00443">443</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a716efd9e04cf578cc79bdeee854fdefa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_RECIPINFO_ISSUER_SERIAL&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00435">435</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a35fb45fa8fa8aed132f64827bf8babf3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_RECIPINFO_KEYIDENTIFIER&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00436">436</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="adcf4c7b7ee4fafcba3324805c9896392"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_REK_ISSUER_SERIAL&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00438">438</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae29b7278fde140f345e7425e33192372"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_REK_KEYIDENTIFIER&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00439">439</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a56217290da46d71e42d5d9cba9fbcc70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_REVCHOICE_CRL&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00343">343</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac59c14adf2a36ef5cd12fec4bf7ce55f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_REVCHOICE_OTHER&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00344">344</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa90a5540395664981482a8f6aa9e5e33"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_SIGNERINFO_ISSUER_SERIAL&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00432">432</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad42a4799f8919e59919223af98623ca0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMS_SIGNERINFO_KEYIDENTIFIER&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00433">433</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<h2>Typedef Documentation</h2>
<a class="anchor" id="ad014098c2fc9ebdedbefb1719cba0412"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__AuthenticatedData__st.html">CMS_AuthenticatedData_st</a> <a class="el" href="cms__lcl_8h.html#ad014098c2fc9ebdedbefb1719cba0412">CMS_AuthenticatedData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00079">79</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a61eba1db4f92d835d5fdb2ba14eacfab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__CompressedData__st.html">CMS_CompressedData_st</a> <a class="el" href="cms__lcl_8h.html#a61eba1db4f92d835d5fdb2ba14eacfab">CMS_CompressedData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00080">80</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a23583c48b5429324f8084e6275a2242c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__DigestedData__st.html">CMS_DigestedData_st</a> <a class="el" href="cms__lcl_8h.html#a23583c48b5429324f8084e6275a2242c">CMS_DigestedData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00077">77</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a43d5fbe8d3d48436737af5049d312acc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__EncapsulatedContentInfo__st.html">CMS_EncapsulatedContentInfo_st</a> <a class="el" href="cms__lcl_8h.html#a43d5fbe8d3d48436737af5049d312acc">CMS_EncapsulatedContentInfo</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00070">70</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="aff176e0206ddea7f5862958dbf131112"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__EncryptedContentInfo__st.html">CMS_EncryptedContentInfo_st</a> <a class="el" href="cms__lcl_8h.html#aff176e0206ddea7f5862958dbf131112">CMS_EncryptedContentInfo</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00075">75</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a97367bb136637cfc9362aa539c4aa0f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__EncryptedData__st.html">CMS_EncryptedData_st</a> <a class="el" href="cms__lcl_8h.html#a97367bb136637cfc9362aa539c4aa0f1">CMS_EncryptedData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00078">78</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4cb65b7d7c915efc367f5e1e999440d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__EnvelopedData__st.html">CMS_EnvelopedData_st</a> <a class="el" href="cms__lcl_8h.html#a4cb65b7d7c915efc367f5e1e999440d9">CMS_EnvelopedData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00076">76</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a161c64a652f5a8893905640ecf4123b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__IssuerAndSerialNumber__st.html">CMS_IssuerAndSerialNumber_st</a> <a class="el" href="cms__lcl_8h.html#a161c64a652f5a8893905640ecf4123b9">CMS_IssuerAndSerialNumber</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00069">69</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a34d0db06d618f85e5cc5a1053ffceda2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__KEKIdentifier__st.html">CMS_KEKIdentifier_st</a> <a class="el" href="cms__lcl_8h.html#a34d0db06d618f85e5cc5a1053ffceda2">CMS_KEKIdentifier</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00088">88</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="afa726e7f6dd799ab49866eba897c29b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__KEKRecipientInfo__st.html">CMS_KEKRecipientInfo_st</a> <a class="el" href="cms__lcl_8h.html#afa726e7f6dd799ab49866eba897c29b9">CMS_KEKRecipientInfo</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00089">89</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="acafb516add3d662a5409c26641ed8f70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__KeyAgreeRecipientIdentifier__st.html">CMS_KeyAgreeRecipientIdentifier_st</a> <a class="el" href="cms__lcl_8h.html#acafb516add3d662a5409c26641ed8f70">CMS_KeyAgreeRecipientIdentifier</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00087">87</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac10c410f89175d84d4f753f32434a937"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__KeyAgreeRecipientInfo__st.html">CMS_KeyAgreeRecipientInfo_st</a> <a class="el" href="cms__lcl_8h.html#ac10c410f89175d84d4f753f32434a937">CMS_KeyAgreeRecipientInfo</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00085">85</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9cf59e0f39bf03604b1096dae2d94b5f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__KeyTransRecipientInfo__st.html">CMS_KeyTransRecipientInfo_st</a> <a class="el" href="cms__lcl_8h.html#a9cf59e0f39bf03604b1096dae2d94b5f">CMS_KeyTransRecipientInfo</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00082">82</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab3b0c12e27a4a93e217c0ba76c557776"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__OriginatorIdentifierOrKey__st.html">CMS_OriginatorIdentifierOrKey_st</a> <a class="el" href="cms__lcl_8h.html#ab3b0c12e27a4a93e217c0ba76c557776">CMS_OriginatorIdentifierOrKey</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00084">84</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4c325dbee271c3317533c278d43bd6e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__OriginatorInfo__st.html">CMS_OriginatorInfo_st</a> <a class="el" href="cms__lcl_8h.html#a4c325dbee271c3317533c278d43bd6e3">CMS_OriginatorInfo</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00074">74</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a05196d48afe66b5708a55dc10a1ea640"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__OriginatorPublicKey__st.html">CMS_OriginatorPublicKey_st</a> <a class="el" href="cms__lcl_8h.html#a05196d48afe66b5708a55dc10a1ea640">CMS_OriginatorPublicKey</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00083">83</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a607e2c91e4e68db49d0ccaa97ce5d7c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__OtherCertificateFormat__st.html">CMS_OtherCertificateFormat_st</a> <a class="el" href="cms__lcl_8h.html#a607e2c91e4e68db49d0ccaa97ce5d7c1">CMS_OtherCertificateFormat</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00081">81</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a45ba7d9c55339513397c0231aa1d4f90"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__OtherRecipientInfo__st.html">CMS_OtherRecipientInfo_st</a> <a class="el" href="cms__lcl_8h.html#a45ba7d9c55339513397c0231aa1d4f90">CMS_OtherRecipientInfo</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00091">91</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8a7037a68100a105c28714cb7167220e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__OtherRevocationInfoFormat__st.html">CMS_OtherRevocationInfoFormat_st</a> <a class="el" href="cms__lcl_8h.html#a8a7037a68100a105c28714cb7167220e">CMS_OtherRevocationInfoFormat</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00073">73</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8a91002ed5166ed1ab01498f4ce1382b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__PasswordRecipientInfo__st.html">CMS_PasswordRecipientInfo_st</a> <a class="el" href="cms__lcl_8h.html#a8a91002ed5166ed1ab01498f4ce1382b">CMS_PasswordRecipientInfo</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00090">90</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a835cce00809db159d9df5ce2d60e89cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct CMS_ReceiptsFrom_st <a class="el" href="cms__lcl_8h.html#a835cce00809db159d9df5ce2d60e89cf">CMS_ReceiptsFrom</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00092">92</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a836bb2f688a31b7ec32eb11344d74350"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="cms__lcl_8h.html#ae014235d4e06243d4ec1b9ac00cc0315">CMS_SignerIdentifier</a> <a class="el" href="cms__lcl_8h.html#a836bb2f688a31b7ec32eb11344d74350">CMS_RecipientIdentifier</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00195">195</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="a26bd3673afe7e2e7a95c254027cb7e81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__RecipientKeyIdentifier__st.html">CMS_RecipientKeyIdentifier_st</a> <a class="el" href="cms__lcl_8h.html#a26bd3673afe7e2e7a95c254027cb7e81">CMS_RecipientKeyIdentifier</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00086">86</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="abe2230f6a5d53b38935afce1134f5e59"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__SignedData__st.html">CMS_SignedData_st</a> <a class="el" href="cms__lcl_8h.html#abe2230f6a5d53b38935afce1134f5e59">CMS_SignedData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00072">72</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae014235d4e06243d4ec1b9ac00cc0315"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCMS__SignerIdentifier__st.html">CMS_SignerIdentifier_st</a> <a class="el" href="cms__lcl_8h.html#ae014235d4e06243d4ec1b9ac00cc0315">CMS_SignerIdentifier</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lcl_8h_source.html#l00071">71</a> of file <a class="el" href="cms__lcl_8h_source.html">cms_lcl.h</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a021dfa768bb69b86058748fc84bd2180"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* cms_CompressedData_create </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>comp_nid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="acf77ed7105bfbe80a22d8bf47ef62bb0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* cms_CompressedData_init_bio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8a4dbf1a9981c0b07fc164f220bae461"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* cms_content_bio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00089">89</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> **pos = <a class="code" href="cms_8h.html#aed4845b6010a2e1988ca0234cbfa3b18">CMS_get0_content</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!pos)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="comment">/* If content detached data goes nowhere: create NULL BIO */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!*pos)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="bio_8h.html#a581a4f51e785ab7df2d032d38f589259">BIO_new</a>(<a class="code" href="bio_8h.html#af30879ddb464dd84bbd801075291d058">BIO_s_null</a>());</div>
<div class="line">        <span class="comment">/* If content not detached and created return memory BIO</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!*pos || ((*pos)-&gt;flags == <a class="code" href="asn1_8h.html#a4b7ab2e2bd5b4e52b4f3d13a3a3e59bd">ASN1_STRING_FLAG_CONT</a>))</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="bio_8h.html#a581a4f51e785ab7df2d032d38f589259">BIO_new</a>(<a class="code" href="bio_8h.html#aa00c1ff95f6d83e358d2daa6eca3e724">BIO_s_mem</a>());</div>
<div class="line">        <span class="comment">/* Else content was read in: return read only BIO for it */</span></div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="bio_8h.html#a3c93aa21db46e50b7002f434b641d218">BIO_new_mem_buf</a>((*pos)-&gt;data, (*pos)-&gt;length);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab98170e495ae6b0ee6e8a3d3d7892ea3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* cms_Data_create </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00076">76</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a> *cms;</div>
<div class="line">        cms = CMS_ContentInfo_new();</div>
<div class="line">        <span class="keywordflow">if</span> (cms)</div>
<div class="line">                {</div>
<div class="line">                cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#aae0b0e1c6da4732f18167de51c9eb9e5">contentType</a> = <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="obj__mac_8h.html#a13d08edbaf91c1fd310b3e4cbd9f98a9">NID_pkcs7_data</a>);</div>
<div class="line">                <span class="comment">/* Never detached */</span></div>
<div class="line">                <a class="code" href="cms_8h.html#a7e9044c6fa0899c711c09da4eed9d5c5">CMS_set_detached</a>(cms, 0);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> cms;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a061cd98f90341e462ce7050fafe88768"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_DigestAlgorithm_find_ctx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a69cda4d21bd068f01c469222c1dd92fe">EVP_MD_CTX</a> *&#160;</td>
          <td class="paramname"><em>mctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>chain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> *&#160;</td>
          <td class="paramname"><em>mdalg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00375">375</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> <a class="code" href="pem_8h.html#a85baed467a8a5107268fae0ceb6cb9b6">nid</a>;</div>
<div class="line">        <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *mdoid;</div>
<div class="line">        <a class="code" href="x509_8h.html#acfea022df77108974470fa98aa88d9b9">X509_ALGOR_get0</a>(&amp;mdoid, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, mdalg);</div>
<div class="line">        nid = <a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(mdoid);</div>
<div class="line">        <span class="comment">/* Look for digest type to match signature */</span></div>
<div class="line">        <span class="keywordflow">for</span> (;;)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structenv__md__ctx__st.html">EVP_MD_CTX</a> *mtmp;</div>
<div class="line">                chain = <a class="code" href="bio_8h.html#aee7bbe95cd69d7944f939d4a8073604c">BIO_find_type</a>(chain, <a class="code" href="bio_8h.html#a4c8ef84469c42d0bedbdd75c81f777fa">BIO_TYPE_MD</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (chain == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a9ba97bf7f311bcc5ac1b5020e22cf63c">CMS_F_CMS_DIGESTALGORITHM_FIND_CTX</a>,</div>
<div class="line">                                                <a class="code" href="cms_8h.html#a625091664f384ceaab468eb6aa106c03">CMS_R_NO_MATCHING_DIGEST</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                <a class="code" href="evp_8h.html#a0caa551c5fd31ff55117e6b55dfc54b4">BIO_get_md_ctx</a>(chain, &amp;mtmp);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#aaabf31f5ebaa97f5dc26e1e65f0a221e">EVP_MD_CTX_type</a>(mtmp) == nid</div>
<div class="line">                <span class="comment">/* Workaround for broken implementations that use signature</span></div>
<div class="line"><span class="comment">                 * algorithm  OID instead of digest.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                        || <a class="code" href="evp_8h.html#aa2be6df8c406dcdfb312833086ef54f6">EVP_MD_pkey_type</a>(<a class="code" href="evp_8h.html#a71fed39076aec9a43d618177317e3691">EVP_MD_CTX_md</a>(mtmp)) == nid)</div>
<div class="line">                        <span class="keywordflow">return</span> <a class="code" href="digest_8c.html#ab42e7b7bc6ec24356f278a660fcc61f0">EVP_MD_CTX_copy_ex</a>(mctx, mtmp);</div>
<div class="line">                chain = <a class="code" href="bio_8h.html#ab4efedc5dfbd06141e8e08df6782ae4d">BIO_next</a>(chain);</div>
<div class="line">                }</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a149b22de836f8e10d2e6671d7c5b2847"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* cms_DigestAlgorithm_init_bio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#aa2b6185e6254f36f709cd6577fb5022e">X509_ALGOR</a> *&#160;</td>
          <td class="paramname"><em>digestAlgorithm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00346">346</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *mdbio = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *digestoid;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structenv__md__st.html">EVP_MD</a> *digest;</div>
<div class="line">        <a class="code" href="x509_8h.html#acfea022df77108974470fa98aa88d9b9">X509_ALGOR_get0</a>(&amp;digestoid, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, digestAlgorithm);</div>
<div class="line">        digest = <a class="code" href="evp_8h.html#afd1d14292f13b363355410634e00ec09">EVP_get_digestbyobj</a>(digestoid);</div>
<div class="line">        <span class="keywordflow">if</span> (!digest)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a5e4f1b8a34184e085d9623ba93382843">CMS_F_CMS_DIGESTALGORITHM_INIT_BIO</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a1a4144c1803a65d36cc4f75a98704dd8">CMS_R_UNKNOWN_DIGEST_ALGORIHM</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;       </div>
<div class="line">                }</div>
<div class="line">        mdbio = <a class="code" href="bio_8h.html#a581a4f51e785ab7df2d032d38f589259">BIO_new</a>(<a class="code" href="bio__md_8c.html#a2d39e4a3c1f89551732fb39ce8df19fb">BIO_f_md</a>());</div>
<div class="line">        <span class="keywordflow">if</span> (!mdbio || !<a class="code" href="evp_8h.html#ac18e24ee9b5fde311b117ed697dffc15">BIO_set_md</a>(mdbio, digest))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a5e4f1b8a34184e085d9623ba93382843">CMS_F_CMS_DIGESTALGORITHM_INIT_BIO</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a7c37779b4e7c568c841d84b1607687f3">CMS_R_MD_BIO_INIT_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;       </div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> mdbio;</div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (mdbio)</div>
<div class="line">                <a class="code" href="bio_8h.html#abbfb67b5eb998ce232f2482b097da8b2">BIO_free</a>(mdbio);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6284ac93855f0ff2d88c4a86998d2671"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a>* cms_DigestedData_create </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#aac66cf010326fa9a927c2a34888f45d3">EVP_MD</a> *&#160;</td>
          <td class="paramname"><em>md</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__dd_8c_source.html#l00066">66</a> of file <a class="el" href="cms__dd_8c_source.html">cms_dd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__ContentInfo__st.html">CMS_ContentInfo</a> *cms;</div>
<div class="line">        <a class="code" href="structCMS__DigestedData__st.html">CMS_DigestedData</a> *dd;</div>
<div class="line">        cms = CMS_ContentInfo_new();</div>
<div class="line">        <span class="keywordflow">if</span> (!cms)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        dd = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__DigestedData__st.html">CMS_DigestedData</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!dd)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#aae0b0e1c6da4732f18167de51c9eb9e5">contentType</a> = <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="obj__mac_8h.html#a5913b3f520c08ebb4000fee1be9ec0f5">NID_pkcs7_digest</a>);</div>
<div class="line">        cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a18f598edb29c5a3440125620d3bf2602">digestedData</a> = dd;</div>
<div class="line"></div>
<div class="line">        dd-&gt;<a class="code" href="structCMS__DigestedData__st.html#aca7e7fc8f4ba13f2a9aebbf375bc0991">version</a> = 0;</div>
<div class="line">        dd-&gt;<a class="code" href="structCMS__DigestedData__st.html#aa5cad160cc805026470f28c7837c75ad">encapContentInfo</a>-&gt;<a class="code" href="structCMS__EncapsulatedContentInfo__st.html#a30b904336e1af30f53d6877fb94e32d2">eContentType</a> = <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="obj__mac_8h.html#a13d08edbaf91c1fd310b3e4cbd9f98a9">NID_pkcs7_data</a>);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="x509_8h.html#ab44f4d3bad3d1c20afa59b4c38772cf3">X509_ALGOR_set_md</a>(dd-&gt;<a class="code" href="structCMS__DigestedData__st.html#abbdb0991c5559106dbfc24a2eed38685">digestAlgorithm</a>, md);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> cms;</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (cms)</div>
<div class="line">                CMS_ContentInfo_free(cms);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8a10b03dabe71726e5ba1122e0e7d521"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_DigestedData_do_final </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>chain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verify</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__dd_8c_source.html#l00104">104</a> of file <a class="el" href="cms__dd_8c_source.html">cms_dd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structenv__md__ctx__st.html">EVP_MD_CTX</a> mctx;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> md[<a class="code" href="evp_8h.html#a71bfc78a168f00f0c4ffd2535082b129">EVP_MAX_MD_SIZE</a>];</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mdlen;</div>
<div class="line">        <span class="keywordtype">int</span> r = 0;</div>
<div class="line">        <a class="code" href="structCMS__DigestedData__st.html">CMS_DigestedData</a> *dd;</div>
<div class="line">        <a class="code" href="digest_8c.html#afe58145aa88a8ee187d858c762c00399">EVP_MD_CTX_init</a>(&amp;mctx);</div>
<div class="line"></div>
<div class="line">        dd = cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a18f598edb29c5a3440125620d3bf2602">digestedData</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="cms__lcl_8h.html#a061cd98f90341e462ce7050fafe88768">cms_DigestAlgorithm_find_ctx</a>(&amp;mctx, chain, dd-&gt;<a class="code" href="structCMS__DigestedData__st.html#abbdb0991c5559106dbfc24a2eed38685">digestAlgorithm</a>))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="digest_8c.html#a3c3bec018dd4bdf73a3f14d27ea9b718">EVP_DigestFinal_ex</a>(&amp;mctx, md, &amp;mdlen) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (verify)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (mdlen != (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)dd-&gt;<a class="code" href="structCMS__DigestedData__st.html#a81e53e5b4bc33c8238e1f1bedd9e8213">digest</a>-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#aa71e5f8afca2b67f50d075a33457d88f">CMS_F_CMS_DIGESTEDDATA_DO_FINAL</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#aac86e03aa9a17729244f690e449a3fd5">CMS_R_MESSAGEDIGEST_WRONG_LENGTH</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (memcmp(md, dd-&gt;<a class="code" href="structCMS__DigestedData__st.html#a81e53e5b4bc33c8238e1f1bedd9e8213">digest</a>-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>, mdlen))</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#aa71e5f8afca2b67f50d075a33457d88f">CMS_F_CMS_DIGESTEDDATA_DO_FINAL</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#aa49b30049d0eb233a76d8c3396f72d7a">CMS_R_VERIFICATION_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        r = 1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="asn1_8h.html#ac3d9dac6e1a10d91c46e2d9f30f9c225">ASN1_STRING_set</a>(dd-&gt;<a class="code" href="structCMS__DigestedData__st.html#a81e53e5b4bc33c8238e1f1bedd9e8213">digest</a>, md, mdlen))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                r = 1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line">        <a class="code" href="digest_8c.html#ac6c8c38d6c8e3e274c9a974792b8342d">EVP_MD_CTX_cleanup</a>(&amp;mctx);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> r;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a42c657a8d92b5f24da640eb77f890416"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* cms_DigestedData_init_bio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__dd_8c_source.html#l00097">97</a> of file <a class="el" href="cms__dd_8c_source.html">cms_dd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__DigestedData__st.html">CMS_DigestedData</a> *dd;</div>
<div class="line">        dd = cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a18f598edb29c5a3440125620d3bf2602">digestedData</a>;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#a149b22de836f8e10d2e6671d7c5b2847">cms_DigestAlgorithm_init_bio</a>(dd-&gt;<a class="code" href="structCMS__DigestedData__st.html#abbdb0991c5559106dbfc24a2eed38685">digestAlgorithm</a>);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a052ae32c1ce228c85b2d5f772c0b38c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a>* cms_encode_Receipt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>si</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__ess_8c_source.html#l00377">377</a> of file <a class="el" href="cms__ess_8c_source.html">cms_ess.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__Receipt__st.html">CMS_Receipt</a> rct;</div>
<div class="line">        <a class="code" href="cms_8h.html#ad6b0df3c7c986cf29209828f9e31c523">CMS_ReceiptRequest</a> *rr = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *ctype;</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> *os = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Get original receipt request */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Get original receipt request details */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="cms__ess_8c.html#a0dd87d2fec71b02c15c2fb504c086252">CMS_get1_ReceiptRequest</a>(si, &amp;rr) &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ad76a23b904c12491ccbf836d87ecb583">CMS_F_CMS_ENCODE_RECEIPT</a>, <a class="code" href="cms_8h.html#a77a255f4d9b2a55cdbc0c0bd77b3c4a2">CMS_R_NO_RECEIPT_REQUEST</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Get original content type */</span></div>
<div class="line"></div>
<div class="line">        ctype = <a class="code" href="cms_8h.html#af1803123210af8b7304b66eb4c704941">CMS_signed_get0_data_by_OBJ</a>(si,</div>
<div class="line">                                <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="obj__mac_8h.html#ac141d207d6e4810d04a02180f2142b00">NID_pkcs9_contentType</a>),</div>
<div class="line">                                        -3, <a class="code" href="asn1_8h.html#aa8aa9044005ad5fec5af188c7c1bd186">V_ASN1_OBJECT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!ctype)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ad76a23b904c12491ccbf836d87ecb583">CMS_F_CMS_ENCODE_RECEIPT</a>, <a class="code" href="cms_8h.html#a315dac2b2cfc6ee517e8dafa92b56a7f">CMS_R_NO_CONTENT_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        rct.<a class="code" href="structCMS__Receipt__st.html#a5504bd880827d15a24f213318033ef37">version</a> = 1;</div>
<div class="line">        rct.<a class="code" href="structCMS__Receipt__st.html#a9e920f52ab68a7717100eec3ddb4c676">contentType</a> = ctype;</div>
<div class="line">        rct.<a class="code" href="structCMS__Receipt__st.html#ae6beb43eb9fa185af3c56bebca24596c">signedContentIdentifier</a> = rr-&gt;signedContentIdentifier;</div>
<div class="line">        rct.<a class="code" href="structCMS__Receipt__st.html#a97d8eea00219d7075145441834018527">originatorSignatureValue</a> = si-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aee2347ee93351b9d44fb978a71295ca8">signature</a>;</div>
<div class="line"></div>
<div class="line">        os = <a class="code" href="asn1_8h.html#ae48707fb4d9967ddb90ce4458c3810ab">ASN1_item_pack</a>(&amp;rct, <a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(<a class="code" href="structCMS__Receipt__st.html">CMS_Receipt</a>), <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (rr)</div>
<div class="line">                CMS_ReceiptRequest_free(rr);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> os;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abd1f18f503cb0c237d12a089de669dd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_EncryptedContent_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms__lcl_8h.html#aff176e0206ddea7f5862958dbf131112">CMS_EncryptedContentInfo</a> *&#160;</td>
          <td class="paramname"><em>ec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a54a8663a8084d45c31f2786156b55405">EVP_CIPHER</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__enc_8c_source.html#l00239">239</a> of file <a class="el" href="cms__enc_8c_source.html">cms_enc.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a42d15187520e31613b3d2c47c79fa8dd">cipher</a> = cipher;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>)</div>
<div class="line">                {</div>
<div class="line">                ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a> = <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(keylen);</div>
<div class="line">                <span class="keywordflow">if</span> (!ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>)</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                memcpy(ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>, <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, keylen);</div>
<div class="line">                }</div>
<div class="line">        ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a> = keylen;</div>
<div class="line">        <span class="keywordflow">if</span> (cipher)</div>
<div class="line">                ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#af94b00cdd5833b615f05b9e4d23be859">contentType</a> = <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="obj__mac_8h.html#a13d08edbaf91c1fd310b3e4cbd9f98a9">NID_pkcs7_data</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8b6dfda01af260a20f9cb2b29b24b94b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* cms_EncryptedContent_init_bio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms__lcl_8h.html#aff176e0206ddea7f5862958dbf131112">CMS_EncryptedContentInfo</a> *&#160;</td>
          <td class="paramname"><em>ec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__enc_8c_source.html#l00069">69</a> of file <a class="el" href="cms__enc_8c_source.html">cms_enc.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *<a class="code" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>;</div>
<div class="line">        <a class="code" href="structevp__cipher__ctx__st.html">EVP_CIPHER_CTX</a> *ctx;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structevp__cipher__st.html">EVP_CIPHER</a> *ciph;</div>
<div class="line">        <a class="code" href="structX509__algor__st.html">X509_ALGOR</a> *calg = ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#aaa6a3598e05785e2d59a3abd4e53900a">contentEncryptionAlgorithm</a>;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> iv[<a class="code" href="evp_8h.html#a80893bc2dbae769441bf6a042cf4069e">EVP_MAX_IV_LENGTH</a>], *piv = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *tkey = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">size_t</span> tkeylen = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> ok = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> enc, keep_key = 0;</div>
<div class="line"></div>
<div class="line">        enc = ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a42d15187520e31613b3d2c47c79fa8dd">cipher</a> ? 1 : 0;</div>
<div class="line"></div>
<div class="line">        b = <a class="code" href="bio_8h.html#a581a4f51e785ab7df2d032d38f589259">BIO_new</a>(<a class="code" href="bio__enc_8c.html#ae38a2c0160131c560c98fbf63d1eb65d">BIO_f_cipher</a>());</div>
<div class="line">        <span class="keywordflow">if</span> (!b)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a0212693acbc22d892fea7d594532dc5d">CMS_F_CMS_ENCRYPTEDCONTENT_INIT_BIO</a>,</div>
<div class="line">                                                        <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="evp_8h.html#a04d02269f6bd11231243c65acce8f57e">BIO_get_cipher_ctx</a>(b, &amp;ctx);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (enc)</div>
<div class="line">                {</div>
<div class="line">                ciph = ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a42d15187520e31613b3d2c47c79fa8dd">cipher</a>;</div>
<div class="line">                <span class="comment">/* If not keeping key set cipher to NULL so subsequent calls</span></div>
<div class="line"><span class="comment">                 * decrypt.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                <span class="keywordflow">if</span> (ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>)</div>
<div class="line">                        ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a42d15187520e31613b3d2c47c79fa8dd">cipher</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                ciph = <a class="code" href="evp_8h.html#a359c5ec316dfeb6d04e2f146d9b0484d">EVP_get_cipherbyobj</a>(calg-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (!ciph)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a0212693acbc22d892fea7d594532dc5d">CMS_F_CMS_ENCRYPTEDCONTENT_INIT_BIO</a>,</div>
<div class="line">                                                        <a class="code" href="cms_8h.html#a7ced89b08b244602676ca478190f6c91">CMS_R_UNKNOWN_CIPHER</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#aab11ae066491958c229882a364c3feb8">EVP_CipherInit_ex</a>(ctx, ciph, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, enc) &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a0212693acbc22d892fea7d594532dc5d">CMS_F_CMS_ENCRYPTEDCONTENT_INIT_BIO</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#afa52b2bd2206156435b55e15bac11ee1">CMS_R_CIPHER_INITIALISATION_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (enc)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordtype">int</span> ivlen;</div>
<div class="line">                calg-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a> = <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="evp_8h.html#ab96111f6a3cef845f0d94c40b2b236fd">EVP_CIPHER_CTX_type</a>(ctx));</div>
<div class="line">                <span class="comment">/* Generate a random IV if we need one */</span></div>
<div class="line">                ivlen = <a class="code" href="evp_8h.html#af3201d12bcf0e13a885ca4cf5ee379f3">EVP_CIPHER_CTX_iv_length</a>(ctx);</div>
<div class="line">                <span class="keywordflow">if</span> (ivlen &gt; 0)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="rand_8h.html#a8a4e911a9be281eb797faa8590637ac3">RAND_pseudo_bytes</a>(iv, ivlen) &lt;= 0)</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        piv = iv;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#ab4235d136f646de5e37bc7521bafedc8">EVP_CIPHER_asn1_to_param</a>(ctx, calg-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a>) &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a0212693acbc22d892fea7d594532dc5d">CMS_F_CMS_ENCRYPTEDCONTENT_INIT_BIO</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a8f810f38c4d363007aaf06a17919f61f">CMS_R_CIPHER_PARAMETER_INITIALISATION_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        tkeylen = <a class="code" href="evp_8h.html#a59acb66206fbf0e0c2e6789983db3dd7">EVP_CIPHER_CTX_key_length</a>(ctx);</div>
<div class="line">        <span class="comment">/* Generate random session key */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!enc || !ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>)</div>
<div class="line">                {</div>
<div class="line">                tkey = <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(tkeylen);</div>
<div class="line">                <span class="keywordflow">if</span> (!tkey)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a0212693acbc22d892fea7d594532dc5d">CMS_F_CMS_ENCRYPTEDCONTENT_INIT_BIO</a>,</div>
<div class="line">                                                        <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#a2f171ee3d2e29079c553d8cfafeaadaf">EVP_CIPHER_CTX_rand_key</a>(ctx, tkey) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>)</div>
<div class="line">                {</div>
<div class="line">                ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a> = tkey;</div>
<div class="line">                ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a> = tkeylen;</div>
<div class="line">                tkey = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (enc)</div>
<div class="line">                        keep_key = 1;</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        <a class="code" href="err_8c.html#ae562e57f2e66f238d774cbfddc6bf7a4">ERR_clear_error</a>();</div>
<div class="line">                </div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a> != tkeylen)</div>
<div class="line">                {</div>
<div class="line">                <span class="comment">/* If necessary set key length */</span></div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#ad790f422c8622c30a4e9d79ba6d444e2">EVP_CIPHER_CTX_set_key_length</a>(ctx, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a>) &lt;= 0)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="comment">/* Only reveal failure if debugging so we don&#39;t</span></div>
<div class="line"><span class="comment">                         * leak information which may be useful in MMA.</span></div>
<div class="line"><span class="comment">                         */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (enc || ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#acac0ff1fe57132f12130a3a42d57c4fc">debug</a>)</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a0212693acbc22d892fea7d594532dc5d">CMS_F_CMS_ENCRYPTEDCONTENT_INIT_BIO</a>,</div>
<div class="line">                                                <a class="code" href="cms_8h.html#ad72973d78eacc1a9b5794588665614d2">CMS_R_INVALID_KEY_LENGTH</a>);</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                                {</div>
<div class="line">                                <span class="comment">/* Use random key */</span></div>
<div class="line">                                <a class="code" href="crypto_8h.html#a2aa47e40c63b05d00e9a780592f2a2b8">OPENSSL_cleanse</a>(ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a>);</div>
<div class="line">                                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>);</div>
<div class="line">                                ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a> = tkey;</div>
<div class="line">                                ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a> = tkeylen;</div>
<div class="line">                                tkey = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                                <a class="code" href="err_8c.html#ae562e57f2e66f238d774cbfddc6bf7a4">ERR_clear_error</a>();</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#aab11ae066491958c229882a364c3feb8">EVP_CipherInit_ex</a>(ctx, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>, piv, enc) &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a0212693acbc22d892fea7d594532dc5d">CMS_F_CMS_ENCRYPTEDCONTENT_INIT_BIO</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#afa52b2bd2206156435b55e15bac11ee1">CMS_R_CIPHER_INITIALISATION_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (piv)</div>
<div class="line">                {</div>
<div class="line">                calg-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a> = ASN1_TYPE_new();</div>
<div class="line">                <span class="keywordflow">if</span> (!calg-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a0212693acbc22d892fea7d594532dc5d">CMS_F_CMS_ENCRYPTEDCONTENT_INIT_BIO</a>,</div>
<div class="line">                                                        <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#a3a3e94ce6ad87d960addd62106a6d71d">EVP_CIPHER_param_to_asn1</a>(ctx, calg-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a>) &lt;= 0)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a0212693acbc22d892fea7d594532dc5d">CMS_F_CMS_ENCRYPTEDCONTENT_INIT_BIO</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a8f810f38c4d363007aaf06a17919f61f">CMS_R_CIPHER_PARAMETER_INITIALISATION_ERROR</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        ok = 1;</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a> &amp;&amp; !keep_key)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="crypto_8h.html#a2aa47e40c63b05d00e9a780592f2a2b8">OPENSSL_cleanse</a>(ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a>);</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>);</div>
<div class="line">                ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (tkey)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="crypto_8h.html#a2aa47e40c63b05d00e9a780592f2a2b8">OPENSSL_cleanse</a>(tkey, tkeylen);</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(tkey);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (ok)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>;</div>
<div class="line">        <a class="code" href="bio_8h.html#abbfb67b5eb998ce232f2482b097da8b2">BIO_free</a>(b);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a55dec6744581e6a39e9b38a3bfeafb1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* cms_EncryptedData_init_bio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__enc_8c_source.html#l00288">288</a> of file <a class="el" href="cms__enc_8c_source.html">cms_enc.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__EncryptedData__st.html">CMS_EncryptedData</a> *enc = cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#aecda2b0d84ed349f274ef28ec9dabc21">encryptedData</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (enc-&gt;<a class="code" href="structCMS__EncryptedData__st.html#ada7019d43f9e2dd51cb8fbe711e41a4e">encryptedContentInfo</a>-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a42d15187520e31613b3d2c47c79fa8dd">cipher</a> &amp;&amp; enc-&gt;unprotectedAttrs)</div>
<div class="line">                enc-&gt;<a class="code" href="structCMS__EncryptedData__st.html#a9acd2de00440d6c223d54b587745acf0">version</a> = 2;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="cms__enc_8c.html#a8b6dfda01af260a20f9cb2b29b24b94b">cms_EncryptedContent_init_bio</a>(enc-&gt;<a class="code" href="structCMS__EncryptedData__st.html#ada7019d43f9e2dd51cb8fbe711e41a4e">encryptedContentInfo</a>);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac35f315f7ccd6ac91196b3ec171dc0cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_env_asn1_ctrl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cmd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00106">106</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structevp__pkey__st.html">EVP_PKEY</a> *pkey;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> == <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>)</div>
<div class="line">                pkey = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a931c9714689ab434cd072f8ae5c75cec">ktri</a>-&gt;<a class="code" href="structCMS__KeyTransRecipientInfo__st.html#a9ec467fb7deec1d82c9c730b8c2db000">pkey</a>;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> == <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structevp__pkey__ctx__st.html">EVP_PKEY_CTX</a> *pctx = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a72c16b9727ba03e41e28085f501a290b">pctx</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (!pctx)</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                pkey = <a class="code" href="evp_8h.html#a94df22cd02656bd24b1849d2ab620260">EVP_PKEY_CTX_get0_pkey</a>(pctx);</div>
<div class="line">                <span class="keywordflow">if</span> (!pkey)</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (!pkey-&gt;<a class="code" href="structevp__pkey__st.html#a89d9cab6071d889719126a8ebc03b673">ameth</a> || !pkey-&gt;<a class="code" href="structevp__pkey__st.html#a89d9cab6071d889719126a8ebc03b673">ameth</a>-&gt;<a class="code" href="structevp__pkey__asn1__method__st.html#acf78fd1a5c1abf3cf46222e3c2bfc659">pkey_ctrl</a>)</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">        i = pkey-&gt;<a class="code" href="structevp__pkey__st.html#a89d9cab6071d889719126a8ebc03b673">ameth</a>-&gt;<a class="code" href="structevp__pkey__asn1__method__st.html#acf78fd1a5c1abf3cf46222e3c2bfc659">pkey_ctrl</a>(pkey, <a class="code" href="evp_8h.html#a53beaded425f9afdfb4fd5cd3f91a9d3">ASN1_PKEY_CTRL_CMS_ENVELOPE</a>, cmd, ri);</div>
<div class="line">        <span class="keywordflow">if</span> (i == -2)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#af36b801b1dec357f689eff8c68fb16b4">CMS_F_CMS_ENV_ASN1_CTRL</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a5501f38a05380b4d48562e17db5d931b">CMS_R_NOT_SUPPORTED_FOR_THIS_KEY_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (i &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#af36b801b1dec357f689eff8c68fb16b4">CMS_F_CMS_ENV_ASN1_CTRL</a>, <a class="code" href="cms_8h.html#a8d038f601b36de5ab9b0ee6829f41d2a">CMS_R_CTRL_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a40e7ed2550f0b34ee904c6576f08bc57"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* cms_EnvelopedData_init_bio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00988">988</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__EncryptedContentInfo__st.html">CMS_EncryptedContentInfo</a> *ec;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a>) *rinfos;</div>
<div class="line">        <a class="code" href="structCMS__RecipientInfo__st.html">CMS_RecipientInfo</a> *ri;</div>
<div class="line">        <span class="keywordtype">int</span> i, ok = 0;</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *ret;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Get BIO first to set up key */</span></div>
<div class="line"></div>
<div class="line">        ec = cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>-&gt;<a class="code" href="structCMS__EnvelopedData__st.html#a61ff72488726aa8cf3191e2e1cacc97d">encryptedContentInfo</a>;</div>
<div class="line">        ret = <a class="code" href="cms__enc_8c.html#a8b6dfda01af260a20f9cb2b29b24b94b">cms_EncryptedContent_init_bio</a>(ec);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* If error or no cipher end of processing */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!ret || !ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a42d15187520e31613b3d2c47c79fa8dd">cipher</a>)</div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Now encrypt content key according to each RecipientInfo type */</span></div>
<div class="line"></div>
<div class="line">        rinfos = cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>-&gt;recipientInfos;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a0c1e686cfaa11baf6f61c28373ba3b98">sk_CMS_RecipientInfo_num</a>(rinfos); i++)</div>
<div class="line">                {</div>
<div class="line">                ri = <a class="code" href="safestack_8h.html#a546bb94aa3a8b2cb44c8bcef75da1a01">sk_CMS_RecipientInfo_value</a>(rinfos, i);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="cms_8h.html#a44fec504f4ab356a6095f25527aabc46">CMS_RecipientInfo_encrypt</a>(cms, ri) &lt;= 0)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#ae35927bfd818290e5affff1a96ef33c6">CMS_F_CMS_ENVELOPEDDATA_INIT_BIO</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#ab0d306b14288eeebeec749a1fddbbe82">CMS_R_ERROR_SETTING_RECIPIENTINFO</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        cms_env_set_version(cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>);</div>
<div class="line"></div>
<div class="line">        ok = 1;</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line">        ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a42d15187520e31613b3d2c47c79fa8dd">cipher</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="crypto_8h.html#a2aa47e40c63b05d00e9a780592f2a2b8">OPENSSL_cleanse</a>(ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a>);</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>);</div>
<div class="line">                ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a> = 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (ok)</div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line">        <a class="code" href="bio_8h.html#abbfb67b5eb998ce232f2482b097da8b2">BIO_free</a>(ret);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a904bcd4685600e69c9cadfc48e4c3e7c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cms__lcl_8h.html#a4cb65b7d7c915efc367f5e1e999440d9">CMS_EnvelopedData</a>* cms_get0_enveloped </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l00074">74</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#aae0b0e1c6da4732f18167de51c9eb9e5">contentType</a>) != <a class="code" href="obj__mac_8h.html#a4587e848643383571699c4b1fdaf5710">NID_pkcs7_enveloped</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a024f46d6ce854beb8be94aa80426e2cd">CMS_F_CMS_GET0_ENVELOPED</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a0407e04d7aee2109eaa028cc17096869">CMS_R_CONTENT_TYPE_NOT_ENVELOPED_DATA</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a013cca1c46db1e5c849677157326d3eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_ias_cert_cmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms__lcl_8h.html#a161c64a652f5a8893905640ecf4123b9">CMS_IssuerAndSerialNumber</a> *&#160;</td>
          <td class="paramname"><em>ias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00609">609</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret;</div>
<div class="line">        ret = <a class="code" href="x509_8h.html#ab52671f661dab2939d339792e9b30d37">X509_NAME_cmp</a>(ias-&gt;<a class="code" href="structCMS__IssuerAndSerialNumber__st.html#ae8924a6986383f83257f1c08c1ac301a">issuer</a>, <a class="code" href="x509_8h.html#ade3220b850537708545f660ee272d4e4">X509_get_issuer_name</a>(cert));</div>
<div class="line">        <span class="keywordflow">if</span> (ret)</div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="a__int_8c.html#aad8c36259e70b4071b2d90ee9e85ebf4">ASN1_INTEGER_cmp</a>(ias-&gt;<a class="code" href="structCMS__IssuerAndSerialNumber__st.html#aa44d6bf4b715606d29551da6bdad464f">serialNumber</a>, <a class="code" href="x509_8h.html#a667af4dd51a9a8cafefc3f6fb8fc23b8">X509_get_serialNumber</a>(cert));</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac7878a1f6e7641e2d71cc14cb69b209e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_keyid_cert_cmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> *&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00618">618</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="v3__purp_8c.html#ad14cac500b50cb3b5b1392af85d35e0d">X509_check_purpose</a>(cert, -1, -1);</div>
<div class="line">        <span class="keywordflow">if</span> (!cert-&gt;<a class="code" href="structx509__st.html#a6ebe771c246586c77c91f2deca26b84d">skid</a>)</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="a__octet_8c.html#a9a5442543cd9a35a1bb6c50c21f890c4">ASN1_OCTET_STRING_cmp</a>(keyid, cert-&gt;<a class="code" href="structx509__st.html#a6ebe771c246586c77c91f2deca26b84d">skid</a>);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a59155921f635636542bf47f780acc979"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_msgSigDigest_add1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a3f38c8c8e63c9af0a13f373f9f9df2f5">CMS_SignerInfo</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__ess_8c_source.html#l00209">209</a> of file <a class="el" href="cms__ess_8c_source.html">cms_ess.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> dig[<a class="code" href="evp_8h.html#a71bfc78a168f00f0c4ffd2535082b129">EVP_MAX_MD_SIZE</a>];</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> diglen;</div>
<div class="line">        <span class="keywordflow">if</span> (!cms_msgSigDigest(src, dig, &amp;diglen))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a0b9af42b4cb5106ebc14b28ff58d93c5">CMS_F_CMS_MSGSIGDIGEST_ADD1</a>, <a class="code" href="cms_8h.html#a9f5d6cdd1764fed539c9f80d1fb5089b">CMS_R_MSGSIGDIGEST_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="cms_8h.html#ac54e63b2827670c7b82c449f536ae59d">CMS_signed_add1_attr_by_NID</a>(dest, <a class="code" href="obj__mac_8h.html#a747def753157b80d18a7b1a0b6be60df">NID_id_smime_aa_msgSigDigest</a>,</div>
<div class="line">                                        <a class="code" href="asn1_8h.html#ab7338bcfcfbbd8f90c680759f373663b">V_ASN1_OCTET_STRING</a>, dig, diglen))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a0b9af42b4cb5106ebc14b28ff58d93c5">CMS_F_CMS_MSGSIGDIGEST_ADD1</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4175d1c76c8093fb8a0f61c77a62fd86"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_pkey_get_ri_type </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>pk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__env_8c_source.html#l01043">1043</a> of file <a class="el" href="cms__env_8c_source.html">cms_env.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (pk-&gt;<a class="code" href="structevp__pkey__st.html#a89d9cab6071d889719126a8ebc03b673">ameth</a> &amp;&amp; pk-&gt;<a class="code" href="structevp__pkey__st.html#a89d9cab6071d889719126a8ebc03b673">ameth</a>-&gt;<a class="code" href="structevp__pkey__asn1__method__st.html#acf78fd1a5c1abf3cf46222e3c2bfc659">pkey_ctrl</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordtype">int</span> i, r;</div>
<div class="line">                i = pk-&gt;<a class="code" href="structevp__pkey__st.html#a89d9cab6071d889719126a8ebc03b673">ameth</a>-&gt;<a class="code" href="structevp__pkey__asn1__method__st.html#acf78fd1a5c1abf3cf46222e3c2bfc659">pkey_ctrl</a>(pk, <a class="code" href="evp_8h.html#aee6545cbc20437eaa64a9cbdaf593619">ASN1_PKEY_CTRL_CMS_RI_TYPE</a>, 0, &amp;r);</div>
<div class="line">                <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line">                        <span class="keywordflow">return</span> r;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="cms_8h.html#a16bd2b791fd7cc36a235fe459226ebfa">CMS_RECIPINFO_TRANS</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8e3f30d1637a47523fdb553550a6aaf6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_Receipt_verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>req_cms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__ess_8c_source.html#l00229">229</a> of file <a class="el" href="cms__ess_8c_source.html">cms_ess.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> r = 0, i;</div>
<div class="line">        <a class="code" href="cms_8h.html#ad6b0df3c7c986cf29209828f9e31c523">CMS_ReceiptRequest</a> *rr = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structCMS__Receipt__st.html">CMS_Receipt</a> *rct = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__SignerInfo__st.html">CMS_SignerInfo</a>) *sis, *osis;</div>
<div class="line">        <a class="code" href="structCMS__SignerInfo__st.html">CMS_SignerInfo</a> *si, *osi = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> *msig, **pcont;</div>
<div class="line">        <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *octype;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> dig[<a class="code" href="evp_8h.html#a71bfc78a168f00f0c4ffd2535082b129">EVP_MAX_MD_SIZE</a>];</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> diglen;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Get SignerInfos, also checks SignedData content type */</span></div>
<div class="line">        osis = CMS_get0_SignerInfos(req_cms);</div>
<div class="line">        sis = CMS_get0_SignerInfos(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!osis || !sis)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="safestack_8h.html#a60f8dafbf2a20918520d0f334fcd8be6">sk_CMS_SignerInfo_num</a>(sis) != 1)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>, <a class="code" href="cms_8h.html#abd680d0fa6e388cc7d6d78790c42d0ea">CMS_R_NEED_ONE_SIGNER</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Check receipt content type */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(<a class="code" href="cms_8h.html#ab0a011907cfe668a473f918ccbab301d">CMS_get0_eContentType</a>(cms)) != <a class="code" href="obj__mac_8h.html#af2ef6f53a32ba0f8dd0b3377bedc02d0">NID_id_smime_ct_receipt</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>, <a class="code" href="cms_8h.html#a8faeb882bae14e4e12b5144bb376dcc2">CMS_R_NOT_A_SIGNED_RECEIPT</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Extract and decode receipt content */</span></div>
<div class="line">        pcont = <a class="code" href="cms_8h.html#aed4845b6010a2e1988ca0234cbfa3b18">CMS_get0_content</a>(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!pcont || !*pcont)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>, <a class="code" href="cms_8h.html#a4cb3ddc7ed52aeb2019880b240d1a74f">CMS_R_NO_CONTENT</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        rct = <a class="code" href="asn1_8h.html#a09f402541f23919a85a38a0a3cadb914">ASN1_item_unpack</a>(*pcont, <a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(<a class="code" href="structCMS__Receipt__st.html">CMS_Receipt</a>));</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!rct)       </div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>, <a class="code" href="cms_8h.html#a2876d00a7792f29c9ad4a75be68a8f69">CMS_R_RECEIPT_DECODE_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Locate original request */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a60f8dafbf2a20918520d0f334fcd8be6">sk_CMS_SignerInfo_num</a>(osis); i++)</div>
<div class="line">                {</div>
<div class="line">                osi = <a class="code" href="safestack_8h.html#a6b01d6da466a0cfe0bf35f47870735ae">sk_CMS_SignerInfo_value</a>(osis, i);</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="asn1_8h.html#a301393c164d61c40976d2971a358164f">ASN1_STRING_cmp</a>(osi-&gt;<a class="code" href="structCMS__SignerInfo__st.html#aee2347ee93351b9d44fb978a71295ca8">signature</a>,</div>
<div class="line">                                        rct-&gt;<a class="code" href="structCMS__Receipt__st.html#a97d8eea00219d7075145441834018527">originatorSignatureValue</a>))</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (i == <a class="code" href="safestack_8h.html#a60f8dafbf2a20918520d0f334fcd8be6">sk_CMS_SignerInfo_num</a>(osis))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>, <a class="code" href="cms_8h.html#a6c6e7c179f9ba847a46ff8fd62040223">CMS_R_NO_MATCHING_SIGNATURE</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        si = <a class="code" href="safestack_8h.html#a6b01d6da466a0cfe0bf35f47870735ae">sk_CMS_SignerInfo_value</a>(sis, 0);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Get msgSigDigest value and compare */</span></div>
<div class="line"></div>
<div class="line">        msig = <a class="code" href="cms_8h.html#af1803123210af8b7304b66eb4c704941">CMS_signed_get0_data_by_OBJ</a>(si,</div>
<div class="line">                                <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="obj__mac_8h.html#a747def753157b80d18a7b1a0b6be60df">NID_id_smime_aa_msgSigDigest</a>),</div>
<div class="line">                                        -3, <a class="code" href="asn1_8h.html#ab7338bcfcfbbd8f90c680759f373663b">V_ASN1_OCTET_STRING</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!msig)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>, <a class="code" href="cms_8h.html#af5be1545206725e8206e07d83572537d">CMS_R_NO_MSGSIGDIGEST</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!cms_msgSigDigest(osi, dig, &amp;diglen))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>, <a class="code" href="cms_8h.html#a9f5d6cdd1764fed539c9f80d1fb5089b">CMS_R_MSGSIGDIGEST_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (diglen != (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)msig-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#ae6aabfd4a80e3663df4f2dec244afec5">CMS_R_MSGSIGDIGEST_WRONG_LENGTH</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(dig, msig-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>, diglen))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#afb33e9388a7ad0416830cf0aa4f26cc9">CMS_R_MSGSIGDIGEST_VERIFICATION_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Compare content types */</span></div>
<div class="line"></div>
<div class="line">        octype = <a class="code" href="cms_8h.html#af1803123210af8b7304b66eb4c704941">CMS_signed_get0_data_by_OBJ</a>(osi,</div>
<div class="line">                                <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="obj__mac_8h.html#ac141d207d6e4810d04a02180f2142b00">NID_pkcs9_contentType</a>),</div>
<div class="line">                                        -3, <a class="code" href="asn1_8h.html#aa8aa9044005ad5fec5af188c7c1bd186">V_ASN1_OBJECT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!octype)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>, <a class="code" href="cms_8h.html#a315dac2b2cfc6ee517e8dafa92b56a7f">CMS_R_NO_CONTENT_TYPE</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Compare details in receipt request */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="obj__lib_8c.html#a6d99bcc0e6b7ad3e012d53b9513c9656">OBJ_cmp</a>(octype, rct-&gt;<a class="code" href="structCMS__Receipt__st.html#a9e920f52ab68a7717100eec3ddb4c676">contentType</a>))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>, <a class="code" href="cms_8h.html#a27141fe451491203f154002af88d6fce">CMS_R_CONTENT_TYPE_MISMATCH</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Get original receipt request details */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="cms__ess_8c.html#a0dd87d2fec71b02c15c2fb504c086252">CMS_get1_ReceiptRequest</a>(osi, &amp;rr) &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>, <a class="code" href="cms_8h.html#a77a255f4d9b2a55cdbc0c0bd77b3c4a2">CMS_R_NO_RECEIPT_REQUEST</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#a301393c164d61c40976d2971a358164f">ASN1_STRING_cmp</a>(rr-&gt;signedContentIdentifier,</div>
<div class="line">                                        rct-&gt;<a class="code" href="structCMS__Receipt__st.html#ae6beb43eb9fa185af3c56bebca24596c">signedContentIdentifier</a>))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a07a945524b609f3976c0fe852ad7558a">CMS_F_CMS_RECEIPT_VERIFY</a>,</div>
<div class="line">                                        <a class="code" href="cms_8h.html#a54d94a3135e8cac7ded5fa3e4aee6378">CMS_R_CONTENTIDENTIFIER_MISMATCH</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        r = 1;</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (rr)</div>
<div class="line">                CMS_ReceiptRequest_free(rr);</div>
<div class="line">        <span class="keywordflow">if</span> (rct)</div>
<div class="line">                <a class="code" href="asn1_8h.html#a64344e58b69188c21fd5ec2abe3a4a38">M_ASN1_free_of</a>(rct, <a class="code" href="structCMS__Receipt__st.html">CMS_Receipt</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> r;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a178c4432e47cc12081fd3e4e28910092"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_RecipientInfo_kari_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__kari_8c_source.html#l00429">429</a> of file <a class="el" href="cms__kari_8c_source.html">cms_kari.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html">CMS_KeyAgreeRecipientInfo</a> *kari;</div>
<div class="line">        <a class="code" href="structCMS__EncryptedContentInfo__st.html">CMS_EncryptedContentInfo</a> *ec;</div>
<div class="line">        <a class="code" href="structCMS__RecipientEncryptedKey__st.html">CMS_RecipientEncryptedKey</a> *rek;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__RecipientEncryptedKey__st.html">CMS_RecipientEncryptedKey</a>) *reks;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> != <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a58ff144816f61684193afd1144a81ba7">CMS_F_CMS_RECIPIENTINFO_KARI_ENCRYPT</a>,</div>
<div class="line">                        <a class="code" href="cms_8h.html#a3dafd7ae00cc336b974db955156f890f">CMS_R_NOT_KEY_AGREEMENT</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        kari = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>;</div>
<div class="line">        reks = kari-&gt;recipientEncryptedKeys;</div>
<div class="line">        ec = cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>-&gt;<a class="code" href="structCMS__EnvelopedData__st.html#a61ff72488726aa8cf3191e2e1cacc97d">encryptedContentInfo</a>;</div>
<div class="line">        <span class="comment">/* Initialise wrap algorithm parameters */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!cms_wrap_init(kari, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a42d15187520e31613b3d2c47c79fa8dd">cipher</a>))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="comment">/* If no orignator key set up initialise for ephemeral key</span></div>
<div class="line"><span class="comment">         * the public key ASN1 structure will set the actual public</span></div>
<div class="line"><span class="comment">         * key value.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (kari-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a5230303cf63716c151f7f7cc2b86d816">originator</a>-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a005783130889ef0e2100e219fc19ae02">type</a> == -1)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html">CMS_OriginatorIdentifierOrKey</a> *oik = kari-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a5230303cf63716c151f7f7cc2b86d816">originator</a>;</div>
<div class="line">                oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a005783130889ef0e2100e219fc19ae02">type</a> = <a class="code" href="cms__lcl_8h.html#a7ca4de9879cff722eab3b9ebf9cc73ea">CMS_OIK_PUBKEY</a>;</div>
<div class="line">                oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a28bc4aea3dfb2aa4c8f27cb7d0d4f673">d</a>.<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#ac5559321f5be1422ebbc138590e48c96">originatorKey</a> = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__OriginatorPublicKey__st.html">CMS_OriginatorPublicKey</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (!oik-&gt;<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#a28bc4aea3dfb2aa4c8f27cb7d0d4f673">d</a>.<a class="code" href="structCMS__OriginatorIdentifierOrKey__st.html#ac5559321f5be1422ebbc138590e48c96">originatorKey</a>)</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="comment">/* Initialise KDF algorithm */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="cms__env_8c.html#ac35f315f7ccd6ac91196b3ec171dc0cc">cms_env_asn1_ctrl</a>(ri, 0))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="comment">/* For each rek, derive KEK, encrypt CEK */</span></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#aba16160d72d9c247493142e2eef84755">sk_CMS_RecipientEncryptedKey_num</a>(reks); i++)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *enckey;</div>
<div class="line">                <span class="keywordtype">size_t</span> enckeylen;</div>
<div class="line">                rek = <a class="code" href="safestack_8h.html#a59a9c2dd94c0a85865041952a7d152fa">sk_CMS_RecipientEncryptedKey_value</a>(reks, i);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#a8b9b4ce1541519c3e1d9de5c7ba3db15">EVP_PKEY_derive_set_peer</a>(kari-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#a72c16b9727ba03e41e28085f501a290b">pctx</a>, rek-&gt;<a class="code" href="structCMS__RecipientEncryptedKey__st.html#a28a9a4782cb4ec8380fd2f7b4984e49d">pkey</a>) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                <span class="keywordflow">if</span> (!cms_kek_cipher(&amp;enckey, &amp;enckeylen, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a>,</div>
<div class="line">                                                                kari, 1))</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                <a class="code" href="asn1_8h.html#add085933f3a303f7c59acf0e9b072d63">ASN1_STRING_set0</a>(rek-&gt;<a class="code" href="structCMS__RecipientEncryptedKey__st.html#af861a7676bfae5f3f4ce5c5b7ba044af">encryptedKey</a>, enckey, enckeylen);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acf47dd02ab24b071a4539c0eae072a73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_RecipientInfo_kari_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>recip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__kari_8c_source.html#l00354">354</a> of file <a class="el" href="cms__kari_8c_source.html">cms_kari.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html">CMS_KeyAgreeRecipientInfo</a> *kari;</div>
<div class="line">        <a class="code" href="structCMS__RecipientEncryptedKey__st.html">CMS_RecipientEncryptedKey</a> *rek = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a> = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html">CMS_KeyAgreeRecipientInfo</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a9f2d873cfd8472c69844df802bd71f13">type</a> = <a class="code" href="cms_8h.html#acef9d700f8704eef4c8cef466d2ccce2">CMS_RECIPINFO_AGREE</a>;</div>
<div class="line"></div>
<div class="line">        kari = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#a1df83734b1f23faba9b9bb5a580e6211">kari</a>;</div>
<div class="line">        kari-&gt;<a class="code" href="structCMS__KeyAgreeRecipientInfo__st.html#ada88fbb3bd7e460c0310d3aa1b1e9214">version</a> = 3;</div>
<div class="line"></div>
<div class="line">        rek = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__RecipientEncryptedKey__st.html">CMS_RecipientEncryptedKey</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#a198e9cf5c5935dd6d981cb38000c4863">sk_CMS_RecipientEncryptedKey_push</a>(kari-&gt;recipientEncryptedKeys, rek))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="asn1_8h.html#a64344e58b69188c21fd5ec2abe3a4a38">M_ASN1_free_of</a>(rek, <a class="code" href="structCMS__RecipientEncryptedKey__st.html">CMS_RecipientEncryptedKey</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="cms_8h.html#ae4670dfe3e27c5494ea55bc9f7a70296">CMS_USE_KEYID</a>)</div>
<div class="line">                {</div>
<div class="line">                rek-&gt;<a class="code" href="structCMS__RecipientEncryptedKey__st.html#a46ec8673f0d9bbdd9a66ab7b28ebc433">rid</a>-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#a9e09b503569a350cbe02daaa6e4334ad">type</a> = <a class="code" href="cms__lcl_8h.html#ae29b7278fde140f345e7425e33192372">CMS_REK_KEYIDENTIFIER</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="cms__lcl_8h.html#aedcc935c2d546a5704b460ccf277e053">cms_set1_keyid</a>(&amp;rek-&gt;<a class="code" href="structCMS__RecipientEncryptedKey__st.html#a46ec8673f0d9bbdd9a66ab7b28ebc433">rid</a>-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#af94b30a9481c62573166ae4982d42fbb">d</a>.<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#a5dc8e9dd2f255a0e008f6355ec5e419f">rKeyId</a>-&gt;<a class="code" href="structCMS__RecipientKeyIdentifier__st.html#a81e57ea93d5273862f46b808b54af56b">subjectKeyIdentifier</a>, recip))</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                rek-&gt;<a class="code" href="structCMS__RecipientEncryptedKey__st.html#a46ec8673f0d9bbdd9a66ab7b28ebc433">rid</a>-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#a9e09b503569a350cbe02daaa6e4334ad">type</a> = <a class="code" href="cms__lcl_8h.html#adcf4c7b7ee4fafcba3324805c9896392">CMS_REK_ISSUER_SERIAL</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="cms__lcl_8h.html#af1abd64a7d3f7b9e06fcd1111652ea00">cms_set1_ias</a>(&amp;rek-&gt;<a class="code" href="structCMS__RecipientEncryptedKey__st.html#a46ec8673f0d9bbdd9a66ab7b28ebc433">rid</a>-&gt;<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#af94b30a9481c62573166ae4982d42fbb">d</a>.<a class="code" href="structCMS__KeyAgreeRecipientIdentifier__st.html#afb51fb2a4dafcde2a4d39ef2e29ec866">issuerAndSerialNumber</a>, recip))</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Create ephemeral key */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!cms_kari_create_ephemeral_key(kari, pk))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="crypto_8h.html#ab8556c4f12443f1876ce487dd0c8db27">CRYPTO_add</a>(&amp;pk-&gt;<a class="code" href="structevp__pkey__st.html#a89b11b788ffad7d747d1c7eed4cf279f">references</a>, 1, <a class="code" href="crypto_8h.html#aee0129d89ab09d6bccecd1ce55307584">CRYPTO_LOCK_EVP_PKEY</a>);</div>
<div class="line">        rek-&gt;<a class="code" href="structCMS__RecipientEncryptedKey__st.html#a28a9a4782cb4ec8380fd2f7b4984e49d">pkey</a> = pk;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a23e449de7f0b59882111f6025b6403f4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_RecipientInfo_pwri_crypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cms_8h.html#ac5c9066f9d23a39dc973dd8821304756">CMS_RecipientInfo</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>en_de</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__pwri_8c_source.html#l00324">324</a> of file <a class="el" href="cms__pwri_8c_source.html">cms_pwri.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__EncryptedContentInfo__st.html">CMS_EncryptedContentInfo</a> *ec;</div>
<div class="line">        <a class="code" href="structCMS__PasswordRecipientInfo__st.html">CMS_PasswordRecipientInfo</a> *pwri;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> plen;</div>
<div class="line">        <span class="keywordtype">int</span> r = 0;</div>
<div class="line">        <a class="code" href="structX509__algor__st.html">X509_ALGOR</a> *algtmp, *kekalg = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structevp__cipher__ctx__st.html">EVP_CIPHER_CTX</a> kekctx;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structevp__cipher__st.html">EVP_CIPHER</a> *kekcipher;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">size_t</span> keylen;</div>
<div class="line"></div>
<div class="line">        ec = cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#a9b7f4b2c1c079c4f2803c9d238bac3b8">envelopedData</a>-&gt;<a class="code" href="structCMS__EnvelopedData__st.html#a61ff72488726aa8cf3191e2e1cacc97d">encryptedContentInfo</a>;</div>
<div class="line"></div>
<div class="line">        pwri = ri-&gt;<a class="code" href="structCMS__RecipientInfo__st.html#a3cf345049f14144cbdee1ee1d29d39cf">d</a>.<a class="code" href="structCMS__RecipientInfo__st.html#af50e43fa59b8416cfc0a31cc74805aca">pwri</a>;</div>
<div class="line">        <a class="code" href="evp_8h.html#ad32900fec7d9cb579e5d0bad7a4e1daa">EVP_CIPHER_CTX_init</a>(&amp;kekctx);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#ac8796b7e1a95c563a56015c5f42eb47e">pass</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a4c23192ef7c2b91b8760a454380d2de7">CMS_F_CMS_RECIPIENTINFO_PWRI_CRYPT</a>, <a class="code" href="cms_8h.html#a24ba42a81c73436b8da937f56185d745">CMS_R_NO_PASSWORD</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        algtmp = pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#abaa7dcab8ae9e0969cffc43f4ba4bd13">keyEncryptionAlgorithm</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!algtmp || <a class="code" href="obj__dat_8c.html#a8b51f927a6f1ee63665c43ef6fc98552">OBJ_obj2nid</a>(algtmp-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a>) != <a class="code" href="obj__mac_8h.html#a9c9b8533d6d319e89277ab17f83c2374">NID_id_alg_PWRI_KEK</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a4c23192ef7c2b91b8760a454380d2de7">CMS_F_CMS_RECIPIENTINFO_PWRI_CRYPT</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#ae91540d4d6a51fc2ae4021a33d111f9d">CMS_R_UNSUPPORTED_KEY_ENCRYPTION_ALGORITHM</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (algtmp-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a>-&gt;<a class="code" href="structasn1__type__st.html#af1bd6ef16c406f3cd3fa67eb81693b54">type</a> == <a class="code" href="asn1_8h.html#ab76fef5a089d894b827029a84a6f4f7a">V_ASN1_SEQUENCE</a>)</div>
<div class="line">                {</div>
<div class="line">                p = algtmp-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a>-&gt;<a class="code" href="structasn1__type__st.html#ab37a86242c23b20bd17ee2adb4678e38">value</a>.<a class="code" href="structasn1__type__st.html#a3799edca9238b6a1cb9604ed8ffdfb54">sequence</a>-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>;</div>
<div class="line">                plen = algtmp-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a>-&gt;<a class="code" href="structasn1__type__st.html#ab37a86242c23b20bd17ee2adb4678e38">value</a>.<a class="code" href="structasn1__type__st.html#a3799edca9238b6a1cb9604ed8ffdfb54">sequence</a>-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>;</div>
<div class="line">                kekalg = d2i_X509_ALGOR(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, &amp;p, plen);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (kekalg == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a4c23192ef7c2b91b8760a454380d2de7">CMS_F_CMS_RECIPIENTINFO_PWRI_CRYPT</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#aeb8794764b9fdbd0a746c676be282791">CMS_R_INVALID_KEY_ENCRYPTION_PARAMETER</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        kekcipher = <a class="code" href="evp_8h.html#a359c5ec316dfeb6d04e2f146d9b0484d">EVP_get_cipherbyobj</a>(kekalg-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a>);</div>
<div class="line">                </div>
<div class="line">        <span class="keywordflow">if</span>(!kekcipher)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a4c23192ef7c2b91b8760a454380d2de7">CMS_F_CMS_RECIPIENTINFO_PWRI_CRYPT</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a7ced89b08b244602676ca478190f6c91">CMS_R_UNKNOWN_CIPHER</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Fixup cipher based on AlgorithmIdentifier to set IV etc */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="evp_8h.html#aab11ae066491958c229882a364c3feb8">EVP_CipherInit_ex</a>(&amp;kekctx, kekcipher, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, en_de))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <a class="code" href="evp_8h.html#a171bd50b3014686da08759b1282d5a53">EVP_CIPHER_CTX_set_padding</a>(&amp;kekctx, 0);</div>
<div class="line">        <span class="keywordflow">if</span>(<a class="code" href="evp_8h.html#ab4235d136f646de5e37bc7521bafedc8">EVP_CIPHER_asn1_to_param</a>(&amp;kekctx, kekalg-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a>) &lt; 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a4c23192ef7c2b91b8760a454380d2de7">CMS_F_CMS_RECIPIENTINFO_PWRI_CRYPT</a>,</div>
<div class="line">                                <a class="code" href="cms_8h.html#a8f810f38c4d363007aaf06a17919f61f">CMS_R_CIPHER_PARAMETER_INITIALISATION_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        algtmp = pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#ada13747d28a08335dbc4381df2c796ac">keyDerivationAlgorithm</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Finish password based key derivation to setup key in &quot;ctx&quot; */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="evp_8h.html#a7bd14b793dd2b4962301dfc2fd1551a5">EVP_PBE_CipherInit</a>(algtmp-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a>,</div>
<div class="line">                                (<span class="keywordtype">char</span> *)pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#ac8796b7e1a95c563a56015c5f42eb47e">pass</a>, pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#ab064037ca54c55063d6f422ad094323f">passlen</a>,</div>
<div class="line">                                algtmp-&gt;<a class="code" href="structX509__algor__st.html#a0c0f294d859665c5b1e6d86c695ac4e1">parameter</a>, &amp;kekctx, en_de) &lt; 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a4c23192ef7c2b91b8760a454380d2de7">CMS_F_CMS_RECIPIENTINFO_PWRI_CRYPT</a>, <a class="code" href="err_8h.html#a8959418b04c171c02dbacbd298326e2f">ERR_R_EVP_LIB</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Finally wrap/unwrap the key */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (en_de)</div>
<div class="line">                {</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (!kek_wrap_key(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, &amp;keylen, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a>, &amp;kekctx))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">                key = <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(keylen);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (!key)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (!kek_wrap_key(key, &amp;keylen, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a>, ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a>, &amp;kekctx))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#a454c7126250cabffe93681f9fa5e7052">encryptedKey</a>-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a> = <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>;</div>
<div class="line">                pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#a454c7126250cabffe93681f9fa5e7052">encryptedKey</a>-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a> = keylen;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                key = <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#a454c7126250cabffe93681f9fa5e7052">encryptedKey</a>-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (!key)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a4c23192ef7c2b91b8760a454380d2de7">CMS_F_CMS_RECIPIENTINFO_PWRI_CRYPT</a>,</div>
<div class="line">                                                        <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (!kek_unwrap_key(key, &amp;keylen,</div>
<div class="line">                                        pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#a454c7126250cabffe93681f9fa5e7052">encryptedKey</a>-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>,</div>
<div class="line">                                        pwri-&gt;<a class="code" href="structCMS__PasswordRecipientInfo__st.html#a454c7126250cabffe93681f9fa5e7052">encryptedKey</a>-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>, &amp;kekctx))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a4c23192ef7c2b91b8760a454380d2de7">CMS_F_CMS_RECIPIENTINFO_PWRI_CRYPT</a>,</div>
<div class="line">                                                        <a class="code" href="cms_8h.html#a6e89c9021038aa0f4961ef1d6f222b06">CMS_R_UNWRAP_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a07604ea895cfab1afb5fcccf72fc0706">key</a> = <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>;</div>
<div class="line">                ec-&gt;<a class="code" href="structCMS__EncryptedContentInfo__st.html#a7609a5affd1037e9313029db3d095676">keylen</a> = keylen;</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        r = 1;</div>
<div class="line"></div>
<div class="line">        err:</div>
<div class="line"></div>
<div class="line">        <a class="code" href="evp_8h.html#a41a7598b73c126d9f881296cad6305b8">EVP_CIPHER_CTX_cleanup</a>(&amp;kekctx);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!r &amp;&amp; key)</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(key);</div>
<div class="line">        X509_ALGOR_free(kekalg);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> r;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af1abd64a7d3f7b9e06fcd1111652ea00"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_set1_ias </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms__lcl_8h.html#a161c64a652f5a8893905640ecf4123b9">CMS_IssuerAndSerialNumber</a> **&#160;</td>
          <td class="paramname"><em>pias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00626">626</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structCMS__IssuerAndSerialNumber__st.html">CMS_IssuerAndSerialNumber</a> *ias;</div>
<div class="line">        ias = <a class="code" href="asn1_8h.html#ae2f9bfe2b1e8a6b13251fb01ca2dc25c">M_ASN1_new_of</a>(<a class="code" href="structCMS__IssuerAndSerialNumber__st.html">CMS_IssuerAndSerialNumber</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!ias)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="x__name_8c.html#a2b7f33760c1ad95f513ef3d835cf516f">X509_NAME_set</a>(&amp;ias-&gt;<a class="code" href="structCMS__IssuerAndSerialNumber__st.html#ae8924a6986383f83257f1c08c1ac301a">issuer</a>, <a class="code" href="x509_8h.html#ade3220b850537708545f660ee272d4e4">X509_get_issuer_name</a>(cert)))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="asn1_8h.html#a63d50d2a45b9743786df314cb856c55c">ASN1_STRING_copy</a>(ias-&gt;<a class="code" href="structCMS__IssuerAndSerialNumber__st.html#aa44d6bf4b715606d29551da6bdad464f">serialNumber</a>, <a class="code" href="x509_8h.html#a667af4dd51a9a8cafefc3f6fb8fc23b8">X509_get_serialNumber</a>(cert)))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (*pias)</div>
<div class="line">                <a class="code" href="asn1_8h.html#a64344e58b69188c21fd5ec2abe3a4a38">M_ASN1_free_of</a>(*pias, <a class="code" href="structCMS__IssuerAndSerialNumber__st.html">CMS_IssuerAndSerialNumber</a>);</div>
<div class="line">        *pias = ias;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (ias)</div>
<div class="line">                <a class="code" href="asn1_8h.html#a64344e58b69188c21fd5ec2abe3a4a38">M_ASN1_free_of</a>(ias, <a class="code" href="structCMS__IssuerAndSerialNumber__st.html">CMS_IssuerAndSerialNumber</a>);</div>
<div class="line">        <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a56afcc0b4f6ae8e72f2f2d367747c3c0">CMS_F_CMS_SET1_IAS</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aedcc935c2d546a5704b460ccf277e053"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_set1_keyid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **&#160;</td>
          <td class="paramname"><em>pkeyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__lib_8c_source.html#l00647">647</a> of file <a class="el" href="cms__lib_8c_source.html">cms_lib.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> *keyid = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="v3__purp_8c.html#ad14cac500b50cb3b5b1392af85d35e0d">X509_check_purpose</a>(cert, -1, -1);</div>
<div class="line">        <span class="keywordflow">if</span> (!cert-&gt;<a class="code" href="structx509__st.html#a6ebe771c246586c77c91f2deca26b84d">skid</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a13e1d37542421bef355e03450ca36499">CMS_F_CMS_SET1_KEYID</a>, <a class="code" href="cms_8h.html#a05a57d82abc5030a5340dce444a84d98">CMS_R_CERTIFICATE_HAS_NO_KEYID</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        keyid = <a class="code" href="asn1_8h.html#a2537a429bafad3dac54a01d4bea4a0cc">ASN1_STRING_dup</a>(cert-&gt;<a class="code" href="structx509__st.html#a6ebe771c246586c77c91f2deca26b84d">skid</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!keyid)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#a13e1d37542421bef355e03450ca36499">CMS_F_CMS_SET1_KEYID</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (*pkeyid)</div>
<div class="line">                ASN1_OCTET_STRING_free(*pkeyid);</div>
<div class="line">        *pkeyid = keyid;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae2f46d9be341636d0e22d58d86fb7c1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_set1_SignerIdentifier </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms__lcl_8h.html#ae014235d4e06243d4ec1b9ac00cc0315">CMS_SignerIdentifier</a> *&#160;</td>
          <td class="paramname"><em>sid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00211">211</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">switch</span>(<a class="code" href="e__aes_8c.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#aa90a5540395664981482a8f6aa9e5e33">CMS_SIGNERINFO_ISSUER_SERIAL</a>:</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="cms__lcl_8h.html#af1abd64a7d3f7b9e06fcd1111652ea00">cms_set1_ias</a>(&amp;sid-&gt;<a class="code" href="structCMS__SignerIdentifier__st.html#a4c826dd9127fe3254f61ac9ba083e089">d</a>.<a class="code" href="structCMS__SignerIdentifier__st.html#a0e446b4a9385e947da9678125042ba15">issuerAndSerialNumber</a>, cert))</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="cms_8h.html#ad42a4799f8919e59919223af98623ca0">CMS_SIGNERINFO_KEYIDENTIFIER</a>:</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="cms__lcl_8h.html#aedcc935c2d546a5704b460ccf277e053">cms_set1_keyid</a>(&amp;sid-&gt;<a class="code" href="structCMS__SignerIdentifier__st.html#a4c826dd9127fe3254f61ac9ba083e089">d</a>.<a class="code" href="structCMS__SignerIdentifier__st.html#a5b7e3008060b95223bc13cd335c40f34">subjectKeyIdentifier</a>, cert))</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                <a class="code" href="err_8h.html#a7f1e52a75a4c3d2ee7541c219a79617a">CMSerr</a>(<a class="code" href="cms_8h.html#aca9ac7d7daad952eb717b68b6018c314">CMS_F_CMS_SET1_SIGNERIDENTIFIER</a>, <a class="code" href="cms_8h.html#ac9bcaaf30c0d054b260b256208cf0bbf">CMS_R_UNKNOWN_ID</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        sid-&gt;<a class="code" href="structCMS__SignerIdentifier__st.html#a8e06fab2a2986e15ae733216cba6a09e">type</a> = <a class="code" href="e__aes_8c.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeaa6987a61ee75542fde7e9d4b5dbe56"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_SignedData_final </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>chain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00717">717</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCMS__SignerInfo__st.html">CMS_SignerInfo</a>) *sinfos;</div>
<div class="line">        <a class="code" href="structCMS__SignerInfo__st.html">CMS_SignerInfo</a> *si;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        sinfos = CMS_get0_SignerInfos(cms);</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a60f8dafbf2a20918520d0f334fcd8be6">sk_CMS_SignerInfo_num</a>(sinfos); i++)</div>
<div class="line">                {</div>
<div class="line">                si = <a class="code" href="safestack_8h.html#a6b01d6da466a0cfe0bf35f47870735ae">sk_CMS_SignerInfo_value</a>(sinfos, i);</div>
<div class="line">                <span class="keywordflow">if</span> (!cms_SignerInfo_content_sign(cms, si, chain))</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#aa4afa3c04a5347cfe6f27f4fe2aa94d0">signedData</a>-&gt;<a class="code" href="structCMS__SignedData__st.html#a258881ecd96a6577de4ae0bbf605980e">encapContentInfo</a>-&gt;<a class="code" href="structCMS__EncapsulatedContentInfo__st.html#ad9d37ab0702d6cdbd3106fb22b3dd3e3">partial</a> = 0;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0ab3d20e8cc3de71f04703dfa7c62017"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* cms_SignedData_init_bio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms_8h.html#a8f6e99fcf6597c9d6ef2959736e697b3">CMS_ContentInfo</a> *&#160;</td>
          <td class="paramname"><em>cms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00850">850</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <a class="code" href="structCMS__SignedData__st.html">CMS_SignedData</a> *sd;</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *chain = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        sd = cms_get0_signed(cms);</div>
<div class="line">        <span class="keywordflow">if</span> (!sd)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (cms-&gt;<a class="code" href="structCMS__ContentInfo__st.html#a5d7048ed3f6cbbae2020c1d4e9e85197">d</a>.<a class="code" href="structCMS__ContentInfo__st.html#aa4afa3c04a5347cfe6f27f4fe2aa94d0">signedData</a>-&gt;<a class="code" href="structCMS__SignedData__st.html#a258881ecd96a6577de4ae0bbf605980e">encapContentInfo</a>-&gt;<a class="code" href="structCMS__EncapsulatedContentInfo__st.html#ad9d37ab0702d6cdbd3106fb22b3dd3e3">partial</a>)</div>
<div class="line">                cms_sd_set_version(sd);</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a94c75bbf81b8ad2a5ae09b10c8e47719">sk_X509_ALGOR_num</a>(sd-&gt;digestAlgorithms); i++)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structX509__algor__st.html">X509_ALGOR</a> *digestAlgorithm;</div>
<div class="line">                <a class="code" href="structbio__st.html">BIO</a> *mdbio;</div>
<div class="line">                digestAlgorithm = <a class="code" href="safestack_8h.html#a6f0738d8fab06b164ea825826b366fd0">sk_X509_ALGOR_value</a>(sd-&gt;digestAlgorithms, i);</div>
<div class="line">                mdbio = <a class="code" href="cms__lcl_8h.html#a149b22de836f8e10d2e6671d7c5b2847">cms_DigestAlgorithm_init_bio</a>(digestAlgorithm);</div>
<div class="line">                <span class="keywordflow">if</span> (!mdbio)</div>
<div class="line">                        <span class="keywordflow">goto</span> err;       </div>
<div class="line">                <span class="keywordflow">if</span> (chain)</div>
<div class="line">                         <a class="code" href="bio_8h.html#a4e509280cddd4eb3537fe7e3bc0827a9">BIO_push</a>(chain, mdbio);</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        chain = mdbio;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> chain;</div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (chain)</div>
<div class="line">                <a class="code" href="bio_8h.html#a9cc47fc222c166cd863e1dfb5467a14e">BIO_free_all</a>(chain);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae15c777be21e1c02be97ddf5bc27dc54"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_SignerIdentifier_cert_cmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms__lcl_8h.html#ae014235d4e06243d4ec1b9ac00cc0315">CMS_SignerIdentifier</a> *&#160;</td>
          <td class="paramname"><em>sid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00256">256</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (sid-&gt;<a class="code" href="structCMS__SignerIdentifier__st.html#a8e06fab2a2986e15ae733216cba6a09e">type</a> == <a class="code" href="cms_8h.html#aa90a5540395664981482a8f6aa9e5e33">CMS_SIGNERINFO_ISSUER_SERIAL</a>)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#a013cca1c46db1e5c849677157326d3eb">cms_ias_cert_cmp</a>(sid-&gt;<a class="code" href="structCMS__SignerIdentifier__st.html#a4c826dd9127fe3254f61ac9ba083e089">d</a>.<a class="code" href="structCMS__SignerIdentifier__st.html#a0e446b4a9385e947da9678125042ba15">issuerAndSerialNumber</a>, cert);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sid-&gt;<a class="code" href="structCMS__SignerIdentifier__st.html#a8e06fab2a2986e15ae733216cba6a09e">type</a> == <a class="code" href="cms_8h.html#ad42a4799f8919e59919223af98623ca0">CMS_SIGNERINFO_KEYIDENTIFIER</a>)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="cms__lcl_8h.html#ac7878a1f6e7641e2d71cc14cb69b209e">cms_keyid_cert_cmp</a>(sid-&gt;<a class="code" href="structCMS__SignerIdentifier__st.html#a4c826dd9127fe3254f61ac9ba083e089">d</a>.<a class="code" href="structCMS__SignerIdentifier__st.html#a5b7e3008060b95223bc13cd335c40f34">subjectKeyIdentifier</a>, cert);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a73e3ae14ece4aba2d5bcc38796b23907"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cms_SignerIdentifier_get0_signer_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cms__lcl_8h.html#ae014235d4e06243d4ec1b9ac00cc0315">CMS_SignerIdentifier</a> *&#160;</td>
          <td class="paramname"><em>sid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a5c5fc036757e87b9bd163d0221696533">X509_NAME</a> **&#160;</td>
          <td class="paramname"><em>issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **&#160;</td>
          <td class="paramname"><em>sno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cms__sd_8c_source.html#l00235">235</a> of file <a class="el" href="cms__sd_8c_source.html">cms_sd.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (sid-&gt;<a class="code" href="structCMS__SignerIdentifier__st.html#a8e06fab2a2986e15ae733216cba6a09e">type</a> == <a class="code" href="cms_8h.html#aa90a5540395664981482a8f6aa9e5e33">CMS_SIGNERINFO_ISSUER_SERIAL</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (issuer)</div>
<div class="line">                        *issuer = sid-&gt;<a class="code" href="structCMS__SignerIdentifier__st.html#a4c826dd9127fe3254f61ac9ba083e089">d</a>.<a class="code" href="structCMS__SignerIdentifier__st.html#a0e446b4a9385e947da9678125042ba15">issuerAndSerialNumber</a>-&gt;<a class="code" href="structCMS__IssuerAndSerialNumber__st.html#ae8924a6986383f83257f1c08c1ac301a">issuer</a>;</div>
<div class="line">                <span class="keywordflow">if</span> (sno)</div>
<div class="line">                        *sno = sid-&gt;<a class="code" href="structCMS__SignerIdentifier__st.html#a4c826dd9127fe3254f61ac9ba083e089">d</a>.<a class="code" href="structCMS__SignerIdentifier__st.html#a0e446b4a9385e947da9678125042ba15">issuerAndSerialNumber</a>-&gt;<a class="code" href="structCMS__IssuerAndSerialNumber__st.html#aa44d6bf4b715606d29551da6bdad464f">serialNumber</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sid-&gt;<a class="code" href="structCMS__SignerIdentifier__st.html#a8e06fab2a2986e15ae733216cba6a09e">type</a> == <a class="code" href="cms_8h.html#ad42a4799f8919e59919223af98623ca0">CMS_SIGNERINFO_KEYIDENTIFIER</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (keyid)</div>
<div class="line">                        *keyid = sid-&gt;<a class="code" href="structCMS__SignerIdentifier__st.html#a4c826dd9127fe3254f61ac9ba083e089">d</a>.<a class="code" href="structCMS__SignerIdentifier__st.html#a5b7e3008060b95223bc13cd335c40f34">subjectKeyIdentifier</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 15 2014 18:16:51 for openssl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
