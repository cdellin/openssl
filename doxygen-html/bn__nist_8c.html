<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/bn/bn_nist.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_bf4984ea57f5888de95a64cb80bbf1fb.html">bn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">bn_nist.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="bn__lcl_8h_source.html">bn_lcl.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cryptlib_8h_source.html">cryptlib.h</a>&quot;</code><br/>
</div>
<p><a href="bn__nist_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a9b2f0cf02d3b536f722df7db72e4b0af"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>&#160;&#160;&#160;(192+BN_BITS2-1)/BN_BITS2</td></tr>
<tr class="memitem:aa36a32c8406e656d39db3d6b5d99b069"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>&#160;&#160;&#160;(224+BN_BITS2-1)/BN_BITS2</td></tr>
<tr class="memitem:ad5049d296f6b68f7807ea504f70caab8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>&#160;&#160;&#160;(256+BN_BITS2-1)/BN_BITS2</td></tr>
<tr class="memitem:aece04c512a77ed2aaa689d5fe5c691a6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>&#160;&#160;&#160;(384+BN_BITS2-1)/BN_BITS2</td></tr>
<tr class="memitem:ad7301de5b30b8800f30738396fc5c3e1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#ad7301de5b30b8800f30738396fc5c3e1">BN_NIST_521_TOP</a>&#160;&#160;&#160;(521+BN_BITS2-1)/BN_BITS2</td></tr>
<tr class="memitem:a2a88bbbd5c4f2c419f286139944932d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a2a88bbbd5c4f2c419f286139944932d6">bn_cp_64</a>(to, n, from, m)</td></tr>
<tr class="memitem:ae74c9890dc91c8db7f27252f5193ca56"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#ae74c9890dc91c8db7f27252f5193ca56">bn_64_set_0</a>(to, n)</td></tr>
<tr class="memitem:a37e3333f384c9cb3f41de389ccc76ed4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a37e3333f384c9cb3f41de389ccc76ed4">bn_cp_32</a>(to, n, from, m)&#160;&#160;&#160;(to)[n] = (m&gt;=0)?((from)[m]):0;</td></tr>
<tr class="memitem:a21a8aed9b1746f90a0336bb7eb28d40a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a21a8aed9b1746f90a0336bb7eb28d40a">bn_32_set_0</a>(to, n)&#160;&#160;&#160;(to)[n] = (BN_ULONG)0;</td></tr>
<tr class="memitem:ad1478dc2df46f199950eb361182ba223"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#ad1478dc2df46f199950eb361182ba223">nist_set_192</a>(to, from, a1, a2, a3)</td></tr>
<tr class="memitem:a7db73a5fd660e5711078b66c7be983f3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a7db73a5fd660e5711078b66c7be983f3">nist_set_224</a>(to, from, a1, a2, a3, a4, a5, a6, a7)</td></tr>
<tr class="memitem:a0809aa8928b1953d389ac8b23516678f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a0809aa8928b1953d389ac8b23516678f">nist_set_256</a>(to, from, a1, a2, a3, a4, a5, a6, a7, a8)</td></tr>
<tr class="memitem:aba95fa994d7104c4fc293d373b263eb8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#aba95fa994d7104c4fc293d373b263eb8">nist_set_384</a>(to, from, a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12)</td></tr>
<tr class="memitem:acb71f0118dd01e5ac1acea36590bad76"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#acb71f0118dd01e5ac1acea36590bad76">BN_NIST_521_RSHIFT</a>&#160;&#160;&#160;(521%BN_BITS2)</td></tr>
<tr class="memitem:a0f6e2c58591d272db0aacd7c65ee14c6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a0f6e2c58591d272db0aacd7c65ee14c6">BN_NIST_521_LSHIFT</a>&#160;&#160;&#160;(BN_BITS2-<a class="el" href="bn__nist_8c.html#acb71f0118dd01e5ac1acea36590bad76">BN_NIST_521_RSHIFT</a>)</td></tr>
<tr class="memitem:a2ca13195551c3ef9eb90d85bcee0634c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a2ca13195551c3ef9eb90d85bcee0634c">BN_NIST_521_TOP_MASK</a>&#160;&#160;&#160;((BN_ULONG)BN_MASK2&gt;&gt;<a class="el" href="bn__nist_8c.html#a0f6e2c58591d272db0aacd7c65ee14c6">BN_NIST_521_LSHIFT</a>)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a797dfc360a4b12740f0608e9639819dd"><td class="memItemLeft" align="right" valign="top">typedef BN_ULONG(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a797dfc360a4b12740f0608e9639819dd">bn_addsub_f</a> )(BN_ULONG *, const BN_ULONG *, const BN_ULONG *, int)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad76abea60da547945df85683a5beead5"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#ad76abea60da547945df85683a5beead5">BN_get0_nist_prime_192</a> (void)</td></tr>
<tr class="memitem:a369ac15499192c7d85e1a2812fdd5c8e"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a369ac15499192c7d85e1a2812fdd5c8e">BN_get0_nist_prime_224</a> (void)</td></tr>
<tr class="memitem:a80e2f11d7bd89ac3ba44d7a50ef3d04f"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a80e2f11d7bd89ac3ba44d7a50ef3d04f">BN_get0_nist_prime_256</a> (void)</td></tr>
<tr class="memitem:a94f266457e55187506fbf6caa38006c6"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a94f266457e55187506fbf6caa38006c6">BN_get0_nist_prime_384</a> (void)</td></tr>
<tr class="memitem:a7427232977e02c9058794dd6fa66415d"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a7427232977e02c9058794dd6fa66415d">BN_get0_nist_prime_521</a> (void)</td></tr>
<tr class="memitem:ae48794554d36dc468a0df9d4245b2cb4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#ae48794554d36dc468a0df9d4245b2cb4">BN_nist_mod_192</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *r, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *field, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx)</td></tr>
<tr class="memitem:a76c271bacacb03c2c1fb682e5453268f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a76c271bacacb03c2c1fb682e5453268f">BN_nist_mod_224</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *r, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *field, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx)</td></tr>
<tr class="memitem:a70fb5939c3d9a609ca0e692e0c1243af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a70fb5939c3d9a609ca0e692e0c1243af">BN_nist_mod_256</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *r, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *field, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx)</td></tr>
<tr class="memitem:a32d00a2fa999acfdccfd3695cde10e25"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a32d00a2fa999acfdccfd3695cde10e25">BN_nist_mod_384</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *r, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *field, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx)</td></tr>
<tr class="memitem:a367bf3d97106e048ff5a49ca87f5b622"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a367bf3d97106e048ff5a49ca87f5b622">BN_nist_mod_521</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *r, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *field, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4b690234a5014fd63c061917a8a14f3a"><td class="memItemLeft" align="right" valign="top">int(*)(<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *r, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> <br class="typebreak"/>
*<a class="el" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *field, <br class="typebreak"/>
<a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__nist_8c.html#a4b690234a5014fd63c061917a8a14f3a">BN_nist_mod_func</a> (const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *p)</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="a21a8aed9b1746f90a0336bb7eb28d40a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define bn_32_set_0</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">to, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(to)[n] = (BN_ULONG)0;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00360">360</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae74c9890dc91c8db7f27252f5193ca56"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define bn_64_set_0</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">to, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div>
<div class="line">        bn_32_set_0(to, (n)*2); \</div>
<div class="line">        bn_32_set_0(to, (n)*2+1); \</div>
<div class="line">        }</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00354">354</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="a37e3333f384c9cb3f41de389ccc76ed4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define bn_cp_32</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">to, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">from, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(to)[n] = (m&gt;=0)?((from)[m]):0;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00359">359</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2a88bbbd5c4f2c419f286139944932d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define bn_cp_64</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">to, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">from, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div>
<div class="line">        bn_cp_32(to, (n)*2, from, (m)*2); \</div>
<div class="line">        bn_cp_32(to, (n)*2+1, from, (m)*2+1); \</div>
<div class="line">        }</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00349">349</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="a9b2f0cf02d3b536f722df7db72e4b0af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BN_NIST_192_TOP&#160;&#160;&#160;(192+BN_BITS2-1)/BN_BITS2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00063">63</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa36a32c8406e656d39db3d6b5d99b069"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BN_NIST_224_TOP&#160;&#160;&#160;(224+BN_BITS2-1)/BN_BITS2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00064">64</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad5049d296f6b68f7807ea504f70caab8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BN_NIST_256_TOP&#160;&#160;&#160;(256+BN_BITS2-1)/BN_BITS2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00065">65</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="aece04c512a77ed2aaa689d5fe5c691a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BN_NIST_384_TOP&#160;&#160;&#160;(384+BN_BITS2-1)/BN_BITS2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00066">66</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0f6e2c58591d272db0aacd7c65ee14c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BN_NIST_521_LSHIFT&#160;&#160;&#160;(BN_BITS2-<a class="el" href="bn__nist_8c.html#acb71f0118dd01e5ac1acea36590bad76">BN_NIST_521_RSHIFT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l01065">1065</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="acb71f0118dd01e5ac1acea36590bad76"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BN_NIST_521_RSHIFT&#160;&#160;&#160;(521%BN_BITS2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l01064">1064</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad7301de5b30b8800f30738396fc5c3e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BN_NIST_521_TOP&#160;&#160;&#160;(521+BN_BITS2-1)/BN_BITS2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00067">67</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2ca13195551c3ef9eb90d85bcee0634c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BN_NIST_521_TOP_MASK&#160;&#160;&#160;((BN_ULONG)BN_MASK2&gt;&gt;<a class="el" href="bn__nist_8c.html#a0f6e2c58591d272db0aacd7c65ee14c6">BN_NIST_521_LSHIFT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l01066">1066</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad1478dc2df46f199950eb361182ba223"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define nist_set_192</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">to, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">from, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a3&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div>
<div class="line">        bn_cp_64(to, 0, from, (a3) - 3) \</div>
<div class="line">        bn_cp_64(to, 1, from, (a2) - 3) \</div>
<div class="line">        bn_cp_64(to, 2, from, (a1) - 3) \</div>
<div class="line">        }</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00368">368</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7db73a5fd660e5711078b66c7be983f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define nist_set_224</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">to, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">from, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a4, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a5, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a6, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a7&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div>
<div class="line">        bn_cp_32(to, 0, from, (a7) - 7) \</div>
<div class="line">        bn_cp_32(to, 1, from, (a6) - 7) \</div>
<div class="line">        bn_cp_32(to, 2, from, (a5) - 7) \</div>
<div class="line">        bn_cp_32(to, 3, from, (a4) - 7) \</div>
<div class="line">        bn_cp_32(to, 4, from, (a3) - 7) \</div>
<div class="line">        bn_cp_32(to, 5, from, (a2) - 7) \</div>
<div class="line">        bn_cp_32(to, 6, from, (a1) - 7) \</div>
<div class="line">        }</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00485">485</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0809aa8928b1953d389ac8b23516678f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define nist_set_256</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">to, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">from, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a4, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a5, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a6, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a7, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a8&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div>
<div class="line">        bn_cp_32(to, 0, from, (a8) - 8) \</div>
<div class="line">        bn_cp_32(to, 1, from, (a7) - 8) \</div>
<div class="line">        bn_cp_32(to, 2, from, (a6) - 8) \</div>
<div class="line">        bn_cp_32(to, 3, from, (a5) - 8) \</div>
<div class="line">        bn_cp_32(to, 4, from, (a4) - 8) \</div>
<div class="line">        bn_cp_32(to, 5, from, (a3) - 8) \</div>
<div class="line">        bn_cp_32(to, 6, from, (a2) - 8) \</div>
<div class="line">        bn_cp_32(to, 7, from, (a1) - 8) \</div>
<div class="line">        }</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00642">642</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<a class="anchor" id="aba95fa994d7104c4fc293d373b263eb8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define nist_set_384</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">to, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">from, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a4, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a5, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a6, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a7, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a8, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a9, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a10, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a11, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a12&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div>
<div class="line">        bn_cp_32(to, 0, from,  (a12) - 12) \</div>
<div class="line">        bn_cp_32(to, 1, from,  (a11) - 12) \</div>
<div class="line">        bn_cp_32(to, 2, from,  (a10) - 12) \</div>
<div class="line">        bn_cp_32(to, 3, from,  (a9) - 12)  \</div>
<div class="line">        bn_cp_32(to, 4, from,  (a8) - 12)  \</div>
<div class="line">        bn_cp_32(to, 5, from,  (a7) - 12)  \</div>
<div class="line">        bn_cp_32(to, 6, from,  (a6) - 12)  \</div>
<div class="line">        bn_cp_32(to, 7, from,  (a5) - 12)  \</div>
<div class="line">        bn_cp_32(to, 8, from,  (a4) - 12)  \</div>
<div class="line">        bn_cp_32(to, 9, from,  (a3) - 12)  \</div>
<div class="line">        bn_cp_32(to, 10, from, (a2) - 12)  \</div>
<div class="line">        bn_cp_32(to, 11, from, (a1) - 12)  \</div>
<div class="line">        }</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00842">842</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<h2>Typedef Documentation</h2>
<a class="anchor" id="a797dfc360a4b12740f0608e9639819dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef BN_ULONG(* bn_addsub_f)(BN_ULONG *, const BN_ULONG *, const BN_ULONG *, int)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00483">483</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="ad76abea60da547945df85683a5beead5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a>* BN_get0_nist_prime_192 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00283">283</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> &amp;_bignum_nist_p_192;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a369ac15499192c7d85e1a2812fdd5c8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a>* BN_get0_nist_prime_224 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00288">288</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> &amp;_bignum_nist_p_224;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a80e2f11d7bd89ac3ba44d7a50ef3d04f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a>* BN_get0_nist_prime_256 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00293">293</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> &amp;_bignum_nist_p_256;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a94f266457e55187506fbf6caa38006c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a>* BN_get0_nist_prime_384 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00298">298</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> &amp;_bignum_nist_p_384;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7427232977e02c9058794dd6fa66415d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a>* BN_get0_nist_prime_521 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00303">303</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> &amp;_bignum_nist_p_521;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae48794554d36dc468a0df9d4245b2cb4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BN_nist_mod_192 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00375">375</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span>      top = a-&gt;<a class="code" href="structbignum__st.html#acb2587e7e0ff144adee978acd5b362f6">top</a>, i;</div>
<div class="line">        <span class="keywordtype">int</span>      carry;</div>
<div class="line">        <span class="keyword">register</span> BN_ULONG *r_d, *a_d = a-&gt;<a class="code" href="structbignum__st.html#afa4e4a2eb24f9c3df7eb33fd589cba31">d</a>;</div>
<div class="line">        <span class="keyword">union   </span>{</div>
<div class="line">                BN_ULONG        bn[<a class="code" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>];</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    ui[<a class="code" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>*<span class="keyword">sizeof</span>(BN_ULONG)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)];</div>
<div class="line">                } buf;</div>
<div class="line">        BN_ULONG c_d[<a class="code" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>],</div>
<div class="line">                *res;</div>
<div class="line">        <a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a> mask;</div>
<div class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structbignum__st.html">BIGNUM</a> _bignum_nist_p_192_sqr = {</div>
<div class="line">                (BN_ULONG *)_nist_p_192_sqr,</div>
<div class="line">                <span class="keyword">sizeof</span>(_nist_p_192_sqr)/<span class="keyword">sizeof</span>(_nist_p_192_sqr[0]),</div>
<div class="line">                <span class="keyword">sizeof</span>(_nist_p_192_sqr)/<span class="keyword">sizeof</span>(_nist_p_192_sqr[0]),</div>
<div class="line">                0,<a class="code" href="bn_8h.html#ae32355ce26c7a72424f52f6ae5358816">BN_FLG_STATIC_DATA</a> };</div>
<div class="line"></div>
<div class="line">        field = &amp;_bignum_nist_p_192; <span class="comment">/* just to make sure */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bn_8h.html#a64e63ab330037b5d7bacd2ae3bb0c74a">BN_is_negative</a>(a) || <a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(a,&amp;_bignum_nist_p_192_sqr)&gt;=0)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="bn_8h.html#a762a91b13a7ad118051f34eacac4e104">BN_nnmod</a>(r, a, field, ctx);</div>
<div class="line"></div>
<div class="line">        i = <a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(field, a);</div>
<div class="line">        <span class="keywordflow">if</span> (i == 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="bn_8h.html#ac97841d49b39ffdd49fcda8b152c0677">BN_zero</a>(r);</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line">                <span class="keywordflow">return</span> (r == a) ? 1 : (<a class="code" href="bn_8h.html#aea0c4e291bb4a98877f3e106aba231ad">BN_copy</a>(r ,a) != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (r != a)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a15094251b9047bc54ef42c702e65ce86">bn_wexpand</a>(r, <a class="code" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>))</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                r_d = r-&gt;<a class="code" href="structbignum__st.html#afa4e4a2eb24f9c3df7eb33fd589cba31">d</a>;</div>
<div class="line">                nist_cp_bn(r_d, a_d, <a class="code" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                r_d = a_d;</div>
<div class="line"></div>
<div class="line">        nist_cp_bn_0(buf.bn, a_d + <a class="code" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>, top - <a class="code" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>, <a class="code" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if defined(NIST_INT64)</span></div>
<div class="line"><span class="preprocessor"></span>        {</div>
<div class="line">        NIST_INT64              acc;    <span class="comment">/* accumulator */</span></div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            *rp=(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)r_d;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>      *<a class="code" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>=(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)buf.ui;</div>
<div class="line"></div>
<div class="line">        acc  = rp[0];   acc += bp[3*2-6];</div>
<div class="line">                        acc += bp[5*2-6]; rp[0] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[1];   acc += bp[3*2-5];</div>
<div class="line">                        acc += bp[5*2-5]; rp[1] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[2];   acc += bp[3*2-6];</div>
<div class="line">                        acc += bp[4*2-6];</div>
<div class="line">                        acc += bp[5*2-6]; rp[2] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[3];   acc += bp[3*2-5];</div>
<div class="line">                        acc += bp[4*2-5];</div>
<div class="line">                        acc += bp[5*2-5]; rp[3] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[4];   acc += bp[4*2-6];</div>
<div class="line">                        acc += bp[5*2-6]; rp[4] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[5];   acc += bp[4*2-5];</div>
<div class="line">                        acc += bp[5*2-5]; rp[5] = (<span class="keywordtype">unsigned</span> int)acc;</div>
<div class="line"></div>
<div class="line">        carry = (int)(acc&gt;&gt;32);</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        {</div>
<div class="line">        BN_ULONG t_d[<a class="code" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>];</div>
<div class="line"></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#ad1478dc2df46f199950eb361182ba223">nist_set_192</a>(t_d, buf.bn, 0, 3, 3);</div>
<div class="line">        carry = (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>);</div>
<div class="line">        <a class="code" href="bn__nist_8c.html#ad1478dc2df46f199950eb361182ba223">nist_set_192</a>(t_d, buf.bn, 4, 4, 0);</div>
<div class="line">        carry += (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>);</div>
<div class="line">        <a class="code" href="bn__nist_8c.html#ad1478dc2df46f199950eb361182ba223">nist_set_192</a>(t_d, buf.bn, 5, 5, 5)</div>
<div class="line">        carry += (<span class="keywordtype">int</span>)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>);</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (carry &gt; 0)</div>
<div class="line">                carry = (int)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(r_d,r_d,_nist_p_192[carry-1],BN_NIST_192_TOP);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                carry = 1;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * we need &#39;if (carry==0 || result&gt;=modulus) result-=modulus;&#39;</span></div>
<div class="line"><span class="comment">         * as comparison implies subtraction, we can write</span></div>
<div class="line"><span class="comment">         * &#39;tmp=result-modulus; if (!carry || !borrow) result=tmp;&#39;</span></div>
<div class="line"><span class="comment">         * this is what happens below, but without explicit if:-) a.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        mask  = 0-(<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(c_d,r_d,_nist_p_192[0],BN_NIST_192_TOP);</div>
<div class="line">        mask &amp;= 0-(<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)carry;</div>
<div class="line">        res   = c_d;</div>
<div class="line">        res   = (BN_ULONG *)</div>
<div class="line">         (((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)res&amp;~mask) | ((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)r_d&amp;mask));</div>
<div class="line">        nist_cp_bn(r_d, res, BN_NIST_192_TOP);</div>
<div class="line">        r-&gt;<a class="code" href="structbignum__st.html#acb2587e7e0ff144adee978acd5b362f6">top</a> = <a class="code" href="bn__nist_8c.html#a9b2f0cf02d3b536f722df7db72e4b0af">BN_NIST_192_TOP</a>;</div>
<div class="line">        <a class="code" href="bn_8h.html#ac7cda4cbe7c292e7acbc0e66d7f45364">bn_correct_top</a>(r);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a76c271bacacb03c2c1fb682e5453268f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BN_nist_mod_224 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00496">496</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span>     top = a-&gt;<a class="code" href="structbignum__st.html#acb2587e7e0ff144adee978acd5b362f6">top</a>, i;</div>
<div class="line">        <span class="keywordtype">int</span>     carry;</div>
<div class="line">        BN_ULONG *r_d, *a_d = a-&gt;<a class="code" href="structbignum__st.html#afa4e4a2eb24f9c3df7eb33fd589cba31">d</a>;</div>
<div class="line">        <span class="keyword">union   </span>{</div>
<div class="line">                BN_ULONG        bn[<a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>];</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    ui[<a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>*<span class="keyword">sizeof</span>(BN_ULONG)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)];</div>
<div class="line">                } buf;</div>
<div class="line">        BN_ULONG c_d[<a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>],</div>
<div class="line">                *res;</div>
<div class="line">        <a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a> mask;</div>
<div class="line">        <span class="keyword">union </span>{ <a class="code" href="bn__nist_8c.html#a797dfc360a4b12740f0608e9639819dd">bn_addsub_f</a> f; <a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a> p; } <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>;</div>
<div class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structbignum__st.html">BIGNUM</a> _bignum_nist_p_224_sqr = {</div>
<div class="line">                (BN_ULONG *)_nist_p_224_sqr,</div>
<div class="line">                <span class="keyword">sizeof</span>(_nist_p_224_sqr)/<span class="keyword">sizeof</span>(_nist_p_224_sqr[0]),</div>
<div class="line">                <span class="keyword">sizeof</span>(_nist_p_224_sqr)/<span class="keyword">sizeof</span>(_nist_p_224_sqr[0]),</div>
<div class="line">                0,<a class="code" href="bn_8h.html#ae32355ce26c7a72424f52f6ae5358816">BN_FLG_STATIC_DATA</a> };</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        field = &amp;_bignum_nist_p_224; <span class="comment">/* just to make sure */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bn_8h.html#a64e63ab330037b5d7bacd2ae3bb0c74a">BN_is_negative</a>(a) || <a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(a,&amp;_bignum_nist_p_224_sqr)&gt;=0)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="bn_8h.html#a762a91b13a7ad118051f34eacac4e104">BN_nnmod</a>(r, a, field, ctx);</div>
<div class="line"></div>
<div class="line">        i = <a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(field, a);</div>
<div class="line">        <span class="keywordflow">if</span> (i == 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="bn_8h.html#ac97841d49b39ffdd49fcda8b152c0677">BN_zero</a>(r);</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line">                <span class="keywordflow">return</span> (r == a)? 1 : (<a class="code" href="bn_8h.html#aea0c4e291bb4a98877f3e106aba231ad">BN_copy</a>(r ,a) != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (r != a)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a15094251b9047bc54ef42c702e65ce86">bn_wexpand</a>(r, <a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>))</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                r_d = r-&gt;<a class="code" href="structbignum__st.html#afa4e4a2eb24f9c3df7eb33fd589cba31">d</a>;</div>
<div class="line">                nist_cp_bn(r_d, a_d, <a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                r_d = a_d;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if BN_BITS2==64</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="comment">/* copy upper 256 bits of 448 bit number ... */</span></div>
<div class="line">        nist_cp_bn_0(c_d, a_d + (<a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>-1), top - (<a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>-1), <a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>);</div>
<div class="line">        <span class="comment">/* ... and right shift by 32 to obtain upper 224 bits */</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a7db73a5fd660e5711078b66c7be983f3">nist_set_224</a>(buf.bn, c_d, 14, 13, 12, 11, 10, 9, 8);</div>
<div class="line">        <span class="comment">/* truncate lower part to 224 bits too */</span></div>
<div class="line">        r_d[<a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>-1] &amp;= BN_MASK2l;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        nist_cp_bn_0(buf.bn, a_d + <a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>, top - <a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>, <a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#if defined(NIST_INT64) &amp;&amp; BN_BITS2!=64</span></div>
<div class="line"><span class="preprocessor"></span>        {</div>
<div class="line">        NIST_INT64              acc;    <span class="comment">/* accumulator */</span></div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            *rp=(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)r_d;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>      *<a class="code" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>=(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)buf.ui;</div>
<div class="line"></div>
<div class="line">        acc  = rp[0];   acc -= bp[7-7];</div>
<div class="line">                        acc -= bp[11-7]; rp[0] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[1];   acc -= bp[8-7];</div>
<div class="line">                        acc -= bp[12-7]; rp[1] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[2];   acc -= bp[9-7];</div>
<div class="line">                        acc -= bp[13-7]; rp[2] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[3];   acc += bp[7-7];</div>
<div class="line">                        acc += bp[11-7];</div>
<div class="line">                        acc -= bp[10-7]; rp[3] = (<span class="keywordtype">unsigned</span> int)acc; acc&gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[4];   acc += bp[8-7];</div>
<div class="line">                        acc += bp[12-7];</div>
<div class="line">                        acc -= bp[11-7]; rp[4] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[5];   acc += bp[9-7];</div>
<div class="line">                        acc += bp[13-7];</div>
<div class="line">                        acc -= bp[12-7]; rp[5] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[6];   acc += bp[10-7];</div>
<div class="line">                        acc -= bp[13-7]; rp[6] = (<span class="keywordtype">unsigned</span> int)acc;</div>
<div class="line"></div>
<div class="line">        carry = (int)(acc&gt;&gt;32);</div>
<div class="line"><span class="preprocessor"># if BN_BITS2==64</span></div>
<div class="line"><span class="preprocessor"></span>        rp[7] = carry;</div>
<div class="line"><span class="preprocessor"># endif</span></div>
<div class="line"><span class="preprocessor"></span>        }       </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        {</div>
<div class="line">        BN_ULONG t_d[<a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>];</div>
<div class="line"></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a7db73a5fd660e5711078b66c7be983f3">nist_set_224</a>(t_d, buf.bn, 10, 9, 8, 7, 0, 0, 0);</div>
<div class="line">        carry = (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>);</div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a7db73a5fd660e5711078b66c7be983f3">nist_set_224</a>(t_d, buf.bn, 0, 13, 12, 11, 0, 0, 0);</div>
<div class="line">        carry += (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>);</div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a7db73a5fd660e5711078b66c7be983f3">nist_set_224</a>(t_d, buf.bn, 13, 12, 11, 10, 9, 8, 7);</div>
<div class="line">        carry -= (int)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>);</div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a7db73a5fd660e5711078b66c7be983f3">nist_set_224</a>(t_d, buf.bn, 0, 0, 0, 0, 13, 12, 11);</div>
<div class="line">        carry -= (int)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if BN_BITS2==64</span></div>
<div class="line"><span class="preprocessor"></span>        carry = (int)(r_d[<a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>-1]&gt;&gt;32);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>.f = <a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (carry &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                carry = (int)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(r_d,r_d,_nist_p_224[carry-1],<a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>);</div>
<div class="line"><span class="preprocessor">#if BN_BITS2==64</span></div>
<div class="line"><span class="preprocessor"></span>                carry=(int)(~(r_d[<a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>-1]&gt;&gt;32))&amp;1;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (carry &lt; 0)</div>
<div class="line">                {</div>
<div class="line">                <span class="comment">/* it&#39;s a bit more comlicated logic in this case.</span></div>
<div class="line"><span class="comment">                 * if bn_add_words yields no carry, then result</span></div>
<div class="line"><span class="comment">                 * has to be adjusted by unconditionally *adding*</span></div>
<div class="line"><span class="comment">                 * the modulus. but if it does, then result has</span></div>
<div class="line"><span class="comment">                 * to be compared to the modulus and conditionally</span></div>
<div class="line"><span class="comment">                 * adjusted by *subtracting* the latter. */</span></div>
<div class="line">                carry = (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d,r_d,_nist_p_224[-carry-1],<a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>);</div>
<div class="line">                mask = 0-(<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)carry;</div>
<div class="line">                <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>.p = ((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>&amp;mask) |</div>
<div class="line">                 ((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>&amp;~mask);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                carry = 1;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* otherwise it&#39;s effectively same as in BN_nist_mod_192... */</span></div>
<div class="line">        mask  = 0-(<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)(*<a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>.f)(c_d,r_d,_nist_p_224[0],<a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>);</div>
<div class="line">        mask &amp;= 0-(<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)carry;</div>
<div class="line">        res   = c_d;</div>
<div class="line">        res   = (BN_ULONG *)(((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)res&amp;~mask) |</div>
<div class="line">         ((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)r_d&amp;mask));</div>
<div class="line">        nist_cp_bn(r_d, res, <a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>);</div>
<div class="line">        r-&gt;<a class="code" href="structbignum__st.html#acb2587e7e0ff144adee978acd5b362f6">top</a> = <a class="code" href="bn__nist_8c.html#aa36a32c8406e656d39db3d6b5d99b069">BN_NIST_224_TOP</a>;</div>
<div class="line">        <a class="code" href="bn_8h.html#ac7cda4cbe7c292e7acbc0e66d7f45364">bn_correct_top</a>(r);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a70fb5939c3d9a609ca0e692e0c1243af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BN_nist_mod_256 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00654">654</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span>     i, top = a-&gt;<a class="code" href="structbignum__st.html#acb2587e7e0ff144adee978acd5b362f6">top</a>;</div>
<div class="line">        <span class="keywordtype">int</span>     carry = 0;</div>
<div class="line">        <span class="keyword">register</span> BN_ULONG *a_d = a-&gt;<a class="code" href="structbignum__st.html#afa4e4a2eb24f9c3df7eb33fd589cba31">d</a>, *r_d;</div>
<div class="line">        <span class="keyword">union   </span>{</div>
<div class="line">                BN_ULONG bn[<a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>];</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ui[<a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>*<span class="keyword">sizeof</span>(BN_ULONG)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)];</div>
<div class="line">                } buf;</div>
<div class="line">        BN_ULONG c_d[<a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>],</div>
<div class="line">                *res;</div>
<div class="line">        <a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a> mask;</div>
<div class="line">        <span class="keyword">union </span>{ <a class="code" href="bn__nist_8c.html#a797dfc360a4b12740f0608e9639819dd">bn_addsub_f</a> f; <a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a> p; } <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>;</div>
<div class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structbignum__st.html">BIGNUM</a> _bignum_nist_p_256_sqr = {</div>
<div class="line">                (BN_ULONG *)_nist_p_256_sqr,</div>
<div class="line">                <span class="keyword">sizeof</span>(_nist_p_256_sqr)/<span class="keyword">sizeof</span>(_nist_p_256_sqr[0]),</div>
<div class="line">                <span class="keyword">sizeof</span>(_nist_p_256_sqr)/<span class="keyword">sizeof</span>(_nist_p_256_sqr[0]),</div>
<div class="line">                0,<a class="code" href="bn_8h.html#ae32355ce26c7a72424f52f6ae5358816">BN_FLG_STATIC_DATA</a> };</div>
<div class="line"></div>
<div class="line">        field = &amp;_bignum_nist_p_256; <span class="comment">/* just to make sure */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bn_8h.html#a64e63ab330037b5d7bacd2ae3bb0c74a">BN_is_negative</a>(a) || <a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(a,&amp;_bignum_nist_p_256_sqr)&gt;=0)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="bn_8h.html#a762a91b13a7ad118051f34eacac4e104">BN_nnmod</a>(r, a, field, ctx);</div>
<div class="line"></div>
<div class="line">        i = <a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(field, a);</div>
<div class="line">        <span class="keywordflow">if</span> (i == 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="bn_8h.html#ac97841d49b39ffdd49fcda8b152c0677">BN_zero</a>(r);</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line">                <span class="keywordflow">return</span> (r == a)? 1 : (<a class="code" href="bn_8h.html#aea0c4e291bb4a98877f3e106aba231ad">BN_copy</a>(r ,a) != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (r != a)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a15094251b9047bc54ef42c702e65ce86">bn_wexpand</a>(r, <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>))</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                r_d = r-&gt;<a class="code" href="structbignum__st.html#afa4e4a2eb24f9c3df7eb33fd589cba31">d</a>;</div>
<div class="line">                nist_cp_bn(r_d, a_d, <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                r_d = a_d;</div>
<div class="line"></div>
<div class="line">        nist_cp_bn_0(buf.bn, a_d + <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>, top - <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>, <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if defined(NIST_INT64)</span></div>
<div class="line"><span class="preprocessor"></span>        {</div>
<div class="line">        NIST_INT64              acc;    <span class="comment">/* accumulator */</span></div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            *rp=(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)r_d;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>      *<a class="code" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>=(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)buf.ui;</div>
<div class="line"></div>
<div class="line">        acc = rp[0];    acc += bp[8-8];</div>
<div class="line">                        acc += bp[9-8];</div>
<div class="line">                        acc -= bp[11-8];</div>
<div class="line">                        acc -= bp[12-8];</div>
<div class="line">                        acc -= bp[13-8];</div>
<div class="line">                        acc -= bp[14-8]; rp[0] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[1];   acc += bp[9-8];</div>
<div class="line">                        acc += bp[10-8];</div>
<div class="line">                        acc -= bp[12-8];</div>
<div class="line">                        acc -= bp[13-8];</div>
<div class="line">                        acc -= bp[14-8];</div>
<div class="line">                        acc -= bp[15-8]; rp[1] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[2];   acc += bp[10-8];</div>
<div class="line">                        acc += bp[11-8];</div>
<div class="line">                        acc -= bp[13-8];</div>
<div class="line">                        acc -= bp[14-8];</div>
<div class="line">                        acc -= bp[15-8]; rp[2] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[3];   acc += bp[11-8];</div>
<div class="line">                        acc += bp[11-8];</div>
<div class="line">                        acc += bp[12-8];</div>
<div class="line">                        acc += bp[12-8];</div>
<div class="line">                        acc += bp[13-8];</div>
<div class="line">                        acc -= bp[15-8];</div>
<div class="line">                        acc -= bp[8-8];</div>
<div class="line">                        acc -= bp[9-8];  rp[3] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[4];   acc += bp[12-8];</div>
<div class="line">                        acc += bp[12-8];</div>
<div class="line">                        acc += bp[13-8];</div>
<div class="line">                        acc += bp[13-8];</div>
<div class="line">                        acc += bp[14-8];</div>
<div class="line">                        acc -= bp[9-8];</div>
<div class="line">                        acc -= bp[10-8]; rp[4] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[5];   acc += bp[13-8];</div>
<div class="line">                        acc += bp[13-8];</div>
<div class="line">                        acc += bp[14-8];</div>
<div class="line">                        acc += bp[14-8];</div>
<div class="line">                        acc += bp[15-8];</div>
<div class="line">                        acc -= bp[10-8];</div>
<div class="line">                        acc -= bp[11-8]; rp[5] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[6];   acc += bp[14-8];</div>
<div class="line">                        acc += bp[14-8];</div>
<div class="line">                        acc += bp[15-8];</div>
<div class="line">                        acc += bp[15-8];</div>
<div class="line">                        acc += bp[14-8];</div>
<div class="line">                        acc += bp[13-8];</div>
<div class="line">                        acc -= bp[8-8];</div>
<div class="line">                        acc -= bp[9-8];  rp[6] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[7];   acc += bp[15-8];</div>
<div class="line">                        acc += bp[15-8];</div>
<div class="line">                        acc += bp[15-8];</div>
<div class="line">                        acc += bp[8 -8];</div>
<div class="line">                        acc -= bp[10-8];</div>
<div class="line">                        acc -= bp[11-8];</div>
<div class="line">                        acc -= bp[12-8];</div>
<div class="line">                        acc -= bp[13-8]; rp[7] = (<span class="keywordtype">unsigned</span> int)acc;</div>
<div class="line"></div>
<div class="line">        carry = (int)(acc&gt;&gt;32);</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        {</div>
<div class="line">        BN_ULONG t_d[<a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>];</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*S1*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a0809aa8928b1953d389ac8b23516678f">nist_set_256</a>(t_d, buf.bn, 15, 14, 13, 12, 11, 0, 0, 0);</div>
<div class="line">        <span class="comment">/*S2*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a0809aa8928b1953d389ac8b23516678f">nist_set_256</a>(c_d, buf.bn, 0, 15, 14, 13, 12, 0, 0, 0);</div>
<div class="line">        carry = (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(t_d, t_d, c_d, <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line">        <span class="comment">/* left shift */</span></div>
<div class="line">                {</div>
<div class="line">                <span class="keyword">register</span> BN_ULONG *ap,<a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>,<a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>;</div>
<div class="line">                ap = t_d;</div>
<div class="line">                c=0;</div>
<div class="line">                <span class="keywordflow">for</span> (i = <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>; i != 0; --i)</div>
<div class="line">                        {</div>
<div class="line">                        t= *ap;</div>
<div class="line">                        *(ap++)=((t&lt;&lt;1)|c)&amp;BN_MASK2;</div>
<div class="line">                        c=(t &amp; BN_TBIT)?1:0;</div>
<div class="line">                        }</div>
<div class="line">                carry &lt;&lt;= 1;</div>
<div class="line">                carry  |= c;</div>
<div class="line">                }</div>
<div class="line">        carry += (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line">        <span class="comment">/*S3*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a0809aa8928b1953d389ac8b23516678f">nist_set_256</a>(t_d, buf.bn, 15, 14, 0, 0, 0, 10, 9, 8);</div>
<div class="line">        carry += (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line">        <span class="comment">/*S4*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a0809aa8928b1953d389ac8b23516678f">nist_set_256</a>(t_d, buf.bn, 8, 13, 15, 14, 13, 11, 10, 9);</div>
<div class="line">        carry += (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line">        <span class="comment">/*D1*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a0809aa8928b1953d389ac8b23516678f">nist_set_256</a>(t_d, buf.bn, 10, 8, 0, 0, 0, 13, 12, 11);</div>
<div class="line">        carry -= (int)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line">        <span class="comment">/*D2*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a0809aa8928b1953d389ac8b23516678f">nist_set_256</a>(t_d, buf.bn, 11, 9, 0, 0, 15, 14, 13, 12);</div>
<div class="line">        carry -= (int)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line">        <span class="comment">/*D3*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a0809aa8928b1953d389ac8b23516678f">nist_set_256</a>(t_d, buf.bn, 12, 0, 10, 9, 8, 15, 14, 13);</div>
<div class="line">        carry -= (int)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line">        <span class="comment">/*D4*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a0809aa8928b1953d389ac8b23516678f">nist_set_256</a>(t_d, buf.bn, 13, 0, 11, 10, 9, 0, 15, 14);</div>
<div class="line">        carry -= (int)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="comment">/* see BN_nist_mod_224 for explanation */</span></div>
<div class="line">        <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>.f = <a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (carry &gt; 0)</div>
<div class="line">                carry = (int)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(r_d,r_d,_nist_p_256[carry-1],<a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (carry &lt; 0)</div>
<div class="line">                {</div>
<div class="line">                carry = (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d,r_d,_nist_p_256[-carry-1],<a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line">                mask = 0-(<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)carry;</div>
<div class="line">                <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>.p = ((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>&amp;mask) |</div>
<div class="line">                 ((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>&amp;~mask);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                carry = 1;</div>
<div class="line"></div>
<div class="line">        mask  = 0-(<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)(*<a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>.f)(c_d,r_d,_nist_p_256[0],<a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line">        mask &amp;= 0-(<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)carry;</div>
<div class="line">        res   = c_d;</div>
<div class="line">        res   = (BN_ULONG *)(((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)res&amp;~mask) |</div>
<div class="line">         ((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)r_d&amp;mask));</div>
<div class="line">        nist_cp_bn(r_d, res, <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line">        r-&gt;<a class="code" href="structbignum__st.html#acb2587e7e0ff144adee978acd5b362f6">top</a> = <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>;</div>
<div class="line">        <a class="code" href="bn_8h.html#ac7cda4cbe7c292e7acbc0e66d7f45364">bn_correct_top</a>(r);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a32d00a2fa999acfdccfd3695cde10e25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BN_nist_mod_384 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l00858">858</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span>     i, top = a-&gt;<a class="code" href="structbignum__st.html#acb2587e7e0ff144adee978acd5b362f6">top</a>;</div>
<div class="line">        <span class="keywordtype">int</span>     carry = 0;</div>
<div class="line">        <span class="keyword">register</span> BN_ULONG *r_d, *a_d = a-&gt;<a class="code" href="structbignum__st.html#afa4e4a2eb24f9c3df7eb33fd589cba31">d</a>;</div>
<div class="line">        <span class="keyword">union   </span>{</div>
<div class="line">                BN_ULONG bn[<a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>];</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ui[<a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>*<span class="keyword">sizeof</span>(BN_ULONG)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)];</div>
<div class="line">                } buf;</div>
<div class="line">        BN_ULONG c_d[<a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>],</div>
<div class="line">                *res;</div>
<div class="line">        <a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a> mask;</div>
<div class="line">        <span class="keyword">union </span>{ <a class="code" href="bn__nist_8c.html#a797dfc360a4b12740f0608e9639819dd">bn_addsub_f</a> f; <a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a> p; } <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>;</div>
<div class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structbignum__st.html">BIGNUM</a> _bignum_nist_p_384_sqr = {</div>
<div class="line">                (BN_ULONG *)_nist_p_384_sqr,</div>
<div class="line">                <span class="keyword">sizeof</span>(_nist_p_384_sqr)/<span class="keyword">sizeof</span>(_nist_p_384_sqr[0]),</div>
<div class="line">                <span class="keyword">sizeof</span>(_nist_p_384_sqr)/<span class="keyword">sizeof</span>(_nist_p_384_sqr[0]),</div>
<div class="line">                0,<a class="code" href="bn_8h.html#ae32355ce26c7a72424f52f6ae5358816">BN_FLG_STATIC_DATA</a> };</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        field = &amp;_bignum_nist_p_384; <span class="comment">/* just to make sure */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bn_8h.html#a64e63ab330037b5d7bacd2ae3bb0c74a">BN_is_negative</a>(a) || <a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(a,&amp;_bignum_nist_p_384_sqr)&gt;=0)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="bn_8h.html#a762a91b13a7ad118051f34eacac4e104">BN_nnmod</a>(r, a, field, ctx);</div>
<div class="line"></div>
<div class="line">        i = <a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(field, a);</div>
<div class="line">        <span class="keywordflow">if</span> (i == 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="bn_8h.html#ac97841d49b39ffdd49fcda8b152c0677">BN_zero</a>(r);</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line">                <span class="keywordflow">return</span> (r == a)? 1 : (<a class="code" href="bn_8h.html#aea0c4e291bb4a98877f3e106aba231ad">BN_copy</a>(r ,a) != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (r != a)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a15094251b9047bc54ef42c702e65ce86">bn_wexpand</a>(r, <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>))</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                r_d = r-&gt;<a class="code" href="structbignum__st.html#afa4e4a2eb24f9c3df7eb33fd589cba31">d</a>;</div>
<div class="line">                nist_cp_bn(r_d, a_d, <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                r_d = a_d;</div>
<div class="line"></div>
<div class="line">        nist_cp_bn_0(buf.bn, a_d + <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>, top - <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>, <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if defined(NIST_INT64)</span></div>
<div class="line"><span class="preprocessor"></span>        {</div>
<div class="line">        NIST_INT64              acc;    <span class="comment">/* accumulator */</span></div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            *rp=(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)r_d;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>      *<a class="code" href="conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>=(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)buf.ui;</div>
<div class="line"></div>
<div class="line">        acc = rp[0];    acc += bp[12-12];</div>
<div class="line">                        acc += bp[21-12];</div>
<div class="line">                        acc += bp[20-12];</div>
<div class="line">                        acc -= bp[23-12]; rp[0] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[1];   acc += bp[13-12];</div>
<div class="line">                        acc += bp[22-12];</div>
<div class="line">                        acc += bp[23-12];</div>
<div class="line">                        acc -= bp[12-12];</div>
<div class="line">                        acc -= bp[20-12]; rp[1] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[2];   acc += bp[14-12];</div>
<div class="line">                        acc += bp[23-12];</div>
<div class="line">                        acc -= bp[13-12];</div>
<div class="line">                        acc -= bp[21-12]; rp[2] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[3];   acc += bp[15-12];</div>
<div class="line">                        acc += bp[12-12];</div>
<div class="line">                        acc += bp[20-12];</div>
<div class="line">                        acc += bp[21-12];</div>
<div class="line">                        acc -= bp[14-12];</div>
<div class="line">                        acc -= bp[22-12];</div>
<div class="line">                        acc -= bp[23-12]; rp[3] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[4];   acc += bp[21-12];</div>
<div class="line">                        acc += bp[21-12];</div>
<div class="line">                        acc += bp[16-12];</div>
<div class="line">                        acc += bp[13-12];</div>
<div class="line">                        acc += bp[12-12];</div>
<div class="line">                        acc += bp[20-12];</div>
<div class="line">                        acc += bp[22-12];</div>
<div class="line">                        acc -= bp[15-12];</div>
<div class="line">                        acc -= bp[23-12];</div>
<div class="line">                        acc -= bp[23-12]; rp[4] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line"></div>
<div class="line">        acc += rp[5];   acc += bp[22-12];</div>
<div class="line">                        acc += bp[22-12];</div>
<div class="line">                        acc += bp[17-12];</div>
<div class="line">                        acc += bp[14-12];</div>
<div class="line">                        acc += bp[13-12];</div>
<div class="line">                        acc += bp[21-12];</div>
<div class="line">                        acc += bp[23-12];</div>
<div class="line">                        acc -= bp[16-12]; rp[5] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line">                        </div>
<div class="line">        acc += rp[6];   acc += bp[23-12];</div>
<div class="line">                        acc += bp[23-12];</div>
<div class="line">                        acc += bp[18-12];</div>
<div class="line">                        acc += bp[15-12];</div>
<div class="line">                        acc += bp[14-12];</div>
<div class="line">                        acc += bp[22-12];</div>
<div class="line">                        acc -= bp[17-12]; rp[6] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line">                        </div>
<div class="line">        acc += rp[7];   acc += bp[19-12];</div>
<div class="line">                        acc += bp[16-12];</div>
<div class="line">                        acc += bp[15-12];</div>
<div class="line">                        acc += bp[23-12];</div>
<div class="line">                        acc -= bp[18-12]; rp[7] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line">                        </div>
<div class="line">        acc += rp[8];   acc += bp[20-12];</div>
<div class="line">                        acc += bp[17-12];</div>
<div class="line">                        acc += bp[16-12];</div>
<div class="line">                        acc -= bp[19-12]; rp[8] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line">                        </div>
<div class="line">        acc += rp[9];   acc += bp[21-12];</div>
<div class="line">                        acc += bp[18-12];</div>
<div class="line">                        acc += bp[17-12];</div>
<div class="line">                        acc -= bp[20-12]; rp[9] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line">                        </div>
<div class="line">        acc += rp[10];  acc += bp[22-12];</div>
<div class="line">                        acc += bp[19-12];</div>
<div class="line">                        acc += bp[18-12];</div>
<div class="line">                        acc -= bp[21-12]; rp[10] = (<span class="keywordtype">unsigned</span> int)acc; acc &gt;&gt;= 32;</div>
<div class="line">                        </div>
<div class="line">        acc += rp[11];  acc += bp[23-12];</div>
<div class="line">                        acc += bp[20-12];</div>
<div class="line">                        acc += bp[19-12];</div>
<div class="line">                        acc -= bp[22-12]; rp[11] = (<span class="keywordtype">unsigned</span> int)acc;</div>
<div class="line"></div>
<div class="line">        carry = (int)(acc&gt;&gt;32);</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        {</div>
<div class="line">        BN_ULONG t_d[<a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>];</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*S1*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#a0809aa8928b1953d389ac8b23516678f">nist_set_256</a>(t_d, buf.bn, 0, 0, 0, 0, 0, 23-4, 22-4, 21-4);</div>
<div class="line">                <span class="comment">/* left shift */</span></div>
<div class="line">                {</div>
<div class="line">                <span class="keyword">register</span> BN_ULONG *ap,<a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>,<a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>;</div>
<div class="line">                ap = t_d;</div>
<div class="line">                c=0;</div>
<div class="line">                <span class="keywordflow">for</span> (i = 3; i != 0; --i)</div>
<div class="line">                        {</div>
<div class="line">                        t= *ap;</div>
<div class="line">                        *(ap++)=((t&lt;&lt;1)|c)&amp;BN_MASK2;</div>
<div class="line">                        c=(t &amp; BN_TBIT)?1:0;</div>
<div class="line">                        }</div>
<div class="line">                *ap=c;</div>
<div class="line">                }</div>
<div class="line">        carry = (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d+(128/BN_BITS2), r_d+(128/BN_BITS2), </div>
<div class="line">                t_d, <a class="code" href="bn__nist_8c.html#ad5049d296f6b68f7807ea504f70caab8">BN_NIST_256_TOP</a>);</div>
<div class="line">        <span class="comment">/*S2 */</span></div>
<div class="line">        carry += (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d, r_d, buf.bn, <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line">        <span class="comment">/*S3*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#aba95fa994d7104c4fc293d373b263eb8">nist_set_384</a>(t_d,buf.bn,20,19,18,17,16,15,14,13,12,23,22,21);</div>
<div class="line">        carry += (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line">        <span class="comment">/*S4*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#aba95fa994d7104c4fc293d373b263eb8">nist_set_384</a>(t_d,buf.bn,19,18,17,16,15,14,13,12,20,0,23,0);</div>
<div class="line">        carry += (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line">        <span class="comment">/*S5*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#aba95fa994d7104c4fc293d373b263eb8">nist_set_384</a>(t_d, buf.bn,0,0,0,0,23,22,21,20,0,0,0,0);</div>
<div class="line">        carry += (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line">        <span class="comment">/*S6*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#aba95fa994d7104c4fc293d373b263eb8">nist_set_384</a>(t_d,buf.bn,0,0,0,0,0,0,23,22,21,0,0,20);</div>
<div class="line">        carry += (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line">        <span class="comment">/*D1*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#aba95fa994d7104c4fc293d373b263eb8">nist_set_384</a>(t_d,buf.bn,22,21,20,19,18,17,16,15,14,13,12,23);</div>
<div class="line">        carry -= (int)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line">        <span class="comment">/*D2*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#aba95fa994d7104c4fc293d373b263eb8">nist_set_384</a>(t_d,buf.bn,0,0,0,0,0,0,0,23,22,21,20,0);</div>
<div class="line">        carry -= (int)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line">        <span class="comment">/*D3*/</span></div>
<div class="line">        <a class="code" href="bn__nist_8c.html#aba95fa994d7104c4fc293d373b263eb8">nist_set_384</a>(t_d,buf.bn,0,0,0,0,0,0,0,23,23,0,0,0);</div>
<div class="line">        carry -= (int)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(r_d, r_d, t_d, <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="comment">/* see BN_nist_mod_224 for explanation */</span></div>
<div class="line">        <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>.f = <a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (carry &gt; 0)</div>
<div class="line">                carry = (int)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(r_d,r_d,_nist_p_384[carry-1],<a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (carry &lt; 0)</div>
<div class="line">                {</div>
<div class="line">                carry = (int)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d,r_d,_nist_p_384[-carry-1],<a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line">                mask = 0-(<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)carry;</div>
<div class="line">                <a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>.p = ((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>&amp;mask) |</div>
<div class="line">                 ((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)<a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>&amp;~mask);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                carry = 1;</div>
<div class="line"></div>
<div class="line">        mask  = 0-(<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)(*<a class="code" href="pem_8h.html#a9a372ec768baa595be7fbb3a8825a797">u</a>.f)(c_d,r_d,_nist_p_384[0],<a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line">        mask &amp;= 0-(<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)carry;</div>
<div class="line">        res   = c_d;</div>
<div class="line">        res   = (BN_ULONG *)(((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)res&amp;~mask) |</div>
<div class="line">         ((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)r_d&amp;mask));</div>
<div class="line">        nist_cp_bn(r_d, res, <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>);</div>
<div class="line">        r-&gt;<a class="code" href="structbignum__st.html#acb2587e7e0ff144adee978acd5b362f6">top</a> = <a class="code" href="bn__nist_8c.html#aece04c512a77ed2aaa689d5fe5c691a6">BN_NIST_384_TOP</a>;</div>
<div class="line">        <a class="code" href="bn_8h.html#ac7cda4cbe7c292e7acbc0e66d7f45364">bn_correct_top</a>(r);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a367bf3d97106e048ff5a49ca87f5b622"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BN_nist_mod_521 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l01068">1068</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span>     top = a-&gt;<a class="code" href="structbignum__st.html#acb2587e7e0ff144adee978acd5b362f6">top</a>, i;</div>
<div class="line">        BN_ULONG *r_d, *a_d = a-&gt;<a class="code" href="structbignum__st.html#afa4e4a2eb24f9c3df7eb33fd589cba31">d</a>,</div>
<div class="line">                 t_d[<a class="code" href="bn__nist_8c.html#ad7301de5b30b8800f30738396fc5c3e1">BN_NIST_521_TOP</a>],</div>
<div class="line">                 val,tmp,*res;</div>
<div class="line">        <a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a> mask;</div>
<div class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structbignum__st.html">BIGNUM</a> _bignum_nist_p_521_sqr = {</div>
<div class="line">                (BN_ULONG *)_nist_p_521_sqr,</div>
<div class="line">                <span class="keyword">sizeof</span>(_nist_p_521_sqr)/<span class="keyword">sizeof</span>(_nist_p_521_sqr[0]),</div>
<div class="line">                <span class="keyword">sizeof</span>(_nist_p_521_sqr)/<span class="keyword">sizeof</span>(_nist_p_521_sqr[0]),</div>
<div class="line">                0,<a class="code" href="bn_8h.html#ae32355ce26c7a72424f52f6ae5358816">BN_FLG_STATIC_DATA</a> };</div>
<div class="line"></div>
<div class="line">        field = &amp;_bignum_nist_p_521; <span class="comment">/* just to make sure */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bn_8h.html#a64e63ab330037b5d7bacd2ae3bb0c74a">BN_is_negative</a>(a) || <a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(a,&amp;_bignum_nist_p_521_sqr)&gt;=0)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="bn_8h.html#a762a91b13a7ad118051f34eacac4e104">BN_nnmod</a>(r, a, field, ctx);</div>
<div class="line"></div>
<div class="line">        i = <a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(field, a);</div>
<div class="line">        <span class="keywordflow">if</span> (i == 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="bn_8h.html#ac97841d49b39ffdd49fcda8b152c0677">BN_zero</a>(r);</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line">                <span class="keywordflow">return</span> (r == a)? 1 : (<a class="code" href="bn_8h.html#aea0c4e291bb4a98877f3e106aba231ad">BN_copy</a>(r ,a) != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (r != a)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a15094251b9047bc54ef42c702e65ce86">bn_wexpand</a>(r,<a class="code" href="bn__nist_8c.html#ad7301de5b30b8800f30738396fc5c3e1">BN_NIST_521_TOP</a>))</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                r_d = r-&gt;<a class="code" href="structbignum__st.html#afa4e4a2eb24f9c3df7eb33fd589cba31">d</a>;</div>
<div class="line">                nist_cp_bn(r_d,a_d, <a class="code" href="bn__nist_8c.html#ad7301de5b30b8800f30738396fc5c3e1">BN_NIST_521_TOP</a>);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                r_d = a_d;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* upper 521 bits, copy ... */</span></div>
<div class="line">        nist_cp_bn_0(t_d,a_d + (<a class="code" href="bn__nist_8c.html#ad7301de5b30b8800f30738396fc5c3e1">BN_NIST_521_TOP</a>-1), top - (<a class="code" href="bn__nist_8c.html#ad7301de5b30b8800f30738396fc5c3e1">BN_NIST_521_TOP</a>-1),<a class="code" href="bn__nist_8c.html#ad7301de5b30b8800f30738396fc5c3e1">BN_NIST_521_TOP</a>);</div>
<div class="line">        <span class="comment">/* ... and right shift */</span></div>
<div class="line">        <span class="keywordflow">for</span> (val=t_d[0],i=0; i&lt;<a class="code" href="bn__nist_8c.html#ad7301de5b30b8800f30738396fc5c3e1">BN_NIST_521_TOP</a>-1; i++)</div>
<div class="line">                {</div>
<div class="line">                tmp = val&gt;&gt;<a class="code" href="bn__nist_8c.html#acb71f0118dd01e5ac1acea36590bad76">BN_NIST_521_RSHIFT</a>;</div>
<div class="line">                val = t_d[i+1];</div>
<div class="line">                t_d[i] = (tmp | val&lt;&lt;<a class="code" href="bn__nist_8c.html#a0f6e2c58591d272db0aacd7c65ee14c6">BN_NIST_521_LSHIFT</a>) &amp; BN_MASK2;</div>
<div class="line">                }</div>
<div class="line">        t_d[i] = val&gt;&gt;<a class="code" href="bn__nist_8c.html#acb71f0118dd01e5ac1acea36590bad76">BN_NIST_521_RSHIFT</a>;</div>
<div class="line">        <span class="comment">/* lower 521 bits */</span></div>
<div class="line">        r_d[i] &amp;= <a class="code" href="bn__nist_8c.html#a2ca13195551c3ef9eb90d85bcee0634c">BN_NIST_521_TOP_MASK</a>;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="bn_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(r_d,r_d,t_d,BN_NIST_521_TOP);</div>
<div class="line">        mask = 0-(<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)<a class="code" href="bn_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(t_d,r_d,_nist_p_521,BN_NIST_521_TOP);</div>
<div class="line">        res  = t_d;</div>
<div class="line">        res  = (BN_ULONG *)(((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)res&amp;~mask) |</div>
<div class="line">         ((<a class="code" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">PTR_SIZE_INT</a>)r_d&amp;mask));</div>
<div class="line">        nist_cp_bn(r_d,res,BN_NIST_521_TOP);</div>
<div class="line">        r-&gt;<a class="code" href="structbignum__st.html#acb2587e7e0ff144adee978acd5b362f6">top</a> = <a class="code" href="bn__nist_8c.html#ad7301de5b30b8800f30738396fc5c3e1">BN_NIST_521_TOP</a>;</div>
<div class="line">        <a class="code" href="bn_8h.html#ac7cda4cbe7c292e7acbc0e66d7f45364">bn_correct_top</a>(r);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<h2>Variable Documentation</h2>
<a class="anchor" id="a4b690234a5014fd63c061917a8a14f3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(*)(<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *r, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *field, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx) BN_nist_mod_func(const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *p)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__nist_8c_source.html#l01131">1131</a> of file <a class="el" href="bn__nist_8c_source.html">bn_nist.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(&amp;_bignum_nist_p_192, p) == 0)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="bn_8h.html#a25002a8819cd80ceb14c322b2c231d04">BN_nist_mod_192</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(&amp;_bignum_nist_p_224, p) == 0)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="bn_8h.html#a7efaaa00d7e69268d6fdd3633a3441c3">BN_nist_mod_224</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(&amp;_bignum_nist_p_256, p) == 0)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="bn_8h.html#aba10eb20b364035a6587ac69f55685da">BN_nist_mod_256</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(&amp;_bignum_nist_p_384, p) == 0)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="bn_8h.html#aea39ce5e5e7c371e59cb7cdc0c20ea50">BN_nist_mod_384</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bn_8h.html#ab1ae0b9d9dfc923356e8a05a9a5be89a">BN_ucmp</a>(&amp;_bignum_nist_p_521, p) == 0)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="bn_8h.html#aacbcfe3b7eed155fae71d38af30ad2f1">BN_nist_mod_521</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 15 2014 18:16:50 for openssl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
