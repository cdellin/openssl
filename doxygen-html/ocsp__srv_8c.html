<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/ocsp/ocsp_srv.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_78588da27edc0b5889a78535ba3b1a98.html">ocsp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ocsp_srv.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="cryptlib_8h_source.html">cryptlib.h</a>&gt;</code><br/>
<code>#include &lt;openssl/objects.h&gt;</code><br/>
<code>#include &lt;openssl/rand.h&gt;</code><br/>
<code>#include &lt;openssl/x509.h&gt;</code><br/>
<code>#include &lt;openssl/pem.h&gt;</code><br/>
<code>#include &lt;openssl/x509v3.h&gt;</code><br/>
<code>#include &lt;openssl/ocsp.h&gt;</code><br/>
</div>
<p><a href="ocsp__srv_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0dde3b6cf29a05c93930920634f8d102"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__srv_8c.html#a0dde3b6cf29a05c93930920634f8d102">OCSP_request_onereq_count</a> (<a class="el" href="ocsp_8h.html#a17153531638085adb112e6bf8c2bd099">OCSP_REQUEST</a> *req)</td></tr>
<tr class="memitem:a304d87489ebfffd8716d1f6de310fc19"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ocsp_8h.html#a43e15d6fbd17f20cf0b3095cd123d234">OCSP_ONEREQ</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__srv_8c.html#a304d87489ebfffd8716d1f6de310fc19">OCSP_request_onereq_get0</a> (<a class="el" href="ocsp_8h.html#a17153531638085adb112e6bf8c2bd099">OCSP_REQUEST</a> *req, int i)</td></tr>
<tr class="memitem:aca76b651a94e920d0d89df61b471c871"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ocsp_8h.html#a41002d75e30dee19225768ebede01ccd">OCSP_CERTID</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__srv_8c.html#aca76b651a94e920d0d89df61b471c871">OCSP_onereq_get0_id</a> (<a class="el" href="ocsp_8h.html#a43e15d6fbd17f20cf0b3095cd123d234">OCSP_ONEREQ</a> *one)</td></tr>
<tr class="memitem:a4fa5aabb0ba79ffbf5b64404b124b9c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__srv_8c.html#a4fa5aabb0ba79ffbf5b64404b124b9c3">OCSP_id_get0_info</a> (<a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **piNameHash, <a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> **pmd, <a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **pikeyHash, <a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **pserial, <a class="el" href="ocsp_8h.html#a41002d75e30dee19225768ebede01ccd">OCSP_CERTID</a> *cid)</td></tr>
<tr class="memitem:a53ffe3ebe29e60caa5bed316aad17b4a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__srv_8c.html#a53ffe3ebe29e60caa5bed316aad17b4a">OCSP_request_is_signed</a> (<a class="el" href="ocsp_8h.html#a17153531638085adb112e6bf8c2bd099">OCSP_REQUEST</a> *req)</td></tr>
<tr class="memitem:ac48d1154c082306d404e6c6fbb2cbf19"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a126a9513b35297c9f53956eacf2b333d">OCSP_RESPONSE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__srv_8c.html#ac48d1154c082306d404e6c6fbb2cbf19">OCSP_response_create</a> (int status, <a class="el" href="ocsp_8h.html#ac8e546e24809bb0bdbc5ea5c662fea28">OCSP_BASICRESP</a> *bs)</td></tr>
<tr class="memitem:a52b71d75f6332dca67bac9a116ef4322"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ocsp_8h.html#a4a71db108c4230135b5df52537e65c3f">OCSP_SINGLERESP</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__srv_8c.html#a52b71d75f6332dca67bac9a116ef4322">OCSP_basic_add1_status</a> (<a class="el" href="ocsp_8h.html#ac8e546e24809bb0bdbc5ea5c662fea28">OCSP_BASICRESP</a> *rsp, <a class="el" href="ocsp_8h.html#a41002d75e30dee19225768ebede01ccd">OCSP_CERTID</a> *cid, int status, int reason, <a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *revtime, <a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *thisupd, <a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *nextupd)</td></tr>
<tr class="memitem:addeccd4714765aba4a22e96550214a77"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__srv_8c.html#addeccd4714765aba4a22e96550214a77">OCSP_basic_add1_cert</a> (<a class="el" href="ocsp_8h.html#ac8e546e24809bb0bdbc5ea5c662fea28">OCSP_BASICRESP</a> *resp, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *cert)</td></tr>
<tr class="memitem:a79f77c81002428b92733b0bcffaa20fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__srv_8c.html#a79f77c81002428b92733b0bcffaa20fa">OCSP_basic_sign</a> (<a class="el" href="ocsp_8h.html#ac8e546e24809bb0bdbc5ea5c662fea28">OCSP_BASICRESP</a> *brsp, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *signer, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, const <a class="el" href="ossl__typ_8h.html#aac66cf010326fa9a927c2a34888f45d3">EVP_MD</a> *dgst, <a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*certs, unsigned long <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
</table>
<h2>Function Documentation</h2>
<a class="anchor" id="addeccd4714765aba4a22e96550214a77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OCSP_basic_add1_cert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ocsp_8h.html#ac8e546e24809bb0bdbc5ea5c662fea28">OCSP_BASICRESP</a> *&#160;</td>
          <td class="paramname"><em>resp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__srv_8c_source.html#l00198">198</a> of file <a class="el" href="ocsp__srv_8c_source.html">ocsp_srv.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (!resp-&gt;certs &amp;&amp; !(resp-&gt;certs = <a class="code" href="safestack_8h.html#a44ae44bd51bbf3d40058762ac4f0d377">sk_X509_new_null</a>()))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!<a class="code" href="safestack_8h.html#a725eaf517607b2a1c8be5c25c8771003">sk_X509_push</a>(resp-&gt;certs, cert)) <span class="keywordflow">return</span> 0;</div>
<div class="line">        <a class="code" href="crypto_8h.html#ab8556c4f12443f1876ce487dd0c8db27">CRYPTO_add</a>(&amp;cert-&gt;<a class="code" href="structx509__st.html#ab1114b325664bca1cdfd6854f247a4d5">references</a>, 1, <a class="code" href="crypto_8h.html#abcd6591ef6acea51bf9f6edb6bb05bca">CRYPTO_LOCK_X509</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a52b71d75f6332dca67bac9a116ef4322"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ocsp_8h.html#a4a71db108c4230135b5df52537e65c3f">OCSP_SINGLERESP</a>* OCSP_basic_add1_status </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ocsp_8h.html#ac8e546e24809bb0bdbc5ea5c662fea28">OCSP_BASICRESP</a> *&#160;</td>
          <td class="paramname"><em>rsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ocsp_8h.html#a41002d75e30dee19225768ebede01ccd">OCSP_CERTID</a> *&#160;</td>
          <td class="paramname"><em>cid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reason</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *&#160;</td>
          <td class="paramname"><em>revtime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *&#160;</td>
          <td class="paramname"><em>thisupd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *&#160;</td>
          <td class="paramname"><em>nextupd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__srv_8c_source.html#l00124">124</a> of file <a class="el" href="ocsp__srv_8c_source.html">ocsp_srv.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a> *single = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structocsp__cert__status__st.html">OCSP_CERTSTATUS</a> *cs;</div>
<div class="line">        <a class="code" href="structocsp__revoked__info__st.html">OCSP_REVOKEDINFO</a> *ri;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!rsp-&gt;<a class="code" href="structocsp__basic__response__st.html#a09c6bafbf175745b5919a3e15055354c">tbsResponseData</a>-&gt;responses &amp;&amp;</div>
<div class="line">            !(rsp-&gt;<a class="code" href="structocsp__basic__response__st.html#a09c6bafbf175745b5919a3e15055354c">tbsResponseData</a>-&gt;responses = <a class="code" href="safestack_8h.html#a5cd31c73b79f272cbada0599e6cfa038">sk_OCSP_SINGLERESP_new_null</a>()))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(single = OCSP_SINGLERESP_new()))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="a__time_8c.html#ae6a253a24e0e687fbdf35d8198752e8b">ASN1_TIME_to_generalizedtime</a>(thisupd, &amp;single-&gt;<a class="code" href="structocsp__single__response__st.html#a1ed7424e4d254f4af8499303dce9ffb2">thisUpdate</a>))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (nextupd &amp;&amp;</div>
<div class="line">                !<a class="code" href="a__time_8c.html#ae6a253a24e0e687fbdf35d8198752e8b">ASN1_TIME_to_generalizedtime</a>(nextupd, &amp;single-&gt;<a class="code" href="structocsp__single__response__st.html#a54c06d485bae1de66d1e0b58403b2e25">nextUpdate</a>))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        OCSP_CERTID_free(single-&gt;<a class="code" href="structocsp__single__response__st.html#af26393e48e4a9f18955ec0b1785961fb">certId</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!(single-&gt;<a class="code" href="structocsp__single__response__st.html#af26393e48e4a9f18955ec0b1785961fb">certId</a> = <a class="code" href="ocsp_8h.html#af069ac1547a559775629d1753491cc8a">OCSP_CERTID_dup</a>(cid)))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        cs = single-&gt;<a class="code" href="structocsp__single__response__st.html#a2d8ac66aea93406dbf48c722c8f2d185">certStatus</a>;</div>
<div class="line">        <span class="keywordflow">switch</span>(cs-&gt;<a class="code" href="structocsp__cert__status__st.html#a8e834ed8fedd7e6709723625989a2dcf">type</a> = status)</div>
<div class="line">                {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ocsp_8h.html#af06457f204e23d6f9e43bb7d3b549f62">V_OCSP_CERTSTATUS_REVOKED</a>:</div>
<div class="line">                <span class="keywordflow">if</span> (!revtime)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#ac46ee1ac6fef1d3e48c96c8147d363ea">OCSPerr</a>(<a class="code" href="ocsp_8h.html#adc7b9e9d74b7dcd5f897c96ddd83ba69">OCSP_F_OCSP_BASIC_ADD1_STATUS</a>,<a class="code" href="ocsp_8h.html#a5c26c398641e2ba04f6a49682a181ddc">OCSP_R_NO_REVOKED_TIME</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (!(cs-&gt;<a class="code" href="structocsp__cert__status__st.html#ad4e0903c91075dcab4f1160c63375f2e">value</a>.<a class="code" href="structocsp__cert__status__st.html#a323bb45ae7def2ac2d8ad8541d7c12bd">revoked</a> = ri = OCSP_REVOKEDINFO_new())) <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="a__time_8c.html#ae6a253a24e0e687fbdf35d8198752e8b">ASN1_TIME_to_generalizedtime</a>(revtime, &amp;ri-&gt;<a class="code" href="structocsp__revoked__info__st.html#af95cc4676f07ed0d45dfbe2c4b851902">revocationTime</a>))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;       </div>
<div class="line">                <span class="keywordflow">if</span> (reason != <a class="code" href="ocsp_8h.html#af7470abb2ad14aa01a26ad5ec5ab34b1">OCSP_REVOKED_STATUS_NOSTATUS</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (!(ri-&gt;<a class="code" href="structocsp__revoked__info__st.html#a07edd6ecff783b2ad3e0ecf143fdddc3">revocationReason</a> = ASN1_ENUMERATED_new())) </div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        <span class="keywordflow">if</span> (!(<a class="code" href="a__enum_8c.html#a6ff974d35089d835efddcecb33c64a40">ASN1_ENUMERATED_set</a>(ri-&gt;<a class="code" href="structocsp__revoked__info__st.html#a07edd6ecff783b2ad3e0ecf143fdddc3">revocationReason</a>, </div>
<div class="line">                                                  reason)))</div>
<div class="line">                                <span class="keywordflow">goto</span> err;       </div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ocsp_8h.html#a643c7c2fcd1f3818d1463b99d30a771a">V_OCSP_CERTSTATUS_GOOD</a>:</div>
<div class="line">                cs-&gt;<a class="code" href="structocsp__cert__status__st.html#ad4e0903c91075dcab4f1160c63375f2e">value</a>.<a class="code" href="structocsp__cert__status__st.html#a96f64d7018fc012a59e5cbb4d315b16a">good</a> = ASN1_NULL_new();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ocsp_8h.html#ae799935dddc2858540d6a634aad1b71b">V_OCSP_CERTSTATUS_UNKNOWN</a>:</div>
<div class="line">                cs-&gt;<a class="code" href="structocsp__cert__status__st.html#ad4e0903c91075dcab4f1160c63375f2e">value</a>.<a class="code" href="structocsp__cert__status__st.html#a092195c83ed96b20960ecb39fb04bbe8">unknown</a> = ASN1_NULL_new();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!(<a class="code" href="safestack_8h.html#a5edd3d6e7a3687ab88f444fffd0e9d4b">sk_OCSP_SINGLERESP_push</a>(rsp-&gt;<a class="code" href="structocsp__basic__response__st.html#a09c6bafbf175745b5919a3e15055354c">tbsResponseData</a>-&gt;responses, single)))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">return</span> single;</div>
<div class="line">err:</div>
<div class="line">        OCSP_SINGLERESP_free(single);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a79f77c81002428b92733b0bcffaa20fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OCSP_basic_sign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ocsp_8h.html#ac8e546e24809bb0bdbc5ea5c662fea28">OCSP_BASICRESP</a> *&#160;</td>
          <td class="paramname"><em>brsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>signer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#aac66cf010326fa9a927c2a34888f45d3">EVP_MD</a> *&#160;</td>
          <td class="paramname"><em>dgst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__srv_8c_source.html#l00208">208</a> of file <a class="el" href="ocsp__srv_8c_source.html">ocsp_srv.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <a class="code" href="structocsp__responder__id__st.html">OCSP_RESPID</a> *rid;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="x509_8h.html#aa2b4d3747ff3ce6998e1e1423f2c6051">X509_check_private_key</a>(signer, key))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#ac46ee1ac6fef1d3e48c96c8147d363ea">OCSPerr</a>(<a class="code" href="ocsp_8h.html#ac1c913feb526c56e71ba4a19950d9c41">OCSP_F_OCSP_BASIC_SIGN</a>, <a class="code" href="ocsp_8h.html#abcb45252a79668248b27854c84f5a757">OCSP_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="ocsp_8h.html#a69aca835fc88c7a606ba255519622fff">OCSP_NOCERTS</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span>(!<a class="code" href="ocsp_8h.html#addeccd4714765aba4a22e96550214a77">OCSP_basic_add1_cert</a>(brsp, signer))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#af8495d81a6dda58254c7e12528af0118">sk_X509_num</a>(certs); i++)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="structx509__st.html">X509</a> *tmpcert = <a class="code" href="safestack_8h.html#a6ce8e2d1c31859b9b27cd535caba4388">sk_X509_value</a>(certs, i);</div>
<div class="line">                        <span class="keywordflow">if</span>(!<a class="code" href="ocsp_8h.html#addeccd4714765aba4a22e96550214a77">OCSP_basic_add1_cert</a>(brsp, tmpcert))</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        rid = brsp-&gt;<a class="code" href="structocsp__basic__response__st.html#a09c6bafbf175745b5919a3e15055354c">tbsResponseData</a>-&gt;<a class="code" href="structocsp__response__data__st.html#ad3f3152513fd758f44cec6d8b1d78375">responderId</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="ocsp_8h.html#a2e3716055996e26e4d1257e12af8a308">OCSP_RESPID_KEY</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> md[<a class="code" href="sha_8h.html#a1a715db7b4403fe6c165e49a32f5fe3d">SHA_DIGEST_LENGTH</a>];</div>
<div class="line">                <a class="code" href="x509_8h.html#ae6689523c2e4bb685381483d74ffeee4">X509_pubkey_digest</a>(signer, <a class="code" href="evp_8h.html#aa090d659a494a10525e38d272efb01ae">EVP_sha1</a>(), md, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (!(rid-&gt;<a class="code" href="structocsp__responder__id__st.html#a76f3f15f854603a3df53c0fc2b4e043e">value</a>.<a class="code" href="structocsp__responder__id__st.html#adcb31c53f92204c113dadabeec60c6ad">byKey</a> = ASN1_OCTET_STRING_new()))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (!(<a class="code" href="a__octet_8c.html#aa7e489173356c30fd3323dc83066a017">ASN1_OCTET_STRING_set</a>(rid-&gt;<a class="code" href="structocsp__responder__id__st.html#a76f3f15f854603a3df53c0fc2b4e043e">value</a>.<a class="code" href="structocsp__responder__id__st.html#adcb31c53f92204c113dadabeec60c6ad">byKey</a>, md, <a class="code" href="sha_8h.html#a1a715db7b4403fe6c165e49a32f5fe3d">SHA_DIGEST_LENGTH</a>)))</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                rid-&gt;<a class="code" href="structocsp__responder__id__st.html#a77bb04f705903d3d2e8c3b5671d6adc6">type</a> = <a class="code" href="ocsp_8h.html#a796f683cd3b84ca263abe32d1d6782c8">V_OCSP_RESPID_KEY</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="x__name_8c.html#a2b7f33760c1ad95f513ef3d835cf516f">X509_NAME_set</a>(&amp;rid-&gt;<a class="code" href="structocsp__responder__id__st.html#a76f3f15f854603a3df53c0fc2b4e043e">value</a>.<a class="code" href="structocsp__responder__id__st.html#ae32efd81ddf7eb1dc1f88e1c5f30de60">byName</a>,</div>
<div class="line">                                        <a class="code" href="x509_8h.html#aff52c219295ce864fb20f88050f9963c">X509_get_subject_name</a>(signer)))</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                rid-&gt;<a class="code" href="structocsp__responder__id__st.html#a77bb04f705903d3d2e8c3b5671d6adc6">type</a> = <a class="code" href="ocsp_8h.html#aff915b210d33e81bbcffa921ce150267">V_OCSP_RESPID_NAME</a>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(<a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="ocsp_8h.html#addc35ac028f54f7554cd80bd0ddfa2d6">OCSP_NOTIME</a>) &amp;&amp;</div>
<div class="line">                !<a class="code" href="x509_8h.html#a2af41732f9bd8d8b11ae2b94390d415a">X509_gmtime_adj</a>(brsp-&gt;<a class="code" href="structocsp__basic__response__st.html#a09c6bafbf175745b5919a3e15055354c">tbsResponseData</a>-&gt;<a class="code" href="structocsp__response__data__st.html#a70d47981b37a14ee1dabb1b8dd170e0d">producedAt</a>, 0))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Right now, I think that not doing double hashing is the right</span></div>
<div class="line"><span class="comment">           thing.       -- Richard Levitte */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="ocsp_8h.html#a889075b4e7d684711ba8561e6c81bb04">OCSP_BASICRESP_sign</a>(brsp, key, dgst, 0)) <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">err:</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4fa5aabb0ba79ffbf5b64404b124b9c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OCSP_id_get0_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **&#160;</td>
          <td class="paramname"><em>piNameHash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae3fda0801e4c8e250087052bafb3ce2e">ASN1_OBJECT</a> **&#160;</td>
          <td class="paramname"><em>pmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#afbd05e94e0f0430a2b729473efec88c1">ASN1_OCTET_STRING</a> **&#160;</td>
          <td class="paramname"><em>pikeyHash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af4335399bf9774cb410a5e93de65998b">ASN1_INTEGER</a> **&#160;</td>
          <td class="paramname"><em>pserial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ocsp_8h.html#a41002d75e30dee19225768ebede01ccd">OCSP_CERTID</a> *&#160;</td>
          <td class="paramname"><em>cid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__srv_8c_source.html#l00087">87</a> of file <a class="el" href="ocsp__srv_8c_source.html">ocsp_srv.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (!cid) <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (pmd) *pmd = cid-&gt;<a class="code" href="structocsp__cert__id__st.html#ab33f458f416845b6342c235d1afa63be">hashAlgorithm</a>-&gt;<a class="code" href="structX509__algor__st.html#a79eaee9147e50e87d311ccd20f781960">algorithm</a>;</div>
<div class="line">        <span class="keywordflow">if</span>(piNameHash) *piNameHash = cid-&gt;<a class="code" href="structocsp__cert__id__st.html#a778948e91d91afbfd895f5a3860d8d67">issuerNameHash</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (pikeyHash) *pikeyHash = cid-&gt;<a class="code" href="structocsp__cert__id__st.html#a46eeca1e6b207fba6e0ca844f59d6838">issuerKeyHash</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (pserial) *pserial = cid-&gt;<a class="code" href="structocsp__cert__id__st.html#a2385792d7888751bddbaa0dc150e9fbd">serialNumber</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aca76b651a94e920d0d89df61b471c871"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ocsp_8h.html#a41002d75e30dee19225768ebede01ccd">OCSP_CERTID</a>* OCSP_onereq_get0_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ocsp_8h.html#a43e15d6fbd17f20cf0b3095cd123d234">OCSP_ONEREQ</a> *&#160;</td>
          <td class="paramname"><em>one</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__srv_8c_source.html#l00082">82</a> of file <a class="el" href="ocsp__srv_8c_source.html">ocsp_srv.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> one-&gt;<a class="code" href="structocsp__one__request__st.html#acb10504260c2974865557a3d04ff0fa5">reqCert</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a53ffe3ebe29e60caa5bed316aad17b4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OCSP_request_is_signed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ocsp_8h.html#a17153531638085adb112e6bf8c2bd099">OCSP_REQUEST</a> *&#160;</td>
          <td class="paramname"><em>req</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__srv_8c_source.html#l00099">99</a> of file <a class="el" href="ocsp__srv_8c_source.html">ocsp_srv.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span>(req-&gt;<a class="code" href="structocsp__request__st.html#a97762bfa4b2c09c1811bfe21882fce5a">optionalSignature</a>) <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0dde3b6cf29a05c93930920634f8d102"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OCSP_request_onereq_count </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ocsp_8h.html#a17153531638085adb112e6bf8c2bd099">OCSP_REQUEST</a> *&#160;</td>
          <td class="paramname"><em>req</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__srv_8c_source.html#l00072">72</a> of file <a class="el" href="ocsp__srv_8c_source.html">ocsp_srv.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="safestack_8h.html#aefcb4790781312e05d4b22d50046c6e8">sk_OCSP_ONEREQ_num</a>(req-&gt;<a class="code" href="structocsp__request__st.html#a743dcc34d9ff06fe9635118c0a0030c0">tbsRequest</a>-&gt;requestList);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a304d87489ebfffd8716d1f6de310fc19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ocsp_8h.html#a43e15d6fbd17f20cf0b3095cd123d234">OCSP_ONEREQ</a>* OCSP_request_onereq_get0 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ocsp_8h.html#a17153531638085adb112e6bf8c2bd099">OCSP_REQUEST</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__srv_8c_source.html#l00077">77</a> of file <a class="el" href="ocsp__srv_8c_source.html">ocsp_srv.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="safestack_8h.html#a9974d819c1ec6fdb4184c6dab08d3ed4">sk_OCSP_ONEREQ_value</a>(req-&gt;<a class="code" href="structocsp__request__st.html#a743dcc34d9ff06fe9635118c0a0030c0">tbsRequest</a>-&gt;requestList, i);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac48d1154c082306d404e6c6fbb2cbf19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a126a9513b35297c9f53956eacf2b333d">OCSP_RESPONSE</a>* OCSP_response_create </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ocsp_8h.html#ac8e546e24809bb0bdbc5ea5c662fea28">OCSP_BASICRESP</a> *&#160;</td>
          <td class="paramname"><em>bs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__srv_8c_source.html#l00106">106</a> of file <a class="el" href="ocsp__srv_8c_source.html">ocsp_srv.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structocsp__response__st.html">OCSP_RESPONSE</a> *rsp = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(rsp = OCSP_RESPONSE_new())) <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!(<a class="code" href="a__enum_8c.html#a6ff974d35089d835efddcecb33c64a40">ASN1_ENUMERATED_set</a>(rsp-&gt;<a class="code" href="structocsp__response__st.html#a5c79d6dd4c93fb0946fc1e94467589fe">responseStatus</a>, status))) <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!bs) <span class="keywordflow">return</span> rsp;</div>
<div class="line">        <span class="keywordflow">if</span> (!(rsp-&gt;<a class="code" href="structocsp__response__st.html#a4724a80cc511a45789534e55588e5b9c">responseBytes</a> = OCSP_RESPBYTES_new())) <span class="keywordflow">goto</span> err;</div>
<div class="line">        rsp-&gt;<a class="code" href="structocsp__response__st.html#a4724a80cc511a45789534e55588e5b9c">responseBytes</a>-&gt;<a class="code" href="structocsp__resp__bytes__st.html#a304d3f8cf4f98279dca0624763ce8b01">responseType</a> = <a class="code" href="obj__dat_8c.html#a42d9bf0fd7cd17fe4101c74c215b37ca">OBJ_nid2obj</a>(<a class="code" href="obj__mac_8h.html#a6553b5371136e96074cbb544c394615c">NID_id_pkix_OCSP_basic</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="asn1_8h.html#ae48707fb4d9967ddb90ce4458c3810ab">ASN1_item_pack</a>(bs, <a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a>), &amp;rsp-&gt;<a class="code" href="structocsp__response__st.html#a4724a80cc511a45789534e55588e5b9c">responseBytes</a>-&gt;<a class="code" href="structocsp__resp__bytes__st.html#a98f9926c70716d7d4438aa7e87d17649">response</a>))</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">return</span> rsp;</div>
<div class="line">err:</div>
<div class="line">        <span class="keywordflow">if</span> (rsp) OCSP_RESPONSE_free(rsp);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
