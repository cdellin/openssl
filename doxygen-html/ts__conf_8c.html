<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/ts/ts_conf.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_fd67f02936ce579040fbe8641e0b0a68.html">ts</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ts_conf.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;openssl/crypto.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="cryptlib_8h_source.html">cryptlib.h</a>&quot;</code><br/>
<code>#include &lt;openssl/pem.h&gt;</code><br/>
<code>#include &lt;openssl/engine.h&gt;</code><br/>
<code>#include &lt;openssl/ts.h&gt;</code><br/>
</div>
<p><a href="ts__conf_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3fbfdf4266118350e2a435a5282c3364"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a3fbfdf4266118350e2a435a5282c3364">BASE_SECTION</a>&#160;&#160;&#160;&quot;tsa&quot;</td></tr>
<tr class="memitem:aea5f1a2352a7c930943071e9fc75765f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#aea5f1a2352a7c930943071e9fc75765f">ENV_DEFAULT_TSA</a>&#160;&#160;&#160;&quot;default_tsa&quot;</td></tr>
<tr class="memitem:a726048a97001612ad0a686d64c00b542"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a726048a97001612ad0a686d64c00b542">ENV_SERIAL</a>&#160;&#160;&#160;&quot;serial&quot;</td></tr>
<tr class="memitem:acea3cb200884c6431e2e42f93e3e89d0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#acea3cb200884c6431e2e42f93e3e89d0">ENV_CRYPTO_DEVICE</a>&#160;&#160;&#160;&quot;crypto_device&quot;</td></tr>
<tr class="memitem:a53703b2082902b10f2220ca25acc82eb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a53703b2082902b10f2220ca25acc82eb">ENV_SIGNER_CERT</a>&#160;&#160;&#160;&quot;signer_cert&quot;</td></tr>
<tr class="memitem:a2d54cba42196f1c3cecc9e5561d5eb08"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a2d54cba42196f1c3cecc9e5561d5eb08">ENV_CERTS</a>&#160;&#160;&#160;&quot;certs&quot;</td></tr>
<tr class="memitem:af5b0915d38810c00b1709405527a5ea2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#af5b0915d38810c00b1709405527a5ea2">ENV_SIGNER_KEY</a>&#160;&#160;&#160;&quot;signer_key&quot;</td></tr>
<tr class="memitem:aede0b32bce412eabb58ca3849419dabe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#aede0b32bce412eabb58ca3849419dabe">ENV_DEFAULT_POLICY</a>&#160;&#160;&#160;&quot;default_policy&quot;</td></tr>
<tr class="memitem:a592b4f6bd3a30e32fd794f7f2bba0ee5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a592b4f6bd3a30e32fd794f7f2bba0ee5">ENV_OTHER_POLICIES</a>&#160;&#160;&#160;&quot;other_policies&quot;</td></tr>
<tr class="memitem:a0516f413051a870dfcacca77463f8172"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a0516f413051a870dfcacca77463f8172">ENV_DIGESTS</a>&#160;&#160;&#160;&quot;digests&quot;</td></tr>
<tr class="memitem:ab37575c716b7f939f981e3e272de178a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#ab37575c716b7f939f981e3e272de178a">ENV_ACCURACY</a>&#160;&#160;&#160;&quot;accuracy&quot;</td></tr>
<tr class="memitem:a80f56d19f23779b25866f032084c44f6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a80f56d19f23779b25866f032084c44f6">ENV_ORDERING</a>&#160;&#160;&#160;&quot;ordering&quot;</td></tr>
<tr class="memitem:aab0c5988cd99f99ecb9df072b1f76725"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#aab0c5988cd99f99ecb9df072b1f76725">ENV_TSA_NAME</a>&#160;&#160;&#160;&quot;tsa_name&quot;</td></tr>
<tr class="memitem:ac54f6ae9696988130649ae1ca50aeff7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#ac54f6ae9696988130649ae1ca50aeff7">ENV_ESS_CERT_ID_CHAIN</a>&#160;&#160;&#160;&quot;ess_cert_id_chain&quot;</td></tr>
<tr class="memitem:ac27434646273ae7aa23c4b14a0c38ad7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#ac27434646273ae7aa23c4b14a0c38ad7">ENV_VALUE_SECS</a>&#160;&#160;&#160;&quot;secs&quot;</td></tr>
<tr class="memitem:a959f7281d727a002e84bb097e679db62"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a959f7281d727a002e84bb097e679db62">ENV_VALUE_MILLISECS</a>&#160;&#160;&#160;&quot;millisecs&quot;</td></tr>
<tr class="memitem:a5cd774edb95753284a9686bac2f7e5d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a5cd774edb95753284a9686bac2f7e5d6">ENV_VALUE_MICROSECS</a>&#160;&#160;&#160;&quot;microsecs&quot;</td></tr>
<tr class="memitem:a0a089a42cdc170ca6f2e329b4f0b8d3b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a0a089a42cdc170ca6f2e329b4f0b8d3b">ENV_CLOCK_PRECISION_DIGITS</a>&#160;&#160;&#160;&quot;clock_precision_digits&quot;</td></tr>
<tr class="memitem:a620c8a08996432dcd2154cf34021799b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a620c8a08996432dcd2154cf34021799b">ENV_VALUE_YES</a>&#160;&#160;&#160;&quot;yes&quot;</td></tr>
<tr class="memitem:a8f879d0a3fa624a6080b787d1f85db26"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a8f879d0a3fa624a6080b787d1f85db26">ENV_VALUE_NO</a>&#160;&#160;&#160;&quot;no&quot;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7af293292ea98436df3edce48be72c69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a7af293292ea98436df3edce48be72c69">TS_CONF_load_cert</a> (const char *<a class="el" href="conf_8h.html#af0baa3ccdd9d2a6adf03b72e2bea5789">file</a>)</td></tr>
<tr class="memitem:a00cf9f18b18b26449b4cde33c2f1d5ff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a00cf9f18b18b26449b4cde33c2f1d5ff">STACK_OF</a> (<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)</td></tr>
<tr class="memitem:ad48e4cb9bead7161aeaed08a7a174715"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#ad48e4cb9bead7161aeaed08a7a174715">TS_CONF_load_key</a> (const char *<a class="el" href="conf_8h.html#af0baa3ccdd9d2a6adf03b72e2bea5789">file</a>, const char *<a class="el" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>)</td></tr>
<tr class="memitem:aa9abf6497b0e1ed1d9759ce55e33e168"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#aa9abf6497b0e1ed1d9759ce55e33e168">TS_CONF_get_tsa_section</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>)</td></tr>
<tr class="memitem:ada11988bfa8736fbd401a5a2c9a073af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#ada11988bfa8736fbd401a5a2c9a073af">TS_CONF_set_serial</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>, <a class="el" href="ts_8h.html#a41bf93f9cc2b01382c134b2d786581d3">TS_serial_cb</a> <a class="el" href="dsagen_8c.html#aaf444bf60bdcdbb61c2afe741f506693">cb</a>, <a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:ab8bb47fff326d086f771a0e457d83c63"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#ab8bb47fff326d086f771a0e457d83c63">TS_CONF_set_crypto_device</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>, const char *device)</td></tr>
<tr class="memitem:a89648952a5c4bc8cd51a0cea543b04cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a89648952a5c4bc8cd51a0cea543b04cb">TS_CONF_set_default_engine</a> (const char *name)</td></tr>
<tr class="memitem:a30d5e8df67245a3ff66d6e77e83b37ae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a30d5e8df67245a3ff66d6e77e83b37ae">TS_CONF_set_signer_cert</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>, const char *cert, <a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:a90218d5fdf8cc6b91742d2b779d96024"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a90218d5fdf8cc6b91742d2b779d96024">TS_CONF_set_certs</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>, const char *certs, <a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:a85e3525443caeffa33c35a68cfd30a98"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a85e3525443caeffa33c35a68cfd30a98">TS_CONF_set_signer_key</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>, const char *<a class="el" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, const char *<a class="el" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>, <a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:a1ca228788cbb8ef09602031cfd42a2b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a1ca228788cbb8ef09602031cfd42a2b2">TS_CONF_set_def_policy</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>, const char *policy, <a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:ae4c6855e6353ba0b25f72b0c5fee1d74"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#ae4c6855e6353ba0b25f72b0c5fee1d74">TS_CONF_set_policies</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>, <a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:a443ebb27830ca469280ed0380d9662c8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a443ebb27830ca469280ed0380d9662c8">TS_CONF_set_digests</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>, <a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:a41da4268eaaa4429872554928ce479ca"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a41da4268eaaa4429872554928ce479ca">TS_CONF_set_accuracy</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>, <a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:aecac59ecf66b3bf50badb4f9db490842"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#aecac59ecf66b3bf50badb4f9db490842">TS_CONF_set_clock_precision_digits</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>, <a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:ae1ccf53a25158db99af453ab0866bc3a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#ae1ccf53a25158db99af453ab0866bc3a">TS_CONF_set_ordering</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>, <a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:a29ce739738891ff5b569bb01e25e7498"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a29ce739738891ff5b569bb01e25e7498">TS_CONF_set_tsa_name</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>, <a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
<tr class="memitem:a3ad82eb71fd13dc44716ef5fa3d1f8fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ts__conf_8c.html#a3ad82eb71fd13dc44716ef5fa3d1f8fa">TS_CONF_set_ess_cert_id_chain</a> (<a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *conf, const char *<a class="el" href="x509v3_8h.html#a34053b1a08396d7684fa1c2a83257343">section</a>, <a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *ctx)</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="a3fbfdf4266118350e2a435a5282c3364"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BASE_SECTION&#160;&#160;&#160;&quot;tsa&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00071">71</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab37575c716b7f939f981e3e272de178a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_ACCURACY&#160;&#160;&#160;&quot;accuracy&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00081">81</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2d54cba42196f1c3cecc9e5561d5eb08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_CERTS&#160;&#160;&#160;&quot;certs&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00076">76</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0a089a42cdc170ca6f2e329b4f0b8d3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_CLOCK_PRECISION_DIGITS&#160;&#160;&#160;&quot;clock_precision_digits&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00088">88</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="acea3cb200884c6431e2e42f93e3e89d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_CRYPTO_DEVICE&#160;&#160;&#160;&quot;crypto_device&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00074">74</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="aede0b32bce412eabb58ca3849419dabe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_DEFAULT_POLICY&#160;&#160;&#160;&quot;default_policy&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00078">78</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="aea5f1a2352a7c930943071e9fc75765f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_DEFAULT_TSA&#160;&#160;&#160;&quot;default_tsa&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00072">72</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0516f413051a870dfcacca77463f8172"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_DIGESTS&#160;&#160;&#160;&quot;digests&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00080">80</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac54f6ae9696988130649ae1ca50aeff7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_ESS_CERT_ID_CHAIN&#160;&#160;&#160;&quot;ess_cert_id_chain&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00084">84</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="a80f56d19f23779b25866f032084c44f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_ORDERING&#160;&#160;&#160;&quot;ordering&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00082">82</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="a592b4f6bd3a30e32fd794f7f2bba0ee5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_OTHER_POLICIES&#160;&#160;&#160;&quot;other_policies&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00079">79</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="a726048a97001612ad0a686d64c00b542"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_SERIAL&#160;&#160;&#160;&quot;serial&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00073">73</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="a53703b2082902b10f2220ca25acc82eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_SIGNER_CERT&#160;&#160;&#160;&quot;signer_cert&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00075">75</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="af5b0915d38810c00b1709405527a5ea2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_SIGNER_KEY&#160;&#160;&#160;&quot;signer_key&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00077">77</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="aab0c5988cd99f99ecb9df072b1f76725"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_TSA_NAME&#160;&#160;&#160;&quot;tsa_name&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00083">83</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5cd774edb95753284a9686bac2f7e5d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_VALUE_MICROSECS&#160;&#160;&#160;&quot;microsecs&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00087">87</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="a959f7281d727a002e84bb097e679db62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_VALUE_MILLISECS&#160;&#160;&#160;&quot;millisecs&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00086">86</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8f879d0a3fa624a6080b787d1f85db26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_VALUE_NO&#160;&#160;&#160;&quot;no&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00090">90</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac27434646273ae7aa23c4b14a0c38ad7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_VALUE_SECS&#160;&#160;&#160;&quot;secs&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00085">85</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<a class="anchor" id="a620c8a08996432dcd2154cf34021799b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENV_VALUE_YES&#160;&#160;&#160;&quot;yes&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00089">89</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a00cf9f18b18b26449b4cde33c2f1d5ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STACK_OF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00108">108</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *certs = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *othercerts = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structX509__info__st.html">X509_INFO</a>) *allcerts = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(certs = <a class="code" href="bio_8h.html#a6c0d03af86b3e556f64c1db01369c810">BIO_new_file</a>(<a class="code" href="conf_8h.html#af0baa3ccdd9d2a6adf03b72e2bea5789">file</a>, <span class="stringliteral">&quot;r&quot;</span>))) <span class="keywordflow">goto</span> end;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(othercerts = <a class="code" href="safestack_8h.html#a44ae44bd51bbf3d40058762ac4f0d377">sk_X509_new_null</a>())) <span class="keywordflow">goto</span> end;</div>
<div class="line">        allcerts = PEM_X509_INFO_read_bio(certs, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="safestack_8h.html#a04fe1192b0738130716bc36c70f66eb1">sk_X509_INFO_num</a>(allcerts); i++)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structX509__info__st.html">X509_INFO</a> *xi = <a class="code" href="safestack_8h.html#ab618f449a211fd465549255239a26796">sk_X509_INFO_value</a>(allcerts, i);</div>
<div class="line">                <span class="keywordflow">if</span> (xi-&gt;<a class="code" href="structX509__info__st.html#ab25bba431636552ba16640f61c42668c">x509</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="safestack_8h.html#a725eaf517607b2a1c8be5c25c8771003">sk_X509_push</a>(othercerts, xi-&gt;<a class="code" href="structX509__info__st.html#ab25bba431636552ba16640f61c42668c">x509</a>);</div>
<div class="line">                        xi-&gt;<a class="code" href="structX509__info__st.html#ab25bba431636552ba16640f61c42668c">x509</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">end:</div>
<div class="line">        <span class="keywordflow">if</span> (othercerts == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                fprintf(stderr, <span class="stringliteral">&quot;unable to load certificates: %s\n&quot;</span>, <a class="code" href="conf_8h.html#af0baa3ccdd9d2a6adf03b72e2bea5789">file</a>);</div>
<div class="line">        <a class="code" href="safestack_8h.html#a68be67d58783c0edb2b0305a322caa39">sk_X509_INFO_pop_free</a>(allcerts, <a class="code" href="x__info_8c.html#aed61d141ad888e0ab5db0e859598b25d">X509_INFO_free</a>);</div>
<div class="line">        <a class="code" href="bio_8h.html#abbfb67b5eb998ce232f2482b097da8b2">BIO_free</a>(certs);</div>
<div class="line">        <span class="keywordflow">return</span> othercerts;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa9abf6497b0e1ed1d9759ce55e33e168"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* TS_CONF_get_tsa_section </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00162">162</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a> = <a class="code" href="conf_8h.html#aa69b0a54a0ea26f7a5d056b07eb814e6">NCONF_get_string</a>(conf, <a class="code" href="ts__conf_8c.html#a3fbfdf4266118350e2a435a5282c3364">BASE_SECTION</a>, <a class="code" href="ts__conf_8c.html#aea5f1a2352a7c930943071e9fc75765f">ENV_DEFAULT_TSA</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>)</div>
<div class="line">                        TS_CONF_lookup_fail(<a class="code" href="ts__conf_8c.html#a3fbfdf4266118350e2a435a5282c3364">BASE_SECTION</a>, <a class="code" href="ts__conf_8c.html#aea5f1a2352a7c930943071e9fc75765f">ENV_DEFAULT_TSA</a>);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7af293292ea98436df3edce48be72c69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>* TS_CONF_load_cert </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00094">94</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *cert = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structx509__st.html">X509</a> *<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((cert = <a class="code" href="bio_8h.html#a6c0d03af86b3e556f64c1db01369c810">BIO_new_file</a>(<a class="code" href="conf_8h.html#af0baa3ccdd9d2a6adf03b72e2bea5789">file</a>, <span class="stringliteral">&quot;r&quot;</span>)) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <span class="keywordflow">goto</span> end;</div>
<div class="line">        x = PEM_read_bio_X509_AUX(cert, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">end:</div>
<div class="line">        <span class="keywordflow">if</span> (x == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                fprintf(stderr, <span class="stringliteral">&quot;unable to load certificate: %s\n&quot;</span>, <a class="code" href="conf_8h.html#af0baa3ccdd9d2a6adf03b72e2bea5789">file</a>);</div>
<div class="line">        <a class="code" href="bio_8h.html#abbfb67b5eb998ce232f2482b097da8b2">BIO_free</a>(cert);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad48e4cb9bead7161aeaed08a7a174715"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a>* TS_CONF_load_key </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00136">136</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structevp__pkey__st.html">EVP_PKEY</a> *pkey = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(key = <a class="code" href="bio_8h.html#a6c0d03af86b3e556f64c1db01369c810">BIO_new_file</a>(<a class="code" href="conf_8h.html#af0baa3ccdd9d2a6adf03b72e2bea5789">file</a>, <span class="stringliteral">&quot;r&quot;</span>))) <span class="keywordflow">goto</span> end;</div>
<div class="line">        pkey = <a class="code" href="pem__pkey_8c.html#a0672f53436eb012f0940caff980e60ed">PEM_read_bio_PrivateKey</a>(key, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, (<span class="keywordtype">char</span> *) <a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>);</div>
<div class="line"> end:</div>
<div class="line">        <span class="keywordflow">if</span> (pkey == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                fprintf(stderr, <span class="stringliteral">&quot;unable to load private key: %s\n&quot;</span>, <a class="code" href="conf_8h.html#af0baa3ccdd9d2a6adf03b72e2bea5789">file</a>);</div>
<div class="line">        <a class="code" href="bio_8h.html#abbfb67b5eb998ce232f2482b097da8b2">BIO_free</a>(key);</div>
<div class="line">        <span class="keywordflow">return</span> pkey;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a41da4268eaaa4429872554928ce479ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_accuracy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00406">406</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">int</span> secs = 0, millis = 0, micros = 0;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCONF__VALUE.html">CONF_VALUE</a>) *list = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">char</span> *accuracy = <a class="code" href="conf_8h.html#aa69b0a54a0ea26f7a5d056b07eb814e6">NCONF_get_string</a>(conf, <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#ab37575c716b7f939f981e3e272de178a">ENV_ACCURACY</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (accuracy &amp;&amp; !(list = X509V3_parse_list(accuracy)))</div>
<div class="line">                {</div>
<div class="line">                TS_CONF_invalid(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#ab37575c716b7f939f981e3e272de178a">ENV_ACCURACY</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a9390b80388abf2b0bda0124ec5072a2b">sk_CONF_VALUE_num</a>(list); ++i)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structCONF__VALUE.html">CONF_VALUE</a> *val = <a class="code" href="safestack_8h.html#a87e92a8fa826d3da5c3abe0d5192444b">sk_CONF_VALUE_value</a>(list, i);</div>
<div class="line">                <span class="keywordflow">if</span> (strcmp(val-&gt;<a class="code" href="structCONF__VALUE.html#a11c4d31c2078948fab12fd3fe2f75bbc">name</a>, <a class="code" href="ts__conf_8c.html#ac27434646273ae7aa23c4b14a0c38ad7">ENV_VALUE_SECS</a>) == 0) </div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (val-&gt;<a class="code" href="structCONF__VALUE.html#adc4e5ad327beced987b0d51bc4bdeb6e">value</a>) secs = atoi(val-&gt;<a class="code" href="structCONF__VALUE.html#adc4e5ad327beced987b0d51bc4bdeb6e">value</a>);</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(val-&gt;<a class="code" href="structCONF__VALUE.html#a11c4d31c2078948fab12fd3fe2f75bbc">name</a>, <a class="code" href="ts__conf_8c.html#a959f7281d727a002e84bb097e679db62">ENV_VALUE_MILLISECS</a>) == 0)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (val-&gt;<a class="code" href="structCONF__VALUE.html#adc4e5ad327beced987b0d51bc4bdeb6e">value</a>) millis = atoi(val-&gt;<a class="code" href="structCONF__VALUE.html#adc4e5ad327beced987b0d51bc4bdeb6e">value</a>);</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(val-&gt;<a class="code" href="structCONF__VALUE.html#a11c4d31c2078948fab12fd3fe2f75bbc">name</a>, <a class="code" href="ts__conf_8c.html#a5cd774edb95753284a9686bac2f7e5d6">ENV_VALUE_MICROSECS</a>) == 0)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (val-&gt;<a class="code" href="structCONF__VALUE.html#adc4e5ad327beced987b0d51bc4bdeb6e">value</a>) micros = atoi(val-&gt;<a class="code" href="structCONF__VALUE.html#adc4e5ad327beced987b0d51bc4bdeb6e">value</a>);</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                        TS_CONF_invalid(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#ab37575c716b7f939f981e3e272de178a">ENV_ACCURACY</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="ts_8h.html#a2f5b70ae938997c9f5a53b04f86c9599">TS_RESP_CTX_set_accuracy</a>(ctx, secs, millis, micros))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        ret = 1;</div>
<div class="line"> err:</div>
<div class="line">        <a class="code" href="safestack_8h.html#a33868b257332bc35656f6cd319295281">sk_CONF_VALUE_pop_free</a>(list, <a class="code" href="v3__utl_8c.html#a384e27b5ed7f1f63951accefc66a1403">X509V3_conf_free</a>);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a90218d5fdf8cc6b91742d2b779d96024"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_certs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00262">262</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *certs_obj = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (!certs) </div>
<div class="line">                certs = <a class="code" href="conf_8h.html#aa69b0a54a0ea26f7a5d056b07eb814e6">NCONF_get_string</a>(conf, <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a2d54cba42196f1c3cecc9e5561d5eb08">ENV_CERTS</a>);</div>
<div class="line">        <span class="comment">/* Certificate chain is optional. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!certs) <span class="keywordflow">goto</span> end;</div>
<div class="line">        <span class="keywordflow">if</span> (!(certs_obj = TS_CONF_load_certs(certs))) <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="ts_8h.html#a3e01ecfe8435b0654749564045f47342">TS_RESP_CTX_set_certs</a>(ctx, certs_obj)) <span class="keywordflow">goto</span> err;</div>
<div class="line"> end:</div>
<div class="line">        ret = 1;</div>
<div class="line"> err:</div>
<div class="line">        <a class="code" href="safestack_8h.html#a9f351ddac9a3f1d94fcdfacfc9083312">sk_X509_pop_free</a>(certs_obj, X509_free);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aecac59ecf66b3bf50badb4f9db490842"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_clock_precision_digits </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00449">449</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        <span class="keywordtype">long</span> digits = 0;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">/* If not specified, set the default value to 0, i.e. sec  precision */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="conf_8h.html#af0d28301016a85211bb747483bee71e1">NCONF_get_number_e</a>(conf, <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a0a089a42cdc170ca6f2e329b4f0b8d3b">ENV_CLOCK_PRECISION_DIGITS</a>,</div>
<div class="line">                                &amp;digits))</div>
<div class="line">                digits = 0;</div>
<div class="line">        <span class="keywordflow">if</span> (digits &lt; 0 || digits &gt; <a class="code" href="ts_8h.html#a675022b6db1ced7ce45974072b969568">TS_MAX_CLOCK_PRECISION_DIGITS</a>)</div>
<div class="line">                {</div>
<div class="line">                TS_CONF_invalid(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a0a089a42cdc170ca6f2e329b4f0b8d3b">ENV_CLOCK_PRECISION_DIGITS</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="ts_8h.html#a26d9076501317816353e777f335c8b28">TS_RESP_CTX_set_clock_precision_digits</a>(ctx, digits))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"> err:</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab8bb47fff326d086f771a0e457d83c63"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_crypto_device </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>device</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00192">192</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (!device)</div>
<div class="line">                device = <a class="code" href="conf_8h.html#aa69b0a54a0ea26f7a5d056b07eb814e6">NCONF_get_string</a>(conf, <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>,</div>
<div class="line">                                          <a class="code" href="ts__conf_8c.html#acea3cb200884c6431e2e42f93e3e89d0">ENV_CRYPTO_DEVICE</a>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (device &amp;&amp; !<a class="code" href="ts_8h.html#a89648952a5c4bc8cd51a0cea543b04cb">TS_CONF_set_default_engine</a>(device))</div>
<div class="line">                {</div>
<div class="line">                TS_CONF_invalid(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#acea3cb200884c6431e2e42f93e3e89d0">ENV_CRYPTO_DEVICE</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        ret = 1;</div>
<div class="line"> err:</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1ca228788cbb8ef09602031cfd42a2b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_def_policy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00302">302</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *policy_obj = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (!policy) </div>
<div class="line">                policy = <a class="code" href="conf_8h.html#aa69b0a54a0ea26f7a5d056b07eb814e6">NCONF_get_string</a>(conf, <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, </div>
<div class="line">                                          <a class="code" href="ts__conf_8c.html#aede0b32bce412eabb58ca3849419dabe">ENV_DEFAULT_POLICY</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!policy)</div>
<div class="line">                {</div>
<div class="line">                TS_CONF_lookup_fail(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#aede0b32bce412eabb58ca3849419dabe">ENV_DEFAULT_POLICY</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!(policy_obj = <a class="code" href="obj__dat_8c.html#ac69ffb2ce58e557243f7a30882f1f140">OBJ_txt2obj</a>(policy, 0)))</div>
<div class="line">                {</div>
<div class="line">                TS_CONF_invalid(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#aede0b32bce412eabb58ca3849419dabe">ENV_DEFAULT_POLICY</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="ts_8h.html#a0fb724460ef8d661df8d41c9bcad2385">TS_RESP_CTX_set_def_policy</a>(ctx, policy_obj))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        ret = 1;</div>
<div class="line"> err:</div>
<div class="line">        <a class="code" href="a__object_8c.html#ad2c99806f355ca34ae6af600b5fcb055">ASN1_OBJECT_free</a>(policy_obj);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a89648952a5c4bc8cd51a0cea543b04cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_default_engine </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00211">211</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structengine__st.html">ENGINE</a> *e = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Leave the default if builtin specified. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(name, <span class="stringliteral">&quot;builtin&quot;</span>) == 0) <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!(e = <a class="code" href="eng__list_8c.html#a3477259861a506347c6dcfe3e83daaaa">ENGINE_by_id</a>(name))) <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="comment">/* Enable the use of the NCipher HSM for forked children. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(name, <span class="stringliteral">&quot;chil&quot;</span>) == 0) </div>
<div class="line">                <a class="code" href="eng__ctrl_8c.html#ad8f1673866e89bea93c7a8587e608754">ENGINE_ctrl</a>(e, <a class="code" href="engine_8h.html#a17ff38b345cfb3b677521ca8eae3ebd8">ENGINE_CTRL_CHIL_SET_FORKCHECK</a>, 1, 0, 0);</div>
<div class="line">        <span class="comment">/* All the operations are going to be carried out by the engine. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="eng__fat_8c.html#adcf4dd4486469bed026516ebdeb2bbbc">ENGINE_set_default</a>(e, <a class="code" href="engine_8h.html#a4aba473b266346366abe7e95eef30afd">ENGINE_METHOD_ALL</a>)) <span class="keywordflow">goto</span> err;</div>
<div class="line">        ret = 1;</div>
<div class="line"> err:</div>
<div class="line">        <span class="keywordflow">if</span> (!ret)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#af53063c1a302a5acd2050c9f16dc598c">TSerr</a>(<a class="code" href="ts_8h.html#ab6687e42900ef34cad44affc379932a0">TS_F_TS_CONF_SET_DEFAULT_ENGINE</a>, </div>
<div class="line">                      <a class="code" href="ts_8h.html#a6329aaeb9e5cd49427c3b9388717b0ca">TS_R_COULD_NOT_SET_ENGINE</a>);</div>
<div class="line">                <a class="code" href="err_8c.html#a89d6b806fcd20c4ea07229451d489616">ERR_add_error_data</a>(2, <span class="stringliteral">&quot;engine:&quot;</span>, name);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (e) <a class="code" href="eng__lib_8c.html#af1ed15ac480cec888dbc05e8f779c6a2">ENGINE_free</a>(e);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a443ebb27830ca469280ed0380d9662c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_digests </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00364">364</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCONF__VALUE.html">CONF_VALUE</a>) *list = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">char</span> *digests = <a class="code" href="conf_8h.html#aa69b0a54a0ea26f7a5d056b07eb814e6">NCONF_get_string</a>(conf, <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a0516f413051a870dfcacca77463f8172">ENV_DIGESTS</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!digests)</div>
<div class="line">                {</div>
<div class="line">                TS_CONF_lookup_fail(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a0516f413051a870dfcacca77463f8172">ENV_DIGESTS</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!(list = X509V3_parse_list(digests)))</div>
<div class="line">                {</div>
<div class="line">                TS_CONF_invalid(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a0516f413051a870dfcacca77463f8172">ENV_DIGESTS</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="safestack_8h.html#a9390b80388abf2b0bda0124ec5072a2b">sk_CONF_VALUE_num</a>(list) == 0)</div>
<div class="line">                {</div>
<div class="line">                TS_CONF_invalid(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a0516f413051a870dfcacca77463f8172">ENV_DIGESTS</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a9390b80388abf2b0bda0124ec5072a2b">sk_CONF_VALUE_num</a>(list); ++i)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structCONF__VALUE.html">CONF_VALUE</a> *val = <a class="code" href="safestack_8h.html#a87e92a8fa826d3da5c3abe0d5192444b">sk_CONF_VALUE_value</a>(list, i);</div>
<div class="line">                <span class="keyword">const</span> <span class="keywordtype">char</span> *extval = val-&gt;<a class="code" href="structCONF__VALUE.html#adc4e5ad327beced987b0d51bc4bdeb6e">value</a> ? val-&gt;<a class="code" href="structCONF__VALUE.html#adc4e5ad327beced987b0d51bc4bdeb6e">value</a> : val-&gt;<a class="code" href="structCONF__VALUE.html#a11c4d31c2078948fab12fd3fe2f75bbc">name</a>;</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="structenv__md__st.html">EVP_MD</a> *md;</div>
<div class="line">                <span class="keywordflow">if</span> (!(md = <a class="code" href="evp_8h.html#a300143fb70c633da36138f96000e39c5">EVP_get_digestbyname</a>(extval)))</div>
<div class="line">                        {</div>
<div class="line">                        TS_CONF_invalid(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a0516f413051a870dfcacca77463f8172">ENV_DIGESTS</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="ts_8h.html#ac0a7ae67cc7d2c8333afff3f6f757ae5">TS_RESP_CTX_add_md</a>(ctx, md))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        ret = 1;</div>
<div class="line"> err:</div>
<div class="line">        <a class="code" href="safestack_8h.html#a33868b257332bc35656f6cd319295281">sk_CONF_VALUE_pop_free</a>(list, <a class="code" href="v3__utl_8c.html#a384e27b5ed7f1f63951accefc66a1403">X509V3_conf_free</a>);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3ad82eb71fd13dc44716ef5fa3d1f8fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_ess_cert_id_chain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00502">502</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> TS_CONF_add_flag(conf, <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#ac54f6ae9696988130649ae1ca50aeff7">ENV_ESS_CERT_ID_CHAIN</a>, </div>
<div class="line">                                <a class="code" href="ts_8h.html#a819c9ec7b701bfbce57f43386f500b43">TS_ESS_CERT_ID_CHAIN</a>, ctx);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae1ccf53a25158db99af453ab0866bc3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_ordering </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00492">492</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> TS_CONF_add_flag(conf, <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a80f56d19f23779b25866f032084c44f6">ENV_ORDERING</a>, <a class="code" href="ts_8h.html#a58910c6ad50a9c712ccc5be35f869cfe">TS_ORDERING</a>, ctx);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae4c6855e6353ba0b25f72b0c5fee1d74"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_policies </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00329">329</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structCONF__VALUE.html">CONF_VALUE</a>) *list = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">char</span> *policies = <a class="code" href="conf_8h.html#aa69b0a54a0ea26f7a5d056b07eb814e6">NCONF_get_string</a>(conf, <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, </div>
<div class="line">                                          <a class="code" href="ts__conf_8c.html#a592b4f6bd3a30e32fd794f7f2bba0ee5">ENV_OTHER_POLICIES</a>);</div>
<div class="line">        <span class="comment">/* If no other policy is specified, that&#39;s fine. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (policies &amp;&amp; !(list = X509V3_parse_list(policies)))</div>
<div class="line">                {</div>
<div class="line">                TS_CONF_invalid(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a592b4f6bd3a30e32fd794f7f2bba0ee5">ENV_OTHER_POLICIES</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a9390b80388abf2b0bda0124ec5072a2b">sk_CONF_VALUE_num</a>(list); ++i)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structCONF__VALUE.html">CONF_VALUE</a> *val = <a class="code" href="safestack_8h.html#a87e92a8fa826d3da5c3abe0d5192444b">sk_CONF_VALUE_value</a>(list, i);</div>
<div class="line">                <span class="keyword">const</span> <span class="keywordtype">char</span> *extval = val-&gt;<a class="code" href="structCONF__VALUE.html#adc4e5ad327beced987b0d51bc4bdeb6e">value</a> ? val-&gt;<a class="code" href="structCONF__VALUE.html#adc4e5ad327beced987b0d51bc4bdeb6e">value</a> : val-&gt;<a class="code" href="structCONF__VALUE.html#a11c4d31c2078948fab12fd3fe2f75bbc">name</a>;</div>
<div class="line">                <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *objtmp;</div>
<div class="line">                <span class="keywordflow">if</span> (!(objtmp = <a class="code" href="obj__dat_8c.html#ac69ffb2ce58e557243f7a30882f1f140">OBJ_txt2obj</a>(extval, 0)))</div>
<div class="line">                        {</div>
<div class="line">                        TS_CONF_invalid(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a592b4f6bd3a30e32fd794f7f2bba0ee5">ENV_OTHER_POLICIES</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="ts_8h.html#aaf6372a9c955aedaf7e649a3e14aa0be">TS_RESP_CTX_add_policy</a>(ctx, objtmp))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <a class="code" href="a__object_8c.html#ad2c99806f355ca34ae6af600b5fcb055">ASN1_OBJECT_free</a>(objtmp);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        ret = 1;</div>
<div class="line"> err:</div>
<div class="line">        <a class="code" href="safestack_8h.html#a33868b257332bc35656f6cd319295281">sk_CONF_VALUE_pop_free</a>(list, <a class="code" href="v3__utl_8c.html#a384e27b5ed7f1f63951accefc66a1403">X509V3_conf_free</a>);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ada11988bfa8736fbd401a5a2c9a073af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_serial </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a41bf93f9cc2b01382c134b2d786581d3">TS_serial_cb</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00173">173</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        <span class="keywordtype">char</span> *serial = <a class="code" href="conf_8h.html#aa69b0a54a0ea26f7a5d056b07eb814e6">NCONF_get_string</a>(conf, <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a726048a97001612ad0a686d64c00b542">ENV_SERIAL</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!serial)</div>
<div class="line">                {</div>
<div class="line">                TS_CONF_lookup_fail(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a726048a97001612ad0a686d64c00b542">ENV_SERIAL</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <a class="code" href="ts_8h.html#ad9f51f2ec16a9e93f91e9d5f41096541">TS_RESP_CTX_set_serial_cb</a>(ctx, <a class="code" href="pem_8h.html#a8dfe7b67aa87c6713a0e86b1456c1695">cb</a>, serial);</div>
<div class="line"></div>
<div class="line">        ret = 1;</div>
<div class="line"> err:</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a30d5e8df67245a3ff66d6e77e83b37ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_signer_cert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00239">239</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        <a class="code" href="structx509__st.html">X509</a> *cert_obj = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (!cert) </div>
<div class="line">                cert = <a class="code" href="conf_8h.html#aa69b0a54a0ea26f7a5d056b07eb814e6">NCONF_get_string</a>(conf, <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a53703b2082902b10f2220ca25acc82eb">ENV_SIGNER_CERT</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!cert)</div>
<div class="line">                {</div>
<div class="line">                TS_CONF_lookup_fail(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#a53703b2082902b10f2220ca25acc82eb">ENV_SIGNER_CERT</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!(cert_obj = <a class="code" href="ts_8h.html#a7af293292ea98436df3edce48be72c69">TS_CONF_load_cert</a>(cert)))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="ts_8h.html#ace501ad5abb317c322e23e4c9f574246">TS_RESP_CTX_set_signer_cert</a>(ctx, cert_obj))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        ret = 1;</div>
<div class="line"> err:</div>
<div class="line">        X509_free(cert_obj);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a85e3525443caeffa33c35a68cfd30a98"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_signer_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00280">280</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        <a class="code" href="structevp__pkey__st.html">EVP_PKEY</a> *key_obj = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>) </div>
<div class="line">                <a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a> = <a class="code" href="conf_8h.html#aa69b0a54a0ea26f7a5d056b07eb814e6">NCONF_get_string</a>(conf, <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#af5b0915d38810c00b1709405527a5ea2">ENV_SIGNER_KEY</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>)</div>
<div class="line">                {</div>
<div class="line">                TS_CONF_lookup_fail(<a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#af5b0915d38810c00b1709405527a5ea2">ENV_SIGNER_KEY</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (!(key_obj = <a class="code" href="ts_8h.html#ad48e4cb9bead7161aeaed08a7a174715">TS_CONF_load_key</a>(<a class="code" href="des_8c.html#a6a4ff80275090619f35902b61a8c6bf6">key</a>, <a class="code" href="pkcs12_8h.html#a3bef28806edf8f4c8cb82584b7e8c3cb">pass</a>))) <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="ts_8h.html#a2ad1034e40e7e9f33ca3422049237d83">TS_RESP_CTX_set_signer_key</a>(ctx, key_obj)) <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        ret = 1;</div>
<div class="line"> err:</div>
<div class="line">        <a class="code" href="evp_8h.html#a448d9f9209a54694aff045d403850db7">EVP_PKEY_free</a>(key_obj);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a29ce739738891ff5b569bb01e25e7498"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TS_CONF_set_tsa_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a22bfdc2f19c31f1ec7bd6d807aeb68d2">CONF</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ts_8h.html#a879054110214918c817e87745b5e7923">TS_RESP_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ts__conf_8c_source.html#l00497">497</a> of file <a class="el" href="ts__conf_8c_source.html">ts_conf.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> TS_CONF_add_flag(conf, <a class="code" href="conf_8h.html#a93c89824da901eb1b148337a6847a244">section</a>, <a class="code" href="ts__conf_8c.html#aab0c5988cd99f99ecb9df072b1f76725">ENV_TSA_NAME</a>, <a class="code" href="ts_8h.html#acd444eaf0ca3bec17f89fc6fee4e10c9">TS_TSA_NAME</a>, ctx);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
