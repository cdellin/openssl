<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/bio/bss_dgram.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_c5a221fb10ad418f17266024703620f0.html">bio</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">bss_dgram.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="cryptlib_8h_source.html">cryptlib.h</a>&quot;</code><br/>
<code>#include &lt;openssl/bio.h&gt;</code><br/>
<code>#include &lt;netinet/sctp.h&gt;</code><br/>
<code>#include &lt;fcntl.h&gt;</code><br/>
</div>
<p><a href="bss__dgram_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbio__dgram__data__st.html">bio_dgram_data_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbio__dgram__sctp__save__message__st.html">bio_dgram_sctp_save_message_st</a></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbio__dgram__sctp__data__st.html">bio_dgram_sctp_data_st</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:acc88493bed5c7a1a3f7485dae7e0f955"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#acc88493bed5c7a1a3f7485dae7e0f955">USE_SOCKETS</a></td></tr>
<tr class="memitem:af1951d157c3d33e3c358ac4b2a3766e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#af1951d157c3d33e3c358ac4b2a3766e5">OPENSSL_SCTP_DATA_CHUNK_TYPE</a>&#160;&#160;&#160;0x00</td></tr>
<tr class="memitem:ac3b38f60428bd9277e1be035640ecba6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#ac3b38f60428bd9277e1be035640ecba6">OPENSSL_SCTP_FORWARD_CUM_TSN_CHUNK_TYPE</a>&#160;&#160;&#160;0xc0</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a8d5eb65f4b5cc036ab53f9d17bbb395f"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structbio__dgram__data__st.html">bio_dgram_data_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#a8d5eb65f4b5cc036ab53f9d17bbb395f">bio_dgram_data</a></td></tr>
<tr class="memitem:a5a6cac191ec0c5225cd426acc7a4d15f"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structbio__dgram__sctp__save__message__st.html">bio_dgram_sctp_save_message_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#a5a6cac191ec0c5225cd426acc7a4d15f">bio_dgram_sctp_save_message</a></td></tr>
<tr class="memitem:a2f9f1a253990211b73e3217728324518"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structbio__dgram__sctp__data__st.html">bio_dgram_sctp_data_st</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#a2f9f1a253990211b73e3217728324518">bio_dgram_sctp_data</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a999b61be08fd5d6ace961146f98a0c69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#a2b58cec65ab7bb9eda7c86d707e687ca">BIO_METHOD</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#a999b61be08fd5d6ace961146f98a0c69">BIO_s_datagram</a> (void)</td></tr>
<tr class="memitem:a4ed159fa7431a10150b0adaa2d8fdfa7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#a4ed159fa7431a10150b0adaa2d8fdfa7">BIO_new_dgram</a> (int fd, int close_flag)</td></tr>
<tr class="memitem:a0037dc901bee2b48cf042e8e2cf5879f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#a2b58cec65ab7bb9eda7c86d707e687ca">BIO_METHOD</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#a0037dc901bee2b48cf042e8e2cf5879f">BIO_s_datagram_sctp</a> (void)</td></tr>
<tr class="memitem:a6d0ec4ff1b0113502cfd2c4acff02daa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#a6d0ec4ff1b0113502cfd2c4acff02daa">BIO_new_dgram_sctp</a> (int fd, int close_flag)</td></tr>
<tr class="memitem:a1f335fa8b46ddcdfc52cf260781363f9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#a1f335fa8b46ddcdfc52cf260781363f9">BIO_dgram_is_sctp</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *bio)</td></tr>
<tr class="memitem:a55a3029ddb00c919d74e8bfbb18a5f20"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#a55a3029ddb00c919d74e8bfbb18a5f20">BIO_dgram_sctp_notification_cb</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>, void(*handle_notifications)(<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *bio, void *context, void *buf), void *context)</td></tr>
<tr class="memitem:a6acac017a6adc77c6df9452b5ce4956e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#a6acac017a6adc77c6df9452b5ce4956e">BIO_dgram_sctp_wait_for_dry</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>)</td></tr>
<tr class="memitem:a09e63d1cdf0269f007905bb57911797e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#a09e63d1cdf0269f007905bb57911797e">BIO_dgram_sctp_msg_waiting</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>)</td></tr>
<tr class="memitem:ad91d4361631cb8465b16a5f6bfb00d44"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bss__dgram_8c.html#ad91d4361631cb8465b16a5f6bfb00d44">BIO_dgram_non_fatal_error</a> (int err)</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="af1951d157c3d33e3c358ac4b2a3766e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OPENSSL_SCTP_DATA_CHUNK_TYPE&#160;&#160;&#160;0x00</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bss__dgram_8c_source.html#l00076">76</a> of file <a class="el" href="bss__dgram_8c_source.html">bss_dgram.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac3b38f60428bd9277e1be035640ecba6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OPENSSL_SCTP_FORWARD_CUM_TSN_CHUNK_TYPE&#160;&#160;&#160;0xc0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bss__dgram_8c_source.html#l00077">77</a> of file <a class="el" href="bss__dgram_8c_source.html">bss_dgram.c</a>.</p>

</div>
</div>
<a class="anchor" id="acc88493bed5c7a1a3f7485dae7e0f955"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USE_SOCKETS</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bss__dgram_8c_source.html#l00063">63</a> of file <a class="el" href="bss__dgram_8c_source.html">bss_dgram.c</a>.</p>

</div>
</div>
<h2>Typedef Documentation</h2>
<a class="anchor" id="a8d5eb65f4b5cc036ab53f9d17bbb395f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structbio__dgram__data__st.html">bio_dgram_data_st</a>  <a class="el" href="bss__dgram_8c.html#a8d5eb65f4b5cc036ab53f9d17bbb395f">bio_dgram_data</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2f9f1a253990211b73e3217728324518"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structbio__dgram__sctp__data__st.html">bio_dgram_sctp_data_st</a>  <a class="el" href="bss__dgram_8c.html#a2f9f1a253990211b73e3217728324518">bio_dgram_sctp_data</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a5a6cac191ec0c5225cd426acc7a4d15f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structbio__dgram__sctp__save__message__st.html">bio_dgram_sctp_save_message_st</a>  <a class="el" href="bss__dgram_8c.html#a5a6cac191ec0c5225cd426acc7a4d15f">bio_dgram_sctp_save_message</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a1f335fa8b46ddcdfc52cf260781363f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BIO_dgram_is_sctp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>bio</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bss__dgram_8c_source.html#l01000">1000</a> of file <a class="el" href="bss__dgram_8c_source.html">bss_dgram.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> (<a class="code" href="bio_8h.html#a96ecbb07b3727908e41b304bac2586c9">BIO_method_type</a>(bio) == <a class="code" href="bio_8h.html#ab2d0877889a9b28d96368cfd1eec4327">BIO_TYPE_DGRAM_SCTP</a>);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad91d4361631cb8465b16a5f6bfb00d44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BIO_dgram_non_fatal_error </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>err</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bss__dgram_8c_source.html#l01840">1840</a> of file <a class="el" href="bss__dgram_8c_source.html">bss_dgram.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">switch</span> (err)</div>
<div class="line">                {</div>
<div class="line"><span class="preprocessor">#if defined(OPENSSL_SYS_WINDOWS)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor"># if defined(WSAEWOULDBLOCK)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">case</span> WSAEWOULDBLOCK:</div>
<div class="line"><span class="preprocessor"># endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor"># if 0 </span><span class="comment">/* This appears to always be an error */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#  if defined(WSAENOTCONN)</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">case</span> WSAENOTCONN:</div>
<div class="line"><span class="preprocessor">#  endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#ifdef EWOULDBLOCK</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor"># ifdef WSAEWOULDBLOCK</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#  if WSAEWOULDBLOCK != EWOULDBLOCK</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">case</span> EWOULDBLOCK:</div>
<div class="line"><span class="preprocessor">#  endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor"># else</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">case</span> EWOULDBLOCK:</div>
<div class="line"><span class="preprocessor"># endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#ifdef EINTR</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">case</span> EINTR:</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#ifdef EAGAIN</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#if EWOULDBLOCK != EAGAIN</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">case</span> EAGAIN:</div>
<div class="line"><span class="preprocessor"># endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#ifdef EPROTO</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">case</span> EPROTO:</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#ifdef EINPROGRESS</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">case</span> EINPROGRESS:</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#ifdef EALREADY</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">case</span> EALREADY:</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">                <span class="keywordflow">return</span>(1);</div>
<div class="line">                <span class="comment">/* break; */</span></div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span>(0);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a09e63d1cdf0269f007905bb57911797e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BIO_dgram_sctp_msg_waiting </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bss__dgram_8c_source.html#l01748">1748</a> of file <a class="el" href="bss__dgram_8c_source.html">bss_dgram.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> n, sockflags;</div>
<div class="line">        <span class="keyword">union </span>sctp_notification snp;</div>
<div class="line">        <span class="keyword">struct </span>msghdr msg;</div>
<div class="line">        <span class="keyword">struct </span>iovec iov;</div>
<div class="line">        <a class="code" href="structbio__dgram__sctp__data__st.html">bio_dgram_sctp_data</a> *<a class="code" href="e__bf_8c.html#aac2cc005a2915c6b6212402aeee7e635">data</a> = (<a class="code" href="structbio__dgram__sctp__data__st.html">bio_dgram_sctp_data</a> *)b-&gt;<a class="code" href="structbio__st.html#ad59e7884d7949dd931c76ac0d84c2ea5">ptr</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Check if there are any messages waiting to be read */</span></div>
<div class="line">        <span class="keywordflow">do</span></div>
<div class="line">                {</div>
<div class="line">                memset(&amp;snp, 0x00, <span class="keyword">sizeof</span>(<span class="keyword">union</span> sctp_notification));</div>
<div class="line">                iov.iov_base = (<span class="keywordtype">char</span> *)&amp;snp;</div>
<div class="line">                iov.iov_len = <span class="keyword">sizeof</span>(<span class="keyword">union </span>sctp_notification);</div>
<div class="line">                msg.msg_name = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                msg.msg_namelen = 0;</div>
<div class="line">                msg.msg_iov = &amp;iov;</div>
<div class="line">                msg.msg_iovlen = 1;</div>
<div class="line">                msg.msg_control = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                msg.msg_controllen = 0;</div>
<div class="line">                msg.msg_flags = 0;</div>
<div class="line"></div>
<div class="line">                sockflags = fcntl(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, F_GETFL, 0);</div>
<div class="line">                fcntl(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, F_SETFL, O_NONBLOCK);</div>
<div class="line">                n = recvmsg(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, &amp;msg, MSG_PEEK);</div>
<div class="line">                fcntl(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, F_SETFL, sockflags);</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* if notification, process and try again */</span></div>
<div class="line">                <span class="keywordflow">if</span> (n &gt; 0 &amp;&amp; (msg.msg_flags &amp; MSG_NOTIFICATION))</div>
<div class="line">                        {</div>
<div class="line"><span class="preprocessor">#ifdef SCTP_AUTHENTICATION_EVENT</span></div>
<div class="line"><span class="preprocessor"></span>                        <span class="keywordflow">if</span> (snp.sn_header.sn_type == SCTP_AUTHENTICATION_EVENT)</div>
<div class="line">                                dgram_sctp_handle_auth_free_key_event(b, &amp;snp);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">                        memset(&amp;snp, 0x00, <span class="keyword">sizeof</span>(<span class="keyword">union</span> sctp_notification));</div>
<div class="line">                        iov.iov_base = (<span class="keywordtype">char</span> *)&amp;snp;</div>
<div class="line">                        iov.iov_len = <span class="keyword">sizeof</span>(<span class="keyword">union </span>sctp_notification);</div>
<div class="line">                        msg.msg_name = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        msg.msg_namelen = 0;</div>
<div class="line">                        msg.msg_iov = &amp;iov;</div>
<div class="line">                        msg.msg_iovlen = 1;</div>
<div class="line">                        msg.msg_control = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        msg.msg_controllen = 0;</div>
<div class="line">                        msg.msg_flags = 0;</div>
<div class="line">                        n = recvmsg(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, &amp;msg, 0);</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">if</span> (data-&gt;handle_notifications != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                                data-&gt;handle_notifications(b, data-&gt;notification_context, (<span class="keywordtype">void</span>*) &amp;snp);</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                } <span class="keywordflow">while</span> (n &gt; 0 &amp;&amp; (msg.msg_flags &amp; MSG_NOTIFICATION));</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Return 1 if there is a message to be read, return 0 otherwise. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (n &gt; 0)</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a55a3029ddb00c919d74e8bfbb18a5f20"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BIO_dgram_sctp_notification_cb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *bio, void *context, void *buf)&#160;</td>
          <td class="paramname"><em>handle_notifications</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bss__dgram_8c_source.html#l01580">1580</a> of file <a class="el" href="bss__dgram_8c_source.html">bss_dgram.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__dgram__sctp__data__st.html">bio_dgram_sctp_data</a> *<a class="code" href="e__bf_8c.html#aac2cc005a2915c6b6212402aeee7e635">data</a> = (<a class="code" href="structbio__dgram__sctp__data__st.html">bio_dgram_sctp_data</a> *) b-&gt;<a class="code" href="structbio__st.html#ad59e7884d7949dd931c76ac0d84c2ea5">ptr</a>;</div>
<div class="line"></div>
<div class="line">        if (handle_notifications != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                data-&gt;<a class="code" href="structbio__dgram__sctp__data__st.html#af401f96613261f90ad390a013804f670">handle_notifications</a> = handle_notifications;</div>
<div class="line">                data-&gt;<a class="code" href="structbio__dgram__sctp__data__st.html#a36ade55d53ed99d415210dba6d8ad126">notification_context</a> = context;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6acac017a6adc77c6df9452b5ce4956e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BIO_dgram_sctp_wait_for_dry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bss__dgram_8c_source.html#l01597">1597</a> of file <a class="el" href="bss__dgram_8c_source.html">bss_dgram.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> is_dry = 0;</div>
<div class="line">        <span class="keywordtype">int</span> n, sockflags, ret;</div>
<div class="line">        <span class="keyword">union </span>sctp_notification snp;</div>
<div class="line">        <span class="keyword">struct </span>msghdr msg;</div>
<div class="line">        <span class="keyword">struct </span>iovec iov;</div>
<div class="line"><span class="preprocessor">#ifdef SCTP_EVENT</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keyword">struct </span>sctp_event event;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keyword">struct </span>sctp_event_subscribe event;</div>
<div class="line">        socklen_t eventsize;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <a class="code" href="structbio__dgram__sctp__data__st.html">bio_dgram_sctp_data</a> *<a class="code" href="e__bf_8c.html#aac2cc005a2915c6b6212402aeee7e635">data</a> = (<a class="code" href="structbio__dgram__sctp__data__st.html">bio_dgram_sctp_data</a> *)b-&gt;<a class="code" href="structbio__st.html#ad59e7884d7949dd931c76ac0d84c2ea5">ptr</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* set sender dry event */</span></div>
<div class="line">#ifdef SCTP_EVENT</div>
<div class="line">        memset(&amp;event, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sctp_event));</div>
<div class="line">        <span class="keyword">event</span>.se_assoc_id = 0;</div>
<div class="line">        <span class="keyword">event</span>.se_type = SCTP_SENDER_DRY_EVENT;</div>
<div class="line">        <span class="keyword">event</span>.se_on = 1;</div>
<div class="line">        ret = setsockopt(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, IPPROTO_SCTP, SCTP_EVENT, &amp;event, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sctp_event));</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        eventsize = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>sctp_event_subscribe);</div>
<div class="line">        ret = getsockopt(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, IPPROTO_SCTP, SCTP_EVENTS, &amp;event, &amp;eventsize);</div>
<div class="line">        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">event</span>.sctp_sender_dry_event = 1;</div>
<div class="line">        </div>
<div class="line">        ret = setsockopt(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, IPPROTO_SCTP, SCTP_EVENTS, &amp;event, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sctp_event_subscribe));</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* peek for notification */</span></div>
<div class="line">        memset(&amp;snp, 0x00, <span class="keyword">sizeof</span>(<span class="keyword">union</span> sctp_notification));</div>
<div class="line">        iov.iov_base = (<span class="keywordtype">char</span> *)&amp;snp;</div>
<div class="line">        iov.iov_len = <span class="keyword">sizeof</span>(<span class="keyword">union </span>sctp_notification);</div>
<div class="line">        msg.msg_name = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        msg.msg_namelen = 0;</div>
<div class="line">        msg.msg_iov = &amp;iov;</div>
<div class="line">        msg.msg_iovlen = 1;</div>
<div class="line">        msg.msg_control = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        msg.msg_controllen = 0;</div>
<div class="line">        msg.msg_flags = 0;</div>
<div class="line"></div>
<div class="line">        n = recvmsg(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, &amp;msg, MSG_PEEK);</div>
<div class="line">        <span class="keywordflow">if</span> (n &lt;= 0)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> ((n &lt; 0) &amp;&amp; (get_last_socket_error() != EAGAIN) &amp;&amp; (get_last_socket_error() != EWOULDBLOCK))</div>
<div class="line">                        <span class="keywordflow">return</span> -1;</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* if we find a notification, process it and try again if necessary */</span></div>
<div class="line">        <span class="keywordflow">while</span> (msg.msg_flags &amp; MSG_NOTIFICATION)</div>
<div class="line">                {</div>
<div class="line">                memset(&amp;snp, 0x00, <span class="keyword">sizeof</span>(<span class="keyword">union</span> sctp_notification));</div>
<div class="line">                iov.iov_base = (<span class="keywordtype">char</span> *)&amp;snp;</div>
<div class="line">                iov.iov_len = <span class="keyword">sizeof</span>(<span class="keyword">union </span>sctp_notification);</div>
<div class="line">                msg.msg_name = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                msg.msg_namelen = 0;</div>
<div class="line">                msg.msg_iov = &amp;iov;</div>
<div class="line">                msg.msg_iovlen = 1;</div>
<div class="line">                msg.msg_control = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                msg.msg_controllen = 0;</div>
<div class="line">                msg.msg_flags = 0;</div>
<div class="line"></div>
<div class="line">                n = recvmsg(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, &amp;msg, 0);</div>
<div class="line">                <span class="keywordflow">if</span> (n &lt;= 0)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> ((n &lt; 0) &amp;&amp; (get_last_socket_error() != EAGAIN) &amp;&amp; (get_last_socket_error() != EWOULDBLOCK))</div>
<div class="line">                                <span class="keywordflow">return</span> -1;</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                                <span class="keywordflow">return</span> is_dry;</div>
<div class="line">                        }</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">if</span> (snp.sn_header.sn_type == SCTP_SENDER_DRY_EVENT)</div>
<div class="line">                        {</div>
<div class="line">                        is_dry = 1;</div>
<div class="line"></div>
<div class="line">                        <span class="comment">/* disable sender dry event */</span></div>
<div class="line"><span class="preprocessor">#ifdef SCTP_EVENT</span></div>
<div class="line"><span class="preprocessor"></span>                        memset(&amp;event, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sctp_event));</div>
<div class="line">                        <span class="keyword">event</span>.se_assoc_id = 0;</div>
<div class="line">                        <span class="keyword">event</span>.se_type = SCTP_SENDER_DRY_EVENT;</div>
<div class="line">                        <span class="keyword">event</span>.se_on = 0;</div>
<div class="line">                        ret = setsockopt(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, IPPROTO_SCTP, SCTP_EVENT, &amp;event, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sctp_event));</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>                        eventsize = (socklen_t) <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sctp_event_subscribe);</div>
<div class="line">                        ret = getsockopt(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, IPPROTO_SCTP, SCTP_EVENTS, &amp;event, &amp;eventsize);</div>
<div class="line">                        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">                                <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">                        <span class="keyword">event</span>.sctp_sender_dry_event = 0;</div>
<div class="line"></div>
<div class="line">                        ret = setsockopt(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, IPPROTO_SCTP, SCTP_EVENTS, &amp;event, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sctp_event_subscribe));</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>                        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">                                <span class="keywordflow">return</span> -1;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifdef SCTP_AUTHENTICATION_EVENT</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keywordflow">if</span> (snp.sn_header.sn_type == SCTP_AUTHENTICATION_EVENT)</div>
<div class="line">                        dgram_sctp_handle_auth_free_key_event(b, &amp;snp);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">                <span class="keywordflow">if</span> (data-&gt;<a class="code" href="structbio__dgram__sctp__data__st.html#af401f96613261f90ad390a013804f670">handle_notifications</a> != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        data-&gt;<a class="code" href="structbio__dgram__sctp__data__st.html#af401f96613261f90ad390a013804f670">handle_notifications</a>(b, data-&gt;<a class="code" href="structbio__dgram__sctp__data__st.html#a36ade55d53ed99d415210dba6d8ad126">notification_context</a>, (<span class="keywordtype">void</span>*) &amp;snp);</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* found notification, peek again */</span></div>
<div class="line">                memset(&amp;snp, 0x00, <span class="keyword">sizeof</span>(<span class="keyword">union</span> sctp_notification));</div>
<div class="line">                iov.iov_base = (<span class="keywordtype">char</span> *)&amp;snp;</div>
<div class="line">                iov.iov_len = <span class="keyword">sizeof</span>(<span class="keyword">union </span>sctp_notification);</div>
<div class="line">                msg.msg_name = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                msg.msg_namelen = 0;</div>
<div class="line">                msg.msg_iov = &amp;iov;</div>
<div class="line">                msg.msg_iovlen = 1;</div>
<div class="line">                msg.msg_control = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                msg.msg_controllen = 0;</div>
<div class="line">                msg.msg_flags = 0;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* if we have seen the dry already, don&#39;t wait */</span></div>
<div class="line">                <span class="keywordflow">if</span> (is_dry)</div>
<div class="line">                        {</div>
<div class="line">                        sockflags = fcntl(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, F_GETFL, 0);</div>
<div class="line">                        fcntl(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, F_SETFL, O_NONBLOCK);</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                n = recvmsg(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, &amp;msg, MSG_PEEK);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (is_dry)</div>
<div class="line">                        {</div>
<div class="line">                        fcntl(b-&gt;<a class="code" href="structbio__st.html#a3b769c998195a0f139bc68e1a36aaf09">num</a>, F_SETFL, sockflags);</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (n &lt;= 0)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> ((n &lt; 0) &amp;&amp; (get_last_socket_error() != EAGAIN) &amp;&amp; (get_last_socket_error() != EWOULDBLOCK))</div>
<div class="line">                                <span class="keywordflow">return</span> -1;</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                                <span class="keywordflow">return</span> is_dry;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* read anything else */</span></div>
<div class="line">        <span class="keywordflow">return</span> is_dry;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4ed159fa7431a10150b0adaa2d8fdfa7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* BIO_new_dgram </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>close_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bss__dgram_8c_source.html#l00213">213</a> of file <a class="el" href="bss__dgram_8c_source.html">bss_dgram.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *ret;</div>
<div class="line"></div>
<div class="line">        ret=<a class="code" href="bio_8h.html#a581a4f51e785ab7df2d032d38f589259">BIO_new</a>(<a class="code" href="bio_8h.html#a999b61be08fd5d6ace961146f98a0c69">BIO_s_datagram</a>());</div>
<div class="line">        <span class="keywordflow">if</span> (ret == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <span class="keywordflow">return</span>(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        <a class="code" href="bio_8h.html#a397b05650d68fc5584bc4ead3d029045">BIO_set_fd</a>(ret,fd,close_flag);</div>
<div class="line">        <span class="keywordflow">return</span>(ret);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6d0ec4ff1b0113502cfd2c4acff02daa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* BIO_new_dgram_sctp </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>close_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bss__dgram_8c_source.html#l00920">920</a> of file <a class="el" href="bss__dgram_8c_source.html">bss_dgram.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbio__st.html">BIO</a> *bio;</div>
<div class="line">        <span class="keywordtype">int</span> ret, optval = 20000;</div>
<div class="line">        <span class="keywordtype">int</span> auth_data = 0, auth_forward = 0;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p;</div>
<div class="line">        <span class="keyword">struct </span>sctp_authchunk auth;</div>
<div class="line">        <span class="keyword">struct </span>sctp_authchunks *authchunks;</div>
<div class="line">        socklen_t sockopt_len;</div>
<div class="line"><span class="preprocessor">#ifdef SCTP_AUTHENTICATION_EVENT</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#ifdef SCTP_EVENT</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keyword">struct </span>sctp_event event;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keyword">struct </span>sctp_event_subscribe event;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        bio=<a class="code" href="bio_8h.html#a581a4f51e785ab7df2d032d38f589259">BIO_new</a>(<a class="code" href="bio_8h.html#a0037dc901bee2b48cf042e8e2cf5879f">BIO_s_datagram_sctp</a>());</div>
<div class="line">        <span class="keywordflow">if</span> (bio == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <span class="keywordflow">return</span>(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        <a class="code" href="bio_8h.html#a397b05650d68fc5584bc4ead3d029045">BIO_set_fd</a>(bio,fd,close_flag);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Activate SCTP-AUTH for DATA and FORWARD-TSN chunks */</span></div>
<div class="line">        auth.sauth_chunk = <a class="code" href="bss__dgram_8c.html#af1951d157c3d33e3c358ac4b2a3766e5">OPENSSL_SCTP_DATA_CHUNK_TYPE</a>;</div>
<div class="line">        ret = setsockopt(fd, IPPROTO_SCTP, SCTP_AUTH_CHUNK, &amp;auth, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sctp_authchunk));</div>
<div class="line">        <a class="code" href="crypto_8h.html#a6e3638bf542fc7a6a394f34124aa2cba">OPENSSL_assert</a>(ret &gt;= 0);</div>
<div class="line">        auth.sauth_chunk = <a class="code" href="bss__dgram_8c.html#ac3b38f60428bd9277e1be035640ecba6">OPENSSL_SCTP_FORWARD_CUM_TSN_CHUNK_TYPE</a>;</div>
<div class="line">        ret = setsockopt(fd, IPPROTO_SCTP, SCTP_AUTH_CHUNK, &amp;auth, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sctp_authchunk));</div>
<div class="line">        <a class="code" href="crypto_8h.html#a6e3638bf542fc7a6a394f34124aa2cba">OPENSSL_assert</a>(ret &gt;= 0);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Test if activation was successful. When using accept(),</span></div>
<div class="line"><span class="comment">         * SCTP-AUTH has to be activated for the listening socket</span></div>
<div class="line"><span class="comment">         * already, otherwise the connected socket won&#39;t use it. */</span></div>
<div class="line">        sockopt_len = (socklen_t)(<span class="keyword">sizeof</span>(sctp_assoc_t) + 256 * <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line">        authchunks = <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(sockopt_len);</div>
<div class="line">        memset(authchunks, 0, <span class="keyword">sizeof</span>(sockopt_len));</div>
<div class="line">        ret = getsockopt(fd, IPPROTO_SCTP, SCTP_LOCAL_AUTH_CHUNKS, authchunks, &amp;sockopt_len);</div>
<div class="line">        <a class="code" href="crypto_8h.html#a6e3638bf542fc7a6a394f34124aa2cba">OPENSSL_assert</a>(ret &gt;= 0);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (p = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) authchunks-&gt;gauth_chunks;</div>
<div class="line">             p &lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) authchunks + sockopt_len;</div>
<div class="line">             p += <span class="keyword">sizeof</span>(uint8_t))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (*p == <a class="code" href="bss__dgram_8c.html#af1951d157c3d33e3c358ac4b2a3766e5">OPENSSL_SCTP_DATA_CHUNK_TYPE</a>) auth_data = 1;</div>
<div class="line">                <span class="keywordflow">if</span> (*p == <a class="code" href="bss__dgram_8c.html#ac3b38f60428bd9277e1be035640ecba6">OPENSSL_SCTP_FORWARD_CUM_TSN_CHUNK_TYPE</a>) auth_forward = 1;</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(authchunks);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="crypto_8h.html#a6e3638bf542fc7a6a394f34124aa2cba">OPENSSL_assert</a>(auth_data);</div>
<div class="line">        <a class="code" href="crypto_8h.html#a6e3638bf542fc7a6a394f34124aa2cba">OPENSSL_assert</a>(auth_forward);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifdef SCTP_AUTHENTICATION_EVENT</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#ifdef SCTP_EVENT</span></div>
<div class="line"><span class="preprocessor"></span>        memset(&amp;event, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sctp_event));</div>
<div class="line">        <span class="keyword">event</span>.se_assoc_id = 0;</div>
<div class="line">        <span class="keyword">event</span>.se_type = SCTP_AUTHENTICATION_EVENT;</div>
<div class="line">        <span class="keyword">event</span>.se_on = 1;</div>
<div class="line">        ret = setsockopt(fd, IPPROTO_SCTP, SCTP_EVENT, &amp;event, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sctp_event));</div>
<div class="line">        <a class="code" href="crypto_8h.html#a6e3638bf542fc7a6a394f34124aa2cba">OPENSSL_assert</a>(ret &gt;= 0);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        sockopt_len = (socklen_t) <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sctp_event_subscribe);</div>
<div class="line">        ret = getsockopt(fd, IPPROTO_SCTP, SCTP_EVENTS, &amp;event, &amp;sockopt_len);</div>
<div class="line">        <a class="code" href="crypto_8h.html#a6e3638bf542fc7a6a394f34124aa2cba">OPENSSL_assert</a>(ret &gt;= 0);</div>
<div class="line"></div>
<div class="line">        <span class="keyword">event</span>.sctp_authentication_event = 1;</div>
<div class="line"></div>
<div class="line">        ret = setsockopt(fd, IPPROTO_SCTP, SCTP_EVENTS, &amp;event, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sctp_event_subscribe));</div>
<div class="line">        <a class="code" href="crypto_8h.html#a6e3638bf542fc7a6a394f34124aa2cba">OPENSSL_assert</a>(ret &gt;= 0);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        <span class="comment">/* Disable partial delivery by setting the min size</span></div>
<div class="line"><span class="comment">         * larger than the max record size of 2^14 + 2048 + 13</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        ret = setsockopt(fd, IPPROTO_SCTP, SCTP_PARTIAL_DELIVERY_POINT, &amp;optval, <span class="keyword">sizeof</span>(optval));</div>
<div class="line">        <a class="code" href="crypto_8h.html#a6e3638bf542fc7a6a394f34124aa2cba">OPENSSL_assert</a>(ret &gt;= 0);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(bio);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a999b61be08fd5d6ace961146f98a0c69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#a2b58cec65ab7bb9eda7c86d707e687ca">BIO_METHOD</a>* BIO_s_datagram </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bss__dgram_8c_source.html#l00208">208</a> of file <a class="el" href="bss__dgram_8c_source.html">bss_dgram.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span>(&amp;methods_dgramp);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0037dc901bee2b48cf042e8e2cf5879f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#a2b58cec65ab7bb9eda7c86d707e687ca">BIO_METHOD</a>* BIO_s_datagram_sctp </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bss__dgram_8c_source.html#l00915">915</a> of file <a class="el" href="bss__dgram_8c_source.html">bss_dgram.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span>(&amp;methods_dgramp_sctp);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 15 2014 18:16:50 for openssl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
