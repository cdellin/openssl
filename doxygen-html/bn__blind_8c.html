<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/bn/bn_blind.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_bf4984ea57f5888de95a64cb80bbf1fb.html">bn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">bn_blind.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="cryptlib_8h_source.html">cryptlib.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="bn__lcl_8h_source.html">bn_lcl.h</a>&quot;</code><br/>
</div>
<p><a href="bn__blind_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbn__blinding__st.html">bn_blinding_st</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a099e2c772dcc3de688ce53772001b364"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#a099e2c772dcc3de688ce53772001b364">OPENSSL_FIPSAPI</a></td></tr>
<tr class="memitem:a57f9622368cba549baba15b2d1a9392f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#a57f9622368cba549baba15b2d1a9392f">BN_BLINDING_COUNTER</a>&#160;&#160;&#160;32</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6f45590849103e534288a74007862e4c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#a6f45590849103e534288a74007862e4c">BN_BLINDING_new</a> (const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *A, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *Ai, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *mod)</td></tr>
<tr class="memitem:a656a25ba342cff26622239ed51774e81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#a656a25ba342cff26622239ed51774e81">BN_BLINDING_free</a> (<a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *r)</td></tr>
<tr class="memitem:ad50896c3163fef9d02aecbc9bcf296e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#ad50896c3163fef9d02aecbc9bcf296e6">BN_BLINDING_update</a> (<a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx)</td></tr>
<tr class="memitem:a0e6e29f103dc3e0f7a7ccfa27fe3e71c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#a0e6e29f103dc3e0f7a7ccfa27fe3e71c">BN_BLINDING_convert</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *n, <a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx)</td></tr>
<tr class="memitem:ad0b70fac24f5fcb176969c74a9711f98"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#ad0b70fac24f5fcb176969c74a9711f98">BN_BLINDING_convert_ex</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *n, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *r, <a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx)</td></tr>
<tr class="memitem:a999ec9e4c1907395f2267182adac3796"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#a999ec9e4c1907395f2267182adac3796">BN_BLINDING_invert</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *n, <a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx)</td></tr>
<tr class="memitem:a8d0bba3617c8fc715d196ed8bca12111"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#a8d0bba3617c8fc715d196ed8bca12111">BN_BLINDING_invert_ex</a> (<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *n, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *r, <a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx)</td></tr>
<tr class="memitem:ac780e6015e6460ef0fa8fecf5ca4e98b"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#ac780e6015e6460ef0fa8fecf5ca4e98b">BN_BLINDING_get_thread_id</a> (const <a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>)</td></tr>
<tr class="memitem:a0b9847780874ed9094b449774152c31f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#a0b9847780874ed9094b449774152c31f">BN_BLINDING_set_thread_id</a> (<a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>, unsigned long n)</td></tr>
<tr class="memitem:ad1a67b5c786c8621352fdfd6d0b6055c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="crypto_8h.html#a5da789a29aa0f39047c22cfe52462226">CRYPTO_THREADID</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#ad1a67b5c786c8621352fdfd6d0b6055c">BN_BLINDING_thread_id</a> (<a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>)</td></tr>
<tr class="memitem:a8d8206c4cc30232147e763f42f986cbe"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#a8d8206c4cc30232147e763f42f986cbe">BN_BLINDING_get_flags</a> (const <a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>)</td></tr>
<tr class="memitem:a1448101cd8c94c412bd6fe3ccd2dd26e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#a1448101cd8c94c412bd6fe3ccd2dd26e">BN_BLINDING_set_flags</a> (<a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>, unsigned long <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:a09503f075d7a1b3d111895e65e7e1a03"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__blind_8c.html#a09503f075d7a1b3d111895e65e7e1a03">BN_BLINDING_create_param</a> (<a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *e, <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *m, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx, int(*bn_mod_exp)(<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *r, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *p, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *m, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx, <a class="el" href="ossl__typ_8h.html#aec902d353e00ced6d3fee6cd033a8bd0">BN_MONT_CTX</a> *m_ctx), <a class="el" href="ossl__typ_8h.html#aec902d353e00ced6d3fee6cd033a8bd0">BN_MONT_CTX</a> *m_ctx)</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="a57f9622368cba549baba15b2d1a9392f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BN_BLINDING_COUNTER&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00118">118</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>

</div>
</div>
<a class="anchor" id="a099e2c772dcc3de688ce53772001b364"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OPENSSL_FIPSAPI</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00112">112</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a0e6e29f103dc3e0f7a7ccfa27fe3e71c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BN_BLINDING_convert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00221">221</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="bn_8h.html#a2c5a16f6e2cfee7d6c1797b7a49921ee">BN_BLINDING_convert_ex</a>(n, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, b, ctx);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad0b70fac24f5fcb176969c74a9711f98"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BN_BLINDING_convert_ex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00226">226</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret = 1;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="bn_8h.html#a95257c8ba175f77c58a26d83369efc96">bn_check_top</a>(n);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((b-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) || (b-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a16f8679dcdd6241ebccde4ef37f7f024">BNerr</a>(<a class="code" href="bn_8h.html#aafb0b46bf11cd7a19f429f8f7680aa8e">BN_F_BN_BLINDING_CONVERT_EX</a>,<a class="code" href="bn_8h.html#a7f6e61d46e8fba744f25e7d56375d166">BN_R_NOT_INITIALIZED</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(0);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbn__blinding__st.html#ad290c56dbdb3a510620d9a2d5415eb80">counter</a> == -1)</div>
<div class="line">                <span class="comment">/* Fresh blinding, doesn&#39;t need updating. */</span></div>
<div class="line">                b-&gt;<a class="code" href="structbn__blinding__st.html#ad290c56dbdb3a510620d9a2d5415eb80">counter</a> = 0;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#ad50896c3163fef9d02aecbc9bcf296e6">BN_BLINDING_update</a>(b,ctx))</div>
<div class="line">                <span class="keywordflow">return</span>(0);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (r != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#aea0c4e291bb4a98877f3e106aba231ad">BN_copy</a>(r, b-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a>)) ret=0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#ad0146b160c761fbfc83c1eeda4aee561">BN_mod_mul</a>(n,n,b-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>,b-&gt;<a class="code" href="structbn__blinding__st.html#a0fe6cfe69eb86b5ff2e386463d837fa1">mod</a>,ctx)) ret=0;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a09503f075d7a1b3d111895e65e7e1a03"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a>* BN_BLINDING_create_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(<a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *r, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *<a class="el" href="hpux_8cc.html#af3e37283d97a42ffc096d8958a745f32">a</a>, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *p, const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *m, <a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *ctx, <a class="el" href="ossl__typ_8h.html#aec902d353e00ced6d3fee6cd033a8bd0">BN_MONT_CTX</a> *m_ctx)&#160;</td>
          <td class="paramname"><em>bn_mod_exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#aec902d353e00ced6d3fee6cd033a8bd0">BN_MONT_CTX</a> *&#160;</td>
          <td class="paramname"><em>m_ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00308">308</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span>    retry_counter = 32;</div>
<div class="line">        <a class="code" href="structbn__blinding__st.html">BN_BLINDING</a> *ret = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (b == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                ret = <a class="code" href="bn_8h.html#a6f45590849103e534288a74007862e4c">BN_BLINDING_new</a>(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, m);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ret = <a class="code" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ret == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ret-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>  == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> &amp;&amp; (ret-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>  = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (ret-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> &amp;&amp; (ret-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a> = <a class="code" href="bn_8h.html#a778b82cdf93b0e855412c07aafed97f8">BN_new</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (e != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (ret-&gt;<a class="code" href="structbn__blinding__st.html#a6f198b46eb8c809cdc6510372a83c6f5">e</a> != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        <a class="code" href="bn_8h.html#a2d660f4ff6015d33035484c4e9f09e88">BN_free</a>(ret-&gt;<a class="code" href="structbn__blinding__st.html#a6f198b46eb8c809cdc6510372a83c6f5">e</a>);</div>
<div class="line">                ret-&gt;<a class="code" href="structbn__blinding__st.html#a6f198b46eb8c809cdc6510372a83c6f5">e</a> = <a class="code" href="bn_8h.html#a2301c52856e55cb85af5d72ba4d8813a">BN_dup</a>(e);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (ret-&gt;<a class="code" href="structbn__blinding__st.html#a6f198b46eb8c809cdc6510372a83c6f5">e</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (bn_mod_exp != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                ret-&gt;<a class="code" href="structbn__blinding__st.html#ad6fe09135d403350e93f84fc84602a4b">bn_mod_exp</a> = bn_mod_exp;</div>
<div class="line">        <span class="keywordflow">if</span> (m_ctx != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                ret-&gt;<a class="code" href="structbn__blinding__st.html#a9af9e265b9927ebf3f817c79540aedaf">m_ctx</a> = m_ctx;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">do</span> {</div>
<div class="line">                <span class="keywordtype">int</span> rv;</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#ad8ca9f1536dd428b6ecae7578dc2f6a2">BN_rand_range</a>(ret-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>, ret-&gt;<a class="code" href="structbn__blinding__st.html#a0fe6cfe69eb86b5ff2e386463d837fa1">mod</a>)) <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="bn__gcd_8c.html#a5a0c3c63cb1de41db24d5b41aebd2925">int_bn_mod_inverse</a>(ret-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a>, ret-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>, ret-&gt;<a class="code" href="structbn__blinding__st.html#a0fe6cfe69eb86b5ff2e386463d837fa1">mod</a>, ctx, &amp;rv))</div>
<div class="line">                        {</div>
<div class="line">                        <span class="comment">/* this should almost never happen for good RSA keys */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (rv)</div>
<div class="line">                                {</div>
<div class="line">                                <span class="keywordflow">if</span> (retry_counter-- == 0)</div>
<div class="line">                                {</div>
<div class="line">                                        <a class="code" href="err_8h.html#a16f8679dcdd6241ebccde4ef37f7f024">BNerr</a>(<a class="code" href="bn_8h.html#a71fa20f949a4d9eb47836a2dd37a65e2">BN_F_BN_BLINDING_CREATE_PARAM</a>,</div>
<div class="line">                                                <a class="code" href="bn_8h.html#add7a5d89c8eb6aac1043506a5fba35e1">BN_R_TOO_MANY_ITERATIONS</a>);</div>
<div class="line">                                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                                }</div>
<div class="line">                                }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">        } <span class="keywordflow">while</span> (1);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ret-&gt;<a class="code" href="structbn__blinding__st.html#ad6fe09135d403350e93f84fc84602a4b">bn_mod_exp</a> != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> &amp;&amp; ret-&gt;<a class="code" href="structbn__blinding__st.html#a9af9e265b9927ebf3f817c79540aedaf">m_ctx</a> != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!ret-&gt;<a class="code" href="structbn__blinding__st.html#ad6fe09135d403350e93f84fc84602a4b">bn_mod_exp</a>(ret-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>, ret-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>, ret-&gt;<a class="code" href="structbn__blinding__st.html#a6f198b46eb8c809cdc6510372a83c6f5">e</a>, ret-&gt;<a class="code" href="structbn__blinding__st.html#a0fe6cfe69eb86b5ff2e386463d837fa1">mod</a>, ctx, ret-&gt;<a class="code" href="structbn__blinding__st.html#a9af9e265b9927ebf3f817c79540aedaf">m_ctx</a>))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a4624503e0c5a02a37708ecd62734727c">BN_mod_exp</a>(ret-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>, ret-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>, ret-&gt;<a class="code" href="structbn__blinding__st.html#a6f198b46eb8c809cdc6510372a83c6f5">e</a>, ret-&gt;<a class="code" href="structbn__blinding__st.html#a0fe6cfe69eb86b5ff2e386463d837fa1">mod</a>, ctx))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">err:</div>
<div class="line">        <span class="keywordflow">if</span> (b == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> &amp;&amp; ret != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="bn_8h.html#aa60ce05adcbc7be96686316695c29388">BN_BLINDING_free</a>(ret);</div>
<div class="line">                ret = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a656a25ba342cff26622239ed51774e81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BN_BLINDING_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00176">176</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span>(r == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (r-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>  != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <a class="code" href="bn_8h.html#a2d660f4ff6015d33035484c4e9f09e88">BN_free</a>(r-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a> );</div>
<div class="line">        <span class="keywordflow">if</span> (r-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a> != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <a class="code" href="bn_8h.html#a2d660f4ff6015d33035484c4e9f09e88">BN_free</a>(r-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (r-&gt;<a class="code" href="structbn__blinding__st.html#a6f198b46eb8c809cdc6510372a83c6f5">e</a>  != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <a class="code" href="bn_8h.html#a2d660f4ff6015d33035484c4e9f09e88">BN_free</a>(r-&gt;<a class="code" href="structbn__blinding__st.html#a6f198b46eb8c809cdc6510372a83c6f5">e</a> );</div>
<div class="line">        <span class="keywordflow">if</span> (r-&gt;<a class="code" href="structbn__blinding__st.html#a0fe6cfe69eb86b5ff2e386463d837fa1">mod</a> != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <a class="code" href="bn_8h.html#a2d660f4ff6015d33035484c4e9f09e88">BN_free</a>(r-&gt;<a class="code" href="structbn__blinding__st.html#a0fe6cfe69eb86b5ff2e386463d837fa1">mod</a>); </div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(r);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8d8206c4cc30232147e763f42f986cbe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long BN_BLINDING_get_flags </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00298">298</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> b-&gt;<a class="code" href="structbn__blinding__st.html#adbe56227a805950d6ab0fbf9d3cc9344">flags</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac780e6015e6460ef0fa8fecf5ca4e98b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long BN_BLINDING_get_thread_id </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00282">282</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> b-&gt;<a class="code" href="structbn__blinding__st.html#a8f6468d10c6b28a4ac0d12f2b67afd31">thread_id</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a999ec9e4c1907395f2267182adac3796"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BN_BLINDING_invert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00254">254</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="bn_8h.html#a8d08604395fabfd2935156c70d29fd27">BN_BLINDING_invert_ex</a>(n, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, b, ctx);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8d0bba3617c8fc715d196ed8bca12111"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BN_BLINDING_invert_ex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00259">259</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="bn_8h.html#a95257c8ba175f77c58a26d83369efc96">bn_check_top</a>(n);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (r != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                ret = <a class="code" href="bn_8h.html#ad0146b160c761fbfc83c1eeda4aee561">BN_mod_mul</a>(n, n, r, b-&gt;<a class="code" href="structbn__blinding__st.html#a0fe6cfe69eb86b5ff2e386463d837fa1">mod</a>, ctx);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a16f8679dcdd6241ebccde4ef37f7f024">BNerr</a>(<a class="code" href="bn_8h.html#a3a7a33901ff49e7965f668f1f5782d31">BN_F_BN_BLINDING_INVERT_EX</a>,<a class="code" href="bn_8h.html#a7f6e61d46e8fba744f25e7d56375d166">BN_R_NOT_INITIALIZED</a>);</div>
<div class="line">                        <span class="keywordflow">return</span>(0);</div>
<div class="line">                        }</div>
<div class="line">                ret = <a class="code" href="bn_8h.html#ad0146b160c761fbfc83c1eeda4aee561">BN_mod_mul</a>(n, n, b-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a>, b-&gt;<a class="code" href="structbn__blinding__st.html#a0fe6cfe69eb86b5ff2e386463d837fa1">mod</a>, ctx);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="bn_8h.html#a95257c8ba175f77c58a26d83369efc96">bn_check_top</a>(n);</div>
<div class="line">        <span class="keywordflow">return</span>(ret);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6f45590849103e534288a74007862e4c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a>* BN_BLINDING_new </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>Ai</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a6fb19728907ec6515e4bfb716bffa141">BIGNUM</a> *&#160;</td>
          <td class="paramname"><em>mod</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00139">139</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structbn__blinding__st.html">BN_BLINDING</a> *ret=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="bn_8h.html#a95257c8ba175f77c58a26d83369efc96">bn_check_top</a>(mod);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((ret=(<a class="code" href="structbn__blinding__st.html">BN_BLINDING</a> *)<a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structbn__blinding__st.html">BN_BLINDING</a>))) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a16f8679dcdd6241ebccde4ef37f7f024">BNerr</a>(<a class="code" href="bn_8h.html#a7481c6d0662af087bdc952c0a7991f93">BN_F_BN_BLINDING_NEW</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span>(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                }</div>
<div class="line">        memset(ret,0,<span class="keyword">sizeof</span>(<a class="code" href="structbn__blinding__st.html">BN_BLINDING</a>));</div>
<div class="line">        <span class="keywordflow">if</span> (A != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> ((ret-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>  = <a class="code" href="bn_8h.html#a2301c52856e55cb85af5d72ba4d8813a">BN_dup</a>(A))  == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (Ai != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> ((ret-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a> = <a class="code" href="bn_8h.html#a2301c52856e55cb85af5d72ba4d8813a">BN_dup</a>(Ai)) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* save a copy of mod in the BN_BLINDING structure */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((ret-&gt;<a class="code" href="structbn__blinding__st.html#a0fe6cfe69eb86b5ff2e386463d837fa1">mod</a> = <a class="code" href="bn_8h.html#a2301c52856e55cb85af5d72ba4d8813a">BN_dup</a>(mod)) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <span class="keywordflow">goto</span> err;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bn_8h.html#a703b5d815865cb0309567af078d8cd48">BN_get_flags</a>(mod, <a class="code" href="bn_8h.html#adcf064b3d5a81b820d5054c7a6f6ddb9">BN_FLG_CONSTTIME</a>) != 0)</div>
<div class="line">                <a class="code" href="bn_8h.html#a1f5b75f253bd2f10ced985d6470f18b3">BN_set_flags</a>(ret-&gt;<a class="code" href="structbn__blinding__st.html#a0fe6cfe69eb86b5ff2e386463d837fa1">mod</a>, <a class="code" href="bn_8h.html#adcf064b3d5a81b820d5054c7a6f6ddb9">BN_FLG_CONSTTIME</a>);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Set the counter to the special value -1</span></div>
<div class="line"><span class="comment">         * to indicate that this is never-used fresh blinding</span></div>
<div class="line"><span class="comment">         * that does not need updating before first use. */</span></div>
<div class="line">        ret-&gt;<a class="code" href="structbn__blinding__st.html#ad290c56dbdb3a510620d9a2d5415eb80">counter</a> = -1;</div>
<div class="line">        <a class="code" href="crypto_8h.html#a5cb534419a491eefc612468062f83926">CRYPTO_THREADID_current</a>(&amp;ret-&gt;<a class="code" href="structbn__blinding__st.html#a4ccc2eb6381eeb84990b8d0e07834556">tid</a>);</div>
<div class="line">        <span class="keywordflow">return</span>(ret);</div>
<div class="line">err:</div>
<div class="line">        <span class="keywordflow">if</span> (ret != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <a class="code" href="bn_8h.html#aa60ce05adcbc7be96686316695c29388">BN_BLINDING_free</a>(ret);</div>
<div class="line">        <span class="keywordflow">return</span>(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1448101cd8c94c412bd6fe3ccd2dd26e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BN_BLINDING_set_flags </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00303">303</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        b-&gt;<a class="code" href="structbn__blinding__st.html#adbe56227a805950d6ab0fbf9d3cc9344">flags</a> = <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0b9847780874ed9094b449774152c31f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BN_BLINDING_set_thread_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00287">287</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        b-&gt;<a class="code" href="structbn__blinding__st.html#a8f6468d10c6b28a4ac0d12f2b67afd31">thread_id</a> = n;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad1a67b5c786c8621352fdfd6d0b6055c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8h.html#a5da789a29aa0f39047c22cfe52462226">CRYPTO_THREADID</a>* BN_BLINDING_thread_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00293">293</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> &amp;b-&gt;<a class="code" href="structbn__blinding__st.html#a4ccc2eb6381eeb84990b8d0e07834556">tid</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad50896c3163fef9d02aecbc9bcf296e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BN_BLINDING_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a38325fe1e4071c8c097396804df843bb">BN_BLINDING</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a0b235a35b7dd7922c097571ecd90e2bc">BN_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bn__blind_8c_source.html#l00188">188</a> of file <a class="el" href="bn__blind_8c_source.html">bn_blind.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret=0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((b-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) || (b-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a16f8679dcdd6241ebccde4ef37f7f024">BNerr</a>(<a class="code" href="bn_8h.html#acd7d300b68cc43e1cc1dcd05e89072d8">BN_F_BN_BLINDING_UPDATE</a>,<a class="code" href="bn_8h.html#a7f6e61d46e8fba744f25e7d56375d166">BN_R_NOT_INITIALIZED</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbn__blinding__st.html#ad290c56dbdb3a510620d9a2d5415eb80">counter</a> == -1)</div>
<div class="line">                b-&gt;<a class="code" href="structbn__blinding__st.html#ad290c56dbdb3a510620d9a2d5415eb80">counter</a> = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (++b-&gt;<a class="code" href="structbn__blinding__st.html#ad290c56dbdb3a510620d9a2d5415eb80">counter</a> == <a class="code" href="bn__blind_8c.html#a57f9622368cba549baba15b2d1a9392f">BN_BLINDING_COUNTER</a> &amp;&amp; b-&gt;<a class="code" href="structbn__blinding__st.html#a6f198b46eb8c809cdc6510372a83c6f5">e</a> != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a> &amp;&amp;</div>
<div class="line">                !(b-&gt;<a class="code" href="structbn__blinding__st.html#adbe56227a805950d6ab0fbf9d3cc9344">flags</a> &amp; <a class="code" href="bn_8h.html#aca8894dfb749add4e5781b22997f2cb7">BN_BLINDING_NO_RECREATE</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="comment">/* re-create blinding parameters */</span></div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#a09503f075d7a1b3d111895e65e7e1a03">BN_BLINDING_create_param</a>(b, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, ctx, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!(b-&gt;<a class="code" href="structbn__blinding__st.html#adbe56227a805950d6ab0fbf9d3cc9344">flags</a> &amp; <a class="code" href="bn_8h.html#a0ba6965e06f7fd189e658a1398bf21ec">BN_BLINDING_NO_UPDATE</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#ad0146b160c761fbfc83c1eeda4aee561">BN_mod_mul</a>(b-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>,b-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>,b-&gt;<a class="code" href="structbn__blinding__st.html#a11727b7b2b950c515f83895e006380d3">A</a>,b-&gt;<a class="code" href="structbn__blinding__st.html#a0fe6cfe69eb86b5ff2e386463d837fa1">mod</a>,ctx)) <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="bn_8h.html#ad0146b160c761fbfc83c1eeda4aee561">BN_mod_mul</a>(b-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a>,b-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a>,b-&gt;<a class="code" href="structbn__blinding__st.html#a84df31a5c2a07ed8d2af204bf7290ad7">Ai</a>,b-&gt;<a class="code" href="structbn__blinding__st.html#a0fe6cfe69eb86b5ff2e386463d837fa1">mod</a>,ctx)) <span class="keywordflow">goto</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        ret=1;</div>
<div class="line">err:</div>
<div class="line">        <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbn__blinding__st.html#ad290c56dbdb3a510620d9a2d5415eb80">counter</a> == <a class="code" href="bn__blind_8c.html#a57f9622368cba549baba15b2d1a9392f">BN_BLINDING_COUNTER</a>)</div>
<div class="line">                b-&gt;<a class="code" href="structbn__blinding__st.html#ad290c56dbdb3a510620d9a2d5415eb80">counter</a> = 0;</div>
<div class="line">        <span class="keywordflow">return</span>(ret);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 15 2014 18:16:50 for openssl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
