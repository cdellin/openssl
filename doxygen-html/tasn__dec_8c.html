<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/asn1/tasn_dec.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_4789766cb6a80a806f336711a14ff3d1.html">asn1</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tasn_dec.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stddef.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;openssl/asn1.h&gt;</code><br/>
<code>#include &lt;openssl/asn1t.h&gt;</code><br/>
<code>#include &lt;openssl/objects.h&gt;</code><br/>
<code>#include &lt;openssl/buffer.h&gt;</code><br/>
<code>#include &lt;openssl/err.h&gt;</code><br/>
</div>
<p><a href="tasn__dec_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aeba859e5523f1039e9fc3e5423c0902d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tasn__dec_8c.html#aeba859e5523f1039e9fc3e5423c0902d">asn1_tlc_clear</a>(<a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a>)&#160;&#160;&#160;if (<a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a>) (<a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a>)-&gt;valid = 0</td></tr>
<tr class="memitem:a55f020350524c4f8027dadb056b42a73"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tasn__dec_8c.html#a55f020350524c4f8027dadb056b42a73">asn1_tlc_clear_nc</a>(<a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a>)&#160;&#160;&#160;(<a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a>)-&gt;valid = 0</td></tr>
<tr class="memitem:a149ccb0b1169ed883aef4d7103d6160c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tasn__dec_8c.html#a149ccb0b1169ed883aef4d7103d6160c">ASN1_MAX_STRING_NEST</a>&#160;&#160;&#160;5</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5cf29ea4e454ef332831021c1968ad44"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tasn__dec_8c.html#a5cf29ea4e454ef332831021c1968ad44">ASN1_tag2bit</a> (int tag)</td></tr>
<tr class="memitem:a29a443a5f8940076e1bcd7ed1f8f1d75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tasn__dec_8c.html#a29a443a5f8940076e1bcd7ed1f8f1d75">ASN1_item_d2i</a> (<a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **pval, const unsigned char **<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, long <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const <a class="el" href="ossl__typ_8h.html#aea7867d0d5f4d561d2cbf24a9ce49e40">ASN1_ITEM</a> *it)</td></tr>
<tr class="memitem:a97d8df6533ab027de378bc75f10f4fd2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tasn__dec_8c.html#a97d8df6533ab027de378bc75f10f4fd2">ASN1_template_d2i</a> (<a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **pval, const unsigned char **<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, long <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const <a class="el" href="asn1_8h.html#a6c952ee1ae445fda1ca8e1761bbd93ac">ASN1_TEMPLATE</a> *tt)</td></tr>
<tr class="memitem:ae468bdef89c57e81f1e6082f52b94c5d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tasn__dec_8c.html#ae468bdef89c57e81f1e6082f52b94c5d">ASN1_item_ex_d2i</a> (<a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **pval, const unsigned char **<a class="el" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, long <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, const <a class="el" href="ossl__typ_8h.html#aea7867d0d5f4d561d2cbf24a9ce49e40">ASN1_ITEM</a> *it, int tag, int aclass, char opt, <a class="el" href="asn1_8h.html#a71873837864aac1d3532354b7be79222">ASN1_TLC</a> *ctx)</td></tr>
<tr class="memitem:a57618215d5aa6237763ff9fac9ba6391"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tasn__dec_8c.html#a57618215d5aa6237763ff9fac9ba6391">asn1_ex_c2i</a> (<a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **pval, const unsigned char *cont, int <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, int utype, char *free_cont, const <a class="el" href="ossl__typ_8h.html#aea7867d0d5f4d561d2cbf24a9ce49e40">ASN1_ITEM</a> *it)</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="a149ccb0b1169ed883aef4d7103d6160c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ASN1_MAX_STRING_NEST&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tasn__dec_8c_source.html#l01150">1150</a> of file <a class="el" href="tasn__dec_8c_source.html">tasn_dec.c</a>.</p>

</div>
</div>
<a class="anchor" id="aeba859e5523f1039e9fc3e5423c0902d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define asn1_tlc_clear</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a></td><td>)</td>
          <td>&#160;&#160;&#160;if (<a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a>) (<a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a>)-&gt;valid = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tasn__dec_8c_source.html#l00116">116</a> of file <a class="el" href="tasn__dec_8c_source.html">tasn_dec.c</a>.</p>

</div>
</div>
<a class="anchor" id="a55f020350524c4f8027dadb056b42a73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define asn1_tlc_clear_nc</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a></td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="wp__block_8c.html#a188fd389cdeb9a7645273b3d49f06674">c</a>)-&gt;valid = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tasn__dec_8c_source.html#l00118">118</a> of file <a class="el" href="tasn__dec_8c_source.html">tasn_dec.c</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a57618215d5aa6237763ff9fac9ba6391"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int asn1_ex_c2i </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **&#160;</td>
          <td class="paramname"><em>pval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>cont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>utype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>free_cont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#aea7867d0d5f4d561d2cbf24a9ce49e40">ASN1_ITEM</a> *&#160;</td>
          <td class="paramname"><em>it</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tasn__dec_8c_source.html#l00919">919</a> of file <a class="el" href="tasn__dec_8c_source.html">tasn_dec.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **opval = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_STRING</a> *stmp;</div>
<div class="line">        <a class="code" href="structasn1__type__st.html">ASN1_TYPE</a> *typ = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html">ASN1_PRIMITIVE_FUNCS</a> *pf;</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_INTEGER</a> **tint;</div>
<div class="line">        pf = it-&gt;<a class="code" href="structASN1__ITEM__st.html#abb4e623222d55a9c7b203c9b29e5aefe">funcs</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (pf &amp;&amp; pf-&gt;<a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#ad798e3c6d829661a8c5607d271454a4f">prim_c2i</a>)</div>
<div class="line">                <span class="keywordflow">return</span> pf-&gt;<a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#ad798e3c6d829661a8c5607d271454a4f">prim_c2i</a>(pval, cont, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, utype, free_cont, it);</div>
<div class="line">        <span class="comment">/* If ANY type clear type and set pointer to internal value */</span></div>
<div class="line">        <span class="keywordflow">if</span> (it-&gt;<a class="code" href="structASN1__ITEM__st.html#a49602e67011b80d23622751f6ce154f5">utype</a> == <a class="code" href="asn1_8h.html#a18cf605aaf607666cb51932ebe252664">V_ASN1_ANY</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (!*pval)</div>
<div class="line">                        {</div>
<div class="line">                        typ = ASN1_TYPE_new();</div>
<div class="line">                        <span class="keywordflow">if</span> (typ == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        *pval = (<a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> *)typ;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        typ = (<a class="code" href="structasn1__type__st.html">ASN1_TYPE</a> *)*pval;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (utype != typ-&gt;<a class="code" href="structasn1__type__st.html#af1bd6ef16c406f3cd3fa67eb81693b54">type</a>)</div>
<div class="line">                        <a class="code" href="a__type_8c.html#a98c2c27543d3a203f1e8008d1170bf6e">ASN1_TYPE_set</a>(typ, utype, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                opval = pval;</div>
<div class="line">                pval = &amp;typ-&gt;<a class="code" href="structasn1__type__st.html#ab37a86242c23b20bd17ee2adb4678e38">value</a>.<a class="code" href="structasn1__type__st.html#a39afa731aecc9cc93c4d21c7fca573bc">asn1_value</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">switch</span>(utype)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#aa8aa9044005ad5fec5af188c7c1bd186">V_ASN1_OBJECT</a>:</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="a__object_8c.html#ad6930c3b02bf2cc936513b8cf230cceb">c2i_ASN1_OBJECT</a>((<a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> **)pval, &amp;cont, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a0ee96d376143ded4fe24f9dd70da6a29">V_ASN1_NULL</a>:</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#aac32b6e57c5afaea96a87c0cd275f071">ASN1_F_ASN1_EX_C2I</a>,</div>
<div class="line">                                                <a class="code" href="asn1_8h.html#a357a04460fa5b233e6d025931bb90306">ASN1_R_NULL_IS_WRONG_LENGTH</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                *pval = (<a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> *)1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#aff59c36cefb3d3b8ef813971f1aa165d">V_ASN1_BOOLEAN</a>:</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> != 1)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#aac32b6e57c5afaea96a87c0cd275f071">ASN1_F_ASN1_EX_C2I</a>,</div>
<div class="line">                                                <a class="code" href="asn1_8h.html#a90748b06605e621842568510d0f01eb6">ASN1_R_BOOLEAN_IS_WRONG_LENGTH</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="ossl__typ_8h.html#abab3d5c6a3b9e049d27737dc227c0849">ASN1_BOOLEAN</a> *tbool;</div>
<div class="line">                        tbool = (<a class="code" href="ossl__typ_8h.html#abab3d5c6a3b9e049d27737dc227c0849">ASN1_BOOLEAN</a> *)pval;</div>
<div class="line">                        *tbool = *cont;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a2c6b3331bbb8775d33379a287b3cbf55">V_ASN1_BIT_STRING</a>:</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="a__bitstr_8c.html#ab8a7721bc40d12e3f36995286eb11092">c2i_ASN1_BIT_STRING</a>((<a class="code" href="structasn1__string__st.html">ASN1_BIT_STRING</a> **)pval, &amp;cont, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a0fc996672dd3dd88bfcd087456a6796b">V_ASN1_INTEGER</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a5a0bb74c35cee59ea1ee2c64cd396a8e">V_ASN1_NEG_INTEGER</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#aa306fe24cb2028dc08d2c730fbad5bab">V_ASN1_ENUMERATED</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a35e109e600adf63675e83d2173778da6">V_ASN1_NEG_ENUMERATED</a>:</div>
<div class="line">                tint = (<a class="code" href="structasn1__string__st.html">ASN1_INTEGER</a> **)pval;</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="a__int_8c.html#a57a469a9775912dabebe11cf0c4d2b6d">c2i_ASN1_INTEGER</a>(tint, &amp;cont, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>))</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                <span class="comment">/* Fixup type to match the expected form */</span></div>
<div class="line">                (*tint)-&gt;<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a> = utype | ((*tint)-&gt;type &amp; <a class="code" href="asn1_8h.html#adb36656f72977e59d5be4cd65311b82e">V_ASN1_NEG</a>);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#ab7338bcfcfbbd8f90c680759f373663b">V_ASN1_OCTET_STRING</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#aad920e3c5122a0eabec18758fa756936">V_ASN1_NUMERICSTRING</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a90e781fa9a38ee9b80bd8b75b2257ccf">V_ASN1_PRINTABLESTRING</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a901aa5f489f0e4efe8a9c6bbd7286c51">V_ASN1_T61STRING</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a6e7742a636d958fca16186454ff98572">V_ASN1_VIDEOTEXSTRING</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#ae9b8aad0d5710edad90ff55a9ebcfd51">V_ASN1_IA5STRING</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a2a8dd01504f7ee166a07e05cb0707634">V_ASN1_UTCTIME</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a7ec32dd2efb9a8765ccd91b2ab0721a3">V_ASN1_GENERALIZEDTIME</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#af6be78a5cadcdf643d3a20d39e2e9a4f">V_ASN1_GRAPHICSTRING</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a1f20daacf45aa895125ae56fbdeca412">V_ASN1_VISIBLESTRING</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a4f51f73e3c9670d90f3520c2b234b060">V_ASN1_GENERALSTRING</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a907f21d8ca9d0156f894d7c16f938ab6">V_ASN1_UNIVERSALSTRING</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a052cc5b8987a30264899503f10d5a06a">V_ASN1_BMPSTRING</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a3d1cc4bd27cc649035839b824d7a1220">V_ASN1_UTF8STRING</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a77fea8c38548c2c591cdd24c76b47b4e">V_ASN1_OTHER</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#a078f04fc79c8a1acccbb1a4c6705521b">V_ASN1_SET</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1_8h.html#ab76fef5a089d894b827029a84a6f4f7a">V_ASN1_SEQUENCE</a>:</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">if</span> (utype == <a class="code" href="asn1_8h.html#a052cc5b8987a30264899503f10d5a06a">V_ASN1_BMPSTRING</a> &amp;&amp; (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> &amp; 1))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#aac32b6e57c5afaea96a87c0cd275f071">ASN1_F_ASN1_EX_C2I</a>,</div>
<div class="line">                                        <a class="code" href="asn1_8h.html#a329c83e03bfb14b0bbf387fc20b5e3cf">ASN1_R_BMPSTRING_IS_WRONG_LENGTH</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (utype == <a class="code" href="asn1_8h.html#a907f21d8ca9d0156f894d7c16f938ab6">V_ASN1_UNIVERSALSTRING</a> &amp;&amp; (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> &amp; 3))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#aac32b6e57c5afaea96a87c0cd275f071">ASN1_F_ASN1_EX_C2I</a>,</div>
<div class="line">                                        <a class="code" href="asn1_8h.html#a1482e7f5df4012ec85b04e8b1236fc04">ASN1_R_UNIVERSALSTRING_IS_WRONG_LENGTH</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="comment">/* All based on ASN1_STRING and handled the same */</span></div>
<div class="line">                <span class="keywordflow">if</span> (!*pval)</div>
<div class="line">                        {</div>
<div class="line">                        stmp = <a class="code" href="asn1_8h.html#a618922f2aa1b7349a535d99f3365df3a">ASN1_STRING_type_new</a>(utype);</div>
<div class="line">                        <span class="keywordflow">if</span> (!stmp)</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#aac32b6e57c5afaea96a87c0cd275f071">ASN1_F_ASN1_EX_C2I</a>,</div>
<div class="line">                                                        <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                                }</div>
<div class="line">                        *pval = (<a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> *)stmp;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                        stmp = (<a class="code" href="structasn1__string__st.html">ASN1_STRING</a> *)*pval;</div>
<div class="line">                        stmp-&gt;<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a> = utype;</div>
<div class="line">                        }</div>
<div class="line">                <span class="comment">/* If we&#39;ve already allocated a buffer use it */</span></div>
<div class="line">                <span class="keywordflow">if</span> (*free_cont)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (stmp-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>)</div>
<div class="line">                                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(stmp-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>);</div>
<div class="line">                        stmp-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)cont; <span class="comment">/* UGLY CAST! RL */</span></div>
<div class="line">                        stmp-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a> = <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">                        *free_cont = 0;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (!<a class="code" href="asn1_8h.html#ac3d9dac6e1a10d91c46e2d9f30f9c225">ASN1_STRING_set</a>(stmp, cont, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>))</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#aac32b6e57c5afaea96a87c0cd275f071">ASN1_F_ASN1_EX_C2I</a>,</div>
<div class="line">                                                        <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                                <a class="code" href="asn1_8h.html#abab6c6c7b24147dada0a8ce77fdebe95">ASN1_STRING_free</a>(stmp); </div>
<div class="line">                                *pval = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">        <span class="comment">/* If ASN1_ANY and NULL type fix up value */</span></div>
<div class="line">        <span class="keywordflow">if</span> (typ &amp;&amp; (utype == <a class="code" href="asn1_8h.html#a0ee96d376143ded4fe24f9dd70da6a29">V_ASN1_NULL</a>))</div>
<div class="line">                 typ-&gt;<a class="code" href="structasn1__type__st.html#ab37a86242c23b20bd17ee2adb4678e38">value</a>.<a class="code" href="structasn1__type__st.html#ab01ca089818d53090a87858244823952">ptr</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        ret = 1;</div>
<div class="line">        err:</div>
<div class="line">        <span class="keywordflow">if</span> (!ret)</div>
<div class="line">                {</div>
<div class="line">                ASN1_TYPE_free(typ);</div>
<div class="line">                <span class="keywordflow">if</span> (opval)</div>
<div class="line">                        *opval = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a29a443a5f8940076e1bcd7ed1f8f1d75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a>* ASN1_item_d2i </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **&#160;</td>
          <td class="paramname"><em>pval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char **&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#aea7867d0d5f4d561d2cbf24a9ce49e40">ASN1_ITEM</a> *&#160;</td>
          <td class="paramname"><em>it</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tasn__dec_8c_source.html#l00128">128</a> of file <a class="el" href="tasn__dec_8c_source.html">tasn_dec.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structASN1__TLC__st.html">ASN1_TLC</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>;</div>
<div class="line">        <a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> *ptmpval = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (!pval)</div>
<div class="line">                pval = &amp;ptmpval;</div>
<div class="line">        <a class="code" href="tasn__dec_8c.html#a55f020350524c4f8027dadb056b42a73">asn1_tlc_clear_nc</a>(&amp;c);</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1t_8h.html#ae468bdef89c57e81f1e6082f52b94c5d">ASN1_item_ex_d2i</a>(pval, <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, it, -1, 0, 0, &amp;c) &gt; 0) </div>
<div class="line">                <span class="keywordflow">return</span> *pval;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae468bdef89c57e81f1e6082f52b94c5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ASN1_item_ex_d2i </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **&#160;</td>
          <td class="paramname"><em>pval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char **&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#aea7867d0d5f4d561d2cbf24a9ce49e40">ASN1_ITEM</a> *&#160;</td>
          <td class="paramname"><em>it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>aclass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="asn1_8h.html#a71873837864aac1d3532354b7be79222">ASN1_TLC</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tasn__dec_8c_source.html#l00154">154</a> of file <a class="el" href="tasn__dec_8c_source.html">tasn_dec.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> *tt, *errtt = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structASN1__COMPAT__FUNCS__st.html">ASN1_COMPAT_FUNCS</a> *cf;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structASN1__EXTERN__FUNCS__st.html">ASN1_EXTERN_FUNCS</a> *ef;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structASN1__AUX__st.html">ASN1_AUX</a> *aux = it-&gt;<a class="code" href="structASN1__ITEM__st.html#abb4e623222d55a9c7b203c9b29e5aefe">funcs</a>;</div>
<div class="line">        <a class="code" href="asn1t_8h.html#a2b027ba8d1c547004686872d2ce6a295">ASN1_aux_cb</a> *asn1_cb;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, *<a class="code" href="wp__block_8c.html#a60bf45d7a4743f796fb40bf55c69a88c">q</a>;</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *wp=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>; <span class="comment">/* BIG FAT WARNING!  BREAKS CONST WHERE USED */</span></div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> imphack = 0, oclass;</div>
<div class="line">        <span class="keywordtype">char</span> seq_eoc, seq_nolen, cst, isopt;</div>
<div class="line">        <span class="keywordtype">long</span> tmplen;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">int</span> otag;</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">        <a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **pchptr, *ptmpval;</div>
<div class="line">        <span class="keywordflow">if</span> (!pval)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (aux &amp;&amp; aux-&gt;<a class="code" href="structASN1__AUX__st.html#a1972a608ed6091b6b830839b785b74e8">asn1_cb</a>)</div>
<div class="line">                asn1_cb = aux-&gt;<a class="code" href="structASN1__AUX__st.html#a1972a608ed6091b6b830839b785b74e8">asn1_cb</a>;</div>
<div class="line">        <span class="keywordflow">else</span> asn1_cb = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">switch</span>(it-&gt;<a class="code" href="structASN1__ITEM__st.html#a303cc31bacb86b92451cb5b389e57440">itype</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1t_8h.html#abbb258305392fd99072a69884f00d994">ASN1_ITYPE_PRIMITIVE</a>:</div>
<div class="line">                <span class="keywordflow">if</span> (it-&gt;<a class="code" href="structASN1__ITEM__st.html#a63735dc5d18e7f66b3071f4ca76e8462">templates</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="comment">/* tagging or OPTIONAL is currently illegal on an item</span></div>
<div class="line"><span class="comment">                         * template because the flags can&#39;t get passed down.</span></div>
<div class="line"><span class="comment">                         * In practice this isn&#39;t a problem: we include the</span></div>
<div class="line"><span class="comment">                         * relevant flags from the item template in the</span></div>
<div class="line"><span class="comment">                         * template itself.</span></div>
<div class="line"><span class="comment">                         */</span></div>
<div class="line">                        <span class="keywordflow">if</span> ((tag != -1) || opt)</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                <a class="code" href="asn1_8h.html#a41de4f14750422db2746a90a91dc693a">ASN1_R_ILLEGAL_OPTIONS_ON_ITEM_TEMPLATE</a>);</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="keywordflow">return</span> asn1_template_ex_d2i(pval, <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,</div>
<div class="line">                                        it-&gt;<a class="code" href="structASN1__ITEM__st.html#a63735dc5d18e7f66b3071f4ca76e8462">templates</a>, opt, ctx);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">return</span> asn1_d2i_ex_primitive(pval, <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, it,</div>
<div class="line">                                                tag, aclass, opt, ctx);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1t_8h.html#aab22f163721be2d706b4303753ade93f">ASN1_ITYPE_MSTRING</a>:</div>
<div class="line">                p = *<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line">                <span class="comment">/* Just read in tag and class */</span></div>
<div class="line">                ret = asn1_check_tlen(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, &amp;otag, &amp;oclass, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>,</div>
<div class="line">                                                &amp;p, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, -1, 0, 1, ctx);</div>
<div class="line">                <span class="keywordflow">if</span> (!ret)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                        <a class="code" href="err_8h.html#ad61ad7e75e25be4c9d79261c8d488af1">ERR_R_NESTED_ASN1_ERROR</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Must be UNIVERSAL class */</span></div>
<div class="line">                <span class="keywordflow">if</span> (oclass != <a class="code" href="asn1_8h.html#a5e307a806acbaf3dd7d49cf89ed95b09">V_ASN1_UNIVERSAL</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="comment">/* If OPTIONAL, assume this is OK */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (opt) <span class="keywordflow">return</span> -1;</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                        <a class="code" href="asn1_8h.html#ae41485ffe52ad8dcfde03a560ec4d748">ASN1_R_MSTRING_NOT_UNIVERSAL</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="comment">/* Check tag matches bit map */</span></div>
<div class="line">                <span class="keywordflow">if</span> (!(<a class="code" href="asn1_8h.html#a5cf29ea4e454ef332831021c1968ad44">ASN1_tag2bit</a>(otag) &amp; it-&gt;<a class="code" href="structASN1__ITEM__st.html#a49602e67011b80d23622751f6ce154f5">utype</a>))</div>
<div class="line">                        {</div>
<div class="line">                        <span class="comment">/* If OPTIONAL, assume this is OK */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (opt)</div>
<div class="line">                                <span class="keywordflow">return</span> -1;</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                        <a class="code" href="asn1_8h.html#a496e19a6e03cc412301128372408ce42">ASN1_R_MSTRING_WRONG_TAG</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">return</span> asn1_d2i_ex_primitive(pval, <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,</div>
<div class="line">                                                it, otag, 0, 0, ctx);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1t_8h.html#a408744db27f4e2c85ff479e691a99b30">ASN1_ITYPE_EXTERN</a>:</div>
<div class="line">                <span class="comment">/* Use new style d2i */</span></div>
<div class="line">                ef = it-&gt;<a class="code" href="structASN1__ITEM__st.html#abb4e623222d55a9c7b203c9b29e5aefe">funcs</a>;</div>
<div class="line">                <span class="keywordflow">return</span> ef-&gt;<a class="code" href="structASN1__EXTERN__FUNCS__st.html#a21a25960f9687e7456623303538a03f5">asn1_ex_d2i</a>(pval, <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,</div>
<div class="line">                                                it, tag, aclass, opt, ctx);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1t_8h.html#a66eef0de339bec7a229c96b8c47a818d">ASN1_ITYPE_COMPAT</a>:</div>
<div class="line">                <span class="comment">/* we must resort to old style evil hackery */</span></div>
<div class="line">                cf = it-&gt;<a class="code" href="structASN1__ITEM__st.html#abb4e623222d55a9c7b203c9b29e5aefe">funcs</a>;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* If OPTIONAL see if it is there */</span></div>
<div class="line">                <span class="keywordflow">if</span> (opt)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordtype">int</span> exptag;</div>
<div class="line">                        p = *<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line">                        <span class="keywordflow">if</span> (tag == -1)</div>
<div class="line">                                exptag = it-&gt;<a class="code" href="structASN1__ITEM__st.html#a49602e67011b80d23622751f6ce154f5">utype</a>;</div>
<div class="line">                        <span class="keywordflow">else</span> exptag = tag;</div>
<div class="line">                        <span class="comment">/* Don&#39;t care about anything other than presence</span></div>
<div class="line"><span class="comment">                         * of expected tag */</span></div>
<div class="line"></div>
<div class="line">                        ret = asn1_check_tlen(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>,</div>
<div class="line">                                        &amp;p, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, exptag, aclass, 1, ctx);</div>
<div class="line">                        <span class="keywordflow">if</span> (!ret)</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                        <a class="code" href="err_8h.html#ad61ad7e75e25be4c9d79261c8d488af1">ERR_R_NESTED_ASN1_ERROR</a>);</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="keywordflow">if</span> (ret == -1)</div>
<div class="line">                                <span class="keywordflow">return</span> -1;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* This is the old style evil hack IMPLICIT handling:</span></div>
<div class="line"><span class="comment">                 * since the underlying code is expecting a tag and</span></div>
<div class="line"><span class="comment">                 * class other than the one present we change the</span></div>
<div class="line"><span class="comment">                 * buffer temporarily then change it back afterwards.</span></div>
<div class="line"><span class="comment">                 * This doesn&#39;t and never did work for tags &gt; 30.</span></div>
<div class="line"><span class="comment">                 *</span></div>
<div class="line"><span class="comment">                 * Yes this is *horrible* but it is only needed for</span></div>
<div class="line"><span class="comment">                 * old style d2i which will hopefully not be around</span></div>
<div class="line"><span class="comment">                 * for much longer.</span></div>
<div class="line"><span class="comment">                 * FIXME: should copy the buffer then modify it so</span></div>
<div class="line"><span class="comment">                 * the input buffer can be const: we should *always*</span></div>
<div class="line"><span class="comment">                 * copy because the old style d2i might modify the</span></div>
<div class="line"><span class="comment">                 * buffer.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (tag != -1)</div>
<div class="line">                        {</div>
<div class="line">                        wp = *(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **)<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line">                        imphack = *wp;</div>
<div class="line">                        <span class="keywordflow">if</span> (p == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                        <a class="code" href="err_8h.html#ad61ad7e75e25be4c9d79261c8d488af1">ERR_R_NESTED_ASN1_ERROR</a>);</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                                }</div>
<div class="line">                        *wp = (<span class="keywordtype">unsigned</span> char)((*p &amp; <a class="code" href="asn1_8h.html#a45df18b839e1fe5919302e11c2ec12c3">V_ASN1_CONSTRUCTED</a>)</div>
<div class="line">                                                                | it-&gt;<a class="code" href="structASN1__ITEM__st.html#a49602e67011b80d23622751f6ce154f5">utype</a>);</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                ptmpval = cf-&gt;<a class="code" href="structASN1__COMPAT__FUNCS__st.html#aeddb5865fc5b6642fc062d737a032b2b">asn1_d2i</a>(pval, <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (tag != -1)</div>
<div class="line">                        *wp = imphack;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (ptmpval)</div>
<div class="line">                        <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">                <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>, <a class="code" href="err_8h.html#ad61ad7e75e25be4c9d79261c8d488af1">ERR_R_NESTED_ASN1_ERROR</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1t_8h.html#a0cc6b2ea3f999f98632223c5cf6b0334">ASN1_ITYPE_CHOICE</a>:</div>
<div class="line">                <span class="keywordflow">if</span> (asn1_cb &amp;&amp; !asn1_cb(<a class="code" href="asn1t_8h.html#ab162bcfb8b8c723c4334167b897e89f0">ASN1_OP_D2I_PRE</a>, pval, it, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                                <span class="keywordflow">goto</span> auxerr;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Allocate structure */</span></div>
<div class="line">                <span class="keywordflow">if</span> (!*pval &amp;&amp; !<a class="code" href="asn1t_8h.html#a766a96532807da1cef6018bd701f7bce">ASN1_item_ex_new</a>(pval, it))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                                <a class="code" href="err_8h.html#ad61ad7e75e25be4c9d79261c8d488af1">ERR_R_NESTED_ASN1_ERROR</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="comment">/* CHOICE type, try each possibility in turn */</span></div>
<div class="line">                p = *<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line">                <span class="keywordflow">for</span> (i = 0, tt=it-&gt;<a class="code" href="structASN1__ITEM__st.html#a63735dc5d18e7f66b3071f4ca76e8462">templates</a>; i &lt; it-&gt;tcount; i++, tt++)</div>
<div class="line">                        {</div>
<div class="line">                        pchptr = <a class="code" href="asn1t_8h.html#a15b5f094a23e8e68ac3ff70ccd1d09c8">asn1_get_field_ptr</a>(pval, tt);</div>
<div class="line">                        <span class="comment">/* We mark field as OPTIONAL so its absence</span></div>
<div class="line"><span class="comment">                         * can be recognised.</span></div>
<div class="line"><span class="comment">                         */</span></div>
<div class="line">                        ret = asn1_template_ex_d2i(pchptr, &amp;p, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, tt, 1, ctx);</div>
<div class="line">                        <span class="comment">/* If field not present, try the next one */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (ret == -1)</div>
<div class="line">                                <span class="keywordflow">continue</span>;</div>
<div class="line">                        <span class="comment">/* If positive return, read OK, break loop */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (ret &gt; 0)</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="comment">/* Otherwise must be an ASN1 parsing error */</span></div>
<div class="line">                        errtt = tt;</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                                <a class="code" href="err_8h.html#ad61ad7e75e25be4c9d79261c8d488af1">ERR_R_NESTED_ASN1_ERROR</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Did we fall off the end without reading anything? */</span></div>
<div class="line">                <span class="keywordflow">if</span> (i == it-&gt;<a class="code" href="structASN1__ITEM__st.html#a52bce8167464f68b77aeeabf7b8c26d9">tcount</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="comment">/* If OPTIONAL, this is OK */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (opt)</div>
<div class="line">                                {</div>
<div class="line">                                <span class="comment">/* Free and zero it */</span></div>
<div class="line">                                <a class="code" href="asn1t_8h.html#a81f38e01cf9280a511499cc54b299e7e">ASN1_item_ex_free</a>(pval, it);</div>
<div class="line">                                <span class="keywordflow">return</span> -1;</div>
<div class="line">                                }</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                        <a class="code" href="asn1_8h.html#affab77fedf7cdcae035468eb29b15639">ASN1_R_NO_MATCHING_CHOICE_TYPE</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <a class="code" href="asn1t_8h.html#ac61a38ce19a5c51726450e479ca698a1">asn1_set_choice_selector</a>(pval, i, it);</div>
<div class="line">                *<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> = p;</div>
<div class="line">                <span class="keywordflow">if</span> (asn1_cb &amp;&amp; !asn1_cb(<a class="code" href="asn1t_8h.html#ac0f2938fa25cb67984dc20eab36b4264">ASN1_OP_D2I_POST</a>, pval, it, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                                <span class="keywordflow">goto</span> auxerr;</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1t_8h.html#a6c2a46d57cb73c2353d183e55324c5b2">ASN1_ITYPE_NDEF_SEQUENCE</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="asn1t_8h.html#aa6f91eb0c5cd67effa55edb87e99ec97">ASN1_ITYPE_SEQUENCE</a>:</div>
<div class="line">                p = *<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>;</div>
<div class="line">                tmplen = <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* If no IMPLICIT tagging set to SEQUENCE, UNIVERSAL */</span></div>
<div class="line">                <span class="keywordflow">if</span> (tag == -1)</div>
<div class="line">                        {</div>
<div class="line">                        tag = <a class="code" href="asn1_8h.html#ab76fef5a089d894b827029a84a6f4f7a">V_ASN1_SEQUENCE</a>;</div>
<div class="line">                        aclass = <a class="code" href="asn1_8h.html#a5e307a806acbaf3dd7d49cf89ed95b09">V_ASN1_UNIVERSAL</a>;</div>
<div class="line">                        }</div>
<div class="line">                <span class="comment">/* Get SEQUENCE length and update len, p */</span></div>
<div class="line">                ret = asn1_check_tlen(&amp;<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, &amp;seq_eoc, &amp;cst,</div>
<div class="line">                                        &amp;p, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, tag, aclass, opt, ctx);</div>
<div class="line">                <span class="keywordflow">if</span> (!ret)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                        <a class="code" href="err_8h.html#ad61ad7e75e25be4c9d79261c8d488af1">ERR_R_NESTED_ASN1_ERROR</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == -1)</div>
<div class="line">                        <span class="keywordflow">return</span> -1;</div>
<div class="line">                <span class="keywordflow">if</span> (aux &amp;&amp; (aux-&gt;<a class="code" href="structASN1__AUX__st.html#a852e7951bbea693ec9616bac686455c6">flags</a> &amp; <a class="code" href="asn1t_8h.html#a0eace2eccdc6b5faf6e31b62a42e90e3">ASN1_AFLG_BROKEN</a>))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> = tmplen - (p - *<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>);</div>
<div class="line">                        seq_nolen = 1;</div>
<div class="line">                        }</div>
<div class="line">                <span class="comment">/* If indefinite we don&#39;t do a length check */</span></div>
<div class="line">                <span class="keywordflow">else</span> seq_nolen = seq_eoc;</div>
<div class="line">                <span class="keywordflow">if</span> (!cst)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                <a class="code" href="asn1_8h.html#aef4d4434b995358b18a75943225bf42a">ASN1_R_SEQUENCE_NOT_CONSTRUCTED</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (!*pval &amp;&amp; !<a class="code" href="asn1t_8h.html#a766a96532807da1cef6018bd701f7bce">ASN1_item_ex_new</a>(pval, it))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                <a class="code" href="err_8h.html#ad61ad7e75e25be4c9d79261c8d488af1">ERR_R_NESTED_ASN1_ERROR</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (asn1_cb &amp;&amp; !asn1_cb(<a class="code" href="asn1t_8h.html#ab162bcfb8b8c723c4334167b897e89f0">ASN1_OP_D2I_PRE</a>, pval, it, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                                <span class="keywordflow">goto</span> auxerr;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Get each field entry */</span></div>
<div class="line">                <span class="keywordflow">for</span> (i = 0, tt = it-&gt;<a class="code" href="structASN1__ITEM__st.html#a63735dc5d18e7f66b3071f4ca76e8462">templates</a>; i &lt; it-&gt;tcount; i++, tt++)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> *seqtt;</div>
<div class="line">                        <a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **pseqval;</div>
<div class="line">                        seqtt = <a class="code" href="asn1t_8h.html#a6960f69a6a696977ba45217156c479df">asn1_do_adb</a>(pval, tt, 1);</div>
<div class="line">                        <span class="keywordflow">if</span> (!seqtt)</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        pseqval = <a class="code" href="asn1t_8h.html#a15b5f094a23e8e68ac3ff70ccd1d09c8">asn1_get_field_ptr</a>(pval, seqtt);</div>
<div class="line">                        <span class="comment">/* Have we ran out of data? */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (!<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                        q = p;</div>
<div class="line">                        <span class="keywordflow">if</span> (asn1_check_eoc(&amp;p, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>))</div>
<div class="line">                                {</div>
<div class="line">                                <span class="keywordflow">if</span> (!seq_eoc)</div>
<div class="line">                                        {</div>
<div class="line">                                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                                        <a class="code" href="asn1_8h.html#a5a6e8c3f70b7fffc7d65051c2920dff1">ASN1_R_UNEXPECTED_EOC</a>);</div>
<div class="line">                                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                                        }</div>
<div class="line">                                <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= p - <a class="code" href="wp__block_8c.html#a60bf45d7a4743f796fb40bf55c69a88c">q</a>;</div>
<div class="line">                                seq_eoc = 0;</div>
<div class="line">                                q = p;</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="comment">/* This determines the OPTIONAL flag value. The field</span></div>
<div class="line"><span class="comment">                         * cannot be omitted if it is the last of a SEQUENCE</span></div>
<div class="line"><span class="comment">                         * and there is still data to be read. This isn&#39;t</span></div>
<div class="line"><span class="comment">                         * strictly necessary but it increases efficiency in</span></div>
<div class="line"><span class="comment">                         * some cases.</span></div>
<div class="line"><span class="comment">                         */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (i == (it-&gt;<a class="code" href="structASN1__ITEM__st.html#a52bce8167464f68b77aeeabf7b8c26d9">tcount</a> - 1))</div>
<div class="line">                                isopt = 0;</div>
<div class="line">                        <span class="keywordflow">else</span> isopt = (char)(seqtt-&gt;<a class="code" href="structASN1__TEMPLATE__st.html#aadbe8b5ea9d41920c3fc59d6c65848a8">flags</a> &amp; <a class="code" href="asn1t_8h.html#ae5f2aa52f77cc9cae3529f819bee655a">ASN1_TFLG_OPTIONAL</a>);</div>
<div class="line">                        <span class="comment">/* attempt to read in field, allowing each to be</span></div>
<div class="line"><span class="comment">                         * OPTIONAL */</span></div>
<div class="line"></div>
<div class="line">                        ret = asn1_template_ex_d2i(pseqval, &amp;p, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>,</div>
<div class="line">                                                        seqtt, isopt, ctx);</div>
<div class="line">                        <span class="keywordflow">if</span> (!ret)</div>
<div class="line">                                {</div>
<div class="line">                                errtt = seqtt;</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == -1)</div>
<div class="line">                                {</div>
<div class="line">                                <span class="comment">/* OPTIONAL component absent.</span></div>
<div class="line"><span class="comment">                                 * Free and zero the field.</span></div>
<div class="line"><span class="comment">                                 */</span></div>
<div class="line">                                <a class="code" href="asn1t_8h.html#ad841f6c7b40dffe25039a47d71f23c5f">ASN1_template_free</a>(pseqval, seqtt);</div>
<div class="line">                                <span class="keywordflow">continue</span>;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="comment">/* Update length */</span></div>
<div class="line">                        <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> -= p - <a class="code" href="wp__block_8c.html#a60bf45d7a4743f796fb40bf55c69a88c">q</a>;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Check for EOC if expecting one */</span></div>
<div class="line">                <span class="keywordflow">if</span> (seq_eoc &amp;&amp; !asn1_check_eoc(&amp;p, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>, <a class="code" href="asn1_8h.html#a456b8ccdc87e230cbd7f6184729dbca0">ASN1_R_MISSING_EOC</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line">                <span class="comment">/* Check all data read */</span></div>
<div class="line">                <span class="keywordflow">if</span> (!seq_nolen &amp;&amp; <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                        <a class="code" href="asn1_8h.html#afd42c30cec5e83563977d9076778caf2">ASN1_R_SEQUENCE_LENGTH_MISMATCH</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> err;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* If we get here we&#39;ve got no more data in the SEQUENCE,</span></div>
<div class="line"><span class="comment">                 * however we may not have read all fields so check all</span></div>
<div class="line"><span class="comment">                 * remaining are OPTIONAL and clear any that are.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                <span class="keywordflow">for</span> (; i &lt; it-&gt;<a class="code" href="structASN1__ITEM__st.html#a52bce8167464f68b77aeeabf7b8c26d9">tcount</a>; tt++, i++)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> *seqtt;</div>
<div class="line">                        seqtt = <a class="code" href="asn1t_8h.html#a6960f69a6a696977ba45217156c479df">asn1_do_adb</a>(pval, tt, 1);</div>
<div class="line">                        <span class="keywordflow">if</span> (!seqtt)</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                        <span class="keywordflow">if</span> (seqtt-&gt;<a class="code" href="structASN1__TEMPLATE__st.html#aadbe8b5ea9d41920c3fc59d6c65848a8">flags</a> &amp; <a class="code" href="asn1t_8h.html#ae5f2aa52f77cc9cae3529f819bee655a">ASN1_TFLG_OPTIONAL</a>)</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **pseqval;</div>
<div class="line">                                pseqval = <a class="code" href="asn1t_8h.html#a15b5f094a23e8e68ac3ff70ccd1d09c8">asn1_get_field_ptr</a>(pval, seqtt);</div>
<div class="line">                                <a class="code" href="asn1t_8h.html#ad841f6c7b40dffe25039a47d71f23c5f">ASN1_template_free</a>(pseqval, seqtt);</div>
<div class="line">                                }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                                {</div>
<div class="line">                                errtt = seqtt;</div>
<div class="line">                                <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>,</div>
<div class="line">                                                        <a class="code" href="asn1_8h.html#ab23c6aad5f708d2e91882efde08ff72a">ASN1_R_FIELD_MISSING</a>);</div>
<div class="line">                                <span class="keywordflow">goto</span> err;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                <span class="comment">/* Save encoding */</span></div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="asn1t_8h.html#ad556d88ab021c6d1363de3d41f0b81c0">asn1_enc_save</a>(pval, *<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, p - *<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, it))</div>
<div class="line">                        <span class="keywordflow">goto</span> auxerr;</div>
<div class="line">                *<a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a> = p;</div>
<div class="line">                <span class="keywordflow">if</span> (asn1_cb &amp;&amp; !asn1_cb(<a class="code" href="asn1t_8h.html#ac0f2938fa25cb67984dc20eab36b4264">ASN1_OP_D2I_POST</a>, pval, it, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>))</div>
<div class="line">                                <span class="keywordflow">goto</span> auxerr;</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        auxerr:</div>
<div class="line">        <a class="code" href="err_8h.html#aee1665e6ac96d8693cecb07c2d2c7c8e">ASN1err</a>(<a class="code" href="asn1_8h.html#a85cf31534900aa85681abd58a5000b7f">ASN1_F_ASN1_ITEM_EX_D2I</a>, <a class="code" href="asn1_8h.html#a092904618f3303fe933df4f98623516b">ASN1_R_AUX_ERROR</a>);</div>
<div class="line">        err:</div>
<div class="line">        <a class="code" href="asn1t_8h.html#a81f38e01cf9280a511499cc54b299e7e">ASN1_item_ex_free</a>(pval, it);</div>
<div class="line">        <span class="keywordflow">if</span> (errtt)</div>
<div class="line">                <a class="code" href="err_8c.html#a89d6b806fcd20c4ea07229451d489616">ERR_add_error_data</a>(4, <span class="stringliteral">&quot;Field=&quot;</span>, errtt-&gt;<a class="code" href="structASN1__TEMPLATE__st.html#af497df5141e17637e18b4857c147ca73">field_name</a>,</div>
<div class="line">                                        <span class="stringliteral">&quot;, Type=&quot;</span>, it-&gt;<a class="code" href="structASN1__ITEM__st.html#a2375aeececad55dcefd782c78a661fe6">sname</a>);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <a class="code" href="err_8c.html#a89d6b806fcd20c4ea07229451d489616">ERR_add_error_data</a>(2, <span class="stringliteral">&quot;Type=&quot;</span>, it-&gt;<a class="code" href="structASN1__ITEM__st.html#a2375aeececad55dcefd782c78a661fe6">sname</a>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5cf29ea4e454ef332831021c1968ad44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long ASN1_tag2bit </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tasn__dec_8c_source.html#l00108">108</a> of file <a class="el" href="tasn__dec_8c_source.html">tasn_dec.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> ((tag &lt; 0) || (tag &gt; 30)) <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">return</span> tag2bit[tag];</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a97d8df6533ab027de378bc75f10f4fd2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ASN1_template_d2i </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **&#160;</td>
          <td class="paramname"><em>pval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char **&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="asn1_8h.html#a6c952ee1ae445fda1ca8e1761bbd93ac">ASN1_TEMPLATE</a> *&#160;</td>
          <td class="paramname"><em>tt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tasn__dec_8c_source.html#l00141">141</a> of file <a class="el" href="tasn__dec_8c_source.html">tasn_dec.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structASN1__TLC__st.html">ASN1_TLC</a> <a class="code" href="ideatest_8c.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>;</div>
<div class="line">        <a class="code" href="tasn__dec_8c.html#a55f020350524c4f8027dadb056b42a73">asn1_tlc_clear_nc</a>(&amp;c);</div>
<div class="line">        <span class="keywordflow">return</span> asn1_template_ex_d2i(pval, <a class="code" href="ideatest_8c.html#a006e60e2361d5936856cf2b1883c6d61">in</a>, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>, tt, 0, &amp;c);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 15 2014 18:16:50 for openssl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
