<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/ocsp/ocsp_ht.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_78588da27edc0b5889a78535ba3b1a98.html">ocsp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ocsp_ht.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &quot;e_os.h&quot;</code><br/>
<code>#include &lt;openssl/asn1.h&gt;</code><br/>
<code>#include &lt;openssl/ocsp.h&gt;</code><br/>
<code>#include &lt;openssl/err.h&gt;</code><br/>
<code>#include &lt;openssl/buffer.h&gt;</code><br/>
</div>
<p><a href="ocsp__ht_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structocsp__req__ctx__st.html">ocsp_req_ctx_st</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab393fd10d6018a9aefb8f1a73b8d7038"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#ab393fd10d6018a9aefb8f1a73b8d7038">OCSP_MAX_RESP_LENGTH</a>&#160;&#160;&#160;(100 * 1024)</td></tr>
<tr class="memitem:a82b9032ab7281c15f522f11b2c2d19f5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a82b9032ab7281c15f522f11b2c2d19f5">OCSP_MAX_LINE_LEN</a>&#160;&#160;&#160;4096;</td></tr>
<tr class="memitem:ac3e7fbe226601c7bd576d08b5a96e1f7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>&#160;&#160;&#160;0x1000</td></tr>
<tr class="memitem:a7ba4be6e253b8edd89570c4b9ab6a694"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>&#160;&#160;&#160;(0 | <a class="el" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>)</td></tr>
<tr class="memitem:a65621ce6de38605b7e82323899c2d2ae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a65621ce6de38605b7e82323899c2d2ae">OHS_FIRSTLINE</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:a78b8ba6ffd457726c93cf073d6de93c3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a78b8ba6ffd457726c93cf073d6de93c3">OHS_HEADERS</a>&#160;&#160;&#160;2</td></tr>
<tr class="memitem:ae28854506b41464c0f46d1dd7c2393ca"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#ae28854506b41464c0f46d1dd7c2393ca">OHS_ASN1_HEADER</a>&#160;&#160;&#160;3</td></tr>
<tr class="memitem:abadab9e46d9482abd7163f31b9435fc1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#abadab9e46d9482abd7163f31b9435fc1">OHS_ASN1_CONTENT</a>&#160;&#160;&#160;4</td></tr>
<tr class="memitem:a3e00008c68918a1a811b132355c7ec46"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a3e00008c68918a1a811b132355c7ec46">OHS_ASN1_WRITE_INIT</a>&#160;&#160;&#160;(5 | <a class="el" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>)</td></tr>
<tr class="memitem:ad07e40d324a3cd2f9d7e04d3b37872cd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#ad07e40d324a3cd2f9d7e04d3b37872cd">OHS_ASN1_WRITE</a>&#160;&#160;&#160;(6 | <a class="el" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>)</td></tr>
<tr class="memitem:a7833f8195b0d92cfe253dbe2e7736de9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a7833f8195b0d92cfe253dbe2e7736de9">OHS_ASN1_FLUSH</a>&#160;&#160;&#160;(7 | <a class="el" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>)</td></tr>
<tr class="memitem:ac210897838b862644edb488ae72cccf6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#ac210897838b862644edb488ae72cccf6">OHS_DONE</a>&#160;&#160;&#160;(8 | <a class="el" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>)</td></tr>
<tr class="memitem:acb51d59a887f5fb19925ed4ec522cdf2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#acb51d59a887f5fb19925ed4ec522cdf2">OHS_HTTP_HEADER</a>&#160;&#160;&#160;(9 | <a class="el" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a48047488b6364ff2b2e9ed1483525232"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a48047488b6364ff2b2e9ed1483525232">OCSP_REQ_CTX_new</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *io, int maxline)</td></tr>
<tr class="memitem:aafa6182069793383cf86fe72b55626ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#aafa6182069793383cf86fe72b55626ce">OCSP_REQ_CTX_free</a> (<a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *rctx)</td></tr>
<tr class="memitem:a81d9042f18c72bd0b334918c0a3d3491"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a81d9042f18c72bd0b334918c0a3d3491">OCSP_REQ_CTX_get0_mem_bio</a> (<a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *rctx)</td></tr>
<tr class="memitem:a41a8876d5baf94823517c40e39eae41f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a41a8876d5baf94823517c40e39eae41f">OCSP_set_max_response_length</a> (<a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *rctx, unsigned long <a class="el" href="x509_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>)</td></tr>
<tr class="memitem:aaf26b59c7c1740385b0fb80540599ad2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#aaf26b59c7c1740385b0fb80540599ad2">OCSP_REQ_CTX_i2d</a> (<a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *rctx, const <a class="el" href="ossl__typ_8h.html#aea7867d0d5f4d561d2cbf24a9ce49e40">ASN1_ITEM</a> *it, <a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> *val)</td></tr>
<tr class="memitem:a579e2cf59ae70b929f3b01aa074194b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a579e2cf59ae70b929f3b01aa074194b9">OCSP_REQ_CTX_nbio_d2i</a> (<a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *rctx, <a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **pval, const <a class="el" href="ossl__typ_8h.html#aea7867d0d5f4d561d2cbf24a9ce49e40">ASN1_ITEM</a> *it)</td></tr>
<tr class="memitem:a9ade3828290a6e6a9968324014961bb3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a9ade3828290a6e6a9968324014961bb3">OCSP_REQ_CTX_http</a> (<a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *rctx, const char *op, const char *path)</td></tr>
<tr class="memitem:abaa967d2e8847d94936eb6c1520b1860"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#abaa967d2e8847d94936eb6c1520b1860">OCSP_REQ_CTX_set1_req</a> (<a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *rctx, <a class="el" href="ocsp_8h.html#a17153531638085adb112e6bf8c2bd099">OCSP_REQUEST</a> *req)</td></tr>
<tr class="memitem:a3558d2793f4f2297e44912585c443d91"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a3558d2793f4f2297e44912585c443d91">OCSP_REQ_CTX_add1_header</a> (<a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *rctx, const char *name, const char *value)</td></tr>
<tr class="memitem:a9db5cf05e460032f2b49e7f776eb4485"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a9db5cf05e460032f2b49e7f776eb4485">OCSP_sendreq_new</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *io, const char *path, <a class="el" href="ocsp_8h.html#a17153531638085adb112e6bf8c2bd099">OCSP_REQUEST</a> *req, int maxline)</td></tr>
<tr class="memitem:ab747695cf964937686dfc9d26bb5c3c0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#ab747695cf964937686dfc9d26bb5c3c0">OCSP_REQ_CTX_nbio</a> (<a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *rctx)</td></tr>
<tr class="memitem:a5ceb346e6849747c292985b69d6fe2cf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#a5ceb346e6849747c292985b69d6fe2cf">OCSP_sendreq_nbio</a> (<a class="el" href="ossl__typ_8h.html#a126a9513b35297c9f53956eacf2b333d">OCSP_RESPONSE</a> **presp, <a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *rctx)</td></tr>
<tr class="memitem:aeed5454e6f68e59a6d30a1d4bf951404"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a126a9513b35297c9f53956eacf2b333d">OCSP_RESPONSE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ocsp__ht_8c.html#aeed5454e6f68e59a6d30a1d4bf951404">OCSP_sendreq_bio</a> (<a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *<a class="el" href="des_8c.html#af55342ae4b8be9b599750497bddc6687">b</a>, const char *path, <a class="el" href="ocsp_8h.html#a17153531638085adb112e6bf8c2bd099">OCSP_REQUEST</a> *req)</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="a82b9032ab7281c15f522f11b2c2d19f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OCSP_MAX_LINE_LEN&#160;&#160;&#160;4096;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00087">87</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab393fd10d6018a9aefb8f1a73b8d7038"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OCSP_MAX_RESP_LENGTH&#160;&#160;&#160;(100 * 1024)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00086">86</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>

</div>
</div>
<a class="anchor" id="abadab9e46d9482abd7163f31b9435fc1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OHS_ASN1_CONTENT&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00102">102</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7833f8195b0d92cfe253dbe2e7736de9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OHS_ASN1_FLUSH&#160;&#160;&#160;(7 | <a class="el" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00108">108</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae28854506b41464c0f46d1dd7c2393ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OHS_ASN1_HEADER&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00100">100</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad07e40d324a3cd2f9d7e04d3b37872cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OHS_ASN1_WRITE&#160;&#160;&#160;(6 | <a class="el" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00106">106</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3e00008c68918a1a811b132355c7ec46"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OHS_ASN1_WRITE_INIT&#160;&#160;&#160;(5 | <a class="el" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00104">104</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac210897838b862644edb488ae72cccf6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OHS_DONE&#160;&#160;&#160;(8 | <a class="el" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00110">110</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7ba4be6e253b8edd89570c4b9ab6a694"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OHS_ERROR&#160;&#160;&#160;(0 | <a class="el" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00094">94</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>

</div>
</div>
<a class="anchor" id="a65621ce6de38605b7e82323899c2d2ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OHS_FIRSTLINE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00096">96</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>

</div>
</div>
<a class="anchor" id="a78b8ba6ffd457726c93cf073d6de93c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OHS_HEADERS&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00098">98</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>

</div>
</div>
<a class="anchor" id="acb51d59a887f5fb19925ed4ec522cdf2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OHS_HTTP_HEADER&#160;&#160;&#160;(9 | <a class="el" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00112">112</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac3e7fbe226601c7bd576d08b5a96e1f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OHS_NOREAD&#160;&#160;&#160;0x1000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00092">92</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a3558d2793f4f2297e44912585c443d91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OCSP_REQ_CTX_add1_header </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *&#160;</td>
          <td class="paramname"><em>rctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00216">216</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (!name)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a69ef4de9bee4e518fbcebd999d1b3358">BIO_puts</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, name) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (value)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, <span class="stringliteral">&quot;: &quot;</span>, 2) != 2)</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a69ef4de9bee4e518fbcebd999d1b3358">BIO_puts</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, value) &lt;= 0)</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, <span class="stringliteral">&quot;\r\n&quot;</span>, 2) != 2)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#acb51d59a887f5fb19925ed4ec522cdf2">OHS_HTTP_HEADER</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aafa6182069793383cf86fe72b55626ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OCSP_REQ_CTX_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *&#160;</td>
          <td class="paramname"><em>rctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00141">141</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>)</div>
<div class="line">                <a class="code" href="bio_8h.html#abbfb67b5eb998ce232f2482b097da8b2">BIO_free</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a5be089a4280adf7c889fcc46ac8127d7">iobuf</a>)</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a5be089a4280adf7c889fcc46ac8127d7">iobuf</a>);</div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(rctx);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a81d9042f18c72bd0b334918c0a3d3491"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a>* OCSP_REQ_CTX_get0_mem_bio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *&#160;</td>
          <td class="paramname"><em>rctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00150">150</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9ade3828290a6e6a9968324014961bb3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OCSP_REQ_CTX_http </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *&#160;</td>
          <td class="paramname"><em>rctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00197">197</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> http_hdr[] = <span class="stringliteral">&quot;%s %s HTTP/1.0\r\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!path)</div>
<div class="line">                path = <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, http_hdr, op, path) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#acb51d59a887f5fb19925ed4ec522cdf2">OHS_HTTP_HEADER</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaf26b59c7c1740385b0fb80540599ad2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OCSP_REQ_CTX_i2d </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *&#160;</td>
          <td class="paramname"><em>rctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#aea7867d0d5f4d561d2cbf24a9ce49e40">ASN1_ITEM</a> *&#160;</td>
          <td class="paramname"><em>it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> *&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00163">163</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> req_hdr[] =</div>
<div class="line">                        <span class="stringliteral">&quot;Content-Type: application/ocsp-request\r\n&quot;</span></div>
<div class="line">                        <span class="stringliteral">&quot;Content-Length: %d\r\n\r\n&quot;</span>;</div>
<div class="line">        <span class="keywordtype">int</span> reqlen = <a class="code" href="asn1_8h.html#ada80d0bea54b10298b0668eabba68e9e">ASN1_item_i2d</a>(val, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, it);</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="b__print_8c.html#a53da52fd1c69fe357b8a122476352be7">BIO_printf</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, req_hdr, reqlen) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="a__i2d__fp_8c.html#aa8834981e76236333cfead252fc3aa0d">ASN1_item_i2d_bio</a>(it, rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, val) &lt;= 0)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a3e00008c68918a1a811b132355c7ec46">OHS_ASN1_WRITE_INIT</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab747695cf964937686dfc9d26bb5c3c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OCSP_REQ_CTX_nbio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *&#160;</td>
          <td class="paramname"><em>rctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00337">337</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> i, <a class="code" href="structdoall__sorted.html#a2d1891f75b39938140031ddc6bd8d6e6">n</a>;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p;</div>
<div class="line">        next_io:</div>
<div class="line">        <span class="keywordflow">if</span> (!(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> &amp; <a class="code" href="ocsp__ht_8c.html#ac3e7fbe226601c7bd576d08b5a96e1f7">OHS_NOREAD</a>))</div>
<div class="line">                {</div>
<div class="line">                n = <a class="code" href="bio_8h.html#aa9c073049884e4f84d442529a7f14861">BIO_read</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aaf53943a6bc3dbb699ba9f1b250efa60">io</a>, rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a5be089a4280adf7c889fcc46ac8127d7">iobuf</a>, rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a80f1a1d0b51c8d72d26da4273e837bc6">iobuflen</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (n &lt;= 0)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#aa05961c55a37bf6e3ab7bfc8be2ea30c">BIO_should_retry</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aaf53943a6bc3dbb699ba9f1b250efa60">io</a>))</div>
<div class="line">                                <span class="keywordflow">return</span> -1;</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Write data to memory BIO */</span></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a5be089a4280adf7c889fcc46ac8127d7">iobuf</a>, n) != n)</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">switch</span>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ocsp__ht_8c.html#acb51d59a887f5fb19925ed4ec522cdf2">OHS_HTTP_HEADER</a>:</div>
<div class="line">                <span class="comment">/* Last operation was adding headers: need a final \r\n */</span></div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, <span class="stringliteral">&quot;\r\n&quot;</span>, 2) != 2)</div>
<div class="line">                        {</div>
<div class="line">                        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>;</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a3e00008c68918a1a811b132355c7ec46">OHS_ASN1_WRITE_INIT</a>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ocsp__ht_8c.html#a3e00008c68918a1a811b132355c7ec46">OHS_ASN1_WRITE_INIT</a>:</div>
<div class="line">                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aff36e7150d50fa791b00e92f6c6cfaff">asn1_len</a> = <a class="code" href="bio_8h.html#ad1cca133aa21da42cf8dac755e0b4df1">BIO_get_mem_data</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#ad07e40d324a3cd2f9d7e04d3b37872cd">OHS_ASN1_WRITE</a>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ocsp__ht_8c.html#ad07e40d324a3cd2f9d7e04d3b37872cd">OHS_ASN1_WRITE</a>:</div>
<div class="line">                n = <a class="code" href="bio_8h.html#ad1cca133aa21da42cf8dac755e0b4df1">BIO_get_mem_data</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, &amp;p);</div>
<div class="line"></div>
<div class="line">                i = <a class="code" href="bio_8h.html#a7b4c64ffdc342154cf923744210a8429">BIO_write</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aaf53943a6bc3dbb699ba9f1b250efa60">io</a>,</div>
<div class="line">                        p + (n - rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aff36e7150d50fa791b00e92f6c6cfaff">asn1_len</a>), rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aff36e7150d50fa791b00e92f6c6cfaff">asn1_len</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (i &lt;= 0)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#aa05961c55a37bf6e3ab7bfc8be2ea30c">BIO_should_retry</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aaf53943a6bc3dbb699ba9f1b250efa60">io</a>))</div>
<div class="line">                                <span class="keywordflow">return</span> -1;</div>
<div class="line">                        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>;</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aff36e7150d50fa791b00e92f6c6cfaff">asn1_len</a> -= i;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aff36e7150d50fa791b00e92f6c6cfaff">asn1_len</a> &gt; 0)</div>
<div class="line">                        <span class="keywordflow">goto</span> next_io;</div>
<div class="line"></div>
<div class="line">                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a7833f8195b0d92cfe253dbe2e7736de9">OHS_ASN1_FLUSH</a>;</div>
<div class="line"></div>
<div class="line">                (void)<a class="code" href="bio_8h.html#a21d76e2ba67416892612ec20dae42b84">BIO_reset</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ocsp__ht_8c.html#a7833f8195b0d92cfe253dbe2e7736de9">OHS_ASN1_FLUSH</a>:</div>
<div class="line"></div>
<div class="line">                i = <a class="code" href="bio_8h.html#a6e1d8242b642b53ee9aefdc79ff10f3e">BIO_flush</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aaf53943a6bc3dbb699ba9f1b250efa60">io</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line">                        {</div>
<div class="line">                        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a65621ce6de38605b7e82323899c2d2ae">OHS_FIRSTLINE</a>;</div>
<div class="line">                        <span class="keywordflow">goto</span> next_io;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#aa05961c55a37bf6e3ab7bfc8be2ea30c">BIO_should_retry</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aaf53943a6bc3dbb699ba9f1b250efa60">io</a>))</div>
<div class="line">                        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>;</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>:</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ocsp__ht_8c.html#a65621ce6de38605b7e82323899c2d2ae">OHS_FIRSTLINE</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ocsp__ht_8c.html#a78b8ba6ffd457726c93cf073d6de93c3">OHS_HEADERS</a>:</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Attempt to read a line in */</span></div>
<div class="line"></div>
<div class="line">                next_line:</div>
<div class="line">                <span class="comment">/* Due to &amp;%^*$&quot; memory BIO behaviour with BIO_gets we</span></div>
<div class="line"><span class="comment">                 * have to check there&#39;s a complete line in there before</span></div>
<div class="line"><span class="comment">                 * calling BIO_gets or we&#39;ll just get a partial read.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                n = <a class="code" href="bio_8h.html#ad1cca133aa21da42cf8dac755e0b4df1">BIO_get_mem_data</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, &amp;p);</div>
<div class="line">                <span class="keywordflow">if</span> ((n &lt;= 0) || !memchr(p, <span class="charliteral">&#39;\n&#39;</span>, n))</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (n &gt;= rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a80f1a1d0b51c8d72d26da4273e837bc6">iobuflen</a>)</div>
<div class="line">                                {</div>
<div class="line">                                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>;</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="keywordflow">goto</span> next_io;</div>
<div class="line">                        }</div>
<div class="line">                n = <a class="code" href="bio_8h.html#a66854c7e9d463b9655b6a949ddc581f7">BIO_gets</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, (<span class="keywordtype">char</span> *)rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a5be089a4280adf7c889fcc46ac8127d7">iobuf</a>, rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a80f1a1d0b51c8d72d26da4273e837bc6">iobuflen</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (n &lt;= 0)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="bio_8h.html#aa05961c55a37bf6e3ab7bfc8be2ea30c">BIO_should_retry</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>))</div>
<div class="line">                                <span class="keywordflow">goto</span> next_io;</div>
<div class="line">                        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>;</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Don&#39;t allow excessive lines */</span></div>
<div class="line">                <span class="keywordflow">if</span> (n == rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a80f1a1d0b51c8d72d26da4273e837bc6">iobuflen</a>)</div>
<div class="line">                        {</div>
<div class="line">                        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>;</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* First line */</span></div>
<div class="line">                <span class="keywordflow">if</span> (rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> == <a class="code" href="ocsp__ht_8c.html#a65621ce6de38605b7e82323899c2d2ae">OHS_FIRSTLINE</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (parse_http_line1((<span class="keywordtype">char</span> *)rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a5be089a4280adf7c889fcc46ac8127d7">iobuf</a>))</div>
<div class="line">                                {</div>
<div class="line">                                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a78b8ba6ffd457726c93cf073d6de93c3">OHS_HEADERS</a>;</div>
<div class="line">                                <span class="keywordflow">goto</span> next_line;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                                {</div>
<div class="line">                                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>;</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                        <span class="comment">/* Look for blank line: end of headers */</span></div>
<div class="line">                        <span class="keywordflow">for</span> (p = rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a5be089a4280adf7c889fcc46ac8127d7">iobuf</a>; *p; p++)</div>
<div class="line">                                {</div>
<div class="line">                                <span class="keywordflow">if</span> ((*p != <span class="charliteral">&#39;\r&#39;</span>) &amp;&amp; (*p != <span class="charliteral">&#39;\n&#39;</span>))</div>
<div class="line">                                        <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="keywordflow">if</span> (*p)</div>
<div class="line">                                <span class="keywordflow">goto</span> next_line;</div>
<div class="line"></div>
<div class="line">                        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#ae28854506b41464c0f46d1dd7c2393ca">OHS_ASN1_HEADER</a>;</div>
<div class="line"></div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                <span class="comment">/* Fall thru */</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ocsp__ht_8c.html#ae28854506b41464c0f46d1dd7c2393ca">OHS_ASN1_HEADER</a>:</div>
<div class="line">                <span class="comment">/* Now reading ASN1 header: can read at least 2 bytes which</span></div>
<div class="line"><span class="comment">                 * is enough for ASN1 SEQUENCE header and either length field</span></div>
<div class="line"><span class="comment">                 * or at least the length of the length field.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                n = <a class="code" href="bio_8h.html#ad1cca133aa21da42cf8dac755e0b4df1">BIO_get_mem_data</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, &amp;p);</div>
<div class="line">                <span class="keywordflow">if</span> (n &lt; 2)</div>
<div class="line">                        <span class="keywordflow">goto</span> next_io;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Check it is an ASN1 SEQUENCE */</span></div>
<div class="line">                <span class="keywordflow">if</span> (*p++ != (<a class="code" href="asn1_8h.html#ab76fef5a089d894b827029a84a6f4f7a">V_ASN1_SEQUENCE</a>|<a class="code" href="asn1_8h.html#a45df18b839e1fe5919302e11c2ec12c3">V_ASN1_CONSTRUCTED</a>))</div>
<div class="line">                        {</div>
<div class="line">                        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>;</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Check out length field */</span></div>
<div class="line">                <span class="keywordflow">if</span> (*p &amp; 0x80)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="comment">/* If MSB set on initial length octet we can now</span></div>
<div class="line"><span class="comment">                         * always read 6 octets: make sure we have them.</span></div>
<div class="line"><span class="comment">                         */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (n &lt; 6)</div>
<div class="line">                                <span class="keywordflow">goto</span> next_io;</div>
<div class="line">                        n = *p &amp; 0x7F;</div>
<div class="line">                        <span class="comment">/* Not NDEF or excessive length */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (!n || (n &gt; 4))</div>
<div class="line">                                {</div>
<div class="line">                                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>;</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                                }</div>
<div class="line">                        p++;</div>
<div class="line">                        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aff36e7150d50fa791b00e92f6c6cfaff">asn1_len</a> = 0;</div>
<div class="line">                        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="structdoall__sorted.html#a2d1891f75b39938140031ddc6bd8d6e6">n</a>; i++)</div>
<div class="line">                                {</div>
<div class="line">                                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aff36e7150d50fa791b00e92f6c6cfaff">asn1_len</a> &lt;&lt;= 8;</div>
<div class="line">                                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aff36e7150d50fa791b00e92f6c6cfaff">asn1_len</a> |= *p++;</div>
<div class="line">                                }</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">if</span> (rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aff36e7150d50fa791b00e92f6c6cfaff">asn1_len</a> &gt; rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a7a99962116eb85a0b08d2176f6f5be2b">max_resp_len</a>)</div>
<div class="line">                                {</div>
<div class="line">                                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>;</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                                }</div>
<div class="line"></div>
<div class="line">                        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aff36e7150d50fa791b00e92f6c6cfaff">asn1_len</a> += n + 2;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aff36e7150d50fa791b00e92f6c6cfaff">asn1_len</a> = *p + 2;</div>
<div class="line"></div>
<div class="line">                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#abadab9e46d9482abd7163f31b9435fc1">OHS_ASN1_CONTENT</a>;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Fall thru */</span></div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ocsp__ht_8c.html#abadab9e46d9482abd7163f31b9435fc1">OHS_ASN1_CONTENT</a>:</div>
<div class="line">                n = <a class="code" href="bio_8h.html#ad1cca133aa21da42cf8dac755e0b4df1">BIO_get_mem_data</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (n &lt; (<span class="keywordtype">int</span>)rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aff36e7150d50fa791b00e92f6c6cfaff">asn1_len</a>)</div>
<div class="line">                        <span class="keywordflow">goto</span> next_io;</div>
<div class="line"></div>
<div class="line">                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#ac210897838b862644edb488ae72cccf6">OHS_DONE</a>;</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ocsp__ht_8c.html#ac210897838b862644edb488ae72cccf6">OHS_DONE</a>:</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a579e2cf59ae70b929f3b01aa074194b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OCSP_REQ_CTX_nbio_d2i </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *&#160;</td>
          <td class="paramname"><em>rctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **&#160;</td>
          <td class="paramname"><em>pval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#aea7867d0d5f4d561d2cbf24a9ce49e40">ASN1_ITEM</a> *&#160;</td>
          <td class="paramname"><em>it</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00177">177</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> rv, <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p;</div>
<div class="line"></div>
<div class="line">        rv = <a class="code" href="ocsp_8h.html#ab747695cf964937686dfc9d26bb5c3c0">OCSP_REQ_CTX_nbio</a>(rctx);</div>
<div class="line">        <span class="keywordflow">if</span> (rv != 1)</div>
<div class="line">                <span class="keywordflow">return</span> rv;</div>
<div class="line"></div>
<div class="line">        len = <a class="code" href="bio_8h.html#ad1cca133aa21da42cf8dac755e0b4df1">BIO_get_mem_data</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>, &amp;p);</div>
<div class="line">        *pval = <a class="code" href="asn1_8h.html#a5cd3d6660d85c72563fea0f05ca4fa8a">ASN1_item_d2i</a>(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, &amp;p, len, it);</div>
<div class="line">        <span class="keywordflow">if</span> (*pval == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>;</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a48047488b6364ff2b2e9ed1483525232"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a>* OCSP_REQ_CTX_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxline</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00117">117</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structocsp__req__ctx__st.html">OCSP_REQ_CTX</a> *rctx;</div>
<div class="line">        rctx = <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structocsp__req__ctx__st.html">OCSP_REQ_CTX</a>));</div>
<div class="line">        <span class="keywordflow">if</span> (!rctx)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aefff818e61421552409f5f682d3cc27a">state</a> = <a class="code" href="ocsp__ht_8c.html#a7ba4be6e253b8edd89570c4b9ab6a694">OHS_ERROR</a>;</div>
<div class="line">        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a7a99962116eb85a0b08d2176f6f5be2b">max_resp_len</a> = <a class="code" href="ocsp__ht_8c.html#ab393fd10d6018a9aefb8f1a73b8d7038">OCSP_MAX_RESP_LENGTH</a>;</div>
<div class="line">        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a> = <a class="code" href="bio_8h.html#a581a4f51e785ab7df2d032d38f589259">BIO_new</a>(<a class="code" href="bio_8h.html#aa00c1ff95f6d83e358d2daa6eca3e724">BIO_s_mem</a>());</div>
<div class="line">        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aaf53943a6bc3dbb699ba9f1b250efa60">io</a> = io;</div>
<div class="line">        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#aff36e7150d50fa791b00e92f6c6cfaff">asn1_len</a> = 0;</div>
<div class="line">        <span class="keywordflow">if</span> (maxline &gt; 0)</div>
<div class="line">                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a80f1a1d0b51c8d72d26da4273e837bc6">iobuflen</a> = maxline;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a80f1a1d0b51c8d72d26da4273e837bc6">iobuflen</a> = <a class="code" href="ocsp__ht_8c.html#a82b9032ab7281c15f522f11b2c2d19f5">OCSP_MAX_LINE_LEN</a>;</div>
<div class="line">        rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a5be089a4280adf7c889fcc46ac8127d7">iobuf</a> = <a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a80f1a1d0b51c8d72d26da4273e837bc6">iobuflen</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a5be089a4280adf7c889fcc46ac8127d7">iobuf</a> || !rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a9bcff185bc79ba87ad3c98b6e686ddbf">mem</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="ocsp_8h.html#aafa6182069793383cf86fe72b55626ce">OCSP_REQ_CTX_free</a>(rctx);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> rctx;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abaa967d2e8847d94936eb6c1520b1860"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OCSP_REQ_CTX_set1_req </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *&#160;</td>
          <td class="paramname"><em>rctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ocsp_8h.html#a17153531638085adb112e6bf8c2bd099">OCSP_REQUEST</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00210">210</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="ocsp_8h.html#aaf26b59c7c1740385b0fb80540599ad2">OCSP_REQ_CTX_i2d</a>(rctx, <a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a>),</div>
<div class="line">                                                        (<a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> *)req);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeed5454e6f68e59a6d30a1d4bf951404"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a126a9513b35297c9f53956eacf2b333d">OCSP_RESPONSE</a>* OCSP_sendreq_bio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ocsp_8h.html#a17153531638085adb112e6bf8c2bd099">OCSP_REQUEST</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00566">566</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structocsp__response__st.html">OCSP_RESPONSE</a> *resp = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <a class="code" href="structocsp__req__ctx__st.html">OCSP_REQ_CTX</a> *ctx;</div>
<div class="line">        <span class="keywordtype">int</span> rv;</div>
<div class="line"></div>
<div class="line">        ctx = <a class="code" href="ocsp_8h.html#a9db5cf05e460032f2b49e7f776eb4485">OCSP_sendreq_new</a>(b, path, req, -1);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">do</span></div>
<div class="line">                {</div>
<div class="line">                rv = <a class="code" href="ocsp_8h.html#a5ceb346e6849747c292985b69d6fe2cf">OCSP_sendreq_nbio</a>(&amp;resp, ctx);</div>
<div class="line">                } <span class="keywordflow">while</span> ((rv == -1) &amp;&amp; <a class="code" href="bio_8h.html#aa05961c55a37bf6e3ab7bfc8be2ea30c">BIO_should_retry</a>(b));</div>
<div class="line"></div>
<div class="line">        <a class="code" href="ocsp_8h.html#aafa6182069793383cf86fe72b55626ce">OCSP_REQ_CTX_free</a>(ctx);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (rv)</div>
<div class="line">                <span class="keywordflow">return</span> resp;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5ceb346e6849747c292985b69d6fe2cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OCSP_sendreq_nbio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a126a9513b35297c9f53956eacf2b333d">OCSP_RESPONSE</a> **&#160;</td>
          <td class="paramname"><em>presp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *&#160;</td>
          <td class="paramname"><em>rctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00558">558</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="ocsp_8h.html#a579e2cf59ae70b929f3b01aa074194b9">OCSP_REQ_CTX_nbio_d2i</a>(rctx,</div>
<div class="line">                        (<a class="code" href="asn1_8h.html#aaa5ffa26b0bbba094a9ee353b8ade6ab">ASN1_VALUE</a> **)presp, <a class="code" href="asn1_8h.html#a704c92967a505aaabb8a8f7065bc88d0">ASN1_ITEM_rptr</a>(<a class="code" href="structocsp__response__st.html">OCSP_RESPONSE</a>));</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9db5cf05e460032f2b49e7f776eb4485"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a>* OCSP_sendreq_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bio_8h.html#af3fabae1c9af50b9312cdff41e11d1dd">BIO</a> *&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ocsp_8h.html#a17153531638085adb112e6bf8c2bd099">OCSP_REQUEST</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxline</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00236">236</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line"></div>
<div class="line">        <a class="code" href="structocsp__req__ctx__st.html">OCSP_REQ_CTX</a> *rctx = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        rctx = <a class="code" href="ocsp_8h.html#a48047488b6364ff2b2e9ed1483525232">OCSP_REQ_CTX_new</a>(io, maxline);</div>
<div class="line">        <span class="keywordflow">if</span> (!rctx)</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="ocsp_8h.html#a9ade3828290a6e6a9968324014961bb3">OCSP_REQ_CTX_http</a>(rctx, <span class="stringliteral">&quot;POST&quot;</span>, path))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (req &amp;&amp; !<a class="code" href="ocsp_8h.html#abaa967d2e8847d94936eb6c1520b1860">OCSP_REQ_CTX_set1_req</a>(rctx, req))</div>
<div class="line">                <span class="keywordflow">goto</span> err;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> rctx;</div>
<div class="line">        </div>
<div class="line">        err:</div>
<div class="line">        <a class="code" href="ocsp_8h.html#aafa6182069793383cf86fe72b55626ce">OCSP_REQ_CTX_free</a>(rctx);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a41a8876d5baf94823517c40e39eae41f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OCSP_set_max_response_length </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#af89a616e7492960cb781df8b67b99292">OCSP_REQ_CTX</a> *&#160;</td>
          <td class="paramname"><em>rctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ocsp__ht_8c_source.html#l00155">155</a> of file <a class="el" href="ocsp__ht_8c_source.html">ocsp_ht.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a> == 0)</div>
<div class="line">                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a7a99962116eb85a0b08d2176f6f5be2b">max_resp_len</a> = <a class="code" href="ocsp__ht_8c.html#ab393fd10d6018a9aefb8f1a73b8d7038">OCSP_MAX_RESP_LENGTH</a>;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                rctx-&gt;<a class="code" href="structocsp__req__ctx__st.html#a7a99962116eb85a0b08d2176f6f5be2b">max_resp_len</a> = <a class="code" href="asn1_8h.html#ad8c3db4434e9cb5cd772cc009f40e856">len</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
