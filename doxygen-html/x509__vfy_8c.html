<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>openssl: crypto/x509/x509_vfy.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">openssl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_85cebb145304c27eb18975fa1e843011.html">x509</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">x509_vfy.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;time.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="cryptlib_8h_source.html">cryptlib.h</a>&quot;</code><br/>
<code>#include &lt;openssl/crypto.h&gt;</code><br/>
<code>#include &lt;openssl/lhash.h&gt;</code><br/>
<code>#include &lt;openssl/buffer.h&gt;</code><br/>
<code>#include &lt;openssl/evp.h&gt;</code><br/>
<code>#include &lt;openssl/asn1.h&gt;</code><br/>
<code>#include &lt;openssl/x509.h&gt;</code><br/>
<code>#include &lt;openssl/x509v3.h&gt;</code><br/>
<code>#include &lt;openssl/objects.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="vpm__int_8h_source.html">vpm_int.h</a>&quot;</code><br/>
</div>
<p><a href="x509__vfy_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a70988636874dbc5f6cc52540620c4cd1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a70988636874dbc5f6cc52540620c4cd1">CRL_SCORE_NOCRITICAL</a>&#160;&#160;&#160;0x100</td></tr>
<tr class="memitem:ad66073e8a173898b6183dd23906873f2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#ad66073e8a173898b6183dd23906873f2">CRL_SCORE_SCOPE</a>&#160;&#160;&#160;0x080</td></tr>
<tr class="memitem:aab043c4c9b46c3fcd5189ccbadd16dd8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#aab043c4c9b46c3fcd5189ccbadd16dd8">CRL_SCORE_TIME</a>&#160;&#160;&#160;0x040</td></tr>
<tr class="memitem:a1fa1a16a878e0ac22d54815755a47921"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a1fa1a16a878e0ac22d54815755a47921">CRL_SCORE_ISSUER_NAME</a>&#160;&#160;&#160;0x020</td></tr>
<tr class="memitem:a4dcb6f68b612416f1e43a5b4ea65866f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a4dcb6f68b612416f1e43a5b4ea65866f">CRL_SCORE_VALID</a>&#160;&#160;&#160;(<a class="el" href="x509__vfy_8c.html#a70988636874dbc5f6cc52540620c4cd1">CRL_SCORE_NOCRITICAL</a>|<a class="el" href="x509__vfy_8c.html#aab043c4c9b46c3fcd5189ccbadd16dd8">CRL_SCORE_TIME</a>|<a class="el" href="x509__vfy_8c.html#ad66073e8a173898b6183dd23906873f2">CRL_SCORE_SCOPE</a>)</td></tr>
<tr class="memitem:ad11fad6acd45c91aefcab0d8547b8930"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#ad11fad6acd45c91aefcab0d8547b8930">CRL_SCORE_ISSUER_CERT</a>&#160;&#160;&#160;0x018</td></tr>
<tr class="memitem:a77a3d7422f757e95e0514dbcd023dbdf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a77a3d7422f757e95e0514dbcd023dbdf">CRL_SCORE_SAME_PATH</a>&#160;&#160;&#160;0x008</td></tr>
<tr class="memitem:a2f909e1515fec7adfb4dcb2755676a4e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a2f909e1515fec7adfb4dcb2755676a4e">CRL_SCORE_AKID</a>&#160;&#160;&#160;0x004</td></tr>
<tr class="memitem:a9f9a56509020f9e67da45f9ae98c37b1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a9f9a56509020f9e67da45f9ae98c37b1">CRL_SCORE_TIME_DELTA</a>&#160;&#160;&#160;0x002</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a00794722daae3cb1e10ec00eda7c2c62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a00794722daae3cb1e10ec00eda7c2c62">X509_verify_cert</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx)</td></tr>
<tr class="memitem:a9bd6582d48096ec9eecd74573538cc27"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a9bd6582d48096ec9eecd74573538cc27">X509_cmp_current_time</a> (const <a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *ctm)</td></tr>
<tr class="memitem:a7e0a4f2edc36d5bede65104b596e6d72"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a7e0a4f2edc36d5bede65104b596e6d72">X509_cmp_time</a> (const <a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *ctm, time_t *cmp_time)</td></tr>
<tr class="memitem:a2af41732f9bd8d8b11ae2b94390d415a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a2af41732f9bd8d8b11ae2b94390d415a">X509_gmtime_adj</a> (<a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *s, long adj)</td></tr>
<tr class="memitem:a41d9f2b1cc04295be7f113d40656e4d6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a41d9f2b1cc04295be7f113d40656e4d6">X509_time_adj</a> (<a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *s, long offset_sec, time_t *in_tm)</td></tr>
<tr class="memitem:a5974314aa632516c7f9d65b4b4bec334"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a5974314aa632516c7f9d65b4b4bec334">X509_time_adj_ex</a> (<a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *s, int offset_day, long offset_sec, time_t *in_tm)</td></tr>
<tr class="memitem:a5b28966efdd28549644c52bde151dd72"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a5b28966efdd28549644c52bde151dd72">X509_get_pubkey_parameters</a> (<a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *pkey, <a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*chain)</td></tr>
<tr class="memitem:a196c825b6e9ea10b00f7189a82e4453c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a196c825b6e9ea10b00f7189a82e4453c">X509_CRL_diff</a> (<a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a> *base, <a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a> *newer, <a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *skey, const <a class="el" href="ossl__typ_8h.html#aac66cf010326fa9a927c2a34888f45d3">EVP_MD</a> *md, unsigned int <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:aff6ff1506e3f2fa55100f1e21ef2f369"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#aff6ff1506e3f2fa55100f1e21ef2f369">X509_STORE_CTX_get_ex_new_index</a> (long argl, void *argp, <a class="el" href="ossl__typ_8h.html#a524acd717ae812f604e3027f8255d0ba">CRYPTO_EX_new</a> *new_func, <a class="el" href="ossl__typ_8h.html#a1235777e2310295c33f29a5f06e40682">CRYPTO_EX_dup</a> *dup_func, <a class="el" href="ossl__typ_8h.html#a723f84d260fce598230a3cdd45885246">CRYPTO_EX_free</a> *<a class="el" href="asn1_8h.html#a942bd852ec8360a1803ceda0b1029986">free_func</a>)</td></tr>
<tr class="memitem:ae3efef781c0987fba3c0609921060d06"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#ae3efef781c0987fba3c0609921060d06">X509_STORE_CTX_set_ex_data</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, int idx, void *<a class="el" href="ec__curve_8c.html#af1780c54f65adaed36d43e53ad9afe51">data</a>)</td></tr>
<tr class="memitem:aac073808d8376a41e3b8a64c0f12ff55"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#aac073808d8376a41e3b8a64c0f12ff55">X509_STORE_CTX_get_ex_data</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, int idx)</td></tr>
<tr class="memitem:a0168c670323c9c346dc935ef7c0277df"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a0168c670323c9c346dc935ef7c0277df">X509_STORE_CTX_get_error</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx)</td></tr>
<tr class="memitem:a714efa76b5dcc6e39933fea4829e30d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a714efa76b5dcc6e39933fea4829e30d6">X509_STORE_CTX_set_error</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, int err)</td></tr>
<tr class="memitem:a2fb8eb6094215f110482e2a72788b0e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a2fb8eb6094215f110482e2a72788b0e8">X509_STORE_CTX_get_error_depth</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx)</td></tr>
<tr class="memitem:ad0268e76142177fe51d3c5145ba68b54"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#ad0268e76142177fe51d3c5145ba68b54">X509_STORE_CTX_get_current_cert</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx)</td></tr>
<tr class="memitem:a00cf9f18b18b26449b4cde33c2f1d5ff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a00cf9f18b18b26449b4cde33c2f1d5ff">STACK_OF</a> (<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)</td></tr>
<tr class="memitem:a1492b264b9d95d5d0d710ac27876bfce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a1492b264b9d95d5d0d710ac27876bfce">X509_STORE_CTX_get0_current_issuer</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx)</td></tr>
<tr class="memitem:a3d1a917e94eb74c93b3a8cafc1f213fb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a3d1a917e94eb74c93b3a8cafc1f213fb">X509_STORE_CTX_get0_current_crl</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx)</td></tr>
<tr class="memitem:a7d19744a61f81bdc6bec2a9fd2827315"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a7d19744a61f81bdc6bec2a9fd2827315">X509_STORE_CTX_get0_parent_ctx</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx)</td></tr>
<tr class="memitem:a8b2875ef04f22b55ecbae42eb1d15ea5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a8b2875ef04f22b55ecbae42eb1d15ea5">X509_STORE_CTX_set_cert</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *<a class="el" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>)</td></tr>
<tr class="memitem:a48ab5ea069c17ff17fd66dbc15c055f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a48ab5ea069c17ff17fd66dbc15c055f5">X509_STORE_CTX_set_chain</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, <a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*sk)</td></tr>
<tr class="memitem:a208f8d99bd28e1587043127fe846cdc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a208f8d99bd28e1587043127fe846cdc4">X509_STORE_CTX_set0_crls</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, <a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a>)*sk)</td></tr>
<tr class="memitem:a2b4939baca9b28b912b54841865b492b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a2b4939baca9b28b912b54841865b492b">X509_STORE_CTX_set_purpose</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, int purpose)</td></tr>
<tr class="memitem:ac6351c206cbc0c90d573e98d363d4627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#ac6351c206cbc0c90d573e98d363d4627">X509_STORE_CTX_set_trust</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, int trust)</td></tr>
<tr class="memitem:aeae05e156ff5e328afc1923b4bf8a71d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#aeae05e156ff5e328afc1923b4bf8a71d">X509_STORE_CTX_purpose_inherit</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, int def_purpose, int purpose, int trust)</td></tr>
<tr class="memitem:ac6c7030db2040b3dbd4be051e81592dc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#ac6c7030db2040b3dbd4be051e81592dc">X509_STORE_CTX_new</a> (void)</td></tr>
<tr class="memitem:a7fad77ce519c90dc4c9dca799abc80e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a7fad77ce519c90dc4c9dca799abc80e1">X509_STORE_CTX_free</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx)</td></tr>
<tr class="memitem:a513e70fc82c927254c38d0ac102bafd9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a513e70fc82c927254c38d0ac102bafd9">X509_STORE_CTX_init</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, <a class="el" href="ossl__typ_8h.html#a3a2b800bae08729d11bc28f12b795597">X509_STORE</a> *store, <a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *x509, <a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*chain)</td></tr>
<tr class="memitem:a0669313fd5e0304dff1903d2dbe75f61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a0669313fd5e0304dff1903d2dbe75f61">X509_STORE_CTX_trusted_stack</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, <a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*sk)</td></tr>
<tr class="memitem:a8ff79593c52dcc4c9e63bfb7146bb9e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a8ff79593c52dcc4c9e63bfb7146bb9e3">X509_STORE_CTX_cleanup</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx)</td></tr>
<tr class="memitem:a7603bd2496fba14cf60258377f1208e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a7603bd2496fba14cf60258377f1208e7">X509_STORE_CTX_set_depth</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, int depth)</td></tr>
<tr class="memitem:a409bf12f2576229eda9191349742bdfd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a409bf12f2576229eda9191349742bdfd">X509_STORE_CTX_set_flags</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, unsigned long <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</td></tr>
<tr class="memitem:ab76bb6c20423d3315aeaf7c7a4138370"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#ab76bb6c20423d3315aeaf7c7a4138370">X509_STORE_CTX_set_time</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, unsigned long <a class="el" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>, time_t <a class="el" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>)</td></tr>
<tr class="memitem:afaf77ded1467bc020aa71f06aeb05cd0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#afaf77ded1467bc020aa71f06aeb05cd0">X509_STORE_CTX_set_verify_cb</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, int(*verify_cb)(int, <a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *))</td></tr>
<tr class="memitem:ae58f41757bea8a08222f5b646d35c018"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ossl__typ_8h.html#a3be68a7c4cbbe4954ccd27ff7215cf0d">X509_POLICY_TREE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#ae58f41757bea8a08222f5b646d35c018">X509_STORE_CTX_get0_policy_tree</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx)</td></tr>
<tr class="memitem:a4b246972a4ec5b8e8d9705c860f2e5c8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a4b246972a4ec5b8e8d9705c860f2e5c8">X509_STORE_CTX_get_explicit_policy</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx)</td></tr>
<tr class="memitem:abb33e390f015d2ba702a5e6c56388ea3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#abb33e390f015d2ba702a5e6c56388ea3">X509_STORE_CTX_set_default</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, const char *name)</td></tr>
<tr class="memitem:a4bed2c92073c83931e3de7aecf34552f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="x509__vfy_8h.html#a9b8209a7a29bafa279e1b5bc5f81cb23">X509_VERIFY_PARAM</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#a4bed2c92073c83931e3de7aecf34552f">X509_STORE_CTX_get0_param</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx)</td></tr>
<tr class="memitem:ac44243da0226fb4a56b65b0731863621"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#ac44243da0226fb4a56b65b0731863621">X509_STORE_CTX_set0_param</a> (<a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *ctx, <a class="el" href="x509__vfy_8h.html#a9b8209a7a29bafa279e1b5bc5f81cb23">X509_VERIFY_PARAM</a> *param)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad4cb0605e82042158081c00054b67e56"><td class="memItemLeft" align="right" valign="top">const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509__vfy_8c.html#ad4cb0605e82042158081c00054b67e56">X509_version</a> [] = &quot;X.509&quot; OPENSSL_VERSION_PTEXT</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="a2f909e1515fec7adfb4dcb2755676a4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRL_SCORE_AKID&#160;&#160;&#160;0x004</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l00106">106</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad11fad6acd45c91aefcab0d8547b8930"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRL_SCORE_ISSUER_CERT&#160;&#160;&#160;0x018</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l00098">98</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1fa1a16a878e0ac22d54815755a47921"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRL_SCORE_ISSUER_NAME&#160;&#160;&#160;0x020</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l00090">90</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>

</div>
</div>
<a class="anchor" id="a70988636874dbc5f6cc52540620c4cd1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRL_SCORE_NOCRITICAL&#160;&#160;&#160;0x100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l00078">78</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>

</div>
</div>
<a class="anchor" id="a77a3d7422f757e95e0514dbcd023dbdf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRL_SCORE_SAME_PATH&#160;&#160;&#160;0x008</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l00102">102</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad66073e8a173898b6183dd23906873f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRL_SCORE_SCOPE&#160;&#160;&#160;0x080</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l00082">82</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>

</div>
</div>
<a class="anchor" id="aab043c4c9b46c3fcd5189ccbadd16dd8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRL_SCORE_TIME&#160;&#160;&#160;0x040</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l00086">86</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>

</div>
</div>
<a class="anchor" id="a9f9a56509020f9e67da45f9ae98c37b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRL_SCORE_TIME_DELTA&#160;&#160;&#160;0x002</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l00110">110</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4dcb6f68b612416f1e43a5b4ea65866f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRL_SCORE_VALID&#160;&#160;&#160;(<a class="el" href="x509__vfy_8c.html#a70988636874dbc5f6cc52540620c4cd1">CRL_SCORE_NOCRITICAL</a>|<a class="el" href="x509__vfy_8c.html#aab043c4c9b46c3fcd5189ccbadd16dd8">CRL_SCORE_TIME</a>|<a class="el" href="x509__vfy_8c.html#ad66073e8a173898b6183dd23906873f2">CRL_SCORE_SCOPE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l00094">94</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a00cf9f18b18b26449b4cde33c2f1d5ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STACK_OF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02152">2152</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ctx-&gt;chain;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9bd6582d48096ec9eecd74573538cc27"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_cmp_current_time </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *&#160;</td>
          <td class="paramname"><em>ctm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l01839">1839</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#afba9843938bb0294a3cf0b78387f8f68">X509_cmp_time</a>(ctm, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7e0a4f2edc36d5bede65104b596e6d72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_cmp_time </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *&#160;</td>
          <td class="paramname"><em>ctm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t *&#160;</td>
          <td class="paramname"><em>cmp_time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l01844">1844</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">char</span> *str;</div>
<div class="line">        <a class="code" href="structasn1__string__st.html">ASN1_TIME</a> atm;</div>
<div class="line">        <span class="keywordtype">long</span> offset;</div>
<div class="line">        <span class="keywordtype">char</span> buff1[24],buff2[24],*p;</div>
<div class="line">        <span class="keywordtype">int</span> i,j;</div>
<div class="line"></div>
<div class="line">        p=buff1;</div>
<div class="line">        i=ctm-&gt;<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>;</div>
<div class="line">        str=(<span class="keywordtype">char</span> *)ctm-&gt;<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>;</div>
<div class="line">        if (ctm-&gt;<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a> == <a class="code" href="asn1_8h.html#a2a8dd01504f7ee166a07e05cb0707634">V_ASN1_UTCTIME</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> ((i &lt; 11) || (i &gt; 17)) <span class="keywordflow">return</span> 0;</div>
<div class="line">                memcpy(p,str,10);</div>
<div class="line">                p+=10;</div>
<div class="line">                str+=10;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (i &lt; 13) <span class="keywordflow">return</span> 0;</div>
<div class="line">                memcpy(p,str,12);</div>
<div class="line">                p+=12;</div>
<div class="line">                str+=12;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((*str == <span class="charliteral">&#39;Z&#39;</span>) || (*str == <span class="charliteral">&#39;-&#39;</span>) || (*str == <span class="charliteral">&#39;+&#39;</span>))</div>
<div class="line">                { *(p++)=<span class="charliteral">&#39;0&#39;</span>; *(p++)=<span class="charliteral">&#39;0&#39;</span>; }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                { </div>
<div class="line">                *(p++)= *(str++);</div>
<div class="line">                *(p++)= *(str++);</div>
<div class="line">                <span class="comment">/* Skip any fractional seconds... */</span></div>
<div class="line">                <span class="keywordflow">if</span> (*str == <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line">                        {</div>
<div class="line">                        str++;</div>
<div class="line">                        <span class="keywordflow">while</span> ((*str &gt;= <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (*str &lt;= <span class="charliteral">&#39;9&#39;</span>)) str++;</div>
<div class="line">                        }</div>
<div class="line">                </div>
<div class="line">                }</div>
<div class="line">        *(p++)=<span class="charliteral">&#39;Z&#39;</span>;</div>
<div class="line">        *(p++)=<span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (*str == <span class="charliteral">&#39;Z&#39;</span>)</div>
<div class="line">                offset=0;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> ((*str != <span class="charliteral">&#39;+&#39;</span>) &amp;&amp; (*str != <span class="charliteral">&#39;-&#39;</span>))</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                offset=((str[1]-<span class="charliteral">&#39;0&#39;</span>)*10+(str[2]-<span class="charliteral">&#39;0&#39;</span>))*60;</div>
<div class="line">                offset+=(str[3]-<span class="charliteral">&#39;0&#39;</span>)*10+(str[4]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (*str == <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line">                        offset= -offset;</div>
<div class="line">                }</div>
<div class="line">        atm.<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a>=ctm-&gt;<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a>;</div>
<div class="line">        atm.<a class="code" href="structasn1__string__st.html#a166fa78d828cb41bb2499ad411c1774c">flags</a> = 0;</div>
<div class="line">        atm.<a class="code" href="structasn1__string__st.html#a425b332bd4925320832bb18c59f6a9df">length</a>=<span class="keyword">sizeof</span>(buff2);</div>
<div class="line">        atm.<a class="code" href="structasn1__string__st.html#a275a9784693f470debfb2b97411a4fea">data</a>=(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)buff2;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="x509_8h.html#af608891c1a59567348c55fdaa3e62413">X509_time_adj</a>(&amp;atm, offset*60, cmp_time) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ctm-&gt;<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a> == <a class="code" href="asn1_8h.html#a2a8dd01504f7ee166a07e05cb0707634">V_ASN1_UTCTIME</a>)</div>
<div class="line">                {</div>
<div class="line">                i=(buff1[0]-<span class="charliteral">&#39;0&#39;</span>)*10+(buff1[1]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (i &lt; 50) i+=100; <span class="comment">/* cf. RFC 2459 */</span></div>
<div class="line">                j=(buff2[0]-<span class="charliteral">&#39;0&#39;</span>)*10+(buff2[1]-<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (j &lt; 50) j+=100;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (i &lt; j) <span class="keywordflow">return</span> -1;</div>
<div class="line">                <span class="keywordflow">if</span> (i &gt; j) <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line">        i=strcmp(buff1,buff2);</div>
<div class="line">        <span class="keywordflow">if</span> (i == 0) <span class="comment">/* wait a second then return younger :-) */</span></div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> i;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a196c825b6e9ea10b00f7189a82e4453c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a>* X509_CRL_diff </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a> *&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a> *&#160;</td>
          <td class="paramname"><em>newer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>skey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ossl__typ_8h.html#aac66cf010326fa9a927c2a34888f45d3">EVP_MD</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l01996">1996</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structX509__crl__st.html">X509_CRL</a> *crl = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structx509__revoked__st.html">X509_REVOKED</a>) *revs = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="comment">/* CRLs can&#39;t be delta already */</span></div>
<div class="line">        <span class="keywordflow">if</span> (base-&gt;<a class="code" href="structX509__crl__st.html#a758731f9f2c7efcbf2d7e8c6e0b01278">base_crl_number</a> || newer-&gt;<a class="code" href="structX509__crl__st.html#a758731f9f2c7efcbf2d7e8c6e0b01278">base_crl_number</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a773af9c6f9b8b640070518df23a09928">X509_F_X509_CRL_DIFF</a>, <a class="code" href="x509_8h.html#a7d28cbfab8dc3125f78b852cdefa4d48">X509_R_CRL_ALREADY_DELTA</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        }</div>
<div class="line">        <span class="comment">/* Base and new CRL must have a CRL number */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!base-&gt;<a class="code" href="structX509__crl__st.html#a38d84a6c190dc370d74e145cd4faa8d4">crl_number</a> || !newer-&gt;<a class="code" href="structX509__crl__st.html#a38d84a6c190dc370d74e145cd4faa8d4">crl_number</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a773af9c6f9b8b640070518df23a09928">X509_F_X509_CRL_DIFF</a>, <a class="code" href="x509_8h.html#ae972c5686dd48b22ccc6752395510f37">X509_R_NO_CRL_NUMBER</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        }</div>
<div class="line">        <span class="comment">/* Issuer names must match */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="x509_8h.html#ab52671f661dab2939d339792e9b30d37">X509_NAME_cmp</a>(<a class="code" href="x509_8h.html#a8e380db8b19c7276383d88d9bae3d0ff">X509_CRL_get_issuer</a>(base),</div>
<div class="line">                                <a class="code" href="x509_8h.html#a8e380db8b19c7276383d88d9bae3d0ff">X509_CRL_get_issuer</a>(newer)))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a773af9c6f9b8b640070518df23a09928">X509_F_X509_CRL_DIFF</a>, <a class="code" href="x509_8h.html#a563f3da8899f9dc1d14d614aba246564">X509_R_ISSUER_MISMATCH</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        }</div>
<div class="line">        <span class="comment">/* AKID and IDP must match */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!crl_extension_match(base, newer, <a class="code" href="obj__mac_8h.html#a9bcd2acc33de0219ba1e0ba83745baa4">NID_authority_key_identifier</a>))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a773af9c6f9b8b640070518df23a09928">X509_F_X509_CRL_DIFF</a>, <a class="code" href="x509_8h.html#ab5a10774989b89ee70d85ccd2c2d492f">X509_R_AKID_MISMATCH</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        }</div>
<div class="line">        <span class="keywordflow">if</span> (!crl_extension_match(base, newer, <a class="code" href="obj__mac_8h.html#a0d1831ce53fc851240bdf87d75dcdd7b">NID_issuing_distribution_point</a>))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a773af9c6f9b8b640070518df23a09928">X509_F_X509_CRL_DIFF</a>, <a class="code" href="x509_8h.html#a9432b796fc8d64707b47cbf38da6d786">X509_R_IDP_MISMATCH</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        }</div>
<div class="line">        <span class="comment">/* Newer CRL number must exceed full CRL number */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="a__int_8c.html#aad8c36259e70b4071b2d90ee9e85ebf4">ASN1_INTEGER_cmp</a>(newer-&gt;<a class="code" href="structX509__crl__st.html#a38d84a6c190dc370d74e145cd4faa8d4">crl_number</a>, base-&gt;<a class="code" href="structX509__crl__st.html#a38d84a6c190dc370d74e145cd4faa8d4">crl_number</a>) &lt;= 0)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a773af9c6f9b8b640070518df23a09928">X509_F_X509_CRL_DIFF</a>, <a class="code" href="x509_8h.html#af14c4e7bd3ceaea9c0fdddee1698a554">X509_R_NEWER_CRL_NOT_NEWER</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        }</div>
<div class="line">        <span class="comment">/* CRLs must verify */</span></div>
<div class="line">        <span class="keywordflow">if</span> (skey &amp;&amp; (<a class="code" href="x509_8h.html#aa937e0ce7c1aa3d4a947af552b86a5b2">X509_CRL_verify</a>(base, skey) &lt;= 0 ||</div>
<div class="line">                        <a class="code" href="x509_8h.html#aa937e0ce7c1aa3d4a947af552b86a5b2">X509_CRL_verify</a>(newer, skey) &lt;= 0))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a773af9c6f9b8b640070518df23a09928">X509_F_X509_CRL_DIFF</a>, <a class="code" href="x509_8h.html#a4aa7d911a86528bb890412ff76a48983">X509_R_CRL_VERIFY_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="comment">/* Create new CRL */</span></div>
<div class="line">        crl = X509_CRL_new();</div>
<div class="line">        <span class="keywordflow">if</span> (!crl || !<a class="code" href="x509_8h.html#a0efab3a290f1148c2b80539188c6c39d">X509_CRL_set_version</a>(crl, 1))</div>
<div class="line">                <span class="keywordflow">goto</span> memerr;</div>
<div class="line">        <span class="comment">/* Set issuer name */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="x509_8h.html#a60ad195c7f93396d4f93bcb748b02d4b">X509_CRL_set_issuer_name</a>(crl, <a class="code" href="x509_8h.html#a8e380db8b19c7276383d88d9bae3d0ff">X509_CRL_get_issuer</a>(newer)))</div>
<div class="line">                <span class="keywordflow">goto</span> memerr;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="x509_8h.html#a19edc40e2f01546b1828cf0a511a8437">X509_CRL_set_lastUpdate</a>(crl, <a class="code" href="x509_8h.html#a711ae1c9efb02df2280b207bb4086a18">X509_CRL_get_lastUpdate</a>(newer)))</div>
<div class="line">                <span class="keywordflow">goto</span> memerr;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="x509_8h.html#a9f2b01ccb97c8a47369dd6cd5376b001">X509_CRL_set_nextUpdate</a>(crl, <a class="code" href="x509_8h.html#a63614432adc5566254dcefed2181b347">X509_CRL_get_nextUpdate</a>(newer)))</div>
<div class="line">                <span class="keywordflow">goto</span> memerr;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Set base CRL number: must be critical */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="x509_8h.html#a675c1b38adf633fd20fa56c2828e41d9">X509_CRL_add1_ext_i2d</a>(crl, <a class="code" href="obj__mac_8h.html#a2977b6069e84522c54d7aff18d8a327b">NID_delta_crl</a>, base-&gt;<a class="code" href="structX509__crl__st.html#a38d84a6c190dc370d74e145cd4faa8d4">crl_number</a>, 1, 0))</div>
<div class="line">                <span class="keywordflow">goto</span> memerr;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Copy extensions across from newest CRL to delta: this will set</span></div>
<div class="line"><span class="comment">         * CRL number to correct value too.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="x509_8h.html#a92cfb734c75d65523362b65689180607">X509_CRL_get_ext_count</a>(newer); i++)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>;</div>
<div class="line">                ext = <a class="code" href="x509_8h.html#ab75785d36e0c68330f4578c0ca793f0c">X509_CRL_get_ext</a>(newer, i);</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="x509_8h.html#a5555281cc7fb4a60c0d4d4b0474cfd8c">X509_CRL_add_ext</a>(crl, ext, -1))</div>
<div class="line">                        <span class="keywordflow">goto</span> memerr;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Go through revoked entries, copying as needed */</span></div>
<div class="line"></div>
<div class="line">        revs = <a class="code" href="x509_8h.html#abcd9eeee355489ad8e50a8a28c6b958a">X509_CRL_get_REVOKED</a>(newer);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="safestack_8h.html#a3f2c0f3e35572f04534b62b16f06895f">sk_X509_REVOKED_num</a>(revs); i++)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structx509__revoked__st.html">X509_REVOKED</a> *rvn, *rvtmp;</div>
<div class="line">                rvn = <a class="code" href="safestack_8h.html#ad021af426dac9216b3caaa969d5d77da">sk_X509_REVOKED_value</a>(revs, i);</div>
<div class="line">                <span class="comment">/* Add only if not also in base.</span></div>
<div class="line"><span class="comment">                 * TODO: need something cleverer here for some more complex</span></div>
<div class="line"><span class="comment">                 * CRLs covering multiple CAs.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="x509_8h.html#aa78070b3deadd98e12fd29280237c7c4">X509_CRL_get0_by_serial</a>(base, &amp;rvtmp, rvn-&gt;<a class="code" href="structx509__revoked__st.html#a3b638a3caba10ce8daf6992fdd13658c">serialNumber</a>))</div>
<div class="line">                        {</div>
<div class="line">                        rvtmp = <a class="code" href="x509_8h.html#a2600d6ebb8ec4e63c7e6640f644e1d4e">X509_REVOKED_dup</a>(rvn);</div>
<div class="line">                        <span class="keywordflow">if</span> (!rvtmp)</div>
<div class="line">                                <span class="keywordflow">goto</span> memerr;</div>
<div class="line">                        <span class="keywordflow">if</span> (!<a class="code" href="x509_8h.html#a972e185d623fbc459691dbbb261e29a3">X509_CRL_add0_revoked</a>(crl, rvtmp))</div>
<div class="line">                                {</div>
<div class="line">                                X509_REVOKED_free(rvtmp);</div>
<div class="line">                                <span class="keywordflow">goto</span> memerr;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="comment">/* TODO: optionally prune deleted entries */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (skey &amp;&amp; md &amp;&amp; !<a class="code" href="x509_8h.html#a4e2e1a1bedd42d29eccabeb4afa3a295">X509_CRL_sign</a>(crl, skey, md))</div>
<div class="line">                <span class="keywordflow">goto</span> memerr;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">return</span> crl;</div>
<div class="line"></div>
<div class="line">        memerr:</div>
<div class="line">        <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a773af9c6f9b8b640070518df23a09928">X509_F_X509_CRL_DIFF</a>, <a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (crl)</div>
<div class="line">                X509_CRL_free(crl);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5b28966efdd28549644c52bde151dd72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_get_pubkey_parameters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a2fca4fef9e4c7a2a739b1ea04acb56ce">EVP_PKEY</a> *&#160;</td>
          <td class="paramname"><em>pkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*&#160;</td>
          <td class="paramname"><em>chain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l01952">1952</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structevp__pkey__st.html">EVP_PKEY</a> *ktmp=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>,*ktmp2;</div>
<div class="line">        <span class="keywordtype">int</span> i,j;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((pkey != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) &amp;&amp; !<a class="code" href="evp_8h.html#a9cf6d1306481a12d5700eb013b4fb24b">EVP_PKEY_missing_parameters</a>(pkey)) <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="safestack_8h.html#af8495d81a6dda58254c7e12528af0118">sk_X509_num</a>(chain); i++)</div>
<div class="line">                {</div>
<div class="line">                ktmp=<a class="code" href="x509_8h.html#a97c3703b14a1f4a987c5d31cdf6cb205">X509_get_pubkey</a>(<a class="code" href="safestack_8h.html#a6ce8e2d1c31859b9b27cd535caba4388">sk_X509_value</a>(chain,i));</div>
<div class="line">                <span class="keywordflow">if</span> (ktmp == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a5cf4eb01abf90ba2ad51f0d8529f7365">X509_F_X509_GET_PUBKEY_PARAMETERS</a>,<a class="code" href="x509_8h.html#affb256d6a7f9d3b99e472a4de0b8259d">X509_R_UNABLE_TO_GET_CERTS_PUBLIC_KEY</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="evp_8h.html#a9cf6d1306481a12d5700eb013b4fb24b">EVP_PKEY_missing_parameters</a>(ktmp))</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="evp_8h.html#a448d9f9209a54694aff045d403850db7">EVP_PKEY_free</a>(ktmp);</div>
<div class="line">                        ktmp=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (ktmp == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a5cf4eb01abf90ba2ad51f0d8529f7365">X509_F_X509_GET_PUBKEY_PARAMETERS</a>,<a class="code" href="x509_8h.html#a89517c4c81f12169ae9776263306b4eb">X509_R_UNABLE_TO_FIND_PARAMETERS_IN_CHAIN</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* first, populate the other certs */</span></div>
<div class="line">        <span class="keywordflow">for</span> (j=i-1; j &gt;= 0; j--)</div>
<div class="line">                {</div>
<div class="line">                ktmp2=<a class="code" href="x509_8h.html#a97c3703b14a1f4a987c5d31cdf6cb205">X509_get_pubkey</a>(<a class="code" href="safestack_8h.html#a6ce8e2d1c31859b9b27cd535caba4388">sk_X509_value</a>(chain,j));</div>
<div class="line">                <a class="code" href="evp_8h.html#a53bf536fee771202d5eb63ab39cd742b">EVP_PKEY_copy_parameters</a>(ktmp2,ktmp);</div>
<div class="line">                <a class="code" href="evp_8h.html#a448d9f9209a54694aff045d403850db7">EVP_PKEY_free</a>(ktmp2);</div>
<div class="line">                }</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (pkey != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <a class="code" href="evp_8h.html#a53bf536fee771202d5eb63ab39cd742b">EVP_PKEY_copy_parameters</a>(pkey,ktmp);</div>
<div class="line">        <a class="code" href="evp_8h.html#a448d9f9209a54694aff045d403850db7">EVP_PKEY_free</a>(ktmp);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2af41732f9bd8d8b11ae2b94390d415a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a>* X509_gmtime_adj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>adj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l01923">1923</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#af608891c1a59567348c55fdaa3e62413">X509_time_adj</a>(s, adj, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8ff79593c52dcc4c9e63bfb7146bb9e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509_STORE_CTX_cleanup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02418">2418</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a62e5d53c14d406b208d6cd08a0371dbe">cleanup</a>) ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a62e5d53c14d406b208d6cd08a0371dbe">cleanup</a>(ctx);</div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a> != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a647b1547f675fde39774de2672fdbf69">parent</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        <a class="code" href="x509__vfy_8h.html#a9db1cdc6737057af5acabef0707d582e">X509_VERIFY_PARAM_free</a>(ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>);</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a4738c07151861b6f8836cdac1ab66464">tree</a> != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="x509__vfy_8h.html#a194403b0c132b580ef8bc4400defb3d5">X509_policy_tree_free</a>(ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a4738c07151861b6f8836cdac1ab66464">tree</a>);</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a4738c07151861b6f8836cdac1ab66464">tree</a>=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;chain != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="safestack_8h.html#a9f351ddac9a3f1d94fcdfacfc9083312">sk_X509_pop_free</a>(ctx-&gt;chain,X509_free);</div>
<div class="line">                ctx-&gt;chain=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        <a class="code" href="crypto_8h.html#a0ab5fa7e84dfdcb691f88aac8ddefd22">CRYPTO_free_ex_data</a>(<a class="code" href="crypto_8h.html#a30b655e9459543bdb06b750cdd992001">CRYPTO_EX_INDEX_X509_STORE_CTX</a>, ctx, &amp;(ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a30a9b2bc4ea6479c2ce84b1a169cedd4">ex_data</a>));</div>
<div class="line">        memset(&amp;ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a30a9b2bc4ea6479c2ce84b1a169cedd4">ex_data</a>,0,<span class="keyword">sizeof</span>(<a class="code" href="structcrypto__ex__data__st.html">CRYPTO_EX_DATA</a>));</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7fad77ce519c90dc4c9dca799abc80e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509_STORE_CTX_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02275">2275</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <a class="code" href="x509__vfy_8c.html#a8ff79593c52dcc4c9e63bfb7146bb9e3">X509_STORE_CTX_cleanup</a>(ctx);</div>
<div class="line">        <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(ctx);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3d1a917e94eb74c93b3a8cafc1f213fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a>* X509_STORE_CTX_get0_current_crl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02169">2169</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aeb5494eb4dec08c7ec0fbe9a79a23eff">current_crl</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1492b264b9d95d5d0d710ac27876bfce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>* X509_STORE_CTX_get0_current_issuer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02164">2164</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#afbf0d2ac86354f35fb002a6326fca722">current_issuer</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4bed2c92073c83931e3de7aecf34552f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="x509__vfy_8h.html#a9b8209a7a29bafa279e1b5bc5f81cb23">X509_VERIFY_PARAM</a>* X509_STORE_CTX_get0_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02481">2481</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7d19744a61f81bdc6bec2a9fd2827315"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a>* X509_STORE_CTX_get0_parent_ctx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02174">2174</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a647b1547f675fde39774de2672fdbf69">parent</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae58f41757bea8a08222f5b646d35c018"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a3be68a7c4cbbe4954ccd27ff7215cf0d">X509_POLICY_TREE</a>* X509_STORE_CTX_get0_policy_tree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02462">2462</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a4738c07151861b6f8836cdac1ab66464">tree</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad0268e76142177fe51d3c5145ba68b54"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>* X509_STORE_CTX_get_current_cert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02147">2147</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#adbbabe6efb4ed9745801ba73ac6e4f25">current_cert</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0168c670323c9c346dc935ef7c0277df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_STORE_CTX_get_error </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02132">2132</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a02b3dadbb929845bcaeca254930386d1">error</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2fb8eb6094215f110482e2a72788b0e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_STORE_CTX_get_error_depth </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02142">2142</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a525adb8cc9af67d0094fccbd6eca4f4f">error_depth</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aac073808d8376a41e3b8a64c0f12ff55"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* X509_STORE_CTX_get_ex_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02127">2127</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="crypto_8h.html#aff745d0f3e0974080b714f853d0edb11">CRYPTO_get_ex_data</a>(&amp;ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a30a9b2bc4ea6479c2ce84b1a169cedd4">ex_data</a>,idx);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aff6ff1506e3f2fa55100f1e21ef2f369"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_STORE_CTX_get_ex_new_index </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>argl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>argp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a524acd717ae812f604e3027f8255d0ba">CRYPTO_EX_new</a> *&#160;</td>
          <td class="paramname"><em>new_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a1235777e2310295c33f29a5f06e40682">CRYPTO_EX_dup</a> *&#160;</td>
          <td class="paramname"><em>dup_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a723f84d260fce598230a3cdd45885246">CRYPTO_EX_free</a> *&#160;</td>
          <td class="paramname"><em>free_func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02113">2113</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="comment">/* This function is (usually) called only once, by</span></div>
<div class="line"><span class="comment">         * SSL_get_ex_data_X509_STORE_CTX_idx (ssl/ssl_cert.c). */</span></div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="crypto_8h.html#a0e9be769c8df778a93b2650b4c09f9e9">CRYPTO_get_ex_new_index</a>(<a class="code" href="crypto_8h.html#a30b655e9459543bdb06b750cdd992001">CRYPTO_EX_INDEX_X509_STORE_CTX</a>, argl, argp,</div>
<div class="line">                        new_func, dup_func, <a class="code" href="asn1_8h.html#a942bd852ec8360a1803ceda0b1029986">free_func</a>);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4b246972a4ec5b8e8d9705c860f2e5c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_STORE_CTX_get_explicit_policy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02467">2467</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a428d424dc177abfdaa06d44a8951e495">explicit_policy</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a513e70fc82c927254c38d0ac102bafd9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_STORE_CTX_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a3a2b800bae08729d11bc28f12b795597">X509_STORE</a> *&#160;</td>
          <td class="paramname"><em>store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>x509</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*&#160;</td>
          <td class="paramname"><em>chain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02281">2281</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordtype">int</span> ret = 1;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#ac633a0b046f10408d0becf0f1732ede5">ctx</a>=store;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a1bbea1b86bcb3d3f1a7d0bb05e67e860">current_method</a>=0;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aaf9dd5eda06f69f1a8b9f7606ee5c9b1">cert</a>=x509;</div>
<div class="line">        ctx-&gt;untrusted=chain;</div>
<div class="line">        ctx-&gt;crls = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#ab269810ffeac1c116f7fabe0ba50690f">last_untrusted</a>=0;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#ab5ca1f66ed3e28f30ec7dc4df63ae78d">other_ctx</a>=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#ab8b4e8f74c47a32e46099ff8c4b66b7f">valid</a>=0;</div>
<div class="line">        ctx-&gt;chain=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a02b3dadbb929845bcaeca254930386d1">error</a>=0;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a428d424dc177abfdaa06d44a8951e495">explicit_policy</a>=0;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a525adb8cc9af67d0094fccbd6eca4f4f">error_depth</a>=0;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#adbbabe6efb4ed9745801ba73ac6e4f25">current_cert</a>=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#afbf0d2ac86354f35fb002a6326fca722">current_issuer</a>=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aeb5494eb4dec08c7ec0fbe9a79a23eff">current_crl</a>=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a1cd61fb468f397eb179143f18664cfe3">current_crl_score</a>=0;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#ae2ab9b215c63995eaef346e6a1fde845">current_reasons</a>=0;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a4738c07151861b6f8836cdac1ab66464">tree</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a647b1547f675fde39774de2672fdbf69">parent</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a> = <a class="code" href="x509__vfy_8h.html#a07846d1b04026bada8a62acef180c374">X509_VERIFY_PARAM_new</a>();</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a26e5843438c4485c1d97c1caa8f623dd">X509_F_X509_STORE_CTX_INIT</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Inherit callbacks and flags from X509_STORE if not set</span></div>
<div class="line"><span class="comment">         * use defaults.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (store)</div>
<div class="line">                ret = <a class="code" href="x509__vfy_8h.html#a48c1cb313b1da4837d7e6babc9cb6983">X509_VERIFY_PARAM_inherit</a>(ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>, store-&gt;<a class="code" href="structx509__store__st.html#a988c764019923790356d956bc071c50b">param</a>);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>-&gt;<a class="code" href="structX509__VERIFY__PARAM__st.html#ae194a37f094a45b53ddd8156c5e2bab1">inh_flags</a> |= <a class="code" href="x509__vfy_8h.html#aa5e0cedf8e953fa367ebb5ce2e5d2b10">X509_VP_FLAG_DEFAULT</a>|<a class="code" href="x509__vfy_8h.html#a8fad6a8ff910597f2a0357207b156fc4">X509_VP_FLAG_ONCE</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (store)</div>
<div class="line">                {</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a250f3e51c890543f26887260181272ae">verify_cb</a> = store-&gt;<a class="code" href="structx509__store__st.html#a8ad1fc482243953bd329acf0153d63bb">verify_cb</a>;</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a62e5d53c14d406b208d6cd08a0371dbe">cleanup</a> = store-&gt;<a class="code" href="structx509__store__st.html#a74b04b51ab491c978d4709a614db9801">cleanup</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a62e5d53c14d406b208d6cd08a0371dbe">cleanup</a> = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ret)</div>
<div class="line">                ret = <a class="code" href="x509__vfy_8h.html#a48c1cb313b1da4837d7e6babc9cb6983">X509_VERIFY_PARAM_inherit</a>(ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>,</div>
<div class="line">                                        <a class="code" href="x509__vfy_8h.html#af02d5eb77529f5068821062c7c1509ac">X509_VERIFY_PARAM_lookup</a>(<span class="stringliteral">&quot;default&quot;</span>));</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (ret == 0)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a26e5843438c4485c1d97c1caa8f623dd">X509_F_X509_STORE_CTX_INIT</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (store &amp;&amp; store-&gt;<a class="code" href="structx509__store__st.html#a6a145b79b7c6a7c9f3af16ec51cb4f61">check_issued</a>)</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a86b65e1c8478435d76e06a68debaf4d6">check_issued</a> = store-&gt;<a class="code" href="structx509__store__st.html#a6a145b79b7c6a7c9f3af16ec51cb4f61">check_issued</a>;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a86b65e1c8478435d76e06a68debaf4d6">check_issued</a> = check_issued;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (store &amp;&amp; store-&gt;<a class="code" href="structx509__store__st.html#a626e2b6369b3f2dc40fc4afc06dcfd82">get_issuer</a>)</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a71cb957e2f4e4e74b8bdd0a6961a2a93">get_issuer</a> = store-&gt;<a class="code" href="structx509__store__st.html#a626e2b6369b3f2dc40fc4afc06dcfd82">get_issuer</a>;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a71cb957e2f4e4e74b8bdd0a6961a2a93">get_issuer</a> = <a class="code" href="x509__lu_8c.html#ab9ac872bb8e0d4d55f9d56e5ce7dd6a0">X509_STORE_CTX_get1_issuer</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (store &amp;&amp; store-&gt;<a class="code" href="structx509__store__st.html#a8ad1fc482243953bd329acf0153d63bb">verify_cb</a>)</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a250f3e51c890543f26887260181272ae">verify_cb</a> = store-&gt;<a class="code" href="structx509__store__st.html#a8ad1fc482243953bd329acf0153d63bb">verify_cb</a>;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a250f3e51c890543f26887260181272ae">verify_cb</a> = null_callback;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (store &amp;&amp; store-&gt;<a class="code" href="structx509__store__st.html#a90232967e9f3d7a9aee3e9001fe9d5b8">verify</a>)</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a10a448cf0ca7c18d42e7c22e66f73df1">verify</a> = store-&gt;<a class="code" href="structx509__store__st.html#a90232967e9f3d7a9aee3e9001fe9d5b8">verify</a>;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a10a448cf0ca7c18d42e7c22e66f73df1">verify</a> = internal_verify;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (store &amp;&amp; store-&gt;<a class="code" href="structx509__store__st.html#a4ed65eafab27b50a046c0ae32a281426">check_revocation</a>)</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aa8fa9085118f8ac84f78bdaf1134cd14">check_revocation</a> = store-&gt;<a class="code" href="structx509__store__st.html#a4ed65eafab27b50a046c0ae32a281426">check_revocation</a>;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aa8fa9085118f8ac84f78bdaf1134cd14">check_revocation</a> = check_revocation;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (store &amp;&amp; store-&gt;<a class="code" href="structx509__store__st.html#a7351da81e7cc1edc96127da0cbbe188a">get_crl</a>)</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a66160a76754ccc62d03ddd382839562d">get_crl</a> = store-&gt;<a class="code" href="structx509__store__st.html#a7351da81e7cc1edc96127da0cbbe188a">get_crl</a>;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a66160a76754ccc62d03ddd382839562d">get_crl</a> = <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (store &amp;&amp; store-&gt;<a class="code" href="structx509__store__st.html#a126a636b9ad522ae921d672359e7e9ca">check_crl</a>)</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a2fecaf1b16ea3cf5fafdd3a3a675c81d">check_crl</a> = store-&gt;<a class="code" href="structx509__store__st.html#a126a636b9ad522ae921d672359e7e9ca">check_crl</a>;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a2fecaf1b16ea3cf5fafdd3a3a675c81d">check_crl</a> = check_crl;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (store &amp;&amp; store-&gt;<a class="code" href="structx509__store__st.html#ac8a84f34afdf4f716ff718096c29e11a">cert_crl</a>)</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a05a19c5f1e4a045d9fb6e4681395bf82">cert_crl</a> = store-&gt;<a class="code" href="structx509__store__st.html#ac8a84f34afdf4f716ff718096c29e11a">cert_crl</a>;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a05a19c5f1e4a045d9fb6e4681395bf82">cert_crl</a> = cert_crl;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (store &amp;&amp; store-&gt;lookup_certs)</div>
<div class="line">                ctx-&gt;lookup_certs = store-&gt;lookup_certs;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;lookup_certs = X509_STORE_get1_certs;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (store &amp;&amp; store-&gt;lookup_crls)</div>
<div class="line">                ctx-&gt;lookup_crls = store-&gt;lookup_crls;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ctx-&gt;lookup_crls = X509_STORE_get1_crls;</div>
<div class="line"></div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a123ebe8de204a406f18b02b8f35411dc">check_policy</a> = check_policy;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* This memset() can&#39;t make any sense anyway, so it&#39;s removed. As</span></div>
<div class="line"><span class="comment">         * X509_STORE_CTX_cleanup does a proper &quot;free&quot; on the ex_data, we put a</span></div>
<div class="line"><span class="comment">         * corresponding &quot;new&quot; here and remove this bogus initialisation. */</span></div>
<div class="line">        <span class="comment">/* memset(&amp;(ctx-&gt;ex_data),0,sizeof(CRYPTO_EX_DATA)); */</span></div>
<div class="line">        <span class="keywordflow">if</span>(!<a class="code" href="crypto_8h.html#a2be01d9b6b916d48a8a1be08af6bad3c">CRYPTO_new_ex_data</a>(<a class="code" href="crypto_8h.html#a30b655e9459543bdb06b750cdd992001">CRYPTO_EX_INDEX_X509_STORE_CTX</a>, ctx,</div>
<div class="line">                                &amp;(ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a30a9b2bc4ea6479c2ce84b1a169cedd4">ex_data</a>)))</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="crypto_8h.html#aeb21bb7e51c4f5af3bdce7226e52ca5a">OPENSSL_free</a>(ctx);</div>
<div class="line">                <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a26e5843438c4485c1d97c1caa8f623dd">X509_F_X509_STORE_CTX_INIT</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac6c7030db2040b3dbd4be051e81592dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a>* X509_STORE_CTX_new </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02262">2262</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx;</div>
<div class="line">        ctx = (<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *)<a class="code" href="crypto_8h.html#afdb80d14aed3b15d0ef71f72a872310d">OPENSSL_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a>));</div>
<div class="line">        <span class="keywordflow">if</span> (!ctx)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a4a18775f858c2b1498b0310a74ed818c">X509_F_X509_STORE_CTX_NEW</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                }</div>
<div class="line">        memset(ctx, 0, <span class="keyword">sizeof</span>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a>));</div>
<div class="line">        <span class="keywordflow">return</span> ctx;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeae05e156ff5e328afc1923b4bf8a71d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_STORE_CTX_purpose_inherit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>def_purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trust</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02214">2214</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> idx;</div>
<div class="line">        <span class="comment">/* If purpose not set use default */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!purpose) purpose = def_purpose;</div>
<div class="line">        <span class="comment">/* If we have a purpose then check it is valid */</span></div>
<div class="line">        <span class="keywordflow">if</span> (purpose)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="structx509__purpose__st.html">X509_PURPOSE</a> *ptmp;</div>
<div class="line">                idx = <a class="code" href="v3__purp_8c.html#ac17b78d33baed177d7d1397a9d44d8a0">X509_PURPOSE_get_by_id</a>(purpose);</div>
<div class="line">                <span class="keywordflow">if</span> (idx == -1)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a0bfd1136ece0beabe27286e7eb3e0455">X509_F_X509_STORE_CTX_PURPOSE_INHERIT</a>,</div>
<div class="line">                                                <a class="code" href="x509_8h.html#a774a6a59965803d652d7679946ee23bf">X509_R_UNKNOWN_PURPOSE_ID</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                ptmp = <a class="code" href="v3__purp_8c.html#ac8cca20fd5afb37227f5f263d717bbae">X509_PURPOSE_get0</a>(idx);</div>
<div class="line">                <span class="keywordflow">if</span> (ptmp-&gt;<a class="code" href="structx509__purpose__st.html#a2033355e7111f867d6727e2da3e92716">trust</a> == <a class="code" href="x509_8h.html#ae40ca6229ccb8d7e1ef32892f65365fc">X509_TRUST_DEFAULT</a>)</div>
<div class="line">                        {</div>
<div class="line">                        idx = <a class="code" href="v3__purp_8c.html#ac17b78d33baed177d7d1397a9d44d8a0">X509_PURPOSE_get_by_id</a>(def_purpose);</div>
<div class="line">                        <span class="keywordflow">if</span> (idx == -1)</div>
<div class="line">                                {</div>
<div class="line">                                <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a0bfd1136ece0beabe27286e7eb3e0455">X509_F_X509_STORE_CTX_PURPOSE_INHERIT</a>,</div>
<div class="line">                                                <a class="code" href="x509_8h.html#a774a6a59965803d652d7679946ee23bf">X509_R_UNKNOWN_PURPOSE_ID</a>);</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                                }</div>
<div class="line">                        ptmp = <a class="code" href="v3__purp_8c.html#ac8cca20fd5afb37227f5f263d717bbae">X509_PURPOSE_get0</a>(idx);</div>
<div class="line">                        }</div>
<div class="line">                <span class="comment">/* If trust not set then get from purpose default */</span></div>
<div class="line">                <span class="keywordflow">if</span> (!trust) trust = ptmp-&gt;<a class="code" href="structx509__purpose__st.html#a2033355e7111f867d6727e2da3e92716">trust</a>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (trust)</div>
<div class="line">                {</div>
<div class="line">                idx = <a class="code" href="x509_8h.html#a899f94796dcaa03edf563f74c6fa9ff8">X509_TRUST_get_by_id</a>(trust);</div>
<div class="line">                <span class="keywordflow">if</span> (idx == -1)</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a0bfd1136ece0beabe27286e7eb3e0455">X509_F_X509_STORE_CTX_PURPOSE_INHERIT</a>,</div>
<div class="line">                                                <a class="code" href="x509_8h.html#ae985c8dc741a61b60edaaa2607c13e75">X509_R_UNKNOWN_TRUST_ID</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (purpose &amp;&amp; !ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>-&gt;<a class="code" href="structX509__VERIFY__PARAM__st.html#acae8fafa928701889f757951552f5ee9">purpose</a>) ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>-&gt;<a class="code" href="structX509__VERIFY__PARAM__st.html#acae8fafa928701889f757951552f5ee9">purpose</a> = purpose;</div>
<div class="line">        <span class="keywordflow">if</span> (trust &amp;&amp; !ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>-&gt;<a class="code" href="structX509__VERIFY__PARAM__st.html#a7b7d5b079ed79cb2399ad471d1b57415">trust</a>) ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>-&gt;<a class="code" href="structX509__VERIFY__PARAM__st.html#a7b7d5b079ed79cb2399ad471d1b57415">trust</a> = trust;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a208f8d99bd28e1587043127fe846cdc4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509_STORE_CTX_set0_crls </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#ac8661d2485c2c8da5fd7dd26b846f4bf">X509_CRL</a>)*&#160;</td>
          <td class="paramname"><em>sk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02189">2189</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        ctx-&gt;crls=sk;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac44243da0226fb4a56b65b0731863621"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509_STORE_CTX_set0_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509__vfy_8h.html#a9b8209a7a29bafa279e1b5bc5f81cb23">X509_VERIFY_PARAM</a> *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02486">2486</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>)</div>
<div class="line">                <a class="code" href="x509__vfy_8h.html#a9db1cdc6737057af5acabef0707d582e">X509_VERIFY_PARAM_free</a>(ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>);</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a> = param;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8b2875ef04f22b55ecbae42eb1d15ea5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509_STORE_CTX_set_cert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a> *&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02179">2179</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aaf9dd5eda06f69f1a8b9f7606ee5c9b1">cert</a>=<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a48ab5ea069c17ff17fd66dbc15c055f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509_STORE_CTX_set_chain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*&#160;</td>
          <td class="paramname"><em>sk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02184">2184</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        ctx-&gt;untrusted=sk;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abb33e390f015d2ba702a5e6c56388ea3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_STORE_CTX_set_default </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02472">2472</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structX509__VERIFY__PARAM__st.html">X509_VERIFY_PARAM</a> *param;</div>
<div class="line">        param = <a class="code" href="x509__vfy_8h.html#af02d5eb77529f5068821062c7c1509ac">X509_VERIFY_PARAM_lookup</a>(name);</div>
<div class="line">        <span class="keywordflow">if</span> (!param)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509__vfy_8h.html#a48c1cb313b1da4837d7e6babc9cb6983">X509_VERIFY_PARAM_inherit</a>(ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>, param);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7603bd2496fba14cf60258377f1208e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509_STORE_CTX_set_depth </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02441">2441</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="x509__vfy_8h.html#a487be1b6272938c845c8e1df7ead4335">X509_VERIFY_PARAM_set_depth</a>(ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>, depth);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a714efa76b5dcc6e39933fea4829e30d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509_STORE_CTX_set_error </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02137">2137</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a02b3dadbb929845bcaeca254930386d1">error</a>=err;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae3efef781c0987fba3c0609921060d06"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_STORE_CTX_set_ex_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02122">2122</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="crypto_8h.html#ac4a7d82b83b588b4f8c8e90c0179c600">CRYPTO_set_ex_data</a>(&amp;ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a30a9b2bc4ea6479c2ce84b1a169cedd4">ex_data</a>,idx,<a class="code" href="e__bf_8c.html#aac2cc005a2915c6b6212402aeee7e635">data</a>);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a409bf12f2576229eda9191349742bdfd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509_STORE_CTX_set_flags </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02446">2446</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="x509__vfy_8h.html#a73c04c27978f12c5271521da01bf8c3e">X509_VERIFY_PARAM_set_flags</a>(ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>, <a class="code" href="pkcs7_8h.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2b4939baca9b28b912b54841865b492b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_STORE_CTX_set_purpose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>purpose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02194">2194</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509__vfy_8c.html#aeae05e156ff5e328afc1923b4bf8a71d">X509_STORE_CTX_purpose_inherit</a>(ctx, 0, purpose, 0);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab76bb6c20423d3315aeaf7c7a4138370"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509_STORE_CTX_set_time </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02451">2451</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="x509__vfy_8h.html#aba2f67c23006855793bed30104426ce7">X509_VERIFY_PARAM_set_time</a>(ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>, <a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac6351c206cbc0c90d573e98d363d4627"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_STORE_CTX_set_trust </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trust</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02199">2199</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509__vfy_8c.html#aeae05e156ff5e328afc1923b4bf8a71d">X509_STORE_CTX_purpose_inherit</a>(ctx, 0, 0, trust);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afaf77ded1467bc020aa71f06aeb05cd0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509_STORE_CTX_set_verify_cb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(int, <a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *)&#160;</td>
          <td class="paramname"><em>verify_cb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02456">2456</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a250f3e51c890543f26887260181272ae">verify_cb</a>=verify_cb;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0669313fd5e0304dff1903d2dbe75f61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void X509_STORE_CTX_trusted_stack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="x509v3_8h.html#a9c9204f1c9200b4c0ac4cfb65ddf0397">STACK_OF</a>(<a class="el" href="ossl__typ_8h.html#a4f666bde6518f95deb3050c54b408416">X509</a>)*&#160;</td>
          <td class="paramname"><em>sk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l02412">2412</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#ab5ca1f66ed3e28f30ec7dc4df63ae78d">other_ctx</a> = sk;</div>
<div class="line">        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a71cb957e2f4e4e74b8bdd0a6961a2a93">get_issuer</a> = get_issuer_sk;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a41d9f2b1cc04295be7f113d40656e4d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a>* X509_time_adj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>offset_sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t *&#160;</td>
          <td class="paramname"><em>in_tm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l01928">1928</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="x509_8h.html#a71d24dcf2d75b17f75c03b2392e87293">X509_time_adj_ex</a>(s, 0, offset_sec, in_tm);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5974314aa632516c7f9d65b4b4bec334"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a>* X509_time_adj_ex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ad8d7393bc444b691d2b2c20d247b4e27">ASN1_TIME</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>offset_day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>offset_sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t *&#160;</td>
          <td class="paramname"><em>in_tm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l01933">1933</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        time_t <a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (in_tm) t = *in_tm;</div>
<div class="line">        <span class="keywordflow">else</span> time(&amp;t);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (s &amp;&amp; !(s-&gt;<a class="code" href="structasn1__string__st.html#a166fa78d828cb41bb2499ad411c1774c">flags</a> &amp; <a class="code" href="asn1_8h.html#a6b9a0874e56b75bf9db6bc9870a1419a">ASN1_STRING_FLAG_MSTRING</a>))</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a> == <a class="code" href="asn1_8h.html#a2a8dd01504f7ee166a07e05cb0707634">V_ASN1_UTCTIME</a>)</div>
<div class="line">                        <span class="keywordflow">return</span> <a class="code" href="a__utctm_8c.html#a30e49ea58c976b94926f8186ccdfb1b5">ASN1_UTCTIME_adj</a>(s,t, offset_day, offset_sec);</div>
<div class="line">                <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structasn1__string__st.html#a4bc5c5a5d5cd42ec6108e8bef50e09ad">type</a> == <a class="code" href="asn1_8h.html#a7ec32dd2efb9a8765ccd91b2ab0721a3">V_ASN1_GENERALIZEDTIME</a>)</div>
<div class="line">                        <span class="keywordflow">return</span> <a class="code" href="a__gentm_8c.html#a83d4235e51dd9864abb26e058cee20a9">ASN1_GENERALIZEDTIME_adj</a>(s, t, offset_day,</div>
<div class="line">                                                                offset_sec);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="a__time_8c.html#a094fdf1e359fd79f63ddc80259d95185">ASN1_TIME_adj</a>(s, t, offset_day, offset_sec);</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a00794722daae3cb1e10ec00eda7c2c62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X509_verify_cert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ossl__typ_8h.html#ae681945a2cf88d6337137dc0260a1545">X509_STORE_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l00190">190</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>
<div class="fragment"><div class="line">        {</div>
<div class="line">        <a class="code" href="structx509__st.html">X509</a> *<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>,*xtmp,*chain_ss=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordtype">int</span> bad_chain = 0;</div>
<div class="line">        <a class="code" href="structX509__VERIFY__PARAM__st.html">X509_VERIFY_PARAM</a> *param = ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>;</div>
<div class="line">        <span class="keywordtype">int</span> depth,i,ok=0;</div>
<div class="line">        <span class="keywordtype">int</span> num;</div>
<div class="line">        int (*<a class="code" href="pem_8h.html#a8dfe7b67aa87c6713a0e86b1456c1695">cb</a>)(<span class="keywordtype">int</span> xok,<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *xctx);</div>
<div class="line">        <a class="code" href="safestack_8h.html#ac5f89a88ae9f79f8c27a2bf748e5fbb2">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *sktmp=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aaf9dd5eda06f69f1a8b9f7606ee5c9b1">cert</a> == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a0993d7ad5f0ca3dfd175c1c1a223328a">X509_F_X509_VERIFY_CERT</a>,<a class="code" href="x509_8h.html#a1a55a729d1e870ab6bfefc6c1899d561">X509_R_NO_CERT_SET_FOR_US_TO_VERIFY</a>);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="pem_8h.html#a8dfe7b67aa87c6713a0e86b1456c1695">cb</a>=ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a250f3e51c890543f26887260181272ae">verify_cb</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* first we make sure the chain we are going to build is</span></div>
<div class="line"><span class="comment">         * present and that the first entry is in place */</span></div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;chain == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> (    ((ctx-&gt;chain=<a class="code" href="safestack_8h.html#a44ae44bd51bbf3d40058762ac4f0d377">sk_X509_new_null</a>()) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) ||</div>
<div class="line">                        (!<a class="code" href="safestack_8h.html#a725eaf517607b2a1c8be5c25c8771003">sk_X509_push</a>(ctx-&gt;chain,ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aaf9dd5eda06f69f1a8b9f7606ee5c9b1">cert</a>)))</div>
<div class="line">                        {</div>
<div class="line">                        <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a0993d7ad5f0ca3dfd175c1c1a223328a">X509_F_X509_VERIFY_CERT</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">goto</span> end;</div>
<div class="line">                        }</div>
<div class="line">                <a class="code" href="crypto_8h.html#ab8556c4f12443f1876ce487dd0c8db27">CRYPTO_add</a>(&amp;ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aaf9dd5eda06f69f1a8b9f7606ee5c9b1">cert</a>-&gt;<a class="code" href="structx509__st.html#ab1114b325664bca1cdfd6854f247a4d5">references</a>,1,<a class="code" href="crypto_8h.html#abcd6591ef6acea51bf9f6edb6bb05bca">CRYPTO_LOCK_X509</a>);</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#ab269810ffeac1c116f7fabe0ba50690f">last_untrusted</a>=1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* We use a temporary STACK so we can chop and hack at it */</span></div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;untrusted != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a></div>
<div class="line">            &amp;&amp; (sktmp=<a class="code" href="safestack_8h.html#a35dc215a04e36b26ce10fba3b4793293">sk_X509_dup</a>(ctx-&gt;untrusted)) == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                {</div>
<div class="line">                <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a0993d7ad5f0ca3dfd175c1c1a223328a">X509_F_X509_VERIFY_CERT</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                <span class="keywordflow">goto</span> end;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        num=<a class="code" href="safestack_8h.html#af8495d81a6dda58254c7e12528af0118">sk_X509_num</a>(ctx-&gt;chain);</div>
<div class="line">        x=<a class="code" href="safestack_8h.html#a6ce8e2d1c31859b9b27cd535caba4388">sk_X509_value</a>(ctx-&gt;chain,num-1);</div>
<div class="line">        depth=param-&gt;<a class="code" href="structX509__VERIFY__PARAM__st.html#afb5fd48dac56bdbd2e1d9e8e69bfaf23">depth</a>;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (;;)</div>
<div class="line">                {</div>
<div class="line">                <span class="comment">/* If we have enough, we break */</span></div>
<div class="line">                <span class="keywordflow">if</span> (depth &lt; num) <span class="keywordflow">break</span>; <span class="comment">/* FIXME: If this happens, we should take</span></div>
<div class="line"><span class="comment">                                         * note of it and, if appropriate, use the</span></div>
<div class="line"><span class="comment">                                         * X509_V_ERR_CERT_CHAIN_TOO_LONG error</span></div>
<div class="line"><span class="comment">                                         * code later.</span></div>
<div class="line"><span class="comment">                                         */</span></div>
<div class="line"></div>
<div class="line">                <span class="comment">/* If we are self signed, we break */</span></div>
<div class="line">                <span class="keywordflow">if</span> (cert_self_signed(x))</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="comment">/* If asked see if we can find issuer in trusted store first */</span></div>
<div class="line">                <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>-&gt;<a class="code" href="structX509__VERIFY__PARAM__st.html#a3ef03c3f57b0a90d4182a057fe0c8d27">flags</a> &amp; <a class="code" href="x509__vfy_8h.html#acbb286f7b4f192c3a23385180f169f3c">X509_V_FLAG_TRUSTED_FIRST</a>)</div>
<div class="line">                        {</div>
<div class="line">                        ok = ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a71cb957e2f4e4e74b8bdd0a6961a2a93">get_issuer</a>(&amp;xtmp, ctx, x);</div>
<div class="line">                        <span class="keywordflow">if</span> (ok &lt; 0)</div>
<div class="line">                                <span class="keywordflow">return</span> ok;</div>
<div class="line">                        <span class="comment">/* If successful for now free up cert so it</span></div>
<div class="line"><span class="comment">                         * will be picked up again later.</span></div>
<div class="line"><span class="comment">                         */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (ok &gt; 0)</div>
<div class="line">                                {</div>
<div class="line">                                X509_free(xtmp);</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* If we were passed a cert chain, use it first */</span></div>
<div class="line">                <span class="keywordflow">if</span> (ctx-&gt;untrusted != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                        {</div>
<div class="line">                        xtmp=find_issuer(ctx, sktmp,x);</div>
<div class="line">                        <span class="keywordflow">if</span> (xtmp != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                                {</div>
<div class="line">                                <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#a725eaf517607b2a1c8be5c25c8771003">sk_X509_push</a>(ctx-&gt;chain,xtmp))</div>
<div class="line">                                        {</div>
<div class="line">                                        <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a0993d7ad5f0ca3dfd175c1c1a223328a">X509_F_X509_VERIFY_CERT</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                                        <span class="keywordflow">goto</span> end;</div>
<div class="line">                                        }</div>
<div class="line">                                <a class="code" href="crypto_8h.html#ab8556c4f12443f1876ce487dd0c8db27">CRYPTO_add</a>(&amp;xtmp-&gt;<a class="code" href="structx509__st.html#ab1114b325664bca1cdfd6854f247a4d5">references</a>,1,<a class="code" href="crypto_8h.html#abcd6591ef6acea51bf9f6edb6bb05bca">CRYPTO_LOCK_X509</a>);</div>
<div class="line">                                (void)<a class="code" href="safestack_8h.html#ae0a132b7a02f8ac8631ec565d0dd40d0">sk_X509_delete_ptr</a>(sktmp,xtmp);</div>
<div class="line">                                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#ab269810ffeac1c116f7fabe0ba50690f">last_untrusted</a>++;</div>
<div class="line">                                x=xtmp;</div>
<div class="line">                                num++;</div>
<div class="line">                                <span class="comment">/* reparse the full chain for</span></div>
<div class="line"><span class="comment">                                 * the next one */</span></div>
<div class="line">                                <span class="keywordflow">continue</span>;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* at this point, chain should contain a list of untrusted</span></div>
<div class="line"><span class="comment">         * certificates.  We now need to add at least one trusted one,</span></div>
<div class="line"><span class="comment">         * if possible, otherwise we complain. */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Examine last certificate in chain and see if it</span></div>
<div class="line"><span class="comment">         * is self signed.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line"></div>
<div class="line">        i=<a class="code" href="safestack_8h.html#af8495d81a6dda58254c7e12528af0118">sk_X509_num</a>(ctx-&gt;chain);</div>
<div class="line">        x=<a class="code" href="safestack_8h.html#a6ce8e2d1c31859b9b27cd535caba4388">sk_X509_value</a>(ctx-&gt;chain,i-1);</div>
<div class="line">        <span class="keywordflow">if</span> (cert_self_signed(x))</div>
<div class="line">                {</div>
<div class="line">                <span class="comment">/* we have a self signed certificate */</span></div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="safestack_8h.html#af8495d81a6dda58254c7e12528af0118">sk_X509_num</a>(ctx-&gt;chain) == 1)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="comment">/* We have a single self signed certificate: see if</span></div>
<div class="line"><span class="comment">                         * we can find it in the store. We must have an exact</span></div>
<div class="line"><span class="comment">                         * match to avoid possible impersonation.</span></div>
<div class="line"><span class="comment">                         */</span></div>
<div class="line">                        ok = ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a71cb957e2f4e4e74b8bdd0a6961a2a93">get_issuer</a>(&amp;xtmp, ctx, x);</div>
<div class="line">                        <span class="keywordflow">if</span> ((ok &lt;= 0) || <a class="code" href="x509_8h.html#af7d8ab113a29212c9818af26c2573b42">X509_cmp</a>(x, xtmp)) </div>
<div class="line">                                {</div>
<div class="line">                                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a02b3dadbb929845bcaeca254930386d1">error</a>=<a class="code" href="x509__vfy_8h.html#aa4f5a3309eae833f85dff37c36fa039d">X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT</a>;</div>
<div class="line">                                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#adbbabe6efb4ed9745801ba73ac6e4f25">current_cert</a>=<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>;</div>
<div class="line">                                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a525adb8cc9af67d0094fccbd6eca4f4f">error_depth</a>=i-1;</div>
<div class="line">                                <span class="keywordflow">if</span> (ok == 1) X509_free(xtmp);</div>
<div class="line">                                bad_chain = 1;</div>
<div class="line">                                ok=<a class="code" href="pem_8h.html#a8dfe7b67aa87c6713a0e86b1456c1695">cb</a>(0,ctx);</div>
<div class="line">                                <span class="keywordflow">if</span> (!ok) <span class="keywordflow">goto</span> end;</div>
<div class="line">                                }</div>
<div class="line">                        <span class="keywordflow">else</span> </div>
<div class="line">                                {</div>
<div class="line">                                <span class="comment">/* We have a match: replace certificate with store version</span></div>
<div class="line"><span class="comment">                                 * so we get any trust settings.</span></div>
<div class="line"><span class="comment">                                 */</span></div>
<div class="line">                                X509_free(x);</div>
<div class="line">                                x = xtmp;</div>
<div class="line">                                (void)<a class="code" href="safestack_8h.html#a28e721982c28c36fda1913b3879d5717">sk_X509_set</a>(ctx-&gt;chain, i - 1, x);</div>
<div class="line">                                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#ab269810ffeac1c116f7fabe0ba50690f">last_untrusted</a>=0;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                        <span class="comment">/* extract and save self signed certificate for later use */</span></div>
<div class="line">                        chain_ss=<a class="code" href="safestack_8h.html#af4b6dd2a8e496c6290793aa049ef7fe7">sk_X509_pop</a>(ctx-&gt;chain);</div>
<div class="line">                        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#ab269810ffeac1c116f7fabe0ba50690f">last_untrusted</a>--;</div>
<div class="line">                        num--;</div>
<div class="line">                        x=<a class="code" href="safestack_8h.html#a6ce8e2d1c31859b9b27cd535caba4388">sk_X509_value</a>(ctx-&gt;chain,num-1);</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* We now lookup certs from the certificate store */</span></div>
<div class="line">        <span class="keywordflow">for</span> (;;)</div>
<div class="line">                {</div>
<div class="line">                <span class="comment">/* If we have enough, we break */</span></div>
<div class="line">                <span class="keywordflow">if</span> (depth &lt; num) <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* If we are self signed, we break */</span></div>
<div class="line">                <span class="keywordflow">if</span> (cert_self_signed(x))</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                ok = ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a71cb957e2f4e4e74b8bdd0a6961a2a93">get_issuer</a>(&amp;xtmp, ctx, x);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (ok &lt; 0) <span class="keywordflow">return</span> ok;</div>
<div class="line">                <span class="keywordflow">if</span> (ok == 0) <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                x = xtmp;</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="safestack_8h.html#a725eaf517607b2a1c8be5c25c8771003">sk_X509_push</a>(ctx-&gt;chain,x))</div>
<div class="line">                        {</div>
<div class="line">                        X509_free(xtmp);</div>
<div class="line">                        <a class="code" href="err_8h.html#a4f629efe059e17d94eee1068a90e96c9">X509err</a>(<a class="code" href="x509_8h.html#a0993d7ad5f0ca3dfd175c1c1a223328a">X509_F_X509_VERIFY_CERT</a>,<a class="code" href="err_8h.html#ae17d140bd9b2b4d297015e6a260d63c2">ERR_R_MALLOC_FAILURE</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                num++;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* we now have our chain, lets check it... */</span></div>
<div class="line"></div>
<div class="line">        i = check_trust(ctx);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* If explicitly rejected error */</span></div>
<div class="line">        <span class="keywordflow">if</span> (i == <a class="code" href="x509_8h.html#ae265a58b36b18e67d49d1bee70b90d43">X509_TRUST_REJECTED</a>)</div>
<div class="line">                <span class="keywordflow">goto</span> end;</div>
<div class="line">        <span class="comment">/* If not explicitly trusted then indicate error unless it&#39;s</span></div>
<div class="line"><span class="comment">         * a single self signed certificate in which case we&#39;ve indicated</span></div>
<div class="line"><span class="comment">         * an error already and set bad_chain == 1</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (i != <a class="code" href="x509_8h.html#a9ee09ff46895f74bd102553eb38216e6">X509_TRUST_TRUSTED</a> &amp;&amp; !bad_chain)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">if</span> ((chain_ss == <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) || !ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a86b65e1c8478435d76e06a68debaf4d6">check_issued</a>(ctx, x, chain_ss))</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#ab269810ffeac1c116f7fabe0ba50690f">last_untrusted</a> &gt;= num)</div>
<div class="line">                                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a02b3dadbb929845bcaeca254930386d1">error</a>=<a class="code" href="x509__vfy_8h.html#aa5446ec77613f1194d8b1e15e7aea7c3">X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY</a>;</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a02b3dadbb929845bcaeca254930386d1">error</a>=<a class="code" href="x509__vfy_8h.html#aa59e16e70157bc15c08ffc828334a64d">X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT</a>;</div>
<div class="line">                        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#adbbabe6efb4ed9745801ba73ac6e4f25">current_cert</a>=<a class="code" href="pem_8h.html#a97dc7cf0c4554cbe9a4b58bfe9a749f5">x</a>;</div>
<div class="line">                        }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line"></div>
<div class="line">                        <a class="code" href="safestack_8h.html#a725eaf517607b2a1c8be5c25c8771003">sk_X509_push</a>(ctx-&gt;chain,chain_ss);</div>
<div class="line">                        num++;</div>
<div class="line">                        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#ab269810ffeac1c116f7fabe0ba50690f">last_untrusted</a>=num;</div>
<div class="line">                        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#adbbabe6efb4ed9745801ba73ac6e4f25">current_cert</a>=chain_ss;</div>
<div class="line">                        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a02b3dadbb929845bcaeca254930386d1">error</a>=<a class="code" href="x509__vfy_8h.html#a2cfd82c853f3e9cc0a1b87c8c16452cb">X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN</a>;</div>
<div class="line">                        chain_ss=<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a525adb8cc9af67d0094fccbd6eca4f4f">error_depth</a>=num-1;</div>
<div class="line">                bad_chain = 1;</div>
<div class="line">                ok=<a class="code" href="pem_8h.html#a8dfe7b67aa87c6713a0e86b1456c1695">cb</a>(0,ctx);</div>
<div class="line">                <span class="keywordflow">if</span> (!ok) <span class="keywordflow">goto</span> end;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* We have the chain complete: now we need to check its purpose */</span></div>
<div class="line">        ok = check_chain_extensions(ctx);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!ok) <span class="keywordflow">goto</span> end;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Check name constraints */</span></div>
<div class="line"></div>
<div class="line">        ok = check_name_constraints(ctx);</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (!ok) <span class="keywordflow">goto</span> end;</div>
<div class="line"></div>
<div class="line">        ok = check_id(ctx);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!ok) <span class="keywordflow">goto</span> end;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* We may as well copy down any DSA parameters that are required */</span></div>
<div class="line">        <a class="code" href="x509_8h.html#a5b28966efdd28549644c52bde151dd72">X509_get_pubkey_parameters</a>(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>,ctx-&gt;chain);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Check revocation status: we do this after copying parameters</span></div>
<div class="line"><span class="comment">         * because they may be needed for CRL signature verification.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line"></div>
<div class="line">        ok = ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aa8fa9085118f8ac84f78bdaf1134cd14">check_revocation</a>(ctx);</div>
<div class="line">        <span class="keywordflow">if</span>(!ok) <span class="keywordflow">goto</span> end;</div>
<div class="line"></div>
<div class="line">        i = <a class="code" href="x509_8h.html#ab178c6d99ad9956fd12422a73d4644c2">X509_chain_check_suiteb</a>(&amp;ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a525adb8cc9af67d0094fccbd6eca4f4f">error_depth</a>, <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>, ctx-&gt;chain,</div>
<div class="line">                                                        ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>-&gt;<a class="code" href="structX509__VERIFY__PARAM__st.html#a3ef03c3f57b0a90d4182a057fe0c8d27">flags</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (i != <a class="code" href="x509__vfy_8h.html#ac0a59adf149eda514d31e7c33881ef3c">X509_V_OK</a>)</div>
<div class="line">                {</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a02b3dadbb929845bcaeca254930386d1">error</a> = i;</div>
<div class="line">                ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#adbbabe6efb4ed9745801ba73ac6e4f25">current_cert</a> = <a class="code" href="safestack_8h.html#a6ce8e2d1c31859b9b27cd535caba4388">sk_X509_value</a>(ctx-&gt;chain, ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a525adb8cc9af67d0094fccbd6eca4f4f">error_depth</a>);</div>
<div class="line">                ok = <a class="code" href="pem_8h.html#a8dfe7b67aa87c6713a0e86b1456c1695">cb</a>(0, ctx);</div>
<div class="line">                <span class="keywordflow">if</span> (!ok)</div>
<div class="line">                        <span class="keywordflow">goto</span> end;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* At this point, we have a chain and need to verify it */</span></div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a10a448cf0ca7c18d42e7c22e66f73df1">verify</a> != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>)</div>
<div class="line">                ok=ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a10a448cf0ca7c18d42e7c22e66f73df1">verify</a>(ctx);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                ok=internal_verify(ctx);</div>
<div class="line">        <span class="keywordflow">if</span>(!ok) <span class="keywordflow">goto</span> end;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef OPENSSL_NO_RFC3779</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="comment">/* RFC 3779 path validation, now that CRL check has been done */</span></div>
<div class="line">        ok = <a class="code" href="v3__asid_8c.html#a7e954d982292e18fe73221b59178fd9c">v3_asid_validate_path</a>(ctx);</div>
<div class="line">        <span class="keywordflow">if</span> (!ok) <span class="keywordflow">goto</span> end;</div>
<div class="line">        ok = <a class="code" href="v3__addr_8c.html#af7fabe2e8e3f0fc446e11064bc0a8cdf">v3_addr_validate_path</a>(ctx);</div>
<div class="line">        <span class="keywordflow">if</span> (!ok) <span class="keywordflow">goto</span> end;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        <span class="comment">/* If we get this far evaluate policies */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!bad_chain &amp;&amp; (ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#aacc66808b8d950db3d83395fdcd985b4">param</a>-&gt;<a class="code" href="structX509__VERIFY__PARAM__st.html#a3ef03c3f57b0a90d4182a057fe0c8d27">flags</a> &amp; <a class="code" href="x509__vfy_8h.html#a20d33a0dbea42d142aff71ed407be0db">X509_V_FLAG_POLICY_CHECK</a>))</div>
<div class="line">                ok = ctx-&gt;<a class="code" href="structx509__store__ctx__st.html#a123ebe8de204a406f18b02b8f35411dc">check_policy</a>(ctx);</div>
<div class="line">        <span class="keywordflow">if</span>(!ok) <span class="keywordflow">goto</span> end;</div>
<div class="line">        <span class="keywordflow">if</span> (0)</div>
<div class="line">                {</div>
<div class="line">end:</div>
<div class="line">                <a class="code" href="x509_8h.html#a5b28966efdd28549644c52bde151dd72">X509_get_pubkey_parameters</a>(<a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>,ctx-&gt;chain);</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">if</span> (sktmp != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) <a class="code" href="safestack_8h.html#a767fcef09cbbc07e5659329efcfec32c">sk_X509_free</a>(sktmp);</div>
<div class="line">        <span class="keywordflow">if</span> (chain_ss != <a class="code" href="e__des3_8c.html#abd96bf38ecc88042908f20aa5e5752cc">NULL</a>) X509_free(chain_ss);</div>
<div class="line">        <span class="keywordflow">return</span> ok;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<h2>Variable Documentation</h2>
<a class="anchor" id="ad4cb0605e82042158081c00054b67e56"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char X509_version[] = &quot;X.509&quot; OPENSSL_VERSION_PTEXT</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="x509__vfy_8c_source.html#l00140">140</a> of file <a class="el" href="x509__vfy_8c_source.html">x509_vfy.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
